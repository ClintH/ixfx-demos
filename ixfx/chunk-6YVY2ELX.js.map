{"version":3,"sources":["../node_modules/fp-ts/lib/function.js","../node_modules/fp-ts/lib/internal.js","../node_modules/fp-ts/lib/Apply.js","../node_modules/fp-ts/lib/Chain.js","../node_modules/fp-ts/lib/FromEither.js","../node_modules/fp-ts/lib/Functor.js","../node_modules/fp-ts/lib/Eq.js","../node_modules/fp-ts/lib/Ord.js","../node_modules/fp-ts/lib/Magma.js","../node_modules/fp-ts/lib/Semigroup.js","../node_modules/fp-ts/lib/ReadonlyNonEmptyArray.js","../node_modules/fp-ts/lib/NonEmptyArray.js","../node_modules/fp-ts/lib/number.js","../node_modules/fp-ts/lib/Separated.js","../node_modules/fp-ts/lib/Witherable.js","../node_modules/fp-ts/lib/Zero.js","../node_modules/fp-ts/lib/ReadonlyArray.js","../node_modules/fp-ts/lib/Array.js","../node_modules/fp-ts/lib/string.js","../node_modules/rxjs/node_modules/tslib/tslib.js","../node_modules/json5/dist/index.js","../src/KeyValue.ts","../src/collections/Arrays.ts","../src/Random.ts","../src/modulation/Easing.ts","../src/data/index.ts","../src/data/Normalise.ts","../src/collections/NumericArrays.ts","../src/data/Scale.ts","../src/geometry/index.ts","../src/geometry/Arc.ts","../src/geometry/Point.ts","../src/geometry/Line.ts","../src/collections/index.ts","../src/Util.ts","../src/Text.ts","../src/Debug.ts","../src/collections/Map.ts","../src/collections/ExpiringMap.ts","../src/visual/Colour.ts","../node_modules/d3-color/src/define.js","../node_modules/d3-color/src/color.js","../node_modules/d3-color/src/math.js","../node_modules/d3-color/src/lab.js","../node_modules/d3-color/src/cubehelix.js","../node_modules/d3-interpolate/src/basis.js","../node_modules/d3-interpolate/src/basisClosed.js","../node_modules/d3-interpolate/src/constant.js","../node_modules/d3-interpolate/src/color.js","../node_modules/d3-interpolate/src/rgb.js","../node_modules/d3-interpolate/src/numberArray.js","../node_modules/d3-interpolate/src/array.js","../node_modules/d3-interpolate/src/date.js","../node_modules/d3-interpolate/src/number.js","../node_modules/d3-interpolate/src/object.js","../node_modules/d3-interpolate/src/string.js","../node_modules/d3-interpolate/src/value.js","../node_modules/d3-interpolate/src/hsl.js","../node_modules/d3-interpolate/src/lab.js","../node_modules/d3-interpolate/src/hcl.js","../node_modules/d3-interpolate/src/cubehelix.js","../node_modules/d3-interpolate/src/piecewise.js","../src/collections/CircularArray.ts","../src/collections/MapMultiMutable.ts","../src/collections/Stack.ts","../src/collections/Queue.ts","../src/collections/MapImmutable.ts","../src/collections/MapMutable.ts","../src/Numbers.ts","../src/data/TrackerBase.ts","../src/data/PrimitiveTracker.ts","../src/data/NumberTracker.ts","../src/geometry/Bezier.ts","../node_modules/bezier-js/src/utils.js","../node_modules/bezier-js/src/poly-bezier.js","../node_modules/bezier-js/src/bezier.js","../src/geometry/Circle.ts","../src/geometry/CompoundPath.ts","../src/geometry/Grid.ts","../src/geometry/Path.ts","../src/geometry/Rect.ts","../src/geometry/Ellipse.ts","../src/geometry/Shape.ts","../src/geometry/Polar.ts","../src/geometry/Vector.ts","../src/geometry/Waypoint.ts","../src/geometry/Sphere.ts","../src/geometry/Scaler.ts","../src/geometry/SurfacePoints.ts","../src/geometry/Triangle.ts","../src/geometry/TriangleEquilateral.ts","../src/geometry/TriangleRight.ts","../src/geometry/TriangleIsosceles.ts","../src/io/index.ts","../src/io/NordicBleDevice.ts","../src/io/Codec.ts","../src/io/StringReceiveBuffer.ts","../src/io/StringWriteBuffer.ts","../src/flow/Retry.ts","../src/io/BleDevice.ts","../src/io/AudioAnalyser.ts","../src/io/AudioVisualiser.ts","../src/io/Espruino.ts","../src/io/EspruinoBleDevice.ts","../src/io/Serial.ts","../src/io/JsonDevice.ts","../src/io/EspruinoSerialDevice.ts","../src/io/Camera.ts","../src/io/VideoFile.ts","../src/visual/Video.ts","../src/io/FrameProcessor.ts","../src/visual/index.ts","../src/visual/Drawing.ts","../node_modules/rxjs/node_modules/tslib/modules/index.js","../node_modules/rxjs/src/internal/util/isFunction.ts","../node_modules/rxjs/src/internal/util/createErrorClass.ts","../node_modules/rxjs/src/internal/util/UnsubscriptionError.ts","../node_modules/rxjs/src/internal/util/arrRemove.ts","../node_modules/rxjs/src/internal/Subscription.ts","../node_modules/rxjs/src/internal/config.ts","../node_modules/rxjs/src/internal/scheduler/timeoutProvider.ts","../node_modules/rxjs/src/internal/util/reportUnhandledError.ts","../node_modules/rxjs/src/internal/util/noop.ts","../node_modules/rxjs/src/internal/NotificationFactories.ts","../node_modules/rxjs/src/internal/util/errorContext.ts","../node_modules/rxjs/src/internal/Subscriber.ts","../node_modules/rxjs/src/internal/symbol/observable.ts","../node_modules/rxjs/src/internal/util/identity.ts","../node_modules/rxjs/src/internal/util/pipe.ts","../node_modules/rxjs/src/internal/Observable.ts","../node_modules/rxjs/src/internal/util/lift.ts","../node_modules/rxjs/src/internal/operators/OperatorSubscriber.ts","../node_modules/rxjs/src/internal/scheduler/dateTimestampProvider.ts","../node_modules/rxjs/src/internal/scheduler/Action.ts","../node_modules/rxjs/src/internal/scheduler/intervalProvider.ts","../node_modules/rxjs/src/internal/scheduler/AsyncAction.ts","../node_modules/rxjs/src/internal/Scheduler.ts","../node_modules/rxjs/src/internal/scheduler/AsyncScheduler.ts","../node_modules/rxjs/src/internal/scheduler/async.ts","../node_modules/rxjs/src/internal/util/isArrayLike.ts","../node_modules/rxjs/src/internal/util/isPromise.ts","../node_modules/rxjs/src/internal/util/isInteropObservable.ts","../node_modules/rxjs/src/internal/util/isAsyncIterable.ts","../node_modules/rxjs/src/internal/util/throwUnobservableError.ts","../node_modules/rxjs/src/internal/symbol/iterator.ts","../node_modules/rxjs/src/internal/util/isIterable.ts","../node_modules/rxjs/src/internal/util/isReadableStreamLike.ts","../node_modules/rxjs/src/internal/observable/innerFrom.ts","../node_modules/rxjs/src/internal/util/executeSchedule.ts","../node_modules/rxjs/src/internal/operators/map.ts","../node_modules/rxjs/src/internal/util/mapOneOrManyArgs.ts","../node_modules/rxjs/src/internal/operators/mergeInternals.ts","../node_modules/rxjs/src/internal/operators/mergeMap.ts","../node_modules/rxjs/src/internal/observable/fromEvent.ts","../node_modules/rxjs/src/internal/operators/debounceTime.ts","../src/dom/Util.ts","../src/visual/Svg.ts","../src/visual/SvgMarkers.ts","../src/visual/SvgElements.ts","../src/visual/Plot.ts","../src/visual/Plot2.ts","../src/visual/SceneGraph.ts","../src/visual/Palette.ts","../src/dom/index.ts","../src/dom/ShadowDom.ts","../src/dom/Log.ts","../src/dom/DomRx.ts","../src/dom/Forms.ts","../src/data/TrackedValue.ts","../src/data/ObjectTracker.ts","../src/data/PointTracker.ts","../src/dom/PointerVisualise.ts","../src/dom/ErrorHandler.ts","../src/dom/DragDrop.ts","../src/modulation/index.ts","../src/modulation/Envelope.ts","../src/modulation/Forces.ts","../src/modulation/Oscillator.ts","../src/data/FrequencyMutable.ts","../src/data/MovingAverage.ts","../src/data/IntervalTracker.ts","../src/data/Flip.ts","../src/data/Wrap.ts","../src/data/Correlate.ts","../src/data/Pool.ts","../src/data/Interpolate.ts"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getEndomorphismMonoid = exports.not = exports.SK = exports.hole = exports.pipe = exports.untupled = exports.tupled = exports.absurd = exports.decrement = exports.increment = exports.tuple = exports.flow = exports.flip = exports.constVoid = exports.constUndefined = exports.constNull = exports.constFalse = exports.constTrue = exports.constant = exports.unsafeCoerce = exports.identity = exports.apply = exports.getRing = exports.getSemiring = exports.getMonoid = exports.getSemigroup = exports.getBooleanAlgebra = void 0;\n// -------------------------------------------------------------------------------------\n// instances\n// -------------------------------------------------------------------------------------\n/**\n * @category instances\n * @since 2.10.0\n */\nvar getBooleanAlgebra = function (B) { return function () { return ({\n    meet: function (x, y) { return function (a) { return B.meet(x(a), y(a)); }; },\n    join: function (x, y) { return function (a) { return B.join(x(a), y(a)); }; },\n    zero: function () { return B.zero; },\n    one: function () { return B.one; },\n    implies: function (x, y) { return function (a) { return B.implies(x(a), y(a)); }; },\n    not: function (x) { return function (a) { return B.not(x(a)); }; }\n}); }; };\nexports.getBooleanAlgebra = getBooleanAlgebra;\n/**\n * Unary functions form a semigroup as long as you can provide a semigroup for the codomain.\n *\n * @example\n * import { Predicate, getSemigroup } from 'fp-ts/function'\n * import * as B from 'fp-ts/boolean'\n *\n * const f: Predicate<number> = (n) => n <= 2\n * const g: Predicate<number> = (n) => n >= 0\n *\n * const S1 = getSemigroup(B.SemigroupAll)<number>()\n *\n * assert.deepStrictEqual(S1.concat(f, g)(1), true)\n * assert.deepStrictEqual(S1.concat(f, g)(3), false)\n *\n * const S2 = getSemigroup(B.SemigroupAny)<number>()\n *\n * assert.deepStrictEqual(S2.concat(f, g)(1), true)\n * assert.deepStrictEqual(S2.concat(f, g)(3), true)\n *\n * @category instances\n * @since 2.10.0\n */\nvar getSemigroup = function (S) { return function () { return ({\n    concat: function (f, g) { return function (a) { return S.concat(f(a), g(a)); }; }\n}); }; };\nexports.getSemigroup = getSemigroup;\n/**\n * Unary functions form a monoid as long as you can provide a monoid for the codomain.\n *\n * @example\n * import { Predicate } from 'fp-ts/Predicate'\n * import { getMonoid } from 'fp-ts/function'\n * import * as B from 'fp-ts/boolean'\n *\n * const f: Predicate<number> = (n) => n <= 2\n * const g: Predicate<number> = (n) => n >= 0\n *\n * const M1 = getMonoid(B.MonoidAll)<number>()\n *\n * assert.deepStrictEqual(M1.concat(f, g)(1), true)\n * assert.deepStrictEqual(M1.concat(f, g)(3), false)\n *\n * const M2 = getMonoid(B.MonoidAny)<number>()\n *\n * assert.deepStrictEqual(M2.concat(f, g)(1), true)\n * assert.deepStrictEqual(M2.concat(f, g)(3), true)\n *\n * @category instances\n * @since 2.10.0\n */\nvar getMonoid = function (M) {\n    var getSemigroupM = (0, exports.getSemigroup)(M);\n    return function () { return ({\n        concat: getSemigroupM().concat,\n        empty: function () { return M.empty; }\n    }); };\n};\nexports.getMonoid = getMonoid;\n/**\n * @category instances\n * @since 2.10.0\n */\nvar getSemiring = function (S) { return ({\n    add: function (f, g) { return function (x) { return S.add(f(x), g(x)); }; },\n    zero: function () { return S.zero; },\n    mul: function (f, g) { return function (x) { return S.mul(f(x), g(x)); }; },\n    one: function () { return S.one; }\n}); };\nexports.getSemiring = getSemiring;\n/**\n * @category instances\n * @since 2.10.0\n */\nvar getRing = function (R) {\n    var S = (0, exports.getSemiring)(R);\n    return {\n        add: S.add,\n        mul: S.mul,\n        one: S.one,\n        zero: S.zero,\n        sub: function (f, g) { return function (x) { return R.sub(f(x), g(x)); }; }\n    };\n};\nexports.getRing = getRing;\n// -------------------------------------------------------------------------------------\n// utils\n// -------------------------------------------------------------------------------------\n/**\n * @since 2.11.0\n */\nvar apply = function (a) { return function (f) { return f(a); }; };\nexports.apply = apply;\n/**\n * @since 2.0.0\n */\nfunction identity(a) {\n    return a;\n}\nexports.identity = identity;\n/**\n * @since 2.0.0\n */\nexports.unsafeCoerce = identity;\n/**\n * @since 2.0.0\n */\nfunction constant(a) {\n    return function () { return a; };\n}\nexports.constant = constant;\n/**\n * A thunk that returns always `true`.\n *\n * @since 2.0.0\n */\nexports.constTrue = constant(true);\n/**\n * A thunk that returns always `false`.\n *\n * @since 2.0.0\n */\nexports.constFalse = constant(false);\n/**\n * A thunk that returns always `null`.\n *\n * @since 2.0.0\n */\nexports.constNull = constant(null);\n/**\n * A thunk that returns always `undefined`.\n *\n * @since 2.0.0\n */\nexports.constUndefined = constant(undefined);\n/**\n * A thunk that returns always `void`.\n *\n * @since 2.0.0\n */\nexports.constVoid = exports.constUndefined;\n/**\n * Flips the order of the arguments of a function of two arguments.\n *\n * @since 2.0.0\n */\nfunction flip(f) {\n    return function (b, a) { return f(a, b); };\n}\nexports.flip = flip;\nfunction flow(ab, bc, cd, de, ef, fg, gh, hi, ij) {\n    switch (arguments.length) {\n        case 1:\n            return ab;\n        case 2:\n            return function () {\n                return bc(ab.apply(this, arguments));\n            };\n        case 3:\n            return function () {\n                return cd(bc(ab.apply(this, arguments)));\n            };\n        case 4:\n            return function () {\n                return de(cd(bc(ab.apply(this, arguments))));\n            };\n        case 5:\n            return function () {\n                return ef(de(cd(bc(ab.apply(this, arguments)))));\n            };\n        case 6:\n            return function () {\n                return fg(ef(de(cd(bc(ab.apply(this, arguments))))));\n            };\n        case 7:\n            return function () {\n                return gh(fg(ef(de(cd(bc(ab.apply(this, arguments)))))));\n            };\n        case 8:\n            return function () {\n                return hi(gh(fg(ef(de(cd(bc(ab.apply(this, arguments))))))));\n            };\n        case 9:\n            return function () {\n                return ij(hi(gh(fg(ef(de(cd(bc(ab.apply(this, arguments)))))))));\n            };\n    }\n    return;\n}\nexports.flow = flow;\n/**\n * @since 2.0.0\n */\nfunction tuple() {\n    var t = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        t[_i] = arguments[_i];\n    }\n    return t;\n}\nexports.tuple = tuple;\n/**\n * @since 2.0.0\n */\nfunction increment(n) {\n    return n + 1;\n}\nexports.increment = increment;\n/**\n * @since 2.0.0\n */\nfunction decrement(n) {\n    return n - 1;\n}\nexports.decrement = decrement;\n/**\n * @since 2.0.0\n */\nfunction absurd(_) {\n    throw new Error('Called `absurd` function which should be uncallable');\n}\nexports.absurd = absurd;\n/**\n * Creates a tupled version of this function: instead of `n` arguments, it accepts a single tuple argument.\n *\n * @example\n * import { tupled } from 'fp-ts/function'\n *\n * const add = tupled((x: number, y: number): number => x + y)\n *\n * assert.strictEqual(add([1, 2]), 3)\n *\n * @since 2.4.0\n */\nfunction tupled(f) {\n    return function (a) { return f.apply(void 0, a); };\n}\nexports.tupled = tupled;\n/**\n * Inverse function of `tupled`\n *\n * @since 2.4.0\n */\nfunction untupled(f) {\n    return function () {\n        var a = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            a[_i] = arguments[_i];\n        }\n        return f(a);\n    };\n}\nexports.untupled = untupled;\nfunction pipe(a, ab, bc, cd, de, ef, fg, gh, hi) {\n    switch (arguments.length) {\n        case 1:\n            return a;\n        case 2:\n            return ab(a);\n        case 3:\n            return bc(ab(a));\n        case 4:\n            return cd(bc(ab(a)));\n        case 5:\n            return de(cd(bc(ab(a))));\n        case 6:\n            return ef(de(cd(bc(ab(a)))));\n        case 7:\n            return fg(ef(de(cd(bc(ab(a))))));\n        case 8:\n            return gh(fg(ef(de(cd(bc(ab(a)))))));\n        case 9:\n            return hi(gh(fg(ef(de(cd(bc(ab(a))))))));\n        default: {\n            var ret = arguments[0];\n            for (var i = 1; i < arguments.length; i++) {\n                ret = arguments[i](ret);\n            }\n            return ret;\n        }\n    }\n}\nexports.pipe = pipe;\n/**\n * Type hole simulation\n *\n * @since 2.7.0\n */\nexports.hole = absurd;\n/**\n * @since 2.11.0\n */\nvar SK = function (_, b) { return b; };\nexports.SK = SK;\n/**\n * Use `Predicate` module instead.\n *\n * @since 2.0.0\n * @deprecated\n */\nfunction not(predicate) {\n    return function (a) { return !predicate(a); };\n}\nexports.not = not;\n/**\n * Use `Endomorphism` module instead.\n *\n * @category instances\n * @since 2.10.0\n * @deprecated\n */\nvar getEndomorphismMonoid = function () { return ({\n    concat: function (first, second) { return flow(first, second); },\n    empty: identity\n}); };\nexports.getEndomorphismMonoid = getEndomorphismMonoid;\n","\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.fromReadonlyNonEmptyArray = exports.has = exports.emptyRecord = exports.emptyReadonlyArray = exports.tail = exports.head = exports.isNonEmpty = exports.singleton = exports.right = exports.left = exports.isRight = exports.isLeft = exports.some = exports.none = exports.isSome = exports.isNone = void 0;\n// -------------------------------------------------------------------------------------\n// Option\n// -------------------------------------------------------------------------------------\n/** @internal */\nvar isNone = function (fa) { return fa._tag === 'None'; };\nexports.isNone = isNone;\n/** @internal */\nvar isSome = function (fa) { return fa._tag === 'Some'; };\nexports.isSome = isSome;\n/** @internal */\nexports.none = { _tag: 'None' };\n/** @internal */\nvar some = function (a) { return ({ _tag: 'Some', value: a }); };\nexports.some = some;\n// -------------------------------------------------------------------------------------\n// Either\n// -------------------------------------------------------------------------------------\n/** @internal */\nvar isLeft = function (ma) { return ma._tag === 'Left'; };\nexports.isLeft = isLeft;\n/** @internal */\nvar isRight = function (ma) { return ma._tag === 'Right'; };\nexports.isRight = isRight;\n/** @internal */\nvar left = function (e) { return ({ _tag: 'Left', left: e }); };\nexports.left = left;\n/** @internal */\nvar right = function (a) { return ({ _tag: 'Right', right: a }); };\nexports.right = right;\n// -------------------------------------------------------------------------------------\n// ReadonlyNonEmptyArray\n// -------------------------------------------------------------------------------------\n/** @internal */\nvar singleton = function (a) { return [a]; };\nexports.singleton = singleton;\n/** @internal */\nvar isNonEmpty = function (as) { return as.length > 0; };\nexports.isNonEmpty = isNonEmpty;\n/** @internal */\nvar head = function (as) { return as[0]; };\nexports.head = head;\n/** @internal */\nvar tail = function (as) { return as.slice(1); };\nexports.tail = tail;\n// -------------------------------------------------------------------------------------\n// empty\n// -------------------------------------------------------------------------------------\n/** @internal */\nexports.emptyReadonlyArray = [];\n/** @internal */\nexports.emptyRecord = {};\n// -------------------------------------------------------------------------------------\n// Record\n// -------------------------------------------------------------------------------------\n/** @internal */\nexports.has = Object.prototype.hasOwnProperty;\n// -------------------------------------------------------------------------------------\n// NonEmptyArray\n// -------------------------------------------------------------------------------------\n/** @internal */\nvar fromReadonlyNonEmptyArray = function (as) { return __spreadArray([as[0]], as.slice(1), true); };\nexports.fromReadonlyNonEmptyArray = fromReadonlyNonEmptyArray;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sequenceS = exports.sequenceT = exports.getApplySemigroup = exports.apS = exports.apSecond = exports.apFirst = exports.ap = void 0;\nvar function_1 = require(\"./function\");\nvar _ = __importStar(require(\"./internal\"));\nfunction ap(F, G) {\n    return function (fa) { return function (fab) {\n        return F.ap(F.map(fab, function (gab) { return function (ga) { return G.ap(gab, ga); }; }), fa);\n    }; };\n}\nexports.ap = ap;\nfunction apFirst(A) {\n    return function (second) { return function (first) {\n        return A.ap(A.map(first, function (a) { return function () { return a; }; }), second);\n    }; };\n}\nexports.apFirst = apFirst;\nfunction apSecond(A) {\n    return function (second) { return function (first) {\n        return A.ap(A.map(first, function () { return function (b) { return b; }; }), second);\n    }; };\n}\nexports.apSecond = apSecond;\nfunction apS(F) {\n    return function (name, fb) { return function (fa) {\n        return F.ap(F.map(fa, function (a) { return function (b) {\n            var _a;\n            return Object.assign({}, a, (_a = {}, _a[name] = b, _a));\n        }; }), fb);\n    }; };\n}\nexports.apS = apS;\nfunction getApplySemigroup(F) {\n    return function (S) { return ({\n        concat: function (first, second) {\n            return F.ap(F.map(first, function (x) { return function (y) { return S.concat(x, y); }; }), second);\n        }\n    }); };\n}\nexports.getApplySemigroup = getApplySemigroup;\nfunction curried(f, n, acc) {\n    return function (x) {\n        var combined = Array(acc.length + 1);\n        for (var i = 0; i < acc.length; i++) {\n            combined[i] = acc[i];\n        }\n        combined[acc.length] = x;\n        return n === 0 ? f.apply(null, combined) : curried(f, n - 1, combined);\n    };\n}\nvar tupleConstructors = {\n    1: function (a) { return [a]; },\n    2: function (a) { return function (b) { return [a, b]; }; },\n    3: function (a) { return function (b) { return function (c) { return [a, b, c]; }; }; },\n    4: function (a) { return function (b) { return function (c) { return function (d) { return [a, b, c, d]; }; }; }; },\n    5: function (a) { return function (b) { return function (c) { return function (d) { return function (e) { return [a, b, c, d, e]; }; }; }; }; }\n};\nfunction getTupleConstructor(len) {\n    if (!_.has.call(tupleConstructors, len)) {\n        tupleConstructors[len] = curried(function_1.tuple, len - 1, []);\n    }\n    return tupleConstructors[len];\n}\nfunction sequenceT(F) {\n    return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var len = args.length;\n        var f = getTupleConstructor(len);\n        var fas = F.map(args[0], f);\n        for (var i = 1; i < len; i++) {\n            fas = F.ap(fas, args[i]);\n        }\n        return fas;\n    };\n}\nexports.sequenceT = sequenceT;\nfunction getRecordConstructor(keys) {\n    var len = keys.length;\n    switch (len) {\n        case 1:\n            return function (a) {\n                var _a;\n                return (_a = {}, _a[keys[0]] = a, _a);\n            };\n        case 2:\n            return function (a) { return function (b) {\n                var _a;\n                return (_a = {}, _a[keys[0]] = a, _a[keys[1]] = b, _a);\n            }; };\n        case 3:\n            return function (a) { return function (b) { return function (c) {\n                var _a;\n                return (_a = {}, _a[keys[0]] = a, _a[keys[1]] = b, _a[keys[2]] = c, _a);\n            }; }; };\n        case 4:\n            return function (a) { return function (b) { return function (c) { return function (d) {\n                var _a;\n                return (_a = {},\n                    _a[keys[0]] = a,\n                    _a[keys[1]] = b,\n                    _a[keys[2]] = c,\n                    _a[keys[3]] = d,\n                    _a);\n            }; }; }; };\n        case 5:\n            return function (a) { return function (b) { return function (c) { return function (d) { return function (e) {\n                var _a;\n                return (_a = {},\n                    _a[keys[0]] = a,\n                    _a[keys[1]] = b,\n                    _a[keys[2]] = c,\n                    _a[keys[3]] = d,\n                    _a[keys[4]] = e,\n                    _a);\n            }; }; }; }; };\n        default:\n            return curried(function () {\n                var args = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    args[_i] = arguments[_i];\n                }\n                var r = {};\n                for (var i = 0; i < len; i++) {\n                    r[keys[i]] = args[i];\n                }\n                return r;\n            }, len - 1, []);\n    }\n}\nfunction sequenceS(F) {\n    return function (r) {\n        var keys = Object.keys(r);\n        var len = keys.length;\n        var f = getRecordConstructor(keys);\n        var fr = F.map(r[keys[0]], f);\n        for (var i = 1; i < len; i++) {\n            fr = F.ap(fr, r[keys[i]]);\n        }\n        return fr;\n    };\n}\nexports.sequenceS = sequenceS;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.bind = exports.chainFirst = void 0;\nfunction chainFirst(M) {\n    return function (f) { return function (first) { return M.chain(first, function (a) { return M.map(f(a), function () { return a; }); }); }; };\n}\nexports.chainFirst = chainFirst;\nfunction bind(M) {\n    return function (name, f) { return function (ma) { return M.chain(ma, function (a) { return M.map(f(a), function (b) {\n        var _a;\n        return Object.assign({}, a, (_a = {}, _a[name] = b, _a));\n    }); }); }; };\n}\nexports.bind = bind;\n","\"use strict\";\n/**\n * The `FromEither` type class represents those data types which support errors.\n *\n * @since 2.10.0\n */\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.filterOrElse = exports.chainFirstEitherK = exports.chainEitherK = exports.fromEitherK = exports.chainOptionK = exports.fromOptionK = exports.fromPredicate = exports.fromOption = void 0;\nvar Chain_1 = require(\"./Chain\");\nvar function_1 = require(\"./function\");\nvar _ = __importStar(require(\"./internal\"));\nfunction fromOption(F) {\n    return function (onNone) { return function (ma) { return F.fromEither(_.isNone(ma) ? _.left(onNone()) : _.right(ma.value)); }; };\n}\nexports.fromOption = fromOption;\nfunction fromPredicate(F) {\n    return function (predicate, onFalse) { return function (a) {\n        return F.fromEither(predicate(a) ? _.right(a) : _.left(onFalse(a)));\n    }; };\n}\nexports.fromPredicate = fromPredicate;\nfunction fromOptionK(F) {\n    var fromOptionF = fromOption(F);\n    return function (onNone) {\n        var from = fromOptionF(onNone);\n        return function (f) { return (0, function_1.flow)(f, from); };\n    };\n}\nexports.fromOptionK = fromOptionK;\nfunction chainOptionK(F, M) {\n    var fromOptionKF = fromOptionK(F);\n    return function (onNone) {\n        var from = fromOptionKF(onNone);\n        return function (f) { return function (ma) { return M.chain(ma, from(f)); }; };\n    };\n}\nexports.chainOptionK = chainOptionK;\nfunction fromEitherK(F) {\n    return function (f) { return (0, function_1.flow)(f, F.fromEither); };\n}\nexports.fromEitherK = fromEitherK;\nfunction chainEitherK(F, M) {\n    var fromEitherKF = fromEitherK(F);\n    return function (f) { return function (ma) { return M.chain(ma, fromEitherKF(f)); }; };\n}\nexports.chainEitherK = chainEitherK;\nfunction chainFirstEitherK(F, M) {\n    return (0, function_1.flow)(fromEitherK(F), (0, Chain_1.chainFirst)(M));\n}\nexports.chainFirstEitherK = chainFirstEitherK;\nfunction filterOrElse(F, M) {\n    return function (predicate, onFalse) { return function (ma) {\n        return M.chain(ma, function (a) { return F.fromEither(predicate(a) ? _.right(a) : _.left(onFalse(a))); });\n    }; };\n}\nexports.filterOrElse = filterOrElse;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getFunctorComposition = exports.bindTo = exports.flap = exports.map = void 0;\n/**\n * A `Functor` is a type constructor which supports a mapping operation `map`.\n *\n * `map` can be used to turn functions `a -> b` into functions `f a -> f b` whose argument and return types use the type\n * constructor `f` to represent some computational context.\n *\n * Instances must satisfy the following laws:\n *\n * 1. Identity: `F.map(fa, a => a) <-> fa`\n * 2. Composition: `F.map(fa, a => bc(ab(a))) <-> F.map(F.map(fa, ab), bc)`\n *\n * @since 2.0.0\n */\nvar function_1 = require(\"./function\");\nfunction map(F, G) {\n    return function (f) { return function (fa) { return F.map(fa, function (ga) { return G.map(ga, f); }); }; };\n}\nexports.map = map;\nfunction flap(F) {\n    return function (a) { return function (fab) { return F.map(fab, function (f) { return f(a); }); }; };\n}\nexports.flap = flap;\nfunction bindTo(F) {\n    return function (name) { return function (fa) { return F.map(fa, function (a) {\n        var _a;\n        return (_a = {}, _a[name] = a, _a);\n    }); }; };\n}\nexports.bindTo = bindTo;\n/** @deprecated */\nfunction getFunctorComposition(F, G) {\n    var _map = map(F, G);\n    return {\n        map: function (fga, f) { return (0, function_1.pipe)(fga, _map(f)); }\n    };\n}\nexports.getFunctorComposition = getFunctorComposition;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.eqDate = exports.eqNumber = exports.eqString = exports.eqBoolean = exports.eq = exports.strictEqual = exports.getStructEq = exports.getTupleEq = exports.Contravariant = exports.getMonoid = exports.getSemigroup = exports.eqStrict = exports.URI = exports.contramap = exports.tuple = exports.struct = exports.fromEquals = void 0;\nvar function_1 = require(\"./function\");\n// -------------------------------------------------------------------------------------\n// constructors\n// -------------------------------------------------------------------------------------\n/**\n * @category constructors\n * @since 2.0.0\n */\nvar fromEquals = function (equals) { return ({\n    equals: function (x, y) { return x === y || equals(x, y); }\n}); };\nexports.fromEquals = fromEquals;\n// -------------------------------------------------------------------------------------\n// combinators\n// -------------------------------------------------------------------------------------\n/**\n * @category combinators\n * @since 2.10.0\n */\nvar struct = function (eqs) {\n    return (0, exports.fromEquals)(function (first, second) {\n        for (var key in eqs) {\n            if (!eqs[key].equals(first[key], second[key])) {\n                return false;\n            }\n        }\n        return true;\n    });\n};\nexports.struct = struct;\n/**\n * Given a tuple of `Eq`s returns a `Eq` for the tuple\n *\n * @example\n * import { tuple } from 'fp-ts/Eq'\n * import * as S from 'fp-ts/string'\n * import * as N from 'fp-ts/number'\n * import * as B from 'fp-ts/boolean'\n *\n * const E = tuple(S.Eq, N.Eq, B.Eq)\n * assert.strictEqual(E.equals(['a', 1, true], ['a', 1, true]), true)\n * assert.strictEqual(E.equals(['a', 1, true], ['b', 1, true]), false)\n * assert.strictEqual(E.equals(['a', 1, true], ['a', 2, true]), false)\n * assert.strictEqual(E.equals(['a', 1, true], ['a', 1, false]), false)\n *\n * @category combinators\n * @since 2.10.0\n */\nvar tuple = function () {\n    var eqs = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        eqs[_i] = arguments[_i];\n    }\n    return (0, exports.fromEquals)(function (first, second) { return eqs.every(function (E, i) { return E.equals(first[i], second[i]); }); });\n};\nexports.tuple = tuple;\n// -------------------------------------------------------------------------------------\n// non-pipeables\n// -------------------------------------------------------------------------------------\n/* istanbul ignore next */\nvar contramap_ = function (fa, f) { return (0, function_1.pipe)(fa, (0, exports.contramap)(f)); };\n// -------------------------------------------------------------------------------------\n// type class members\n// -------------------------------------------------------------------------------------\n/**\n * @category Contravariant\n * @since 2.0.0\n */\nvar contramap = function (f) { return function (fa) {\n    return (0, exports.fromEquals)(function (x, y) { return fa.equals(f(x), f(y)); });\n}; };\nexports.contramap = contramap;\n// -------------------------------------------------------------------------------------\n// instances\n// -------------------------------------------------------------------------------------\n/**\n * @category instances\n * @since 2.0.0\n */\nexports.URI = 'Eq';\n/**\n * @category instances\n * @since 2.5.0\n */\nexports.eqStrict = {\n    equals: function (a, b) { return a === b; }\n};\nvar empty = {\n    equals: function () { return true; }\n};\n/**\n * @category instances\n * @since 2.10.0\n */\nvar getSemigroup = function () { return ({\n    concat: function (x, y) { return (0, exports.fromEquals)(function (a, b) { return x.equals(a, b) && y.equals(a, b); }); }\n}); };\nexports.getSemigroup = getSemigroup;\n/**\n * @category instances\n * @since 2.6.0\n */\nvar getMonoid = function () { return ({\n    concat: (0, exports.getSemigroup)().concat,\n    empty: empty\n}); };\nexports.getMonoid = getMonoid;\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Contravariant = {\n    URI: exports.URI,\n    contramap: contramap_\n};\n// -------------------------------------------------------------------------------------\n// deprecated\n// -------------------------------------------------------------------------------------\n/**\n * Use [`tuple`](#tuple) instead.\n *\n * @category combinators\n * @since 2.0.0\n * @deprecated\n */\nexports.getTupleEq = exports.tuple;\n/**\n * Use [`struct`](#struct) instead.\n *\n * @category combinators\n * @since 2.0.0\n * @deprecated\n */\nexports.getStructEq = exports.struct;\n/**\n * Use [`eqStrict`](#eqstrict) instead\n *\n * @since 2.0.0\n * @deprecated\n */\nexports.strictEqual = exports.eqStrict.equals;\n/**\n * This instance is deprecated, use small, specific instances instead.\n * For example if a function needs a `Contravariant` instance, pass `E.Contravariant` instead of `E.eq`\n * (where `E` is from `import E from 'fp-ts/Eq'`)\n *\n * @category instances\n * @since 2.0.0\n * @deprecated\n */\nexports.eq = exports.Contravariant;\n/**\n * Use [`Eq`](./boolean.ts.html#eq) instead.\n *\n * @category instances\n * @since 2.0.0\n * @deprecated\n */\nexports.eqBoolean = exports.eqStrict;\n/**\n * Use [`Eq`](./string.ts.html#eq) instead.\n *\n * @category instances\n * @since 2.0.0\n * @deprecated\n */\nexports.eqString = exports.eqStrict;\n/**\n * Use [`Eq`](./number.ts.html#eq) instead.\n *\n * @category instances\n * @since 2.0.0\n * @deprecated\n */\nexports.eqNumber = exports.eqStrict;\n/**\n * Use [`Eq`](./Date.ts.html#eq) instead.\n *\n * @category instances\n * @since 2.0.0\n * @deprecated\n */\nexports.eqDate = {\n    equals: function (first, second) { return first.valueOf() === second.valueOf(); }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ordDate = exports.ordNumber = exports.ordString = exports.ordBoolean = exports.ord = exports.getDualOrd = exports.getTupleOrd = exports.between = exports.clamp = exports.max = exports.min = exports.geq = exports.leq = exports.gt = exports.lt = exports.equals = exports.trivial = exports.Contravariant = exports.getMonoid = exports.getSemigroup = exports.URI = exports.contramap = exports.reverse = exports.tuple = exports.fromCompare = exports.equalsDefault = void 0;\nvar Eq_1 = require(\"./Eq\");\nvar function_1 = require(\"./function\");\n// -------------------------------------------------------------------------------------\n// defaults\n// -------------------------------------------------------------------------------------\n/**\n * @category defaults\n * @since 2.10.0\n */\nvar equalsDefault = function (compare) { return function (first, second) {\n    return first === second || compare(first, second) === 0;\n}; };\nexports.equalsDefault = equalsDefault;\n// -------------------------------------------------------------------------------------\n// constructors\n// -------------------------------------------------------------------------------------\n/**\n * @category constructors\n * @since 2.0.0\n */\nvar fromCompare = function (compare) { return ({\n    equals: (0, exports.equalsDefault)(compare),\n    compare: function (first, second) { return (first === second ? 0 : compare(first, second)); }\n}); };\nexports.fromCompare = fromCompare;\n// -------------------------------------------------------------------------------------\n// combinators\n// -------------------------------------------------------------------------------------\n/**\n * Given a tuple of `Ord`s returns an `Ord` for the tuple.\n *\n * @example\n * import { tuple } from 'fp-ts/Ord'\n * import * as B from 'fp-ts/boolean'\n * import * as S from 'fp-ts/string'\n * import * as N from 'fp-ts/number'\n *\n * const O = tuple(S.Ord, N.Ord, B.Ord)\n * assert.strictEqual(O.compare(['a', 1, true], ['b', 2, true]), -1)\n * assert.strictEqual(O.compare(['a', 1, true], ['a', 2, true]), -1)\n * assert.strictEqual(O.compare(['a', 1, true], ['a', 1, false]), 1)\n *\n * @category combinators\n * @since 2.10.0\n */\nvar tuple = function () {\n    var ords = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        ords[_i] = arguments[_i];\n    }\n    return (0, exports.fromCompare)(function (first, second) {\n        var i = 0;\n        for (; i < ords.length - 1; i++) {\n            var r = ords[i].compare(first[i], second[i]);\n            if (r !== 0) {\n                return r;\n            }\n        }\n        return ords[i].compare(first[i], second[i]);\n    });\n};\nexports.tuple = tuple;\n/**\n * @category combinators\n * @since 2.10.0\n */\nvar reverse = function (O) { return (0, exports.fromCompare)(function (first, second) { return O.compare(second, first); }); };\nexports.reverse = reverse;\n// -------------------------------------------------------------------------------------\n// non-pipeables\n// -------------------------------------------------------------------------------------\n/* istanbul ignore next */\nvar contramap_ = function (fa, f) { return (0, function_1.pipe)(fa, (0, exports.contramap)(f)); };\n// -------------------------------------------------------------------------------------\n// type class members\n// -------------------------------------------------------------------------------------\n/**\n * @category Contravariant\n * @since 2.0.0\n */\nvar contramap = function (f) { return function (fa) {\n    return (0, exports.fromCompare)(function (first, second) { return fa.compare(f(first), f(second)); });\n}; };\nexports.contramap = contramap;\n// -------------------------------------------------------------------------------------\n// instances\n// -------------------------------------------------------------------------------------\n/**\n * @category instances\n * @since 2.0.0\n */\nexports.URI = 'Ord';\n/**\n * @category instances\n * @since 2.0.0\n */\nvar getSemigroup = function () { return ({\n    concat: function (first, second) {\n        return (0, exports.fromCompare)(function (a, b) {\n            var ox = first.compare(a, b);\n            return ox !== 0 ? ox : second.compare(a, b);\n        });\n    }\n}); };\nexports.getSemigroup = getSemigroup;\n/**\n * Returns a `Monoid` such that:\n *\n * - its `concat(ord1, ord2)` operation will order first by `ord1`, and then by `ord2`\n * - its `empty` value is an `Ord` that always considers compared elements equal\n *\n * @example\n * import { sort } from 'fp-ts/Array'\n * import { contramap, reverse, getMonoid } from 'fp-ts/Ord'\n * import * as S from 'fp-ts/string'\n * import * as B from 'fp-ts/boolean'\n * import { pipe } from 'fp-ts/function'\n * import { concatAll } from 'fp-ts/Monoid'\n * import * as N from 'fp-ts/number'\n *\n * interface User {\n *   readonly id: number\n *   readonly name: string\n *   readonly age: number\n *   readonly rememberMe: boolean\n * }\n *\n * const byName = pipe(\n *   S.Ord,\n *   contramap((p: User) => p.name)\n * )\n *\n * const byAge = pipe(\n *   N.Ord,\n *   contramap((p: User) => p.age)\n * )\n *\n * const byRememberMe = pipe(\n *   B.Ord,\n *   contramap((p: User) => p.rememberMe)\n * )\n *\n * const M = getMonoid<User>()\n *\n * const users: Array<User> = [\n *   { id: 1, name: 'Guido', age: 47, rememberMe: false },\n *   { id: 2, name: 'Guido', age: 46, rememberMe: true },\n *   { id: 3, name: 'Giulio', age: 44, rememberMe: false },\n *   { id: 4, name: 'Giulio', age: 44, rememberMe: true }\n * ]\n *\n * // sort by name, then by age, then by `rememberMe`\n * const O1 = concatAll(M)([byName, byAge, byRememberMe])\n * assert.deepStrictEqual(sort(O1)(users), [\n *   { id: 3, name: 'Giulio', age: 44, rememberMe: false },\n *   { id: 4, name: 'Giulio', age: 44, rememberMe: true },\n *   { id: 2, name: 'Guido', age: 46, rememberMe: true },\n *   { id: 1, name: 'Guido', age: 47, rememberMe: false }\n * ])\n *\n * // now `rememberMe = true` first, then by name, then by age\n * const O2 = concatAll(M)([reverse(byRememberMe), byName, byAge])\n * assert.deepStrictEqual(sort(O2)(users), [\n *   { id: 4, name: 'Giulio', age: 44, rememberMe: true },\n *   { id: 2, name: 'Guido', age: 46, rememberMe: true },\n *   { id: 3, name: 'Giulio', age: 44, rememberMe: false },\n *   { id: 1, name: 'Guido', age: 47, rememberMe: false }\n * ])\n *\n * @category instances\n * @since 2.4.0\n */\nvar getMonoid = function () { return ({\n    concat: (0, exports.getSemigroup)().concat,\n    empty: (0, exports.fromCompare)(function () { return 0; })\n}); };\nexports.getMonoid = getMonoid;\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Contravariant = {\n    URI: exports.URI,\n    contramap: contramap_\n};\n// -------------------------------------------------------------------------------------\n// utils\n// -------------------------------------------------------------------------------------\n/**\n * @since 2.11.0\n */\nexports.trivial = {\n    equals: function_1.constTrue,\n    compare: /*#__PURE__*/ (0, function_1.constant)(0)\n};\n/**\n * @since 2.11.0\n */\nvar equals = function (O) { return function (second) { return function (first) {\n    return first === second || O.compare(first, second) === 0;\n}; }; };\nexports.equals = equals;\n// TODO: curry in v3\n/**\n * Test whether one value is _strictly less than_ another\n *\n * @since 2.0.0\n */\nvar lt = function (O) { return function (first, second) { return O.compare(first, second) === -1; }; };\nexports.lt = lt;\n// TODO: curry in v3\n/**\n * Test whether one value is _strictly greater than_ another\n *\n * @since 2.0.0\n */\nvar gt = function (O) { return function (first, second) { return O.compare(first, second) === 1; }; };\nexports.gt = gt;\n// TODO: curry in v3\n/**\n * Test whether one value is _non-strictly less than_ another\n *\n * @since 2.0.0\n */\nvar leq = function (O) { return function (first, second) { return O.compare(first, second) !== 1; }; };\nexports.leq = leq;\n// TODO: curry in v3\n/**\n * Test whether one value is _non-strictly greater than_ another\n *\n * @since 2.0.0\n */\nvar geq = function (O) { return function (first, second) { return O.compare(first, second) !== -1; }; };\nexports.geq = geq;\n// TODO: curry in v3\n/**\n * Take the minimum of two values. If they are considered equal, the first argument is chosen\n *\n * @since 2.0.0\n */\nvar min = function (O) { return function (first, second) {\n    return first === second || O.compare(first, second) < 1 ? first : second;\n}; };\nexports.min = min;\n// TODO: curry in v3\n/**\n * Take the maximum of two values. If they are considered equal, the first argument is chosen\n *\n * @since 2.0.0\n */\nvar max = function (O) { return function (first, second) {\n    return first === second || O.compare(first, second) > -1 ? first : second;\n}; };\nexports.max = max;\n/**\n * Clamp a value between a minimum and a maximum\n *\n * @since 2.0.0\n */\nvar clamp = function (O) {\n    var minO = (0, exports.min)(O);\n    var maxO = (0, exports.max)(O);\n    return function (low, hi) { return function (a) { return maxO(minO(a, hi), low); }; };\n};\nexports.clamp = clamp;\n/**\n * Test whether a value is between a minimum and a maximum (inclusive)\n *\n * @since 2.0.0\n */\nvar between = function (O) {\n    var ltO = (0, exports.lt)(O);\n    var gtO = (0, exports.gt)(O);\n    return function (low, hi) { return function (a) { return (ltO(a, low) || gtO(a, hi) ? false : true); }; };\n};\nexports.between = between;\n// -------------------------------------------------------------------------------------\n// deprecated\n// -------------------------------------------------------------------------------------\n/**\n * Use [`tuple`](#tuple) instead.\n *\n * @category combinators\n * @since 2.0.0\n * @deprecated\n */\nexports.getTupleOrd = exports.tuple;\n/**\n * Use [`reverse`](#reverse) instead.\n *\n * @category combinators\n * @since 2.0.0\n * @deprecated\n */\nexports.getDualOrd = exports.reverse;\n/**\n * Use [`Contravariant`](#contravariant) instead.\n *\n * @category instances\n * @since 2.0.0\n * @deprecated\n */\nexports.ord = exports.Contravariant;\n// default compare for primitive types\nfunction compare(first, second) {\n    return first < second ? -1 : first > second ? 1 : 0;\n}\nvar strictOrd = {\n    equals: Eq_1.eqStrict.equals,\n    compare: compare\n};\n/**\n * Use [`Ord`](./boolean.ts.html#ord) instead.\n *\n * @category instances\n * @since 2.0.0\n * @deprecated\n */\nexports.ordBoolean = strictOrd;\n/**\n * Use [`Ord`](./string.ts.html#ord) instead.\n *\n * @category instances\n * @since 2.0.0\n * @deprecated\n */\nexports.ordString = strictOrd;\n/**\n * Use [`Ord`](./number.ts.html#ord) instead.\n *\n * @category instances\n * @since 2.0.0\n * @deprecated\n */\nexports.ordNumber = strictOrd;\n/**\n * Use [`Ord`](./Date.ts.html#ord) instead.\n *\n * @category instances\n * @since 2.0.0\n * @deprecated\n */\nexports.ordDate = (0, function_1.pipe)(exports.ordNumber, \n/*#__PURE__*/\n(0, exports.contramap)(function (date) { return date.valueOf(); }));\n","\"use strict\";\n/**\n * A `Magma` is a pair `(A, concat)` in which `A` is a non-empty set and `concat` is a binary operation on `A`\n *\n * See [Semigroup](https://gcanti.github.io/fp-ts/modules/Semigroup.ts.html) for some instances.\n *\n * @since 2.0.0\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.concatAll = exports.endo = exports.filterSecond = exports.filterFirst = exports.reverse = void 0;\n// -------------------------------------------------------------------------------------\n// combinators\n// -------------------------------------------------------------------------------------\n/**\n * The dual of a `Magma`, obtained by swapping the arguments of `concat`.\n *\n * @example\n * import { reverse, concatAll } from 'fp-ts/Magma'\n * import * as N from 'fp-ts/number'\n *\n * const subAll = concatAll(reverse(N.MagmaSub))(0)\n *\n * assert.deepStrictEqual(subAll([1, 2, 3]), 2)\n *\n * @category combinators\n * @since 2.11.0\n */\nvar reverse = function (M) { return ({\n    concat: function (first, second) { return M.concat(second, first); }\n}); };\nexports.reverse = reverse;\n/**\n * @category combinators\n * @since 2.11.0\n */\nvar filterFirst = function (predicate) { return function (M) { return ({\n    concat: function (first, second) { return (predicate(first) ? M.concat(first, second) : second); }\n}); }; };\nexports.filterFirst = filterFirst;\n/**\n * @category combinators\n * @since 2.11.0\n */\nvar filterSecond = function (predicate) { return function (M) { return ({\n    concat: function (first, second) { return (predicate(second) ? M.concat(first, second) : first); }\n}); }; };\nexports.filterSecond = filterSecond;\n/**\n * @category combinators\n * @since 2.11.0\n */\nvar endo = function (f) { return function (M) { return ({\n    concat: function (first, second) { return M.concat(f(first), f(second)); }\n}); }; };\nexports.endo = endo;\n// -------------------------------------------------------------------------------------\n// utils\n// -------------------------------------------------------------------------------------\n/**\n * Given a sequence of `as`, concat them and return the total.\n *\n * If `as` is empty, return the provided `startWith` value.\n *\n * @example\n * import { concatAll } from 'fp-ts/Magma'\n * import * as N from 'fp-ts/number'\n *\n * const subAll = concatAll(N.MagmaSub)(0)\n *\n * assert.deepStrictEqual(subAll([1, 2, 3]), -6)\n *\n * @since 2.11.0\n */\nvar concatAll = function (M) { return function (startWith) { return function (as) {\n    return as.reduce(function (a, acc) { return M.concat(a, acc); }, startWith);\n}; }; };\nexports.concatAll = concatAll;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.semigroupProduct = exports.semigroupSum = exports.semigroupString = exports.getFunctionSemigroup = exports.semigroupAny = exports.semigroupAll = exports.fold = exports.getIntercalateSemigroup = exports.getMeetSemigroup = exports.getJoinSemigroup = exports.getDualSemigroup = exports.getStructSemigroup = exports.getTupleSemigroup = exports.getFirstSemigroup = exports.getLastSemigroup = exports.getObjectSemigroup = exports.semigroupVoid = exports.concatAll = exports.last = exports.first = exports.intercalate = exports.tuple = exports.struct = exports.reverse = exports.constant = exports.max = exports.min = void 0;\n/**\n * If a type `A` can form a `Semigroup` it has an **associative** binary operation.\n *\n * ```ts\n * interface Semigroup<A> {\n *   readonly concat: (x: A, y: A) => A\n * }\n * ```\n *\n * Associativity means the following equality must hold for any choice of `x`, `y`, and `z`.\n *\n * ```ts\n * concat(x, concat(y, z)) = concat(concat(x, y), z)\n * ```\n *\n * A common example of a semigroup is the type `string` with the operation `+`.\n *\n * ```ts\n * import { Semigroup } from 'fp-ts/Semigroup'\n *\n * const semigroupString: Semigroup<string> = {\n *   concat: (x, y) => x + y\n * }\n *\n * const x = 'x'\n * const y = 'y'\n * const z = 'z'\n *\n * semigroupString.concat(x, y) // 'xy'\n *\n * semigroupString.concat(x, semigroupString.concat(y, z)) // 'xyz'\n *\n * semigroupString.concat(semigroupString.concat(x, y), z) // 'xyz'\n * ```\n *\n * *Adapted from https://typelevel.org/cats*\n *\n * @since 2.0.0\n */\nvar function_1 = require(\"./function\");\nvar _ = __importStar(require(\"./internal\"));\nvar M = __importStar(require(\"./Magma\"));\nvar Or = __importStar(require(\"./Ord\"));\n// -------------------------------------------------------------------------------------\n// constructors\n// -------------------------------------------------------------------------------------\n/**\n * Get a semigroup where `concat` will return the minimum, based on the provided order.\n *\n * @example\n * import * as N from 'fp-ts/number'\n * import * as S from 'fp-ts/Semigroup'\n *\n * const S1 = S.min(N.Ord)\n *\n * assert.deepStrictEqual(S1.concat(1, 2), 1)\n *\n * @category constructors\n * @since 2.10.0\n */\nvar min = function (O) { return ({\n    concat: Or.min(O)\n}); };\nexports.min = min;\n/**\n * Get a semigroup where `concat` will return the maximum, based on the provided order.\n *\n * @example\n * import * as N from 'fp-ts/number'\n * import * as S from 'fp-ts/Semigroup'\n *\n * const S1 = S.max(N.Ord)\n *\n * assert.deepStrictEqual(S1.concat(1, 2), 2)\n *\n * @category constructors\n * @since 2.10.0\n */\nvar max = function (O) { return ({\n    concat: Or.max(O)\n}); };\nexports.max = max;\n/**\n * @category constructors\n * @since 2.10.0\n */\nvar constant = function (a) { return ({\n    concat: function () { return a; }\n}); };\nexports.constant = constant;\n// -------------------------------------------------------------------------------------\n// combinators\n// -------------------------------------------------------------------------------------\n/**\n * The dual of a `Semigroup`, obtained by swapping the arguments of `concat`.\n *\n * @example\n * import { reverse } from 'fp-ts/Semigroup'\n * import * as S from 'fp-ts/string'\n *\n * assert.deepStrictEqual(reverse(S.Semigroup).concat('a', 'b'), 'ba')\n *\n * @category combinators\n * @since 2.10.0\n */\nexports.reverse = M.reverse;\n/**\n * Given a struct of semigroups returns a semigroup for the struct.\n *\n * @example\n * import { struct } from 'fp-ts/Semigroup'\n * import * as N from 'fp-ts/number'\n *\n * interface Point {\n *   readonly x: number\n *   readonly y: number\n * }\n *\n * const S = struct<Point>({\n *   x: N.SemigroupSum,\n *   y: N.SemigroupSum\n * })\n *\n * assert.deepStrictEqual(S.concat({ x: 1, y: 2 }, { x: 3, y: 4 }), { x: 4, y: 6 })\n *\n * @category combinators\n * @since 2.10.0\n */\nvar struct = function (semigroups) { return ({\n    concat: function (first, second) {\n        var r = {};\n        for (var k in semigroups) {\n            if (_.has.call(semigroups, k)) {\n                r[k] = semigroups[k].concat(first[k], second[k]);\n            }\n        }\n        return r;\n    }\n}); };\nexports.struct = struct;\n/**\n * Given a tuple of semigroups returns a semigroup for the tuple.\n *\n * @example\n * import { tuple } from 'fp-ts/Semigroup'\n * import * as B from 'fp-ts/boolean'\n * import * as N from 'fp-ts/number'\n * import * as S from 'fp-ts/string'\n *\n * const S1 = tuple(S.Semigroup, N.SemigroupSum)\n * assert.deepStrictEqual(S1.concat(['a', 1], ['b', 2]), ['ab', 3])\n *\n * const S2 = tuple(S.Semigroup, N.SemigroupSum, B.SemigroupAll)\n * assert.deepStrictEqual(S2.concat(['a', 1, true], ['b', 2, false]), ['ab', 3, false])\n *\n * @category combinators\n * @since 2.10.0\n */\nvar tuple = function () {\n    var semigroups = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        semigroups[_i] = arguments[_i];\n    }\n    return ({\n        concat: function (first, second) { return semigroups.map(function (s, i) { return s.concat(first[i], second[i]); }); }\n    });\n};\nexports.tuple = tuple;\n/**\n * Between each pair of elements insert `middle`.\n *\n * @example\n * import { intercalate } from 'fp-ts/Semigroup'\n * import * as S from 'fp-ts/string'\n * import { pipe } from 'fp-ts/function'\n *\n * const S1 = pipe(S.Semigroup, intercalate(' + '))\n *\n * assert.strictEqual(S1.concat('a', 'b'), 'a + b')\n *\n * @category combinators\n * @since 2.10.0\n */\nvar intercalate = function (middle) { return function (S) { return ({\n    concat: function (x, y) { return S.concat(x, S.concat(middle, y)); }\n}); }; };\nexports.intercalate = intercalate;\n// -------------------------------------------------------------------------------------\n// instances\n// -------------------------------------------------------------------------------------\n/**\n * Always return the first argument.\n *\n * @example\n * import * as S from 'fp-ts/Semigroup'\n *\n * assert.deepStrictEqual(S.first<number>().concat(1, 2), 1)\n *\n * @category instances\n * @since 2.10.0\n */\nvar first = function () { return ({ concat: function_1.identity }); };\nexports.first = first;\n/**\n * Always return the last argument.\n *\n * @example\n * import * as S from 'fp-ts/Semigroup'\n *\n * assert.deepStrictEqual(S.last<number>().concat(1, 2), 2)\n *\n * @category instances\n * @since 2.10.0\n */\nvar last = function () { return ({ concat: function (_, y) { return y; } }); };\nexports.last = last;\n// -------------------------------------------------------------------------------------\n// utils\n// -------------------------------------------------------------------------------------\n/**\n * Given a sequence of `as`, concat them and return the total.\n *\n * If `as` is empty, return the provided `startWith` value.\n *\n * @example\n * import { concatAll } from 'fp-ts/Semigroup'\n * import * as N from 'fp-ts/number'\n *\n * const sum = concatAll(N.SemigroupSum)(0)\n *\n * assert.deepStrictEqual(sum([1, 2, 3]), 6)\n * assert.deepStrictEqual(sum([]), 0)\n *\n * @since 2.10.0\n */\nexports.concatAll = M.concatAll;\n// -------------------------------------------------------------------------------------\n// deprecated\n// -------------------------------------------------------------------------------------\n/**\n * Use `void` module instead.\n *\n * @category instances\n * @since 2.0.0\n * @deprecated\n */\nexports.semigroupVoid = (0, exports.constant)(undefined);\n/**\n * Use [`getAssignSemigroup`](./struct.ts.html#getAssignSemigroup) instead.\n *\n * @category instances\n * @since 2.0.0\n * @deprecated\n */\nvar getObjectSemigroup = function () { return ({\n    concat: function (first, second) { return Object.assign({}, first, second); }\n}); };\nexports.getObjectSemigroup = getObjectSemigroup;\n/**\n * Use [`last`](#last) instead.\n *\n * @category instances\n * @since 2.0.0\n * @deprecated\n */\nexports.getLastSemigroup = exports.last;\n/**\n * Use [`first`](#first) instead.\n *\n * @category instances\n * @since 2.0.0\n * @deprecated\n */\nexports.getFirstSemigroup = exports.first;\n/**\n * Use [`tuple`](#tuple) instead.\n *\n * @category combinators\n * @since 2.0.0\n * @deprecated\n */\nexports.getTupleSemigroup = exports.tuple;\n/**\n * Use [`struct`](#struct) instead.\n *\n * @category combinators\n * @since 2.0.0\n * @deprecated\n */\nexports.getStructSemigroup = exports.struct;\n/**\n * Use [`reverse`](#reverse) instead.\n *\n * @category combinators\n * @since 2.0.0\n * @deprecated\n */\nexports.getDualSemigroup = exports.reverse;\n/**\n * Use [`max`](#max) instead.\n *\n * @category constructors\n * @since 2.0.0\n * @deprecated\n */\nexports.getJoinSemigroup = exports.max;\n/**\n * Use [`min`](#min) instead.\n *\n * @category constructors\n * @since 2.0.0\n * @deprecated\n */\nexports.getMeetSemigroup = exports.min;\n/**\n * Use [`intercalate`](#intercalate) instead.\n *\n * @category combinators\n * @since 2.5.0\n * @deprecated\n */\nexports.getIntercalateSemigroup = exports.intercalate;\nfunction fold(S) {\n    var concatAllS = (0, exports.concatAll)(S);\n    return function (startWith, as) { return (as === undefined ? concatAllS(startWith) : concatAllS(startWith)(as)); };\n}\nexports.fold = fold;\n/**\n * Use [`SemigroupAll`](./boolean.ts.html#SemigroupAll) instead.\n *\n * @category instances\n * @since 2.0.0\n * @deprecated\n */\nexports.semigroupAll = {\n    concat: function (x, y) { return x && y; }\n};\n/**\n * Use [`SemigroupAny`](./boolean.ts.html#SemigroupAny) instead.\n *\n * @category instances\n * @since 2.0.0\n * @deprecated\n */\nexports.semigroupAny = {\n    concat: function (x, y) { return x || y; }\n};\n/**\n * Use [`getSemigroup`](./function.ts.html#getSemigroup) instead.\n *\n * @category instances\n * @since 2.0.0\n * @deprecated\n */\nexports.getFunctionSemigroup = function_1.getSemigroup;\n/**\n * Use [`Semigroup`](./string.ts.html#Semigroup) instead.\n *\n * @category instances\n * @since 2.0.0\n * @deprecated\n */\nexports.semigroupString = {\n    concat: function (x, y) { return x + y; }\n};\n/**\n * Use [`SemigroupSum`](./number.ts.html#SemigroupSum) instead.\n *\n * @category instances\n * @since 2.0.0\n * @deprecated\n */\nexports.semigroupSum = {\n    concat: function (x, y) { return x + y; }\n};\n/**\n * Use [`SemigroupProduct`](./number.ts.html#SemigroupProduct) instead.\n *\n * @category instances\n * @since 2.0.0\n * @deprecated\n */\nexports.semigroupProduct = {\n    concat: function (x, y) { return x * y; }\n};\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.reduceRight = exports.foldMap = exports.reduce = exports.mapWithIndex = exports.map = exports.flatten = exports.duplicate = exports.extend = exports.chain = exports.ap = exports.alt = exports.altW = exports.of = exports.chunksOf = exports.splitAt = exports.chop = exports.chainWithIndex = exports.intersperse = exports.prependAll = exports.unzip = exports.zip = exports.zipWith = exports.modifyAt = exports.updateAt = exports.sort = exports.groupBy = exports.group = exports.reverse = exports.concat = exports.concatW = exports.fromArray = exports.unappend = exports.unprepend = exports.range = exports.replicate = exports.makeBy = exports.fromReadonlyArray = exports.rotate = exports.union = exports.sortBy = exports.uniq = exports.unsafeUpdateAt = exports.unsafeInsertAt = exports.append = exports.appendW = exports.prepend = exports.prependW = exports.isOutOfBound = exports.isNonEmpty = exports.empty = void 0;\nexports.filterWithIndex = exports.filter = exports.groupSort = exports.intercalate = exports.updateLast = exports.modifyLast = exports.updateHead = exports.modifyHead = exports.matchRight = exports.matchLeft = exports.concatAll = exports.max = exports.min = exports.init = exports.last = exports.tail = exports.head = exports.apS = exports.bind = exports.bindTo = exports.Do = exports.Comonad = exports.Alt = exports.TraversableWithIndex = exports.Traversable = exports.FoldableWithIndex = exports.Foldable = exports.Monad = exports.chainFirst = exports.Chain = exports.Applicative = exports.apSecond = exports.apFirst = exports.Apply = exports.FunctorWithIndex = exports.Pointed = exports.flap = exports.Functor = exports.getUnionSemigroup = exports.getEq = exports.getSemigroup = exports.getShow = exports.URI = exports.extract = exports.traverseWithIndex = exports.sequence = exports.traverse = exports.reduceRightWithIndex = exports.foldMapWithIndex = exports.reduceWithIndex = void 0;\nexports.readonlyNonEmptyArray = exports.fold = exports.prependToAll = exports.insertAt = exports.snoc = exports.cons = exports.unsnoc = exports.uncons = void 0;\nvar Apply_1 = require(\"./Apply\");\nvar Chain_1 = require(\"./Chain\");\nvar Eq_1 = require(\"./Eq\");\nvar function_1 = require(\"./function\");\nvar Functor_1 = require(\"./Functor\");\nvar _ = __importStar(require(\"./internal\"));\nvar Ord_1 = require(\"./Ord\");\nvar Se = __importStar(require(\"./Semigroup\"));\n// -------------------------------------------------------------------------------------\n// internal\n// -------------------------------------------------------------------------------------\n/**\n * @internal\n */\nexports.empty = _.emptyReadonlyArray;\n/**\n * @internal\n */\nexports.isNonEmpty = _.isNonEmpty;\n/**\n * @internal\n */\nvar isOutOfBound = function (i, as) { return i < 0 || i >= as.length; };\nexports.isOutOfBound = isOutOfBound;\n/**\n * @internal\n */\nvar prependW = function (head) { return function (tail) { return __spreadArray([head], tail, true); }; };\nexports.prependW = prependW;\n/**\n * @internal\n */\nexports.prepend = exports.prependW;\n/**\n * @internal\n */\nvar appendW = function (end) { return function (init) { return __spreadArray(__spreadArray([], init, true), [end], false); }; };\nexports.appendW = appendW;\n/**\n * @internal\n */\nexports.append = exports.appendW;\n/**\n * @internal\n */\nvar unsafeInsertAt = function (i, a, as) {\n    if ((0, exports.isNonEmpty)(as)) {\n        var xs = _.fromReadonlyNonEmptyArray(as);\n        xs.splice(i, 0, a);\n        return xs;\n    }\n    return [a];\n};\nexports.unsafeInsertAt = unsafeInsertAt;\n/**\n * @internal\n */\nvar unsafeUpdateAt = function (i, a, as) {\n    if (as[i] === a) {\n        return as;\n    }\n    else {\n        var xs = _.fromReadonlyNonEmptyArray(as);\n        xs[i] = a;\n        return xs;\n    }\n};\nexports.unsafeUpdateAt = unsafeUpdateAt;\n/**\n * Remove duplicates from a `ReadonlyNonEmptyArray`, keeping the first occurrence of an element.\n *\n * @example\n * import { uniq } from 'fp-ts/ReadonlyNonEmptyArray'\n * import * as N from 'fp-ts/number'\n *\n * assert.deepStrictEqual(uniq(N.Eq)([1, 2, 1]), [1, 2])\n *\n * @category combinators\n * @since 2.11.0\n */\nvar uniq = function (E) { return function (as) {\n    if (as.length === 1) {\n        return as;\n    }\n    var out = [(0, exports.head)(as)];\n    var rest = (0, exports.tail)(as);\n    var _loop_1 = function (a) {\n        if (out.every(function (o) { return !E.equals(o, a); })) {\n            out.push(a);\n        }\n    };\n    for (var _i = 0, rest_1 = rest; _i < rest_1.length; _i++) {\n        var a = rest_1[_i];\n        _loop_1(a);\n    }\n    return out;\n}; };\nexports.uniq = uniq;\n/**\n * Sort the elements of a `ReadonlyNonEmptyArray` in increasing order, where elements are compared using first `ords[0]`, then `ords[1]`,\n * etc...\n *\n * @example\n * import * as RNEA from 'fp-ts/ReadonlyNonEmptyArray'\n * import { contramap } from 'fp-ts/Ord'\n * import * as S from 'fp-ts/string'\n * import * as N from 'fp-ts/number'\n * import { pipe } from 'fp-ts/function'\n *\n * interface Person {\n *   name: string\n *   age: number\n * }\n *\n * const byName = pipe(S.Ord, contramap((p: Person) => p.name))\n *\n * const byAge = pipe(N.Ord, contramap((p: Person) => p.age))\n *\n * const sortByNameByAge = RNEA.sortBy([byName, byAge])\n *\n * const persons: RNEA.ReadonlyNonEmptyArray<Person> = [\n *   { name: 'a', age: 1 },\n *   { name: 'b', age: 3 },\n *   { name: 'c', age: 2 },\n *   { name: 'b', age: 2 }\n * ]\n *\n * assert.deepStrictEqual(sortByNameByAge(persons), [\n *   { name: 'a', age: 1 },\n *   { name: 'b', age: 2 },\n *   { name: 'b', age: 3 },\n *   { name: 'c', age: 2 }\n * ])\n *\n * @category combinators\n * @since 2.11.0\n */\nvar sortBy = function (ords) {\n    if ((0, exports.isNonEmpty)(ords)) {\n        var M = (0, Ord_1.getMonoid)();\n        return (0, exports.sort)(ords.reduce(M.concat, M.empty));\n    }\n    return function_1.identity;\n};\nexports.sortBy = sortBy;\n/**\n * @category combinators\n * @since 2.11.0\n */\nvar union = function (E) {\n    var uniqE = (0, exports.uniq)(E);\n    return function (second) { return function (first) { return uniqE((0, function_1.pipe)(first, concat(second))); }; };\n};\nexports.union = union;\n/**\n * Rotate a `ReadonlyNonEmptyArray` by `n` steps.\n *\n * @example\n * import { rotate } from 'fp-ts/ReadonlyNonEmptyArray'\n *\n * assert.deepStrictEqual(rotate(2)([1, 2, 3, 4, 5]), [4, 5, 1, 2, 3])\n * assert.deepStrictEqual(rotate(-2)([1, 2, 3, 4, 5]), [3, 4, 5, 1, 2])\n *\n * @category combinators\n * @since 2.11.0\n */\nvar rotate = function (n) { return function (as) {\n    var len = as.length;\n    var m = Math.round(n) % len;\n    if ((0, exports.isOutOfBound)(Math.abs(m), as) || m === 0) {\n        return as;\n    }\n    if (m < 0) {\n        var _a = (0, exports.splitAt)(-m)(as), f = _a[0], s = _a[1];\n        return (0, function_1.pipe)(s, concat(f));\n    }\n    else {\n        return (0, exports.rotate)(m - len)(as);\n    }\n}; };\nexports.rotate = rotate;\n// -------------------------------------------------------------------------------------\n// constructors\n// -------------------------------------------------------------------------------------\n/**\n * Return a `ReadonlyNonEmptyArray` from a `ReadonlyArray` returning `none` if the input is empty.\n *\n * @category constructors\n * @since 2.5.0\n */\nvar fromReadonlyArray = function (as) {\n    return (0, exports.isNonEmpty)(as) ? _.some(as) : _.none;\n};\nexports.fromReadonlyArray = fromReadonlyArray;\n/**\n * Return a `ReadonlyNonEmptyArray` of length `n` with element `i` initialized with `f(i)`.\n *\n * **Note**. `n` is normalized to a natural number.\n *\n * @example\n * import { makeBy } from 'fp-ts/ReadonlyNonEmptyArray'\n * import { pipe } from 'fp-ts/function'\n *\n * const double = (n: number): number => n * 2\n * assert.deepStrictEqual(pipe(5, makeBy(double)), [0, 2, 4, 6, 8])\n *\n * @category constructors\n * @since 2.11.0\n */\nvar makeBy = function (f) { return function (n) {\n    var j = Math.max(0, Math.floor(n));\n    var out = [f(0)];\n    for (var i = 1; i < j; i++) {\n        out.push(f(i));\n    }\n    return out;\n}; };\nexports.makeBy = makeBy;\n/**\n * Create a `ReadonlyNonEmptyArray` containing a value repeated the specified number of times.\n *\n * **Note**. `n` is normalized to a natural number.\n *\n * @example\n * import { replicate } from 'fp-ts/ReadonlyNonEmptyArray'\n * import { pipe } from 'fp-ts/function'\n *\n * assert.deepStrictEqual(pipe(3, replicate('a')), ['a', 'a', 'a'])\n *\n * @category constructors\n * @since 2.11.0\n */\nvar replicate = function (a) { return (0, exports.makeBy)(function () { return a; }); };\nexports.replicate = replicate;\n/**\n * Create a `ReadonlyNonEmptyArray` containing a range of integers, including both endpoints.\n *\n * @example\n * import { range } from 'fp-ts/ReadonlyNonEmptyArray'\n *\n * assert.deepStrictEqual(range(1, 5), [1, 2, 3, 4, 5])\n *\n * @category constructors\n * @since 2.11.0\n */\nvar range = function (start, end) {\n    return start <= end ? (0, exports.makeBy)(function (i) { return start + i; })(end - start + 1) : [start];\n};\nexports.range = range;\n// -------------------------------------------------------------------------------------\n// destructors\n// -------------------------------------------------------------------------------------\n/**\n * Return the tuple of the `head` and the `tail`.\n *\n * @example\n * import { unprepend } from 'fp-ts/ReadonlyNonEmptyArray'\n *\n * assert.deepStrictEqual(unprepend([1, 2, 3, 4]), [1, [2, 3, 4]])\n *\n * @category destructors\n * @since 2.9.0\n */\nvar unprepend = function (as) { return [(0, exports.head)(as), (0, exports.tail)(as)]; };\nexports.unprepend = unprepend;\n/**\n * Return the tuple of the `init` and the `last`.\n *\n * @example\n * import { unappend } from 'fp-ts/ReadonlyNonEmptyArray'\n *\n * assert.deepStrictEqual(unappend([1, 2, 3, 4]), [[1, 2, 3], 4])\n *\n * @category destructors\n * @since 2.9.0\n */\nvar unappend = function (as) { return [(0, exports.init)(as), (0, exports.last)(as)]; };\nexports.unappend = unappend;\n// -------------------------------------------------------------------------------------\n// interop\n// -------------------------------------------------------------------------------------\n/**\n * @category interop\n * @since 2.5.0\n */\nvar fromArray = function (as) { return (0, exports.fromReadonlyArray)(as.slice()); };\nexports.fromArray = fromArray;\nfunction concatW(second) {\n    return function (first) { return first.concat(second); };\n}\nexports.concatW = concatW;\nfunction concat(x, y) {\n    return y ? x.concat(y) : function (y) { return y.concat(x); };\n}\nexports.concat = concat;\n/**\n * @category combinators\n * @since 2.5.0\n */\nvar reverse = function (as) {\n    return as.length === 1 ? as : __spreadArray([(0, exports.last)(as)], as.slice(0, -1).reverse(), true);\n};\nexports.reverse = reverse;\nfunction group(E) {\n    return function (as) {\n        var len = as.length;\n        if (len === 0) {\n            return exports.empty;\n        }\n        var out = [];\n        var head = as[0];\n        var nea = [head];\n        for (var i = 1; i < len; i++) {\n            var a = as[i];\n            if (E.equals(a, head)) {\n                nea.push(a);\n            }\n            else {\n                out.push(nea);\n                head = a;\n                nea = [head];\n            }\n        }\n        out.push(nea);\n        return out;\n    };\n}\nexports.group = group;\n/**\n * Splits an array into sub-non-empty-arrays stored in an object, based on the result of calling a `string`-returning\n * function on each element, and grouping the results according to values returned\n *\n * @example\n * import { groupBy } from 'fp-ts/ReadonlyNonEmptyArray'\n *\n * assert.deepStrictEqual(groupBy((s: string) => String(s.length))(['a', 'b', 'ab']), {\n *   '1': ['a', 'b'],\n *   '2': ['ab']\n * })\n *\n * @category combinators\n * @since 2.5.0\n */\nvar groupBy = function (f) { return function (as) {\n    var out = {};\n    for (var _i = 0, as_1 = as; _i < as_1.length; _i++) {\n        var a = as_1[_i];\n        var k = f(a);\n        if (_.has.call(out, k)) {\n            out[k].push(a);\n        }\n        else {\n            out[k] = [a];\n        }\n    }\n    return out;\n}; };\nexports.groupBy = groupBy;\n/**\n * @category combinators\n * @since 2.5.0\n */\nvar sort = function (O) { return function (as) {\n    return as.length === 1 ? as : as.slice().sort(O.compare);\n}; };\nexports.sort = sort;\n/**\n * @category combinators\n * @since 2.5.0\n */\nvar updateAt = function (i, a) {\n    return (0, exports.modifyAt)(i, function () { return a; });\n};\nexports.updateAt = updateAt;\n/**\n * @category combinators\n * @since 2.5.0\n */\nvar modifyAt = function (i, f) { return function (as) { return ((0, exports.isOutOfBound)(i, as) ? _.none : _.some((0, exports.unsafeUpdateAt)(i, f(as[i]), as))); }; };\nexports.modifyAt = modifyAt;\n/**\n * @category combinators\n * @since 2.5.1\n */\nvar zipWith = function (as, bs, f) {\n    var cs = [f(as[0], bs[0])];\n    var len = Math.min(as.length, bs.length);\n    for (var i = 1; i < len; i++) {\n        cs[i] = f(as[i], bs[i]);\n    }\n    return cs;\n};\nexports.zipWith = zipWith;\nfunction zip(as, bs) {\n    if (bs === undefined) {\n        return function (bs) { return zip(bs, as); };\n    }\n    return (0, exports.zipWith)(as, bs, function (a, b) { return [a, b]; });\n}\nexports.zip = zip;\n/**\n * @category combinators\n * @since 2.5.1\n */\nvar unzip = function (abs) {\n    var fa = [abs[0][0]];\n    var fb = [abs[0][1]];\n    for (var i = 1; i < abs.length; i++) {\n        fa[i] = abs[i][0];\n        fb[i] = abs[i][1];\n    }\n    return [fa, fb];\n};\nexports.unzip = unzip;\n/**\n * Prepend an element to every member of a `ReadonlyNonEmptyArray`.\n *\n * @example\n * import { prependAll } from 'fp-ts/ReadonlyNonEmptyArray'\n *\n * assert.deepStrictEqual(prependAll(9)([1, 2, 3, 4]), [9, 1, 9, 2, 9, 3, 9, 4])\n *\n * @category combinators\n * @since 2.10.0\n */\nvar prependAll = function (middle) { return function (as) {\n    var out = [middle, as[0]];\n    for (var i = 1; i < as.length; i++) {\n        out.push(middle, as[i]);\n    }\n    return out;\n}; };\nexports.prependAll = prependAll;\n/**\n * Places an element in between members of a `ReadonlyNonEmptyArray`.\n *\n * @example\n * import { intersperse } from 'fp-ts/ReadonlyNonEmptyArray'\n *\n * assert.deepStrictEqual(intersperse(9)([1, 2, 3, 4]), [1, 9, 2, 9, 3, 9, 4])\n *\n * @category combinators\n * @since 2.9.0\n */\nvar intersperse = function (middle) { return function (as) {\n    var rest = (0, exports.tail)(as);\n    return (0, exports.isNonEmpty)(rest) ? (0, function_1.pipe)(rest, (0, exports.prependAll)(middle), (0, exports.prepend)((0, exports.head)(as))) : as;\n}; };\nexports.intersperse = intersperse;\n/**\n * @category combinators\n * @since 2.10.0\n */\nvar chainWithIndex = function (f) { return function (as) {\n    var out = _.fromReadonlyNonEmptyArray(f(0, (0, exports.head)(as)));\n    for (var i = 1; i < as.length; i++) {\n        out.push.apply(out, f(i, as[i]));\n    }\n    return out;\n}; };\nexports.chainWithIndex = chainWithIndex;\n/**\n * A useful recursion pattern for processing a `ReadonlyNonEmptyArray` to produce a new `ReadonlyNonEmptyArray`, often used for \"chopping\" up the input\n * `ReadonlyNonEmptyArray`. Typically `chop` is called with some function that will consume an initial prefix of the `ReadonlyNonEmptyArray` and produce a\n * value and the tail of the `ReadonlyNonEmptyArray`.\n *\n * @category combinators\n * @since 2.10.0\n */\nvar chop = function (f) { return function (as) {\n    var _a = f(as), b = _a[0], rest = _a[1];\n    var out = [b];\n    var next = rest;\n    while ((0, exports.isNonEmpty)(next)) {\n        var _b = f(next), b_1 = _b[0], rest_2 = _b[1];\n        out.push(b_1);\n        next = rest_2;\n    }\n    return out;\n}; };\nexports.chop = chop;\n/**\n * Splits a `ReadonlyNonEmptyArray` into two pieces, the first piece has max `n` elements.\n *\n * @category combinators\n * @since 2.10.0\n */\nvar splitAt = function (n) { return function (as) {\n    var m = Math.max(1, n);\n    return m >= as.length ? [as, exports.empty] : [(0, function_1.pipe)(as.slice(1, m), (0, exports.prepend)((0, exports.head)(as))), as.slice(m)];\n}; };\nexports.splitAt = splitAt;\n/**\n * Splits a `ReadonlyNonEmptyArray` into length-`n` pieces. The last piece will be shorter if `n` does not evenly divide the length of\n * the `ReadonlyNonEmptyArray`.\n *\n * @category combinators\n * @since 2.10.0\n */\nvar chunksOf = function (n) { return (0, exports.chop)((0, exports.splitAt)(n)); };\nexports.chunksOf = chunksOf;\n// -------------------------------------------------------------------------------------\n// non-pipeables\n// -------------------------------------------------------------------------------------\nvar _map = function (fa, f) { return (0, function_1.pipe)(fa, (0, exports.map)(f)); };\n/* istanbul ignore next */\nvar _mapWithIndex = function (fa, f) { return (0, function_1.pipe)(fa, (0, exports.mapWithIndex)(f)); };\nvar _ap = function (fab, fa) { return (0, function_1.pipe)(fab, (0, exports.ap)(fa)); };\nvar _chain = function (ma, f) { return (0, function_1.pipe)(ma, (0, exports.chain)(f)); };\n/* istanbul ignore next */\nvar _extend = function (wa, f) { return (0, function_1.pipe)(wa, (0, exports.extend)(f)); };\n/* istanbul ignore next */\nvar _reduce = function (fa, b, f) { return (0, function_1.pipe)(fa, (0, exports.reduce)(b, f)); };\n/* istanbul ignore next */\nvar _foldMap = function (M) {\n    var foldMapM = (0, exports.foldMap)(M);\n    return function (fa, f) { return (0, function_1.pipe)(fa, foldMapM(f)); };\n};\n/* istanbul ignore next */\nvar _reduceRight = function (fa, b, f) { return (0, function_1.pipe)(fa, (0, exports.reduceRight)(b, f)); };\n/* istanbul ignore next */\nvar _traverse = function (F) {\n    var traverseF = (0, exports.traverse)(F);\n    return function (ta, f) { return (0, function_1.pipe)(ta, traverseF(f)); };\n};\n/* istanbul ignore next */\nvar _alt = function (fa, that) { return (0, function_1.pipe)(fa, (0, exports.alt)(that)); };\n/* istanbul ignore next */\nvar _reduceWithIndex = function (fa, b, f) {\n    return (0, function_1.pipe)(fa, (0, exports.reduceWithIndex)(b, f));\n};\n/* istanbul ignore next */\nvar _foldMapWithIndex = function (M) {\n    var foldMapWithIndexM = (0, exports.foldMapWithIndex)(M);\n    return function (fa, f) { return (0, function_1.pipe)(fa, foldMapWithIndexM(f)); };\n};\n/* istanbul ignore next */\nvar _reduceRightWithIndex = function (fa, b, f) {\n    return (0, function_1.pipe)(fa, (0, exports.reduceRightWithIndex)(b, f));\n};\n/* istanbul ignore next */\nvar _traverseWithIndex = function (F) {\n    var traverseWithIndexF = (0, exports.traverseWithIndex)(F);\n    return function (ta, f) { return (0, function_1.pipe)(ta, traverseWithIndexF(f)); };\n};\n// -------------------------------------------------------------------------------------\n// type class members\n// -------------------------------------------------------------------------------------\n/**\n * @category Pointed\n * @since 2.5.0\n */\nexports.of = _.singleton;\n/**\n * Less strict version of [`alt`](#alt).\n *\n * @category Alt\n * @since 2.9.0\n */\nvar altW = function (that) { return function (as) { return (0, function_1.pipe)(as, concatW(that())); }; };\nexports.altW = altW;\n/**\n * Identifies an associative operation on a type constructor. It is similar to `Semigroup`, except that it applies to\n * types of kind `* -> *`.\n *\n * @category Alt\n * @since 2.6.2\n */\nexports.alt = exports.altW;\n/**\n * @category Apply\n * @since 2.5.0\n */\nvar ap = function (as) { return (0, exports.chain)(function (f) { return (0, function_1.pipe)(as, (0, exports.map)(f)); }); };\nexports.ap = ap;\n/**\n * Composes computations in sequence, using the return value of one computation to determine the next computation.\n *\n * @category Monad\n * @since 2.5.0\n */\nvar chain = function (f) { return (0, exports.chainWithIndex)(function (_, a) { return f(a); }); };\nexports.chain = chain;\n/**\n * @category Extend\n * @since 2.5.0\n */\nvar extend = function (f) { return function (as) {\n    var next = (0, exports.tail)(as);\n    var out = [f(as)];\n    while ((0, exports.isNonEmpty)(next)) {\n        out.push(f(next));\n        next = (0, exports.tail)(next);\n    }\n    return out;\n}; };\nexports.extend = extend;\n/**\n * Derivable from `Extend`.\n *\n * @category combinators\n * @since 2.5.0\n */\nexports.duplicate = (0, exports.extend)(function_1.identity);\n/**\n * Derivable from `Chain`.\n *\n * @category combinators\n * @since 2.5.0\n */\nexports.flatten = (0, exports.chain)(function_1.identity);\n/**\n * `map` can be used to turn functions `(a: A) => B` into functions `(fa: F<A>) => F<B>` whose argument and return types\n * use the type constructor `F` to represent some computational context.\n *\n * @category Functor\n * @since 2.5.0\n */\nvar map = function (f) {\n    return (0, exports.mapWithIndex)(function (_, a) { return f(a); });\n};\nexports.map = map;\n/**\n * @category FunctorWithIndex\n * @since 2.5.0\n */\nvar mapWithIndex = function (f) { return function (as) {\n    var out = [f(0, (0, exports.head)(as))];\n    for (var i = 1; i < as.length; i++) {\n        out.push(f(i, as[i]));\n    }\n    return out;\n}; };\nexports.mapWithIndex = mapWithIndex;\n/**\n * @category Foldable\n * @since 2.5.0\n */\nvar reduce = function (b, f) {\n    return (0, exports.reduceWithIndex)(b, function (_, b, a) { return f(b, a); });\n};\nexports.reduce = reduce;\n/**\n * **Note**. The constraint is relaxed: a `Semigroup` instead of a `Monoid`.\n *\n * @category Foldable\n * @since 2.5.0\n */\nvar foldMap = function (S) { return function (f) { return function (as) {\n    return as.slice(1).reduce(function (s, a) { return S.concat(s, f(a)); }, f(as[0]));\n}; }; };\nexports.foldMap = foldMap;\n/**\n * @category Foldable\n * @since 2.5.0\n */\nvar reduceRight = function (b, f) {\n    return (0, exports.reduceRightWithIndex)(b, function (_, b, a) { return f(b, a); });\n};\nexports.reduceRight = reduceRight;\n/**\n * @category FoldableWithIndex\n * @since 2.5.0\n */\nvar reduceWithIndex = function (b, f) { return function (as) {\n    return as.reduce(function (b, a, i) { return f(i, b, a); }, b);\n}; };\nexports.reduceWithIndex = reduceWithIndex;\n/**\n * **Note**. The constraint is relaxed: a `Semigroup` instead of a `Monoid`.\n *\n * @category FoldableWithIndex\n * @since 2.5.0\n */\nvar foldMapWithIndex = function (S) { return function (f) { return function (as) { return as.slice(1).reduce(function (s, a, i) { return S.concat(s, f(i + 1, a)); }, f(0, as[0])); }; }; };\nexports.foldMapWithIndex = foldMapWithIndex;\n/**\n * @category FoldableWithIndex\n * @since 2.5.0\n */\nvar reduceRightWithIndex = function (b, f) { return function (as) { return as.reduceRight(function (b, a, i) { return f(i, a, b); }, b); }; };\nexports.reduceRightWithIndex = reduceRightWithIndex;\n/**\n * @category Traversable\n * @since 2.6.3\n */\nvar traverse = function (F) {\n    var traverseWithIndexF = (0, exports.traverseWithIndex)(F);\n    return function (f) { return traverseWithIndexF(function (_, a) { return f(a); }); };\n};\nexports.traverse = traverse;\n/**\n * @category Traversable\n * @since 2.6.3\n */\nvar sequence = function (F) { return (0, exports.traverseWithIndex)(F)(function_1.SK); };\nexports.sequence = sequence;\n/**\n * @category TraversableWithIndex\n * @since 2.6.3\n */\nvar traverseWithIndex = function (F) { return function (f) { return function (as) {\n    var out = F.map(f(0, (0, exports.head)(as)), exports.of);\n    for (var i = 1; i < as.length; i++) {\n        out = F.ap(F.map(out, function (bs) { return function (b) { return (0, function_1.pipe)(bs, (0, exports.append)(b)); }; }), f(i, as[i]));\n    }\n    return out;\n}; }; };\nexports.traverseWithIndex = traverseWithIndex;\n/**\n * @category Comonad\n * @since 2.6.3\n */\nexports.extract = _.head;\n// -------------------------------------------------------------------------------------\n// instances\n// -------------------------------------------------------------------------------------\n/**\n * @category instances\n * @since 2.5.0\n */\nexports.URI = 'ReadonlyNonEmptyArray';\n/**\n * @category instances\n * @since 2.5.0\n */\nvar getShow = function (S) { return ({\n    show: function (as) { return \"[\".concat(as.map(S.show).join(', '), \"]\"); }\n}); };\nexports.getShow = getShow;\n/**\n * Builds a `Semigroup` instance for `ReadonlyNonEmptyArray`\n *\n * @category instances\n * @since 2.5.0\n */\nvar getSemigroup = function () { return ({\n    concat: concat\n}); };\nexports.getSemigroup = getSemigroup;\n/**\n * @example\n * import { getEq } from 'fp-ts/ReadonlyNonEmptyArray'\n * import * as N from 'fp-ts/number'\n *\n * const E = getEq(N.Eq)\n * assert.strictEqual(E.equals([1, 2], [1, 2]), true)\n * assert.strictEqual(E.equals([1, 2], [1, 3]), false)\n *\n * @category instances\n * @since 2.5.0\n */\nvar getEq = function (E) {\n    return (0, Eq_1.fromEquals)(function (xs, ys) { return xs.length === ys.length && xs.every(function (x, i) { return E.equals(x, ys[i]); }); });\n};\nexports.getEq = getEq;\n/**\n * @category combinators\n * @since 2.11.0\n */\nvar getUnionSemigroup = function (E) {\n    var unionE = (0, exports.union)(E);\n    return {\n        concat: function (first, second) { return unionE(second)(first); }\n    };\n};\nexports.getUnionSemigroup = getUnionSemigroup;\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Functor = {\n    URI: exports.URI,\n    map: _map\n};\n/**\n * Derivable from `Functor`.\n *\n * @category combinators\n * @since 2.10.0\n */\nexports.flap = (0, Functor_1.flap)(exports.Functor);\n/**\n * @category instances\n * @since 2.10.0\n */\nexports.Pointed = {\n    URI: exports.URI,\n    of: exports.of\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.FunctorWithIndex = {\n    URI: exports.URI,\n    map: _map,\n    mapWithIndex: _mapWithIndex\n};\n/**\n * @category instances\n * @since 2.10.0\n */\nexports.Apply = {\n    URI: exports.URI,\n    map: _map,\n    ap: _ap\n};\n/**\n * Combine two effectful actions, keeping only the result of the first.\n *\n * Derivable from `Apply`.\n *\n * @category combinators\n * @since 2.5.0\n */\nexports.apFirst = (0, Apply_1.apFirst)(exports.Apply);\n/**\n * Combine two effectful actions, keeping only the result of the second.\n *\n * Derivable from `Apply`.\n *\n * @category combinators\n * @since 2.5.0\n */\nexports.apSecond = (0, Apply_1.apSecond)(exports.Apply);\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Applicative = {\n    URI: exports.URI,\n    map: _map,\n    ap: _ap,\n    of: exports.of\n};\n/**\n * @category instances\n * @since 2.10.0\n */\nexports.Chain = {\n    URI: exports.URI,\n    map: _map,\n    ap: _ap,\n    chain: _chain\n};\n/**\n * Composes computations in sequence, using the return value of one computation to determine the next computation and\n * keeping only the result of the first.\n *\n * Derivable from `Chain`.\n *\n * @category combinators\n * @since 2.5.0\n */\nexports.chainFirst = (0, Chain_1.chainFirst)(exports.Chain);\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Monad = {\n    URI: exports.URI,\n    map: _map,\n    ap: _ap,\n    of: exports.of,\n    chain: _chain\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Foldable = {\n    URI: exports.URI,\n    reduce: _reduce,\n    foldMap: _foldMap,\n    reduceRight: _reduceRight\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.FoldableWithIndex = {\n    URI: exports.URI,\n    reduce: _reduce,\n    foldMap: _foldMap,\n    reduceRight: _reduceRight,\n    reduceWithIndex: _reduceWithIndex,\n    foldMapWithIndex: _foldMapWithIndex,\n    reduceRightWithIndex: _reduceRightWithIndex\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Traversable = {\n    URI: exports.URI,\n    map: _map,\n    reduce: _reduce,\n    foldMap: _foldMap,\n    reduceRight: _reduceRight,\n    traverse: _traverse,\n    sequence: exports.sequence\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.TraversableWithIndex = {\n    URI: exports.URI,\n    map: _map,\n    mapWithIndex: _mapWithIndex,\n    reduce: _reduce,\n    foldMap: _foldMap,\n    reduceRight: _reduceRight,\n    traverse: _traverse,\n    sequence: exports.sequence,\n    reduceWithIndex: _reduceWithIndex,\n    foldMapWithIndex: _foldMapWithIndex,\n    reduceRightWithIndex: _reduceRightWithIndex,\n    traverseWithIndex: _traverseWithIndex\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Alt = {\n    URI: exports.URI,\n    map: _map,\n    alt: _alt\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Comonad = {\n    URI: exports.URI,\n    map: _map,\n    extend: _extend,\n    extract: exports.extract\n};\n// -------------------------------------------------------------------------------------\n// do notation\n// -------------------------------------------------------------------------------------\n/**\n * @since 2.9.0\n */\nexports.Do = (0, exports.of)(_.emptyRecord);\n/**\n * @since 2.8.0\n */\nexports.bindTo = (0, Functor_1.bindTo)(exports.Functor);\n/**\n * @since 2.8.0\n */\nexports.bind = (0, Chain_1.bind)(exports.Chain);\n// -------------------------------------------------------------------------------------\n// pipeable sequence S\n// -------------------------------------------------------------------------------------\n/**\n * @since 2.8.0\n */\nexports.apS = (0, Apply_1.apS)(exports.Apply);\n// -------------------------------------------------------------------------------------\n// utils\n// -------------------------------------------------------------------------------------\n/**\n * @since 2.5.0\n */\nexports.head = exports.extract;\n/**\n * @since 2.5.0\n */\nexports.tail = _.tail;\n/**\n * @since 2.5.0\n */\nvar last = function (as) { return as[as.length - 1]; };\nexports.last = last;\n/**\n * Get all but the last element of a non empty array, creating a new array.\n *\n * @example\n * import { init } from 'fp-ts/ReadonlyNonEmptyArray'\n *\n * assert.deepStrictEqual(init([1, 2, 3]), [1, 2])\n * assert.deepStrictEqual(init([1]), [])\n *\n * @since 2.5.0\n */\nvar init = function (as) { return as.slice(0, -1); };\nexports.init = init;\n/**\n * @since 2.5.0\n */\nvar min = function (O) {\n    var S = Se.min(O);\n    return function (as) { return as.reduce(S.concat); };\n};\nexports.min = min;\n/**\n * @since 2.5.0\n */\nvar max = function (O) {\n    var S = Se.max(O);\n    return function (as) { return as.reduce(S.concat); };\n};\nexports.max = max;\n/**\n * @since 2.10.0\n */\nvar concatAll = function (S) { return function (as) { return as.reduce(S.concat); }; };\nexports.concatAll = concatAll;\n/**\n * Break a `ReadonlyArray` into its first element and remaining elements.\n *\n * @category destructors\n * @since 2.11.0\n */\nvar matchLeft = function (f) { return function (as) {\n    return f((0, exports.head)(as), (0, exports.tail)(as));\n}; };\nexports.matchLeft = matchLeft;\n/**\n * Break a `ReadonlyArray` into its initial elements and the last element.\n *\n * @category destructors\n * @since 2.11.0\n */\nvar matchRight = function (f) { return function (as) {\n    return f((0, exports.init)(as), (0, exports.last)(as));\n}; };\nexports.matchRight = matchRight;\n/**\n * Apply a function to the head, creating a new `ReadonlyNonEmptyArray`.\n *\n * @since 2.11.0\n */\nvar modifyHead = function (f) { return function (as) { return __spreadArray([\n    f((0, exports.head)(as))\n], (0, exports.tail)(as), true); }; };\nexports.modifyHead = modifyHead;\n/**\n * Change the head, creating a new `ReadonlyNonEmptyArray`.\n *\n * @category combinators\n * @since 2.11.0\n */\nvar updateHead = function (a) { return (0, exports.modifyHead)(function () { return a; }); };\nexports.updateHead = updateHead;\n/**\n * Apply a function to the last element, creating a new `ReadonlyNonEmptyArray`.\n *\n * @since 2.11.0\n */\nvar modifyLast = function (f) { return function (as) {\n    return (0, function_1.pipe)((0, exports.init)(as), (0, exports.append)(f((0, exports.last)(as))));\n}; };\nexports.modifyLast = modifyLast;\n/**\n * Change the last element, creating a new `ReadonlyNonEmptyArray`.\n *\n * @category combinators\n * @since 2.11.0\n */\nvar updateLast = function (a) { return (0, exports.modifyLast)(function () { return a; }); };\nexports.updateLast = updateLast;\n/**\n * Places an element in between members of a `ReadonlyNonEmptyArray`, then folds the results using the provided `Semigroup`.\n *\n * @example\n * import * as S from 'fp-ts/string'\n * import { intercalate } from 'fp-ts/ReadonlyNonEmptyArray'\n *\n * assert.deepStrictEqual(intercalate(S.Semigroup)('-')(['a', 'b', 'c']), 'a-b-c')\n *\n * @since 2.12.0\n */\nvar intercalate = function (S) {\n    var concatAllS = (0, exports.concatAll)(S);\n    return function (middle) { return (0, function_1.flow)((0, exports.intersperse)(middle), concatAllS); };\n};\nexports.intercalate = intercalate;\nfunction groupSort(O) {\n    var sortO = (0, exports.sort)(O);\n    var groupO = group(O);\n    return function (as) { return ((0, exports.isNonEmpty)(as) ? groupO(sortO(as)) : exports.empty); };\n}\nexports.groupSort = groupSort;\nfunction filter(predicate) {\n    return (0, exports.filterWithIndex)(function (_, a) { return predicate(a); });\n}\nexports.filter = filter;\n/**\n * Use [`filterWithIndex`](./ReadonlyArray.ts.html#filterwithindex) instead.\n *\n * @category combinators\n * @since 2.5.0\n * @deprecated\n */\nvar filterWithIndex = function (predicate) { return function (as) { return (0, exports.fromReadonlyArray)(as.filter(function (a, i) { return predicate(i, a); })); }; };\nexports.filterWithIndex = filterWithIndex;\n/**\n * Use [`unprepend`](#unprepend) instead.\n *\n * @category destructors\n * @since 2.10.0\n * @deprecated\n */\nexports.uncons = exports.unprepend;\n/**\n * Use [`unappend`](#unappend) instead.\n *\n * @category destructors\n * @since 2.10.0\n * @deprecated\n */\nexports.unsnoc = exports.unappend;\nfunction cons(head, tail) {\n    return tail === undefined ? (0, exports.prepend)(head) : (0, function_1.pipe)(tail, (0, exports.prepend)(head));\n}\nexports.cons = cons;\n/**\n * Use [`append`](./ReadonlyArray.ts.html#append) instead.\n *\n * @category constructors\n * @since 2.5.0\n * @deprecated\n */\nvar snoc = function (init, end) { return (0, function_1.pipe)(init, concat([end])); };\nexports.snoc = snoc;\n/**\n * Use [`insertAt`](./ReadonlyArray.ts.html#insertat) instead.\n *\n * @category combinators\n * @since 2.5.0\n * @deprecated\n */\nvar insertAt = function (i, a) { return function (as) {\n    return i < 0 || i > as.length ? _.none : _.some((0, exports.unsafeInsertAt)(i, a, as));\n}; };\nexports.insertAt = insertAt;\n/**\n * Use [`prependAll`](#prependall) instead.\n *\n * @category combinators\n * @since 2.9.0\n * @deprecated\n */\nexports.prependToAll = exports.prependAll;\n/**\n * Use [`concatAll`](#concatall) instead.\n *\n * @since 2.5.0\n * @deprecated\n */\nexports.fold = exports.concatAll;\n/**\n * This instance is deprecated, use small, specific instances instead.\n * For example if a function needs a `Functor` instance, pass `RNEA.Functor` instead of `RNEA.readonlyNonEmptyArray`\n * (where `RNEA` is from `import RNEA from 'fp-ts/ReadonlyNonEmptyArray'`)\n *\n * @category instances\n * @since 2.5.0\n * @deprecated\n */\nexports.readonlyNonEmptyArray = {\n    URI: exports.URI,\n    of: exports.of,\n    map: _map,\n    mapWithIndex: _mapWithIndex,\n    ap: _ap,\n    chain: _chain,\n    extend: _extend,\n    extract: exports.extract,\n    reduce: _reduce,\n    foldMap: _foldMap,\n    reduceRight: _reduceRight,\n    traverse: _traverse,\n    sequence: exports.sequence,\n    reduceWithIndex: _reduceWithIndex,\n    foldMapWithIndex: _foldMapWithIndex,\n    reduceRightWithIndex: _reduceRightWithIndex,\n    traverseWithIndex: _traverseWithIndex,\n    alt: _alt\n};\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.mapWithIndex = exports.map = exports.flatten = exports.duplicate = exports.extend = exports.chain = exports.ap = exports.alt = exports.altW = exports.chunksOf = exports.splitAt = exports.chop = exports.chainWithIndex = exports.foldMap = exports.foldMapWithIndex = exports.intersperse = exports.prependAll = exports.unzip = exports.zip = exports.zipWith = exports.of = exports.copy = exports.modifyAt = exports.updateAt = exports.insertAt = exports.sort = exports.groupBy = exports.group = exports.reverse = exports.concat = exports.concatW = exports.unappend = exports.unprepend = exports.range = exports.replicate = exports.makeBy = exports.fromArray = exports.fromReadonlyNonEmptyArray = exports.rotate = exports.union = exports.sortBy = exports.uniq = exports.unsafeUpdateAt = exports.unsafeInsertAt = exports.append = exports.appendW = exports.prepend = exports.prependW = exports.isOutOfBound = exports.isNonEmpty = void 0;\nexports.filter = exports.groupSort = exports.intercalate = exports.updateLast = exports.modifyLast = exports.updateHead = exports.modifyHead = exports.matchRight = exports.matchLeft = exports.concatAll = exports.max = exports.min = exports.init = exports.last = exports.tail = exports.head = exports.apS = exports.bind = exports.bindTo = exports.Do = exports.Comonad = exports.Alt = exports.TraversableWithIndex = exports.Traversable = exports.FoldableWithIndex = exports.Foldable = exports.Monad = exports.chainFirst = exports.Chain = exports.Applicative = exports.apSecond = exports.apFirst = exports.Apply = exports.FunctorWithIndex = exports.Pointed = exports.flap = exports.Functor = exports.getUnionSemigroup = exports.getEq = exports.getSemigroup = exports.getShow = exports.URI = exports.extract = exports.traverseWithIndex = exports.sequence = exports.traverse = exports.reduceRightWithIndex = exports.reduceRight = exports.reduceWithIndex = exports.reduce = void 0;\nexports.nonEmptyArray = exports.fold = exports.prependToAll = exports.snoc = exports.cons = exports.unsnoc = exports.uncons = exports.filterWithIndex = void 0;\nvar Apply_1 = require(\"./Apply\");\nvar Chain_1 = require(\"./Chain\");\nvar function_1 = require(\"./function\");\nvar Functor_1 = require(\"./Functor\");\nvar _ = __importStar(require(\"./internal\"));\nvar Ord_1 = require(\"./Ord\");\nvar RNEA = __importStar(require(\"./ReadonlyNonEmptyArray\"));\n// -------------------------------------------------------------------------------------\n// internal\n// -------------------------------------------------------------------------------------\n/**\n * @internal\n */\nvar isNonEmpty = function (as) { return as.length > 0; };\nexports.isNonEmpty = isNonEmpty;\n/**\n * @internal\n */\nvar isOutOfBound = function (i, as) { return i < 0 || i >= as.length; };\nexports.isOutOfBound = isOutOfBound;\n/**\n * @internal\n */\nvar prependW = function (head) { return function (tail) { return __spreadArray([head], tail, true); }; };\nexports.prependW = prependW;\n/**\n * @internal\n */\nexports.prepend = exports.prependW;\n/**\n * @internal\n */\nvar appendW = function (end) { return function (init) { return __spreadArray(__spreadArray([], init, true), [end], false); }; };\nexports.appendW = appendW;\n/**\n * @internal\n */\nexports.append = exports.appendW;\n/**\n * @internal\n */\nvar unsafeInsertAt = function (i, a, as) {\n    if ((0, exports.isNonEmpty)(as)) {\n        var xs = (0, exports.fromReadonlyNonEmptyArray)(as);\n        xs.splice(i, 0, a);\n        return xs;\n    }\n    return [a];\n};\nexports.unsafeInsertAt = unsafeInsertAt;\n/**\n * @internal\n */\nvar unsafeUpdateAt = function (i, a, as) {\n    var xs = (0, exports.fromReadonlyNonEmptyArray)(as);\n    xs[i] = a;\n    return xs;\n};\nexports.unsafeUpdateAt = unsafeUpdateAt;\n/**\n * Remove duplicates from a `NonEmptyArray`, keeping the first occurrence of an element.\n *\n * @example\n * import { uniq } from 'fp-ts/NonEmptyArray'\n * import * as N from 'fp-ts/number'\n *\n * assert.deepStrictEqual(uniq(N.Eq)([1, 2, 1]), [1, 2])\n *\n * @category combinators\n * @since 2.11.0\n */\nvar uniq = function (E) { return function (as) {\n    if (as.length === 1) {\n        return (0, exports.copy)(as);\n    }\n    var out = [(0, exports.head)(as)];\n    var rest = (0, exports.tail)(as);\n    var _loop_1 = function (a) {\n        if (out.every(function (o) { return !E.equals(o, a); })) {\n            out.push(a);\n        }\n    };\n    for (var _i = 0, rest_1 = rest; _i < rest_1.length; _i++) {\n        var a = rest_1[_i];\n        _loop_1(a);\n    }\n    return out;\n}; };\nexports.uniq = uniq;\n/**\n * Sort the elements of a `NonEmptyArray` in increasing order, where elements are compared using first `ords[0]`, then `ords[1]`,\n * etc...\n *\n * @example\n * import * as NEA from 'fp-ts/NonEmptyArray'\n * import { contramap } from 'fp-ts/Ord'\n * import * as S from 'fp-ts/string'\n * import * as N from 'fp-ts/number'\n * import { pipe } from 'fp-ts/function'\n *\n * interface Person {\n *   name: string\n *   age: number\n * }\n *\n * const byName = pipe(S.Ord, contramap((p: Person) => p.name))\n *\n * const byAge = pipe(N.Ord, contramap((p: Person) => p.age))\n *\n * const sortByNameByAge = NEA.sortBy([byName, byAge])\n *\n * const persons: NEA.NonEmptyArray<Person> = [\n *   { name: 'a', age: 1 },\n *   { name: 'b', age: 3 },\n *   { name: 'c', age: 2 },\n *   { name: 'b', age: 2 }\n * ]\n *\n * assert.deepStrictEqual(sortByNameByAge(persons), [\n *   { name: 'a', age: 1 },\n *   { name: 'b', age: 2 },\n *   { name: 'b', age: 3 },\n *   { name: 'c', age: 2 }\n * ])\n *\n * @category combinators\n * @since 2.11.0\n */\nvar sortBy = function (ords) {\n    if ((0, exports.isNonEmpty)(ords)) {\n        var M = (0, Ord_1.getMonoid)();\n        return (0, exports.sort)(ords.reduce(M.concat, M.empty));\n    }\n    return exports.copy;\n};\nexports.sortBy = sortBy;\n/**\n * @category combinators\n * @since 2.11.0\n */\nvar union = function (E) {\n    var uniqE = (0, exports.uniq)(E);\n    return function (second) { return function (first) { return uniqE((0, function_1.pipe)(first, concat(second))); }; };\n};\nexports.union = union;\n/**\n * Rotate a `NonEmptyArray` by `n` steps.\n *\n * @example\n * import { rotate } from 'fp-ts/NonEmptyArray'\n *\n * assert.deepStrictEqual(rotate(2)([1, 2, 3, 4, 5]), [4, 5, 1, 2, 3])\n * assert.deepStrictEqual(rotate(-2)([1, 2, 3, 4, 5]), [3, 4, 5, 1, 2])\n *\n * @category combinators\n * @since 2.11.0\n */\nvar rotate = function (n) { return function (as) {\n    var len = as.length;\n    var m = Math.round(n) % len;\n    if ((0, exports.isOutOfBound)(Math.abs(m), as) || m === 0) {\n        return (0, exports.copy)(as);\n    }\n    if (m < 0) {\n        var _a = (0, exports.splitAt)(-m)(as), f = _a[0], s = _a[1];\n        return (0, function_1.pipe)(s, concat(f));\n    }\n    else {\n        return (0, exports.rotate)(m - len)(as);\n    }\n}; };\nexports.rotate = rotate;\n// -------------------------------------------------------------------------------------\n// constructors\n// -------------------------------------------------------------------------------------\n/**\n * @category constructors\n * @since 2.10.0\n */\nexports.fromReadonlyNonEmptyArray = _.fromReadonlyNonEmptyArray;\n/**\n * Builds a `NonEmptyArray` from an `Array` returning `none` if `as` is an empty array\n *\n * @category constructors\n * @since 2.0.0\n */\nvar fromArray = function (as) { return ((0, exports.isNonEmpty)(as) ? _.some(as) : _.none); };\nexports.fromArray = fromArray;\n/**\n * Return a `NonEmptyArray` of length `n` with element `i` initialized with `f(i)`.\n *\n * **Note**. `n` is normalized to a natural number.\n *\n * @example\n * import { makeBy } from 'fp-ts/NonEmptyArray'\n * import { pipe } from 'fp-ts/function'\n *\n * const double = (n: number): number => n * 2\n * assert.deepStrictEqual(pipe(5, makeBy(double)), [0, 2, 4, 6, 8])\n *\n * @category constructors\n * @since 2.11.0\n */\nvar makeBy = function (f) { return function (n) {\n    var j = Math.max(0, Math.floor(n));\n    var out = [f(0)];\n    for (var i = 1; i < j; i++) {\n        out.push(f(i));\n    }\n    return out;\n}; };\nexports.makeBy = makeBy;\n/**\n * Create a `NonEmptyArray` containing a value repeated the specified number of times.\n *\n * **Note**. `n` is normalized to a natural number.\n *\n * @example\n * import { replicate } from 'fp-ts/NonEmptyArray'\n * import { pipe } from 'fp-ts/function'\n *\n * assert.deepStrictEqual(pipe(3, replicate('a')), ['a', 'a', 'a'])\n *\n * @category constructors\n * @since 2.11.0\n */\nvar replicate = function (a) { return (0, exports.makeBy)(function () { return a; }); };\nexports.replicate = replicate;\n/**\n * Create a `NonEmptyArray` containing a range of integers, including both endpoints.\n *\n * @example\n * import { range } from 'fp-ts/NonEmptyArray'\n *\n * assert.deepStrictEqual(range(1, 5), [1, 2, 3, 4, 5])\n *\n * @category constructors\n * @since 2.11.0\n */\nvar range = function (start, end) {\n    return start <= end ? (0, exports.makeBy)(function (i) { return start + i; })(end - start + 1) : [start];\n};\nexports.range = range;\n// -------------------------------------------------------------------------------------\n// destructors\n// -------------------------------------------------------------------------------------\n/**\n * Return the tuple of the `head` and the `tail`.\n *\n * @example\n * import { unprepend } from 'fp-ts/NonEmptyArray'\n *\n * assert.deepStrictEqual(unprepend([1, 2, 3]), [1, [2, 3]])\n *\n * @category destructors\n * @since 2.9.0\n */\nvar unprepend = function (as) { return [(0, exports.head)(as), (0, exports.tail)(as)]; };\nexports.unprepend = unprepend;\n/**\n * Return the tuple of the `init` and the `last`.\n *\n * @example\n * import { unappend } from 'fp-ts/NonEmptyArray'\n *\n * assert.deepStrictEqual(unappend([1, 2, 3, 4]), [[1, 2, 3], 4])\n *\n * @category destructors\n * @since 2.9.0\n */\nvar unappend = function (as) { return [(0, exports.init)(as), (0, exports.last)(as)]; };\nexports.unappend = unappend;\nfunction concatW(second) {\n    return function (first) { return first.concat(second); };\n}\nexports.concatW = concatW;\nfunction concat(x, y) {\n    return y ? x.concat(y) : function (y) { return y.concat(x); };\n}\nexports.concat = concat;\n/**\n * @category combinators\n * @since 2.0.0\n */\nvar reverse = function (as) { return __spreadArray([(0, exports.last)(as)], as.slice(0, -1).reverse(), true); };\nexports.reverse = reverse;\nfunction group(E) {\n    return function (as) {\n        var len = as.length;\n        if (len === 0) {\n            return [];\n        }\n        var out = [];\n        var head = as[0];\n        var nea = [head];\n        for (var i = 1; i < len; i++) {\n            var a = as[i];\n            if (E.equals(a, head)) {\n                nea.push(a);\n            }\n            else {\n                out.push(nea);\n                head = a;\n                nea = [head];\n            }\n        }\n        out.push(nea);\n        return out;\n    };\n}\nexports.group = group;\n/**\n * Splits an array into sub-non-empty-arrays stored in an object, based on the result of calling a `string`-returning\n * function on each element, and grouping the results according to values returned\n *\n * @example\n * import { groupBy } from 'fp-ts/NonEmptyArray'\n *\n * assert.deepStrictEqual(groupBy((s: string) => String(s.length))(['a', 'b', 'ab']), {\n *   '1': ['a', 'b'],\n *   '2': ['ab']\n * })\n *\n * @category combinators\n * @since 2.0.0\n */\nvar groupBy = function (f) { return function (as) {\n    var out = {};\n    for (var _i = 0, as_1 = as; _i < as_1.length; _i++) {\n        var a = as_1[_i];\n        var k = f(a);\n        if (_.has.call(out, k)) {\n            out[k].push(a);\n        }\n        else {\n            out[k] = [a];\n        }\n    }\n    return out;\n}; };\nexports.groupBy = groupBy;\n/**\n * @category combinators\n * @since 2.0.0\n */\nvar sort = function (O) { return function (as) {\n    return as.slice().sort(O.compare);\n}; };\nexports.sort = sort;\n/**\n * @category combinators\n * @since 2.0.0\n */\nvar insertAt = function (i, a) { return function (as) {\n    return i < 0 || i > as.length ? _.none : _.some((0, exports.unsafeInsertAt)(i, a, as));\n}; };\nexports.insertAt = insertAt;\n/**\n * @category combinators\n * @since 2.0.0\n */\nvar updateAt = function (i, a) {\n    return (0, exports.modifyAt)(i, function () { return a; });\n};\nexports.updateAt = updateAt;\n/**\n * @category combinators\n * @since 2.0.0\n */\nvar modifyAt = function (i, f) { return function (as) {\n    return (0, exports.isOutOfBound)(i, as) ? _.none : _.some((0, exports.unsafeUpdateAt)(i, f(as[i]), as));\n}; };\nexports.modifyAt = modifyAt;\n/**\n * @category combinators\n * @since 2.0.0\n */\nexports.copy = exports.fromReadonlyNonEmptyArray;\n/**\n * @category Pointed\n * @since 2.0.0\n */\nvar of = function (a) { return [a]; };\nexports.of = of;\n/**\n * @category combinators\n * @since 2.5.1\n */\nvar zipWith = function (as, bs, f) {\n    var cs = [f(as[0], bs[0])];\n    var len = Math.min(as.length, bs.length);\n    for (var i = 1; i < len; i++) {\n        cs[i] = f(as[i], bs[i]);\n    }\n    return cs;\n};\nexports.zipWith = zipWith;\nfunction zip(as, bs) {\n    if (bs === undefined) {\n        return function (bs) { return zip(bs, as); };\n    }\n    return (0, exports.zipWith)(as, bs, function (a, b) { return [a, b]; });\n}\nexports.zip = zip;\n/**\n * @category combinators\n * @since 2.5.1\n */\nvar unzip = function (abs) {\n    var fa = [abs[0][0]];\n    var fb = [abs[0][1]];\n    for (var i = 1; i < abs.length; i++) {\n        fa[i] = abs[i][0];\n        fb[i] = abs[i][1];\n    }\n    return [fa, fb];\n};\nexports.unzip = unzip;\n/**\n * Prepend an element to every member of an array\n *\n * @example\n * import { prependAll } from 'fp-ts/NonEmptyArray'\n *\n * assert.deepStrictEqual(prependAll(9)([1, 2, 3, 4]), [9, 1, 9, 2, 9, 3, 9, 4])\n *\n * @category combinators\n * @since 2.10.0\n */\nvar prependAll = function (middle) { return function (as) {\n    var out = [middle, as[0]];\n    for (var i = 1; i < as.length; i++) {\n        out.push(middle, as[i]);\n    }\n    return out;\n}; };\nexports.prependAll = prependAll;\n/**\n * Places an element in between members of an array\n *\n * @example\n * import { intersperse } from 'fp-ts/NonEmptyArray'\n *\n * assert.deepStrictEqual(intersperse(9)([1, 2, 3, 4]), [1, 9, 2, 9, 3, 9, 4])\n *\n * @category combinators\n * @since 2.9.0\n */\nvar intersperse = function (middle) { return function (as) {\n    var rest = (0, exports.tail)(as);\n    return (0, exports.isNonEmpty)(rest) ? (0, function_1.pipe)(rest, (0, exports.prependAll)(middle), (0, exports.prepend)((0, exports.head)(as))) : (0, exports.copy)(as);\n}; };\nexports.intersperse = intersperse;\n/**\n * @category combinators\n * @since 2.0.0\n */\nexports.foldMapWithIndex = RNEA.foldMapWithIndex;\n/**\n * @category combinators\n * @since 2.0.0\n */\nexports.foldMap = RNEA.foldMap;\n/**\n * @category combinators\n * @since 2.10.0\n */\nvar chainWithIndex = function (f) { return function (as) {\n    var out = (0, exports.fromReadonlyNonEmptyArray)(f(0, (0, exports.head)(as)));\n    for (var i = 1; i < as.length; i++) {\n        out.push.apply(out, f(i, as[i]));\n    }\n    return out;\n}; };\nexports.chainWithIndex = chainWithIndex;\n/**\n * @category combinators\n * @since 2.10.0\n */\nvar chop = function (f) { return function (as) {\n    var _a = f(as), b = _a[0], rest = _a[1];\n    var out = [b];\n    var next = rest;\n    while ((0, exports.isNonEmpty)(next)) {\n        var _b = f(next), b_1 = _b[0], rest_2 = _b[1];\n        out.push(b_1);\n        next = rest_2;\n    }\n    return out;\n}; };\nexports.chop = chop;\n/**\n * Splits a `NonEmptyArray` into two pieces, the first piece has max `n` elements.\n *\n * @category combinators\n * @since 2.10.0\n */\nvar splitAt = function (n) { return function (as) {\n    var m = Math.max(1, n);\n    return m >= as.length ? [(0, exports.copy)(as), []] : [(0, function_1.pipe)(as.slice(1, m), (0, exports.prepend)((0, exports.head)(as))), as.slice(m)];\n}; };\nexports.splitAt = splitAt;\n/**\n * @category combinators\n * @since 2.10.0\n */\nvar chunksOf = function (n) { return (0, exports.chop)((0, exports.splitAt)(n)); };\nexports.chunksOf = chunksOf;\n// -------------------------------------------------------------------------------------\n// non-pipeables\n// -------------------------------------------------------------------------------------\n/* istanbul ignore next */\nvar _map = function (fa, f) { return (0, function_1.pipe)(fa, (0, exports.map)(f)); };\n/* istanbul ignore next */\nvar _mapWithIndex = function (fa, f) { return (0, function_1.pipe)(fa, (0, exports.mapWithIndex)(f)); };\n/* istanbul ignore next */\nvar _ap = function (fab, fa) { return (0, function_1.pipe)(fab, (0, exports.ap)(fa)); };\n/* istanbul ignore next */\nvar _chain = function (ma, f) { return (0, function_1.pipe)(ma, (0, exports.chain)(f)); };\n/* istanbul ignore next */\nvar _extend = function (wa, f) { return (0, function_1.pipe)(wa, (0, exports.extend)(f)); };\n/* istanbul ignore next */\nvar _reduce = function (fa, b, f) { return (0, function_1.pipe)(fa, (0, exports.reduce)(b, f)); };\n/* istanbul ignore next */\nvar _foldMap = function (M) {\n    var foldMapM = (0, exports.foldMap)(M);\n    return function (fa, f) { return (0, function_1.pipe)(fa, foldMapM(f)); };\n};\n/* istanbul ignore next */\nvar _reduceRight = function (fa, b, f) { return (0, function_1.pipe)(fa, (0, exports.reduceRight)(b, f)); };\n/* istanbul ignore next */\nvar _traverse = function (F) {\n    var traverseF = (0, exports.traverse)(F);\n    return function (ta, f) { return (0, function_1.pipe)(ta, traverseF(f)); };\n};\n/* istanbul ignore next */\nvar _alt = function (fa, that) { return (0, function_1.pipe)(fa, (0, exports.alt)(that)); };\n/* istanbul ignore next */\nvar _reduceWithIndex = function (fa, b, f) {\n    return (0, function_1.pipe)(fa, (0, exports.reduceWithIndex)(b, f));\n};\n/* istanbul ignore next */\nvar _foldMapWithIndex = function (M) {\n    var foldMapWithIndexM = (0, exports.foldMapWithIndex)(M);\n    return function (fa, f) { return (0, function_1.pipe)(fa, foldMapWithIndexM(f)); };\n};\n/* istanbul ignore next */\nvar _reduceRightWithIndex = function (fa, b, f) {\n    return (0, function_1.pipe)(fa, (0, exports.reduceRightWithIndex)(b, f));\n};\n/* istanbul ignore next */\nvar _traverseWithIndex = function (F) {\n    var traverseWithIndexF = (0, exports.traverseWithIndex)(F);\n    return function (ta, f) { return (0, function_1.pipe)(ta, traverseWithIndexF(f)); };\n};\n// -------------------------------------------------------------------------------------\n// type class members\n// -------------------------------------------------------------------------------------\n/**\n * Less strict version of [`alt`](#alt).\n *\n * @category Alt\n * @since 2.9.0\n */\nvar altW = function (that) { return function (as) {\n    return (0, function_1.pipe)(as, concatW(that()));\n}; };\nexports.altW = altW;\n/**\n * Identifies an associative operation on a type constructor. It is similar to `Semigroup`, except that it applies to\n * types of kind `* -> *`.\n *\n * @category Alt\n * @since 2.6.2\n */\nexports.alt = exports.altW;\n/**\n * Apply a function to an argument under a type constructor.\n *\n * @category Apply\n * @since 2.0.0\n */\nvar ap = function (as) {\n    return (0, exports.chain)(function (f) { return (0, function_1.pipe)(as, (0, exports.map)(f)); });\n};\nexports.ap = ap;\n/**\n * Composes computations in sequence, using the return value of one computation to determine the next computation.\n *\n * @category Monad\n * @since 2.0.0\n */\nvar chain = function (f) {\n    return (0, exports.chainWithIndex)(function (_, a) { return f(a); });\n};\nexports.chain = chain;\n/**\n * @category Extend\n * @since 2.0.0\n */\nvar extend = function (f) { return function (as) {\n    var next = (0, exports.tail)(as);\n    var out = [f(as)];\n    while ((0, exports.isNonEmpty)(next)) {\n        out.push(f(next));\n        next = (0, exports.tail)(next);\n    }\n    return out;\n}; };\nexports.extend = extend;\n/**\n * Derivable from `Extend`.\n *\n * @category combinators\n * @since 2.5.0\n */\nexports.duplicate = (0, exports.extend)(function_1.identity);\n/**\n * Derivable from `Chain`.\n *\n * @category combinators\n * @since 2.5.0\n */\nexports.flatten = (0, exports.chain)(function_1.identity);\n/**\n * `map` can be used to turn functions `(a: A) => B` into functions `(fa: F<A>) => F<B>` whose argument and return types\n * use the type constructor `F` to represent some computational context.\n *\n * @category Functor\n * @since 2.0.0\n */\nvar map = function (f) { return (0, exports.mapWithIndex)(function (_, a) { return f(a); }); };\nexports.map = map;\n/**\n * @category FunctorWithIndex\n * @since 2.0.0\n */\nvar mapWithIndex = function (f) { return function (as) {\n    var out = [f(0, (0, exports.head)(as))];\n    for (var i = 1; i < as.length; i++) {\n        out.push(f(i, as[i]));\n    }\n    return out;\n}; };\nexports.mapWithIndex = mapWithIndex;\n/**\n * @category Foldable\n * @since 2.0.0\n */\nexports.reduce = RNEA.reduce;\n/**\n * @category FoldableWithIndex\n * @since 2.0.0\n */\nexports.reduceWithIndex = RNEA.reduceWithIndex;\n/**\n * @category Foldable\n * @since 2.0.0\n */\nexports.reduceRight = RNEA.reduceRight;\n/**\n * @category FoldableWithIndex\n * @since 2.0.0\n */\nexports.reduceRightWithIndex = RNEA.reduceRightWithIndex;\n/**\n * @since 2.6.3\n */\nvar traverse = function (F) {\n    var traverseWithIndexF = (0, exports.traverseWithIndex)(F);\n    return function (f) { return traverseWithIndexF(function (_, a) { return f(a); }); };\n};\nexports.traverse = traverse;\n/**\n * @since 2.6.3\n */\nvar sequence = function (F) { return (0, exports.traverseWithIndex)(F)(function (_, a) { return a; }); };\nexports.sequence = sequence;\n/**\n * @since 2.6.3\n */\nvar traverseWithIndex = function (F) { return function (f) { return function (as) {\n    var out = F.map(f(0, (0, exports.head)(as)), exports.of);\n    for (var i = 1; i < as.length; i++) {\n        out = F.ap(F.map(out, function (bs) { return function (b) { return (0, function_1.pipe)(bs, (0, exports.append)(b)); }; }), f(i, as[i]));\n    }\n    return out;\n}; }; };\nexports.traverseWithIndex = traverseWithIndex;\n/**\n * @since 2.7.0\n */\nexports.extract = RNEA.head;\n// -------------------------------------------------------------------------------------\n// instances\n// -------------------------------------------------------------------------------------\n/**\n * @category instances\n * @since 2.0.0\n */\nexports.URI = 'NonEmptyArray';\n/**\n * @category instances\n * @since 2.0.0\n */\nexports.getShow = RNEA.getShow;\n/**\n * Builds a `Semigroup` instance for `NonEmptyArray`\n *\n * @category instances\n * @since 2.0.0\n */\nvar getSemigroup = function () { return ({\n    concat: concat\n}); };\nexports.getSemigroup = getSemigroup;\n/**\n * @example\n * import { getEq } from 'fp-ts/NonEmptyArray'\n * import * as N from 'fp-ts/number'\n *\n * const E = getEq(N.Eq)\n * assert.strictEqual(E.equals([1, 2], [1, 2]), true)\n * assert.strictEqual(E.equals([1, 2], [1, 3]), false)\n *\n * @category instances\n * @since 2.0.0\n */\nexports.getEq = RNEA.getEq;\n/**\n * @category combinators\n * @since 2.11.0\n */\nvar getUnionSemigroup = function (E) {\n    var unionE = (0, exports.union)(E);\n    return {\n        concat: function (first, second) { return unionE(second)(first); }\n    };\n};\nexports.getUnionSemigroup = getUnionSemigroup;\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Functor = {\n    URI: exports.URI,\n    map: _map\n};\n/**\n * Derivable from `Functor`.\n *\n * @category combinators\n * @since 2.10.0\n */\nexports.flap = (0, Functor_1.flap)(exports.Functor);\n/**\n * @category instances\n * @since 2.10.0\n */\nexports.Pointed = {\n    URI: exports.URI,\n    of: exports.of\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.FunctorWithIndex = {\n    URI: exports.URI,\n    map: _map,\n    mapWithIndex: _mapWithIndex\n};\n/**\n * @category instances\n * @since 2.10.0\n */\nexports.Apply = {\n    URI: exports.URI,\n    map: _map,\n    ap: _ap\n};\n/**\n * Combine two effectful actions, keeping only the result of the first.\n *\n * Derivable from `Apply`.\n *\n * @category combinators\n * @since 2.5.0\n */\nexports.apFirst = (0, Apply_1.apFirst)(exports.Apply);\n/**\n * Combine two effectful actions, keeping only the result of the second.\n *\n * Derivable from `Apply`.\n *\n * @category combinators\n * @since 2.5.0\n */\nexports.apSecond = (0, Apply_1.apSecond)(exports.Apply);\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Applicative = {\n    URI: exports.URI,\n    map: _map,\n    ap: _ap,\n    of: exports.of\n};\n/**\n * @category instances\n * @since 2.10.0\n */\nexports.Chain = {\n    URI: exports.URI,\n    map: _map,\n    ap: _ap,\n    chain: _chain\n};\n/**\n * Composes computations in sequence, using the return value of one computation to determine the next computation and\n * keeping only the result of the first.\n *\n * Derivable from `Chain`.\n *\n * @category combinators\n * @since 2.5.0\n */\nexports.chainFirst = (0, Chain_1.chainFirst)(exports.Chain);\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Monad = {\n    URI: exports.URI,\n    map: _map,\n    ap: _ap,\n    of: exports.of,\n    chain: _chain\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Foldable = {\n    URI: exports.URI,\n    reduce: _reduce,\n    foldMap: _foldMap,\n    reduceRight: _reduceRight\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.FoldableWithIndex = {\n    URI: exports.URI,\n    reduce: _reduce,\n    foldMap: _foldMap,\n    reduceRight: _reduceRight,\n    reduceWithIndex: _reduceWithIndex,\n    foldMapWithIndex: _foldMapWithIndex,\n    reduceRightWithIndex: _reduceRightWithIndex\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Traversable = {\n    URI: exports.URI,\n    map: _map,\n    reduce: _reduce,\n    foldMap: _foldMap,\n    reduceRight: _reduceRight,\n    traverse: _traverse,\n    sequence: exports.sequence\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.TraversableWithIndex = {\n    URI: exports.URI,\n    map: _map,\n    mapWithIndex: _mapWithIndex,\n    reduce: _reduce,\n    foldMap: _foldMap,\n    reduceRight: _reduceRight,\n    traverse: _traverse,\n    sequence: exports.sequence,\n    reduceWithIndex: _reduceWithIndex,\n    foldMapWithIndex: _foldMapWithIndex,\n    reduceRightWithIndex: _reduceRightWithIndex,\n    traverseWithIndex: _traverseWithIndex\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Alt = {\n    URI: exports.URI,\n    map: _map,\n    alt: _alt\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Comonad = {\n    URI: exports.URI,\n    map: _map,\n    extend: _extend,\n    extract: exports.extract\n};\n// -------------------------------------------------------------------------------------\n// do notation\n// -------------------------------------------------------------------------------------\n/**\n * @since 2.9.0\n */\nexports.Do = (0, exports.of)(_.emptyRecord);\n/**\n * @since 2.8.0\n */\nexports.bindTo = (0, Functor_1.bindTo)(exports.Functor);\n/**\n * @since 2.8.0\n */\nexports.bind = (0, Chain_1.bind)(exports.Chain);\n// -------------------------------------------------------------------------------------\n// pipeable sequence S\n// -------------------------------------------------------------------------------------\n/**\n * @since 2.8.0\n */\nexports.apS = (0, Apply_1.apS)(exports.Apply);\n// -------------------------------------------------------------------------------------\n// utils\n// -------------------------------------------------------------------------------------\n/**\n * @since 2.0.0\n */\nexports.head = RNEA.head;\n/**\n * @since 2.0.0\n */\nvar tail = function (as) { return as.slice(1); };\nexports.tail = tail;\n/**\n * @since 2.0.0\n */\nexports.last = RNEA.last;\n/**\n * Get all but the last element of a non empty array, creating a new array.\n *\n * @example\n * import { init } from 'fp-ts/NonEmptyArray'\n *\n * assert.deepStrictEqual(init([1, 2, 3]), [1, 2])\n * assert.deepStrictEqual(init([1]), [])\n *\n * @since 2.2.0\n */\nvar init = function (as) { return as.slice(0, -1); };\nexports.init = init;\n/**\n * @since 2.0.0\n */\nexports.min = RNEA.min;\n/**\n * @since 2.0.0\n */\nexports.max = RNEA.max;\n/**\n * @since 2.10.0\n */\nvar concatAll = function (S) { return function (as) { return as.reduce(S.concat); }; };\nexports.concatAll = concatAll;\n/**\n * Break an `Array` into its first element and remaining elements.\n *\n * @category destructors\n * @since 2.11.0\n */\nvar matchLeft = function (f) { return function (as) { return f((0, exports.head)(as), (0, exports.tail)(as)); }; };\nexports.matchLeft = matchLeft;\n/**\n * Break an `Array` into its initial elements and the last element.\n *\n * @category destructors\n * @since 2.11.0\n */\nvar matchRight = function (f) { return function (as) {\n    return f((0, exports.init)(as), (0, exports.last)(as));\n}; };\nexports.matchRight = matchRight;\n/**\n * Apply a function to the head, creating a new `NonEmptyArray`.\n *\n * @since 2.11.0\n */\nvar modifyHead = function (f) { return function (as) { return __spreadArray([\n    f((0, exports.head)(as))\n], (0, exports.tail)(as), true); }; };\nexports.modifyHead = modifyHead;\n/**\n * Change the head, creating a new `NonEmptyArray`.\n *\n * @category combinators\n * @since 2.11.0\n */\nvar updateHead = function (a) { return (0, exports.modifyHead)(function () { return a; }); };\nexports.updateHead = updateHead;\n/**\n * Apply a function to the last element, creating a new `NonEmptyArray`.\n *\n * @since 2.11.0\n */\nvar modifyLast = function (f) { return function (as) {\n    return (0, function_1.pipe)((0, exports.init)(as), (0, exports.append)(f((0, exports.last)(as))));\n}; };\nexports.modifyLast = modifyLast;\n/**\n * Change the last element, creating a new `NonEmptyArray`.\n *\n * @category combinators\n * @since 2.11.0\n */\nvar updateLast = function (a) { return (0, exports.modifyLast)(function () { return a; }); };\nexports.updateLast = updateLast;\n/**\n * Places an element in between members of a `NonEmptyArray`, then folds the results using the provided `Semigroup`.\n *\n * @example\n * import * as S from 'fp-ts/string'\n * import { intercalate } from 'fp-ts/NonEmptyArray'\n *\n * assert.deepStrictEqual(intercalate(S.Semigroup)('-')(['a', 'b', 'c']), 'a-b-c')\n *\n * @since 2.12.0\n */\nexports.intercalate = RNEA.intercalate;\nfunction groupSort(O) {\n    var sortO = (0, exports.sort)(O);\n    var groupO = group(O);\n    return function (as) { return ((0, exports.isNonEmpty)(as) ? groupO(sortO(as)) : []); };\n}\nexports.groupSort = groupSort;\nfunction filter(predicate) {\n    return (0, exports.filterWithIndex)(function (_, a) { return predicate(a); });\n}\nexports.filter = filter;\n/**\n * Use [`filterWithIndex`](./Array.ts.html#filterwithindex) instead.\n *\n * @category combinators\n * @since 2.0.0\n * @deprecated\n */\nvar filterWithIndex = function (predicate) { return function (as) { return (0, exports.fromArray)(as.filter(function (a, i) { return predicate(i, a); })); }; };\nexports.filterWithIndex = filterWithIndex;\n/**\n * Use [`unprepend`](#unprepend) instead.\n *\n * @category destructors\n * @since 2.9.0\n * @deprecated\n */\nexports.uncons = exports.unprepend;\n/**\n * Use [`unappend`](#unappend) instead.\n *\n * @category destructors\n * @since 2.9.0\n * @deprecated\n */\nexports.unsnoc = exports.unappend;\nfunction cons(head, tail) {\n    return tail === undefined ? (0, exports.prepend)(head) : (0, function_1.pipe)(tail, (0, exports.prepend)(head));\n}\nexports.cons = cons;\n/**\n * Use [`append`](./Array.ts.html#append) instead.\n *\n * @category constructors\n * @since 2.0.0\n * @deprecated\n */\nvar snoc = function (init, end) { return (0, function_1.pipe)(init, (0, exports.append)(end)); };\nexports.snoc = snoc;\n/**\n * Use [`prependAll`](#prependall) instead.\n *\n * @category combinators\n * @since 2.9.0\n * @deprecated\n */\nexports.prependToAll = exports.prependAll;\n/**\n * Use [`concatAll`](#concatall) instead.\n *\n * @since 2.5.0\n * @deprecated\n */\nexports.fold = RNEA.concatAll;\n/**\n * This instance is deprecated, use small, specific instances instead.\n * For example if a function needs a `Functor` instance, pass `NEA.Functor` instead of `NEA.nonEmptyArray`\n * (where `NEA` is from `import NEA from 'fp-ts/NonEmptyArray'`)\n *\n * @category instances\n * @since 2.0.0\n * @deprecated\n */\nexports.nonEmptyArray = {\n    URI: exports.URI,\n    of: exports.of,\n    map: _map,\n    mapWithIndex: _mapWithIndex,\n    ap: _ap,\n    chain: _chain,\n    extend: _extend,\n    extract: exports.extract,\n    reduce: _reduce,\n    foldMap: _foldMap,\n    reduceRight: _reduceRight,\n    traverse: _traverse,\n    sequence: exports.sequence,\n    reduceWithIndex: _reduceWithIndex,\n    foldMapWithIndex: _foldMapWithIndex,\n    reduceRightWithIndex: _reduceRightWithIndex,\n    traverseWithIndex: _traverseWithIndex,\n    alt: _alt\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Field = exports.MonoidProduct = exports.MonoidSum = exports.SemigroupProduct = exports.SemigroupSum = exports.MagmaSub = exports.Show = exports.Bounded = exports.Ord = exports.Eq = exports.isNumber = void 0;\n// -------------------------------------------------------------------------------------\n// refinements\n// -------------------------------------------------------------------------------------\n/**\n * @category refinements\n * @since 2.11.0\n */\nvar isNumber = function (u) { return typeof u === 'number'; };\nexports.isNumber = isNumber;\n// -------------------------------------------------------------------------------------\n// instances\n// -------------------------------------------------------------------------------------\n/**\n * @category instances\n * @since 2.10.0\n */\nexports.Eq = {\n    equals: function (first, second) { return first === second; }\n};\n/**\n * @category instances\n * @since 2.10.0\n */\nexports.Ord = {\n    equals: exports.Eq.equals,\n    compare: function (first, second) { return (first < second ? -1 : first > second ? 1 : 0); }\n};\n/**\n * @category instances\n * @since 2.10.0\n */\nexports.Bounded = {\n    equals: exports.Eq.equals,\n    compare: exports.Ord.compare,\n    top: Infinity,\n    bottom: -Infinity\n};\n/**\n * @category instances\n * @since 2.10.0\n */\nexports.Show = {\n    show: function (n) { return JSON.stringify(n); }\n};\n/**\n * @category instances\n * @since 2.11.0\n */\nexports.MagmaSub = {\n    concat: function (first, second) { return first - second; }\n};\n/**\n * `number` semigroup under addition.\n *\n * @example\n * import { SemigroupSum } from 'fp-ts/number'\n *\n * assert.deepStrictEqual(SemigroupSum.concat(2, 3), 5)\n *\n * @category instances\n * @since 2.10.0\n */\nexports.SemigroupSum = {\n    concat: function (first, second) { return first + second; }\n};\n/**\n * `number` semigroup under multiplication.\n *\n * @example\n * import { SemigroupProduct } from 'fp-ts/number'\n *\n * assert.deepStrictEqual(SemigroupProduct.concat(2, 3), 6)\n *\n * @category instances\n * @since 2.10.0\n */\nexports.SemigroupProduct = {\n    concat: function (first, second) { return first * second; }\n};\n/**\n * `number` monoid under addition.\n *\n * The `empty` value is `0`.\n *\n * @example\n * import { MonoidSum } from 'fp-ts/number'\n *\n * assert.deepStrictEqual(MonoidSum.concat(2, MonoidSum.empty), 2)\n *\n * @category instances\n * @since 2.10.0\n */\nexports.MonoidSum = {\n    concat: exports.SemigroupSum.concat,\n    empty: 0\n};\n/**\n * `number` monoid under multiplication.\n *\n * The `empty` value is `1`.\n *\n * @example\n * import { MonoidProduct } from 'fp-ts/number'\n *\n * assert.deepStrictEqual(MonoidProduct.concat(2, MonoidProduct.empty), 2)\n *\n * @category instances\n * @since 2.10.0\n */\nexports.MonoidProduct = {\n    concat: exports.SemigroupProduct.concat,\n    empty: 1\n};\n/**\n * @category instances\n * @since 2.10.0\n */\nexports.Field = {\n    add: exports.SemigroupSum.concat,\n    zero: 0,\n    mul: exports.SemigroupProduct.concat,\n    one: 1,\n    sub: exports.MagmaSub.concat,\n    degree: function (_) { return 1; },\n    div: function (first, second) { return first / second; },\n    mod: function (first, second) { return first % second; }\n};\n","\"use strict\";\n/**\n * ```ts\n * interface Separated<E, A> {\n *    readonly left: E\n *    readonly right: A\n * }\n * ```\n *\n * Represents a result of separating a whole into two parts.\n *\n * @since 2.10.0\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.right = exports.left = exports.flap = exports.Functor = exports.Bifunctor = exports.URI = exports.bimap = exports.mapLeft = exports.map = exports.separated = void 0;\nvar function_1 = require(\"./function\");\nvar Functor_1 = require(\"./Functor\");\n// -------------------------------------------------------------------------------------\n// constructors\n// -------------------------------------------------------------------------------------\n/**\n * @category constructors\n * @since 2.10.0\n */\nvar separated = function (left, right) { return ({ left: left, right: right }); };\nexports.separated = separated;\n// -------------------------------------------------------------------------------------\n// non-pipeables\n// -------------------------------------------------------------------------------------\nvar _map = function (fa, f) { return (0, function_1.pipe)(fa, (0, exports.map)(f)); };\nvar _mapLeft = function (fa, f) { return (0, function_1.pipe)(fa, (0, exports.mapLeft)(f)); };\nvar _bimap = function (fa, g, f) { return (0, function_1.pipe)(fa, (0, exports.bimap)(g, f)); };\n// -------------------------------------------------------------------------------------\n// type class members\n// -------------------------------------------------------------------------------------\n/**\n * `map` can be used to turn functions `(a: A) => B` into functions `(fa: F<A>) => F<B>` whose argument and return types\n * use the type constructor `F` to represent some computational context.\n *\n * @category Functor\n * @since 2.10.0\n */\nvar map = function (f) { return function (fa) {\n    return (0, exports.separated)((0, exports.left)(fa), f((0, exports.right)(fa)));\n}; };\nexports.map = map;\n/**\n * Map a function over the first type argument of a bifunctor.\n *\n * @category Bifunctor\n * @since 2.10.0\n */\nvar mapLeft = function (f) { return function (fa) {\n    return (0, exports.separated)(f((0, exports.left)(fa)), (0, exports.right)(fa));\n}; };\nexports.mapLeft = mapLeft;\n/**\n * Map a pair of functions over the two type arguments of the bifunctor.\n *\n * @category Bifunctor\n * @since 2.10.0\n */\nvar bimap = function (f, g) { return function (fa) {\n    return (0, exports.separated)(f((0, exports.left)(fa)), g((0, exports.right)(fa)));\n}; };\nexports.bimap = bimap;\n// -------------------------------------------------------------------------------------\n// instances\n// -------------------------------------------------------------------------------------\n/**\n * @category instances\n * @since 2.10.0\n */\nexports.URI = 'Separated';\n/**\n * @category instances\n * @since 2.10.0\n */\nexports.Bifunctor = {\n    URI: exports.URI,\n    mapLeft: _mapLeft,\n    bimap: _bimap\n};\n/**\n * @category instances\n * @since 2.10.0\n */\nexports.Functor = {\n    URI: exports.URI,\n    map: _map\n};\n/**\n * Derivable from `Functor`.\n *\n * @category combinators\n * @since 2.10.0\n */\nexports.flap = (0, Functor_1.flap)(exports.Functor);\n// -------------------------------------------------------------------------------------\n// utils\n// -------------------------------------------------------------------------------------\n/**\n * @since 2.10.0\n */\nvar left = function (s) { return s.left; };\nexports.left = left;\n/**\n * @since 2.10.0\n */\nvar right = function (s) { return s.right; };\nexports.right = right;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.filterE = exports.witherDefault = exports.wiltDefault = void 0;\nvar _ = __importStar(require(\"./internal\"));\nfunction wiltDefault(T, C) {\n    return function (F) {\n        var traverseF = T.traverse(F);\n        return function (wa, f) { return F.map(traverseF(wa, f), C.separate); };\n    };\n}\nexports.wiltDefault = wiltDefault;\nfunction witherDefault(T, C) {\n    return function (F) {\n        var traverseF = T.traverse(F);\n        return function (wa, f) { return F.map(traverseF(wa, f), C.compact); };\n    };\n}\nexports.witherDefault = witherDefault;\nfunction filterE(W) {\n    return function (F) {\n        var witherF = W.wither(F);\n        return function (predicate) { return function (ga) { return witherF(ga, function (a) { return F.map(predicate(a), function (b) { return (b ? _.some(a) : _.none); }); }); }; };\n    };\n}\nexports.filterE = filterE;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.guard = void 0;\nfunction guard(F, P) {\n    return function (b) { return (b ? P.of(undefined) : F.zero()); };\n}\nexports.guard = guard;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sort = exports.lefts = exports.rights = exports.reverse = exports.modifyAt = exports.deleteAt = exports.updateAt = exports.insertAt = exports.findLastIndex = exports.findLastMap = exports.findLast = exports.findFirstMap = exports.findFirst = exports.findIndex = exports.dropLeftWhile = exports.dropRight = exports.dropLeft = exports.spanLeft = exports.takeLeftWhile = exports.takeRight = exports.takeLeft = exports.init = exports.tail = exports.last = exports.head = exports.lookup = exports.isOutOfBound = exports.size = exports.scanRight = exports.scanLeft = exports.chainWithIndex = exports.foldRight = exports.matchRight = exports.matchRightW = exports.foldLeft = exports.matchLeft = exports.matchLeftW = exports.match = exports.matchW = exports.fromEither = exports.fromOption = exports.fromPredicate = exports.replicate = exports.makeBy = exports.appendW = exports.append = exports.prependW = exports.prepend = exports.isNonEmpty = exports.isEmpty = void 0;\nexports.sequence = exports.traverse = exports.reduceRightWithIndex = exports.reduceRight = exports.reduceWithIndex = exports.foldMap = exports.reduce = exports.foldMapWithIndex = exports.duplicate = exports.extend = exports.filterWithIndex = exports.partitionMapWithIndex = exports.partitionMap = exports.partitionWithIndex = exports.partition = exports.compact = exports.filterMap = exports.filterMapWithIndex = exports.filter = exports.separate = exports.mapWithIndex = exports.map = exports.flatten = exports.chain = exports.ap = exports.alt = exports.altW = exports.zero = exports.of = exports._chainRecBreadthFirst = exports._chainRecDepthFirst = exports.difference = exports.intersection = exports.union = exports.concat = exports.concatW = exports.comprehension = exports.fromOptionK = exports.chunksOf = exports.splitAt = exports.chop = exports.sortBy = exports.uniq = exports.elem = exports.rotate = exports.intersperse = exports.prependAll = exports.unzip = exports.zip = exports.zipWith = void 0;\nexports.toArray = exports.unsafeDeleteAt = exports.unsafeUpdateAt = exports.unsafeInsertAt = exports.fromEitherK = exports.FromEither = exports.filterE = exports.Witherable = exports.ChainRecBreadthFirst = exports.chainRecBreadthFirst = exports.ChainRecDepthFirst = exports.chainRecDepthFirst = exports.TraversableWithIndex = exports.Traversable = exports.FoldableWithIndex = exports.Foldable = exports.FilterableWithIndex = exports.Filterable = exports.Compactable = exports.Extend = exports.Alternative = exports.guard = exports.Zero = exports.Alt = exports.Unfoldable = exports.chainFirst = exports.Monad = exports.Chain = exports.Applicative = exports.apSecond = exports.apFirst = exports.Apply = exports.FunctorWithIndex = exports.Pointed = exports.flap = exports.Functor = exports.getDifferenceMagma = exports.getIntersectionSemigroup = exports.getUnionMonoid = exports.getUnionSemigroup = exports.getOrd = exports.getEq = exports.getMonoid = exports.getSemigroup = exports.getShow = exports.URI = exports.unfold = exports.wilt = exports.wither = exports.traverseWithIndex = void 0;\nexports.readonlyArray = exports.prependToAll = exports.snoc = exports.cons = exports.range = exports.apS = exports.bind = exports.bindTo = exports.Do = exports.intercalate = exports.exists = exports.some = exports.every = exports.empty = exports.fromArray = void 0;\nvar Apply_1 = require(\"./Apply\");\nvar Chain_1 = require(\"./Chain\");\nvar Eq_1 = require(\"./Eq\");\nvar FromEither_1 = require(\"./FromEither\");\nvar function_1 = require(\"./function\");\nvar Functor_1 = require(\"./Functor\");\nvar _ = __importStar(require(\"./internal\"));\nvar N = __importStar(require(\"./number\"));\nvar Ord_1 = require(\"./Ord\");\nvar RNEA = __importStar(require(\"./ReadonlyNonEmptyArray\"));\nvar Separated_1 = require(\"./Separated\");\nvar Witherable_1 = require(\"./Witherable\");\nvar Zero_1 = require(\"./Zero\");\n// -------------------------------------------------------------------------------------\n// refinements\n// -------------------------------------------------------------------------------------\n/**\n * Test whether a `ReadonlyArray` is empty.\n *\n * @example\n * import { isEmpty } from 'fp-ts/ReadonlyArray'\n *\n * assert.strictEqual(isEmpty([]), true)\n *\n * @category refinements\n * @since 2.5.0\n */\nvar isEmpty = function (as) { return as.length === 0; };\nexports.isEmpty = isEmpty;\n/**\n * Test whether a `ReadonlyArray` is non empty.\n *\n * @category refinements\n * @since 2.5.0\n */\nexports.isNonEmpty = RNEA.isNonEmpty;\n// -------------------------------------------------------------------------------------\n// constructors\n// -------------------------------------------------------------------------------------\n/**\n * Prepend an element to the front of a `ReadonlyArray`, creating a new `ReadonlyNonEmptyArray`.\n *\n * @example\n * import { prepend } from 'fp-ts/ReadonlyArray'\n * import { pipe } from 'fp-ts/function'\n *\n * assert.deepStrictEqual(pipe([2, 3, 4], prepend(1)), [1, 2, 3, 4])\n *\n * @category constructors\n * @since 2.10.0\n */\nexports.prepend = RNEA.prepend;\n/**\n * Less strict version of [`prepend`](#prepend).\n *\n * @category constructors\n * @since 2.11.0\n */\nexports.prependW = RNEA.prependW;\n/**\n * Append an element to the end of a `ReadonlyArray`, creating a new `ReadonlyNonEmptyArray`.\n *\n * @example\n * import { append } from 'fp-ts/ReadonlyArray'\n * import { pipe } from 'fp-ts/function'\n *\n * assert.deepStrictEqual(pipe([1, 2, 3], append(4)), [1, 2, 3, 4])\n *\n * @category constructors\n * @since 2.10.0\n */\nexports.append = RNEA.append;\n/**\n * Less strict version of [`append`](#append).\n *\n * @category constructors\n * @since 2.11.0\n */\nexports.appendW = RNEA.appendW;\n/**\n * Return a `ReadonlyArray` of length `n` with element `i` initialized with `f(i)`.\n *\n * **Note**. `n` is normalized to a non negative integer.\n *\n * @example\n * import { makeBy } from 'fp-ts/ReadonlyArray'\n *\n * const double = (n: number): number => n * 2\n * assert.deepStrictEqual(makeBy(5, double), [0, 2, 4, 6, 8])\n *\n * @category constructors\n * @since 2.5.0\n */\nvar makeBy = function (n, f) { return (n <= 0 ? exports.empty : RNEA.makeBy(f)(n)); };\nexports.makeBy = makeBy;\n/**\n * Create a `ReadonlyArray` containing a value repeated the specified number of times.\n *\n * **Note**. `n` is normalized to a non negative integer.\n *\n * @example\n * import { replicate } from 'fp-ts/ReadonlyArray'\n *\n * assert.deepStrictEqual(replicate(3, 'a'), ['a', 'a', 'a'])\n *\n * @category constructors\n * @since 2.5.0\n */\nvar replicate = function (n, a) { return (0, exports.makeBy)(n, function () { return a; }); };\nexports.replicate = replicate;\nfunction fromPredicate(predicate) {\n    return function (a) { return (predicate(a) ? [a] : exports.empty); };\n}\nexports.fromPredicate = fromPredicate;\n// -------------------------------------------------------------------------------------\n// natural transformations\n// -------------------------------------------------------------------------------------\n/**\n * @category natural transformations\n * @since 2.11.0\n */\nvar fromOption = function (ma) { return (_.isNone(ma) ? exports.empty : [ma.value]); };\nexports.fromOption = fromOption;\n/**\n * Transforms an `Either` to a `ReadonlyArray`.\n *\n * @category natural transformations\n * @since 2.11.0\n */\nvar fromEither = function (e) { return (_.isLeft(e) ? exports.empty : [e.right]); };\nexports.fromEither = fromEither;\n// -------------------------------------------------------------------------------------\n// destructors\n// -------------------------------------------------------------------------------------\n/**\n * Less strict version of [`match`](#match).\n *\n * @category destructors\n * @since 2.11.0\n */\nvar matchW = function (onEmpty, onNonEmpty) { return function (as) { return ((0, exports.isNonEmpty)(as) ? onNonEmpty(as) : onEmpty()); }; };\nexports.matchW = matchW;\n/**\n * @category destructors\n * @since 2.11.0\n */\nexports.match = exports.matchW;\n/**\n * Less strict version of [`matchLeft`](#matchleft).\n *\n * @category destructors\n * @since 2.11.0\n */\nvar matchLeftW = function (onEmpty, onNonEmpty) { return function (as) { return ((0, exports.isNonEmpty)(as) ? onNonEmpty(RNEA.head(as), RNEA.tail(as)) : onEmpty()); }; };\nexports.matchLeftW = matchLeftW;\n/**\n * Break a `ReadonlyArray` into its first element and remaining elements.\n *\n * @example\n * import { matchLeft } from 'fp-ts/ReadonlyArray'\n *\n * const len: <A>(as: ReadonlyArray<A>) => number = matchLeft(() => 0, (_, tail) => 1 + len(tail))\n * assert.strictEqual(len([1, 2, 3]), 3)\n *\n * @category destructors\n * @since 2.10.0\n */\nexports.matchLeft = exports.matchLeftW;\n/**\n * Alias of [`matchLeft`](#matchleft).\n *\n * @category destructors\n * @since 2.5.0\n */\nexports.foldLeft = exports.matchLeft;\n/**\n * Less strict version of [`matchRight`](#matchright).\n *\n * @category destructors\n * @since 2.11.0\n */\nvar matchRightW = function (onEmpty, onNonEmpty) { return function (as) { return ((0, exports.isNonEmpty)(as) ? onNonEmpty(RNEA.init(as), RNEA.last(as)) : onEmpty()); }; };\nexports.matchRightW = matchRightW;\n/**\n * Break a `ReadonlyArray` into its initial elements and the last element.\n *\n * @category destructors\n * @since 2.10.0\n */\nexports.matchRight = exports.matchRightW;\n/**\n * Alias of [`matchRight`](#matchright).\n *\n * @category destructors\n * @since 2.5.0\n */\nexports.foldRight = exports.matchRight;\n// -------------------------------------------------------------------------------------\n// combinators\n// -------------------------------------------------------------------------------------\n/**\n * @category combinators\n * @since 2.7.0\n */\nvar chainWithIndex = function (f) { return function (as) {\n    if ((0, exports.isEmpty)(as)) {\n        return exports.empty;\n    }\n    var out = [];\n    for (var i = 0; i < as.length; i++) {\n        out.push.apply(out, f(i, as[i]));\n    }\n    return out;\n}; };\nexports.chainWithIndex = chainWithIndex;\n/**\n * Same as `reduce` but it carries over the intermediate steps.\n *\n * @example\n * import { scanLeft } from 'fp-ts/ReadonlyArray'\n *\n * assert.deepStrictEqual(scanLeft(10, (b, a: number) => b - a)([1, 2, 3]), [10, 9, 7, 4])\n *\n * @category combinators\n * @since 2.5.0\n */\nvar scanLeft = function (b, f) { return function (as) {\n    var len = as.length;\n    var out = new Array(len + 1);\n    out[0] = b;\n    for (var i = 0; i < len; i++) {\n        out[i + 1] = f(out[i], as[i]);\n    }\n    return out;\n}; };\nexports.scanLeft = scanLeft;\n/**\n * Fold an array from the right, keeping all intermediate results instead of only the final result\n *\n * @example\n * import { scanRight } from 'fp-ts/ReadonlyArray'\n *\n * assert.deepStrictEqual(scanRight(10, (a: number, b) => b - a)([1, 2, 3]), [4, 5, 7, 10])\n *\n * @category combinators\n * @since 2.5.0\n */\nvar scanRight = function (b, f) { return function (as) {\n    var len = as.length;\n    var out = new Array(len + 1);\n    out[len] = b;\n    for (var i = len - 1; i >= 0; i--) {\n        out[i] = f(as[i], out[i + 1]);\n    }\n    return out;\n}; };\nexports.scanRight = scanRight;\n/**\n * Calculate the number of elements in a `ReadonlyArray`.\n *\n * @since 2.10.0\n */\nvar size = function (as) { return as.length; };\nexports.size = size;\n/**\n * Test whether an array contains a particular index\n *\n * @since 2.5.0\n */\nexports.isOutOfBound = RNEA.isOutOfBound;\nfunction lookup(i, as) {\n    return as === undefined ? function (as) { return lookup(i, as); } : (0, exports.isOutOfBound)(i, as) ? _.none : _.some(as[i]);\n}\nexports.lookup = lookup;\n/**\n * Get the first element in an array, or `None` if the array is empty\n *\n * @example\n * import { head } from 'fp-ts/ReadonlyArray'\n * import { some, none } from 'fp-ts/Option'\n *\n * assert.deepStrictEqual(head([1, 2, 3]), some(1))\n * assert.deepStrictEqual(head([]), none)\n *\n * @since 2.5.0\n */\nvar head = function (as) { return ((0, exports.isNonEmpty)(as) ? _.some(RNEA.head(as)) : _.none); };\nexports.head = head;\n/**\n * Get the last element in an array, or `None` if the array is empty\n *\n * @example\n * import { last } from 'fp-ts/ReadonlyArray'\n * import { some, none } from 'fp-ts/Option'\n *\n * assert.deepStrictEqual(last([1, 2, 3]), some(3))\n * assert.deepStrictEqual(last([]), none)\n *\n * @since 2.5.0\n */\nvar last = function (as) { return ((0, exports.isNonEmpty)(as) ? _.some(RNEA.last(as)) : _.none); };\nexports.last = last;\n/**\n * Get all but the first element of an array, creating a new array, or `None` if the array is empty\n *\n * @example\n * import { tail } from 'fp-ts/ReadonlyArray'\n * import { some, none } from 'fp-ts/Option'\n *\n * assert.deepStrictEqual(tail([1, 2, 3]), some([2, 3]))\n * assert.deepStrictEqual(tail([]), none)\n *\n * @since 2.5.0\n */\nvar tail = function (as) {\n    return (0, exports.isNonEmpty)(as) ? _.some(RNEA.tail(as)) : _.none;\n};\nexports.tail = tail;\n/**\n * Get all but the last element of an array, creating a new array, or `None` if the array is empty\n *\n * @example\n * import { init } from 'fp-ts/ReadonlyArray'\n * import { some, none } from 'fp-ts/Option'\n *\n * assert.deepStrictEqual(init([1, 2, 3]), some([1, 2]))\n * assert.deepStrictEqual(init([]), none)\n *\n * @since 2.5.0\n */\nvar init = function (as) {\n    return (0, exports.isNonEmpty)(as) ? _.some(RNEA.init(as)) : _.none;\n};\nexports.init = init;\n/**\n * Keep only a max number of elements from the start of an `ReadonlyArray`, creating a new `ReadonlyArray`.\n *\n * **Note**. `n` is normalized to a non negative integer.\n *\n * @example\n * import * as RA from 'fp-ts/ReadonlyArray'\n * import { pipe } from 'fp-ts/function'\n *\n * const input: ReadonlyArray<number> = [1, 2, 3]\n * assert.deepStrictEqual(pipe(input, RA.takeLeft(2)), [1, 2])\n *\n * // out of bounds\n * assert.strictEqual(pipe(input, RA.takeLeft(4)), input)\n * assert.strictEqual(pipe(input, RA.takeLeft(-1)), input)\n *\n * @category combinators\n * @since 2.5.0\n */\nvar takeLeft = function (n) { return function (as) {\n    return (0, exports.isOutOfBound)(n, as) ? as : n === 0 ? exports.empty : as.slice(0, n);\n}; };\nexports.takeLeft = takeLeft;\n/**\n * Keep only a max number of elements from the end of an `ReadonlyArray`, creating a new `ReadonlyArray`.\n *\n * **Note**. `n` is normalized to a non negative integer.\n *\n * @example\n * import * as RA from 'fp-ts/ReadonlyArray'\n * import { pipe } from 'fp-ts/function'\n *\n * const input: ReadonlyArray<number> = [1, 2, 3]\n * assert.deepStrictEqual(pipe(input, RA.takeRight(2)), [2, 3])\n *\n * // out of bounds\n * assert.strictEqual(pipe(input, RA.takeRight(4)), input)\n * assert.strictEqual(pipe(input, RA.takeRight(-1)), input)\n *\n * @category combinators\n * @since 2.5.0\n */\nvar takeRight = function (n) { return function (as) {\n    return (0, exports.isOutOfBound)(n, as) ? as : n === 0 ? exports.empty : as.slice(-n);\n}; };\nexports.takeRight = takeRight;\nfunction takeLeftWhile(predicate) {\n    return function (as) {\n        var out = [];\n        for (var _i = 0, as_1 = as; _i < as_1.length; _i++) {\n            var a = as_1[_i];\n            if (!predicate(a)) {\n                break;\n            }\n            out.push(a);\n        }\n        var len = out.length;\n        return len === as.length ? as : len === 0 ? exports.empty : out;\n    };\n}\nexports.takeLeftWhile = takeLeftWhile;\nvar spanLeftIndex = function (as, predicate) {\n    var l = as.length;\n    var i = 0;\n    for (; i < l; i++) {\n        if (!predicate(as[i])) {\n            break;\n        }\n    }\n    return i;\n};\nfunction spanLeft(predicate) {\n    return function (as) {\n        var _a = (0, exports.splitAt)(spanLeftIndex(as, predicate))(as), init = _a[0], rest = _a[1];\n        return { init: init, rest: rest };\n    };\n}\nexports.spanLeft = spanLeft;\n/**\n * Drop a max number of elements from the start of an `ReadonlyArray`, creating a new `ReadonlyArray`.\n *\n * **Note**. `n` is normalized to a non negative integer.\n *\n * @example\n * import * as RA from 'fp-ts/ReadonlyArray'\n * import { pipe } from 'fp-ts/function'\n *\n * const input: ReadonlyArray<number> = [1, 2, 3]\n * assert.deepStrictEqual(pipe(input, RA.dropLeft(2)), [3])\n * assert.strictEqual(pipe(input, RA.dropLeft(0)), input)\n * assert.strictEqual(pipe(input, RA.dropLeft(-1)), input)\n *\n * @category combinators\n * @since 2.5.0\n */\nvar dropLeft = function (n) { return function (as) {\n    return n <= 0 || (0, exports.isEmpty)(as) ? as : n >= as.length ? exports.empty : as.slice(n, as.length);\n}; };\nexports.dropLeft = dropLeft;\n/**\n * Drop a max number of elements from the end of an `ReadonlyArray`, creating a new `ReadonlyArray`.\n *\n * **Note**. `n` is normalized to a non negative integer.\n *\n * @example\n * import * as RA from 'fp-ts/ReadonlyArray'\n * import { pipe } from 'fp-ts/function'\n *\n * const input: ReadonlyArray<number> = [1, 2, 3]\n * assert.deepStrictEqual(pipe(input, RA.dropRight(2)), [1])\n * assert.strictEqual(pipe(input, RA.dropRight(0)), input)\n * assert.strictEqual(pipe(input, RA.dropRight(-1)), input)\n *\n * @category combinators\n * @since 2.5.0\n */\nvar dropRight = function (n) { return function (as) {\n    return n <= 0 || (0, exports.isEmpty)(as) ? as : n >= as.length ? exports.empty : as.slice(0, as.length - n);\n}; };\nexports.dropRight = dropRight;\nfunction dropLeftWhile(predicate) {\n    return function (as) {\n        var i = spanLeftIndex(as, predicate);\n        return i === 0 ? as : i === as.length ? exports.empty : as.slice(i);\n    };\n}\nexports.dropLeftWhile = dropLeftWhile;\n/**\n * Find the first index for which a predicate holds\n *\n * @example\n * import { findIndex } from 'fp-ts/ReadonlyArray'\n * import { some, none } from 'fp-ts/Option'\n *\n * assert.deepStrictEqual(findIndex((n: number) => n === 2)([1, 2, 3]), some(1))\n * assert.deepStrictEqual(findIndex((n: number) => n === 2)([]), none)\n *\n * @since 2.5.0\n */\nvar findIndex = function (predicate) { return function (as) {\n    for (var i = 0; i < as.length; i++) {\n        if (predicate(as[i])) {\n            return _.some(i);\n        }\n    }\n    return _.none;\n}; };\nexports.findIndex = findIndex;\nfunction findFirst(predicate) {\n    return function (as) {\n        for (var i = 0; i < as.length; i++) {\n            if (predicate(as[i])) {\n                return _.some(as[i]);\n            }\n        }\n        return _.none;\n    };\n}\nexports.findFirst = findFirst;\n/**\n * Find the first element returned by an option based selector function\n *\n * @example\n * import { findFirstMap } from 'fp-ts/ReadonlyArray'\n * import { some, none } from 'fp-ts/Option'\n *\n * interface Person {\n *   readonly name: string\n *   readonly age?: number\n * }\n *\n * const persons: ReadonlyArray<Person> = [{ name: 'John' }, { name: 'Mary', age: 45 }, { name: 'Joey', age: 28 }]\n *\n * // returns the name of the first person that has an age\n * assert.deepStrictEqual(findFirstMap((p: Person) => (p.age === undefined ? none : some(p.name)))(persons), some('Mary'))\n *\n * @since 2.5.0\n */\nvar findFirstMap = function (f) { return function (as) {\n    for (var i = 0; i < as.length; i++) {\n        var out = f(as[i]);\n        if (_.isSome(out)) {\n            return out;\n        }\n    }\n    return _.none;\n}; };\nexports.findFirstMap = findFirstMap;\nfunction findLast(predicate) {\n    return function (as) {\n        for (var i = as.length - 1; i >= 0; i--) {\n            if (predicate(as[i])) {\n                return _.some(as[i]);\n            }\n        }\n        return _.none;\n    };\n}\nexports.findLast = findLast;\n/**\n * Find the last element returned by an option based selector function\n *\n * @example\n * import { findLastMap } from 'fp-ts/ReadonlyArray'\n * import { some, none } from 'fp-ts/Option'\n *\n * interface Person {\n *   readonly name: string\n *   readonly age?: number\n * }\n *\n * const persons: ReadonlyArray<Person> = [{ name: 'John' }, { name: 'Mary', age: 45 }, { name: 'Joey', age: 28 }]\n *\n * // returns the name of the last person that has an age\n * assert.deepStrictEqual(findLastMap((p: Person) => (p.age === undefined ? none : some(p.name)))(persons), some('Joey'))\n *\n * @since 2.5.0\n */\nvar findLastMap = function (f) { return function (as) {\n    for (var i = as.length - 1; i >= 0; i--) {\n        var out = f(as[i]);\n        if (_.isSome(out)) {\n            return out;\n        }\n    }\n    return _.none;\n}; };\nexports.findLastMap = findLastMap;\n/**\n * Returns the index of the last element of the list which matches the predicate\n *\n * @example\n * import { findLastIndex } from 'fp-ts/ReadonlyArray'\n * import { some, none } from 'fp-ts/Option'\n *\n * interface X {\n *   readonly a: number\n *   readonly b: number\n * }\n * const xs: ReadonlyArray<X> = [{ a: 1, b: 0 }, { a: 1, b: 1 }]\n * assert.deepStrictEqual(findLastIndex((x: { readonly a: number }) => x.a === 1)(xs), some(1))\n * assert.deepStrictEqual(findLastIndex((x: { readonly a: number }) => x.a === 4)(xs), none)\n *\n *\n * @since 2.5.0\n */\nvar findLastIndex = function (predicate) { return function (as) {\n    for (var i = as.length - 1; i >= 0; i--) {\n        if (predicate(as[i])) {\n            return _.some(i);\n        }\n    }\n    return _.none;\n}; };\nexports.findLastIndex = findLastIndex;\n/**\n * Insert an element at the specified index, creating a new array, or returning `None` if the index is out of bounds\n *\n * @example\n * import { insertAt } from 'fp-ts/ReadonlyArray'\n * import { some } from 'fp-ts/Option'\n *\n * assert.deepStrictEqual(insertAt(2, 5)([1, 2, 3, 4]), some([1, 2, 5, 3, 4]))\n *\n * @since 2.5.0\n */\nvar insertAt = function (i, a) { return function (as) {\n    return i < 0 || i > as.length ? _.none : _.some(RNEA.unsafeInsertAt(i, a, as));\n}; };\nexports.insertAt = insertAt;\n/**\n * Change the element at the specified index, creating a new array, or returning `None` if the index is out of bounds\n *\n * @example\n * import { updateAt } from 'fp-ts/ReadonlyArray'\n * import { some, none } from 'fp-ts/Option'\n *\n * assert.deepStrictEqual(updateAt(1, 1)([1, 2, 3]), some([1, 1, 3]))\n * assert.deepStrictEqual(updateAt(1, 1)([]), none)\n *\n * @since 2.5.0\n */\nvar updateAt = function (i, a) {\n    return (0, exports.modifyAt)(i, function () { return a; });\n};\nexports.updateAt = updateAt;\n/**\n * Delete the element at the specified index, creating a new array, or returning `None` if the index is out of bounds\n *\n * @example\n * import { deleteAt } from 'fp-ts/ReadonlyArray'\n * import { some, none } from 'fp-ts/Option'\n *\n * assert.deepStrictEqual(deleteAt(0)([1, 2, 3]), some([2, 3]))\n * assert.deepStrictEqual(deleteAt(1)([]), none)\n *\n * @since 2.5.0\n */\nvar deleteAt = function (i) { return function (as) {\n    return (0, exports.isOutOfBound)(i, as) ? _.none : _.some((0, exports.unsafeDeleteAt)(i, as));\n}; };\nexports.deleteAt = deleteAt;\n/**\n * Apply a function to the element at the specified index, creating a new array, or returning `None` if the index is out\n * of bounds\n *\n * @example\n * import { modifyAt } from 'fp-ts/ReadonlyArray'\n * import { some, none } from 'fp-ts/Option'\n *\n * const double = (x: number): number => x * 2\n * assert.deepStrictEqual(modifyAt(1, double)([1, 2, 3]), some([1, 4, 3]))\n * assert.deepStrictEqual(modifyAt(1, double)([]), none)\n *\n * @since 2.5.0\n */\nvar modifyAt = function (i, f) { return function (as) {\n    return (0, exports.isOutOfBound)(i, as) ? _.none : _.some((0, exports.unsafeUpdateAt)(i, f(as[i]), as));\n}; };\nexports.modifyAt = modifyAt;\n/**\n * Reverse an array, creating a new array\n *\n * @example\n * import { reverse } from 'fp-ts/ReadonlyArray'\n *\n * assert.deepStrictEqual(reverse([1, 2, 3]), [3, 2, 1])\n *\n * @category combinators\n * @since 2.5.0\n */\nvar reverse = function (as) { return (as.length <= 1 ? as : as.slice().reverse()); };\nexports.reverse = reverse;\n/**\n * Extracts from an array of `Either` all the `Right` elements. All the `Right` elements are extracted in order\n *\n * @example\n * import { rights } from 'fp-ts/ReadonlyArray'\n * import { right, left } from 'fp-ts/Either'\n *\n * assert.deepStrictEqual(rights([right(1), left('foo'), right(2)]), [1, 2])\n *\n * @category combinators\n * @since 2.5.0\n */\nvar rights = function (as) {\n    var r = [];\n    for (var i = 0; i < as.length; i++) {\n        var a = as[i];\n        if (a._tag === 'Right') {\n            r.push(a.right);\n        }\n    }\n    return r;\n};\nexports.rights = rights;\n/**\n * Extracts from an array of `Either` all the `Left` elements. All the `Left` elements are extracted in order\n *\n * @example\n * import { lefts } from 'fp-ts/ReadonlyArray'\n * import { left, right } from 'fp-ts/Either'\n *\n * assert.deepStrictEqual(lefts([right(1), left('foo'), right(2)]), ['foo'])\n *\n * @category combinators\n * @since 2.5.0\n */\nvar lefts = function (as) {\n    var r = [];\n    for (var i = 0; i < as.length; i++) {\n        var a = as[i];\n        if (a._tag === 'Left') {\n            r.push(a.left);\n        }\n    }\n    return r;\n};\nexports.lefts = lefts;\n/**\n * Sort the elements of an array in increasing order, creating a new array\n *\n * @example\n * import { sort } from 'fp-ts/ReadonlyArray'\n * import * as N from 'fp-ts/number'\n *\n * assert.deepStrictEqual(sort(N.Ord)([3, 2, 1]), [1, 2, 3])\n *\n * @category combinators\n * @since 2.5.0\n */\nvar sort = function (O) { return function (as) {\n    return as.length <= 1 ? as : as.slice().sort(O.compare);\n}; };\nexports.sort = sort;\n// TODO: curry and make data-last in v3\n/**\n * Apply a function to pairs of elements at the same index in two arrays, collecting the results in a new array. If one\n * input array is short, excess elements of the longer array are discarded.\n *\n * @example\n * import { zipWith } from 'fp-ts/ReadonlyArray'\n *\n * assert.deepStrictEqual(zipWith([1, 2, 3], ['a', 'b', 'c', 'd'], (n, s) => s + n), ['a1', 'b2', 'c3'])\n *\n * @category combinators\n * @since 2.5.0\n */\nvar zipWith = function (fa, fb, f) {\n    var fc = [];\n    var len = Math.min(fa.length, fb.length);\n    for (var i = 0; i < len; i++) {\n        fc[i] = f(fa[i], fb[i]);\n    }\n    return fc;\n};\nexports.zipWith = zipWith;\nfunction zip(as, bs) {\n    if (bs === undefined) {\n        return function (bs) { return zip(bs, as); };\n    }\n    return (0, exports.zipWith)(as, bs, function (a, b) { return [a, b]; });\n}\nexports.zip = zip;\n/**\n * The function is reverse of `zip`. Takes an array of pairs and return two corresponding arrays\n *\n * @example\n * import { unzip } from 'fp-ts/ReadonlyArray'\n *\n * assert.deepStrictEqual(unzip([[1, 'a'], [2, 'b'], [3, 'c']]), [[1, 2, 3], ['a', 'b', 'c']])\n *\n * @category combinators\n * @since 2.5.0\n */\nvar unzip = function (as) {\n    var fa = [];\n    var fb = [];\n    for (var i = 0; i < as.length; i++) {\n        fa[i] = as[i][0];\n        fb[i] = as[i][1];\n    }\n    return [fa, fb];\n};\nexports.unzip = unzip;\n/**\n * Prepend an element to every member of an array\n *\n * @example\n * import { prependAll } from 'fp-ts/ReadonlyArray'\n *\n * assert.deepStrictEqual(prependAll(9)([1, 2, 3, 4]), [9, 1, 9, 2, 9, 3, 9, 4])\n *\n * @category combinators\n * @since 2.10.0\n */\nvar prependAll = function (middle) {\n    var f = RNEA.prependAll(middle);\n    return function (as) { return ((0, exports.isNonEmpty)(as) ? f(as) : as); };\n};\nexports.prependAll = prependAll;\n/**\n * Places an element in between members of an array\n *\n * @example\n * import { intersperse } from 'fp-ts/ReadonlyArray'\n *\n * assert.deepStrictEqual(intersperse(9)([1, 2, 3, 4]), [1, 9, 2, 9, 3, 9, 4])\n *\n * @category combinators\n * @since 2.9.0\n */\nvar intersperse = function (middle) {\n    var f = RNEA.intersperse(middle);\n    return function (as) { return ((0, exports.isNonEmpty)(as) ? f(as) : as); };\n};\nexports.intersperse = intersperse;\n/**\n * Rotate a `ReadonlyArray` by `n` steps.\n *\n * @example\n * import { rotate } from 'fp-ts/ReadonlyArray'\n *\n * assert.deepStrictEqual(rotate(2)([1, 2, 3, 4, 5]), [4, 5, 1, 2, 3])\n *\n * @category combinators\n * @since 2.5.0\n */\nvar rotate = function (n) {\n    var f = RNEA.rotate(n);\n    return function (as) { return ((0, exports.isNonEmpty)(as) ? f(as) : as); };\n};\nexports.rotate = rotate;\nfunction elem(E) {\n    return function (a, as) {\n        if (as === undefined) {\n            var elemE_1 = elem(E);\n            return function (as) { return elemE_1(a, as); };\n        }\n        var predicate = function (element) { return E.equals(element, a); };\n        var i = 0;\n        for (; i < as.length; i++) {\n            if (predicate(as[i])) {\n                return true;\n            }\n        }\n        return false;\n    };\n}\nexports.elem = elem;\n/**\n * Remove duplicates from an array, keeping the first occurrence of an element.\n *\n * @example\n * import { uniq } from 'fp-ts/ReadonlyArray'\n * import * as N from 'fp-ts/number'\n *\n * assert.deepStrictEqual(uniq(N.Eq)([1, 2, 1]), [1, 2])\n *\n * @category combinators\n * @since 2.5.0\n */\nvar uniq = function (E) {\n    var f = RNEA.uniq(E);\n    return function (as) { return ((0, exports.isNonEmpty)(as) ? f(as) : as); };\n};\nexports.uniq = uniq;\n/**\n * Sort the elements of an array in increasing order, where elements are compared using first `ords[0]`, then `ords[1]`,\n * etc...\n *\n * @example\n * import { sortBy } from 'fp-ts/ReadonlyArray'\n * import { contramap } from 'fp-ts/Ord'\n * import * as S from 'fp-ts/string'\n * import * as N from 'fp-ts/number'\n * import { pipe } from 'fp-ts/function'\n *\n * interface Person {\n *   readonly name: string\n *   readonly age: number\n * }\n * const byName = pipe(S.Ord, contramap((p: Person) => p.name))\n * const byAge = pipe(N.Ord, contramap((p: Person) => p.age))\n *\n * const sortByNameByAge = sortBy([byName, byAge])\n *\n * const persons = [{ name: 'a', age: 1 }, { name: 'b', age: 3 }, { name: 'c', age: 2 }, { name: 'b', age: 2 }]\n * assert.deepStrictEqual(sortByNameByAge(persons), [\n *   { name: 'a', age: 1 },\n *   { name: 'b', age: 2 },\n *   { name: 'b', age: 3 },\n *   { name: 'c', age: 2 }\n * ])\n *\n * @category combinators\n * @since 2.5.0\n */\nvar sortBy = function (ords) {\n    var f = RNEA.sortBy(ords);\n    return function (as) { return ((0, exports.isNonEmpty)(as) ? f(as) : as); };\n};\nexports.sortBy = sortBy;\n/**\n * A useful recursion pattern for processing a `ReadonlyArray` to produce a new `ReadonlyArray`, often used for \"chopping\" up the input\n * `ReadonlyArray`. Typically `chop` is called with some function that will consume an initial prefix of the `ReadonlyArray` and produce a\n * value and the tail of the `ReadonlyArray`.\n *\n * @example\n * import { Eq } from 'fp-ts/Eq'\n * import * as RA from 'fp-ts/ReadonlyArray'\n * import * as N from 'fp-ts/number'\n * import { pipe } from 'fp-ts/function'\n *\n * const group = <A>(S: Eq<A>): ((as: ReadonlyArray<A>) => ReadonlyArray<ReadonlyArray<A>>) => {\n *   return RA.chop(as => {\n *     const { init, rest } = pipe(as, RA.spanLeft((a: A) => S.equals(a, as[0])))\n *     return [init, rest]\n *   })\n * }\n * assert.deepStrictEqual(group(N.Eq)([1, 1, 2, 3, 3, 4]), [[1, 1], [2], [3, 3], [4]])\n *\n * @category combinators\n * @since 2.5.0\n */\nvar chop = function (f) {\n    var g = RNEA.chop(f);\n    return function (as) { return ((0, exports.isNonEmpty)(as) ? g(as) : exports.empty); };\n};\nexports.chop = chop;\n/**\n * Splits a `ReadonlyArray` into two pieces, the first piece has max `n` elements.\n *\n * @example\n * import { splitAt } from 'fp-ts/ReadonlyArray'\n *\n * assert.deepStrictEqual(splitAt(2)([1, 2, 3, 4, 5]), [[1, 2], [3, 4, 5]])\n *\n * @category combinators\n * @since 2.5.0\n */\nvar splitAt = function (n) { return function (as) {\n    return n >= 1 && (0, exports.isNonEmpty)(as) ? RNEA.splitAt(n)(as) : (0, exports.isEmpty)(as) ? [as, exports.empty] : [exports.empty, as];\n}; };\nexports.splitAt = splitAt;\n/**\n * Splits a `ReadonlyArray` into length-`n` pieces. The last piece will be shorter if `n` does not evenly divide the length of\n * the `ReadonlyArray`. Note that `chunksOf(n)([])` is `[]`, not `[[]]`. This is intentional, and is consistent with a recursive\n * definition of `chunksOf`; it satisfies the property that:\n *\n * ```ts\n * chunksOf(n)(xs).concat(chunksOf(n)(ys)) == chunksOf(n)(xs.concat(ys)))\n * ```\n *\n * whenever `n` evenly divides the length of `as`.\n *\n * @example\n * import { chunksOf } from 'fp-ts/ReadonlyArray'\n *\n * assert.deepStrictEqual(chunksOf(2)([1, 2, 3, 4, 5]), [[1, 2], [3, 4], [5]])\n *\n * @category combinators\n * @since 2.5.0\n */\nvar chunksOf = function (n) {\n    var f = RNEA.chunksOf(n);\n    return function (as) { return ((0, exports.isNonEmpty)(as) ? f(as) : exports.empty); };\n};\nexports.chunksOf = chunksOf;\n/**\n * @category combinators\n * @since 2.11.0\n */\nvar fromOptionK = function (f) { return function () {\n    var a = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        a[_i] = arguments[_i];\n    }\n    return (0, exports.fromOption)(f.apply(void 0, a));\n}; };\nexports.fromOptionK = fromOptionK;\nfunction comprehension(input, f, g) {\n    if (g === void 0) { g = function () { return true; }; }\n    var go = function (scope, input) {\n        return (0, exports.isNonEmpty)(input)\n            ? (0, function_1.pipe)(RNEA.head(input), (0, exports.chain)(function (x) { return go((0, function_1.pipe)(scope, (0, exports.append)(x)), RNEA.tail(input)); }))\n            : g.apply(void 0, scope) ? [f.apply(void 0, scope)]\n                : exports.empty;\n    };\n    return go(exports.empty, input);\n}\nexports.comprehension = comprehension;\n/**\n * @category combinators\n * @since 2.11.0\n */\nvar concatW = function (second) { return function (first) {\n    return (0, exports.isEmpty)(first) ? second : (0, exports.isEmpty)(second) ? first : first.concat(second);\n}; };\nexports.concatW = concatW;\n/**\n * @category combinators\n * @since 2.11.0\n */\nexports.concat = exports.concatW;\nfunction union(E) {\n    var unionE = RNEA.union(E);\n    return function (first, second) {\n        if (second === undefined) {\n            var unionE_1 = union(E);\n            return function (second) { return unionE_1(second, first); };\n        }\n        return (0, exports.isNonEmpty)(first) && (0, exports.isNonEmpty)(second) ? unionE(second)(first) : (0, exports.isNonEmpty)(first) ? first : second;\n    };\n}\nexports.union = union;\nfunction intersection(E) {\n    var elemE = elem(E);\n    return function (xs, ys) {\n        if (ys === undefined) {\n            var intersectionE_1 = intersection(E);\n            return function (ys) { return intersectionE_1(ys, xs); };\n        }\n        return xs.filter(function (a) { return elemE(a, ys); });\n    };\n}\nexports.intersection = intersection;\nfunction difference(E) {\n    var elemE = elem(E);\n    return function (xs, ys) {\n        if (ys === undefined) {\n            var differenceE_1 = difference(E);\n            return function (ys) { return differenceE_1(ys, xs); };\n        }\n        return xs.filter(function (a) { return !elemE(a, ys); });\n    };\n}\nexports.difference = difference;\n// -------------------------------------------------------------------------------------\n// non-pipeables\n// -------------------------------------------------------------------------------------\nvar _map = function (fa, f) { return (0, function_1.pipe)(fa, (0, exports.map)(f)); };\nvar _mapWithIndex = function (fa, f) { return (0, function_1.pipe)(fa, (0, exports.mapWithIndex)(f)); };\nvar _ap = function (fab, fa) { return (0, function_1.pipe)(fab, (0, exports.ap)(fa)); };\nvar _chain = function (ma, f) { return (0, function_1.pipe)(ma, (0, exports.chain)(f)); };\nvar _filter = function (fa, predicate) {\n    return (0, function_1.pipe)(fa, (0, exports.filter)(predicate));\n};\nvar _filterMap = function (fa, f) { return (0, function_1.pipe)(fa, (0, exports.filterMap)(f)); };\nvar _partition = function (fa, predicate) {\n    return (0, function_1.pipe)(fa, (0, exports.partition)(predicate));\n};\nvar _partitionMap = function (fa, f) { return (0, function_1.pipe)(fa, (0, exports.partitionMap)(f)); };\nvar _partitionWithIndex = function (fa, predicateWithIndex) { return (0, function_1.pipe)(fa, (0, exports.partitionWithIndex)(predicateWithIndex)); };\nvar _partitionMapWithIndex = function (fa, f) { return (0, function_1.pipe)(fa, (0, exports.partitionMapWithIndex)(f)); };\nvar _alt = function (fa, that) { return (0, function_1.pipe)(fa, (0, exports.alt)(that)); };\nvar _reduce = function (fa, b, f) { return (0, function_1.pipe)(fa, (0, exports.reduce)(b, f)); };\nvar _foldMap = function (M) {\n    var foldMapM = (0, exports.foldMap)(M);\n    return function (fa, f) { return (0, function_1.pipe)(fa, foldMapM(f)); };\n};\nvar _reduceRight = function (fa, b, f) { return (0, function_1.pipe)(fa, (0, exports.reduceRight)(b, f)); };\nvar _reduceWithIndex = function (fa, b, f) {\n    return (0, function_1.pipe)(fa, (0, exports.reduceWithIndex)(b, f));\n};\nvar _foldMapWithIndex = function (M) {\n    var foldMapWithIndexM = (0, exports.foldMapWithIndex)(M);\n    return function (fa, f) { return (0, function_1.pipe)(fa, foldMapWithIndexM(f)); };\n};\nvar _reduceRightWithIndex = function (fa, b, f) {\n    return (0, function_1.pipe)(fa, (0, exports.reduceRightWithIndex)(b, f));\n};\nvar _filterMapWithIndex = function (fa, f) { return (0, function_1.pipe)(fa, (0, exports.filterMapWithIndex)(f)); };\nvar _filterWithIndex = function (fa, predicateWithIndex) { return (0, function_1.pipe)(fa, (0, exports.filterWithIndex)(predicateWithIndex)); };\nvar _extend = function (fa, f) { return (0, function_1.pipe)(fa, (0, exports.extend)(f)); };\nvar _traverse = function (F) {\n    var traverseF = (0, exports.traverse)(F);\n    return function (ta, f) { return (0, function_1.pipe)(ta, traverseF(f)); };\n};\n/* istanbul ignore next */\nvar _traverseWithIndex = function (F) {\n    var traverseWithIndexF = (0, exports.traverseWithIndex)(F);\n    return function (ta, f) { return (0, function_1.pipe)(ta, traverseWithIndexF(f)); };\n};\n/** @internal */\nvar _chainRecDepthFirst = function (a, f) { return (0, function_1.pipe)(a, (0, exports.chainRecDepthFirst)(f)); };\nexports._chainRecDepthFirst = _chainRecDepthFirst;\n/** @internal */\nvar _chainRecBreadthFirst = function (a, f) { return (0, function_1.pipe)(a, (0, exports.chainRecBreadthFirst)(f)); };\nexports._chainRecBreadthFirst = _chainRecBreadthFirst;\n// -------------------------------------------------------------------------------------\n// type class members\n// -------------------------------------------------------------------------------------\n/**\n * @category Pointed\n * @since 2.5.0\n */\nexports.of = RNEA.of;\n/**\n * @category Zero\n * @since 2.7.0\n */\nvar zero = function () { return exports.empty; };\nexports.zero = zero;\n/**\n * Less strict version of [`alt`](#alt).\n *\n * @category Alt\n * @since 2.9.0\n */\nvar altW = function (that) { return function (fa) {\n    return fa.concat(that());\n}; };\nexports.altW = altW;\n/**\n * Identifies an associative operation on a type constructor. It is similar to `Semigroup`, except that it applies to\n * types of kind `* -> *`.\n *\n * @category Alt\n * @since 2.5.0\n */\nexports.alt = exports.altW;\n/**\n * Apply a function to an argument under a type constructor.\n *\n * @category Apply\n * @since 2.5.0\n */\nvar ap = function (fa) {\n    return (0, exports.chain)(function (f) { return (0, function_1.pipe)(fa, (0, exports.map)(f)); });\n};\nexports.ap = ap;\n/**\n * Composes computations in sequence, using the return value of one computation to determine the next computation.\n *\n * @category Monad\n * @since 2.5.0\n */\nvar chain = function (f) { return function (ma) {\n    return (0, function_1.pipe)(ma, (0, exports.chainWithIndex)(function (_, a) { return f(a); }));\n}; };\nexports.chain = chain;\n/**\n * Derivable from `Chain`.\n *\n * @category combinators\n * @since 2.5.0\n */\nexports.flatten = (0, exports.chain)(function_1.identity);\n/**\n * `map` can be used to turn functions `(a: A) => B` into functions `(fa: F<A>) => F<B>` whose argument and return types\n * use the type constructor `F` to represent some computational context.\n *\n * @category Functor\n * @since 2.5.0\n */\nvar map = function (f) { return function (fa) {\n    return fa.map(function (a) { return f(a); });\n}; };\nexports.map = map;\n/**\n * @category FunctorWithIndex\n * @since 2.5.0\n */\nvar mapWithIndex = function (f) { return function (fa) { return fa.map(function (a, i) { return f(i, a); }); }; };\nexports.mapWithIndex = mapWithIndex;\n/**\n * @category Compactable\n * @since 2.5.0\n */\nvar separate = function (fa) {\n    var left = [];\n    var right = [];\n    for (var _i = 0, fa_1 = fa; _i < fa_1.length; _i++) {\n        var e = fa_1[_i];\n        if (e._tag === 'Left') {\n            left.push(e.left);\n        }\n        else {\n            right.push(e.right);\n        }\n    }\n    return (0, Separated_1.separated)(left, right);\n};\nexports.separate = separate;\n/**\n * @category Filterable\n * @since 2.5.0\n */\nvar filter = function (predicate) { return function (as) { return as.filter(predicate); }; };\nexports.filter = filter;\n/**\n * @category FilterableWithIndex\n * @since 2.5.0\n */\nvar filterMapWithIndex = function (f) { return function (fa) {\n    var out = [];\n    for (var i = 0; i < fa.length; i++) {\n        var optionB = f(i, fa[i]);\n        if (_.isSome(optionB)) {\n            out.push(optionB.value);\n        }\n    }\n    return out;\n}; };\nexports.filterMapWithIndex = filterMapWithIndex;\n/**\n * @category Filterable\n * @since 2.5.0\n */\nvar filterMap = function (f) {\n    return (0, exports.filterMapWithIndex)(function (_, a) { return f(a); });\n};\nexports.filterMap = filterMap;\n/**\n * @category Compactable\n * @since 2.5.0\n */\nexports.compact = (0, exports.filterMap)(function_1.identity);\n/**\n * @category Filterable\n * @since 2.5.0\n */\nvar partition = function (predicate) {\n    return (0, exports.partitionWithIndex)(function (_, a) { return predicate(a); });\n};\nexports.partition = partition;\n/**\n * @category FilterableWithIndex\n * @since 2.5.0\n */\nvar partitionWithIndex = function (predicateWithIndex) { return function (as) {\n    var left = [];\n    var right = [];\n    for (var i = 0; i < as.length; i++) {\n        var a = as[i];\n        if (predicateWithIndex(i, a)) {\n            right.push(a);\n        }\n        else {\n            left.push(a);\n        }\n    }\n    return (0, Separated_1.separated)(left, right);\n}; };\nexports.partitionWithIndex = partitionWithIndex;\n/**\n * @category Filterable\n * @since 2.5.0\n */\nvar partitionMap = function (f) {\n    return (0, exports.partitionMapWithIndex)(function (_, a) { return f(a); });\n};\nexports.partitionMap = partitionMap;\n/**\n * @category FilterableWithIndex\n * @since 2.5.0\n */\nvar partitionMapWithIndex = function (f) { return function (fa) {\n    var left = [];\n    var right = [];\n    for (var i = 0; i < fa.length; i++) {\n        var e = f(i, fa[i]);\n        if (e._tag === 'Left') {\n            left.push(e.left);\n        }\n        else {\n            right.push(e.right);\n        }\n    }\n    return (0, Separated_1.separated)(left, right);\n}; };\nexports.partitionMapWithIndex = partitionMapWithIndex;\n/**\n * @category FilterableWithIndex\n * @since 2.5.0\n */\nvar filterWithIndex = function (predicateWithIndex) { return function (as) {\n    return as.filter(function (a, i) { return predicateWithIndex(i, a); });\n}; };\nexports.filterWithIndex = filterWithIndex;\n/**\n * @category Extend\n * @since 2.5.0\n */\nvar extend = function (f) { return function (wa) { return wa.map(function (_, i) { return f(wa.slice(i)); }); }; };\nexports.extend = extend;\n/**\n * Derivable from `Extend`.\n *\n * @category combinators\n * @since 2.5.0\n */\nexports.duplicate = (0, exports.extend)(function_1.identity);\n/**\n * @category FoldableWithIndex\n * @since 2.5.0\n */\nvar foldMapWithIndex = function (M) { return function (f) { return function (fa) {\n    return fa.reduce(function (b, a, i) { return M.concat(b, f(i, a)); }, M.empty);\n}; }; };\nexports.foldMapWithIndex = foldMapWithIndex;\n/**\n * @category Foldable\n * @since 2.5.0\n */\nvar reduce = function (b, f) {\n    return (0, exports.reduceWithIndex)(b, function (_, b, a) { return f(b, a); });\n};\nexports.reduce = reduce;\n/**\n * @category Foldable\n * @since 2.5.0\n */\nvar foldMap = function (M) {\n    var foldMapWithIndexM = (0, exports.foldMapWithIndex)(M);\n    return function (f) { return foldMapWithIndexM(function (_, a) { return f(a); }); };\n};\nexports.foldMap = foldMap;\n/**\n * @category FoldableWithIndex\n * @since 2.5.0\n */\nvar reduceWithIndex = function (b, f) { return function (fa) {\n    var len = fa.length;\n    var out = b;\n    for (var i = 0; i < len; i++) {\n        out = f(i, out, fa[i]);\n    }\n    return out;\n}; };\nexports.reduceWithIndex = reduceWithIndex;\n/**\n * @category Foldable\n * @since 2.5.0\n */\nvar reduceRight = function (b, f) {\n    return (0, exports.reduceRightWithIndex)(b, function (_, a, b) { return f(a, b); });\n};\nexports.reduceRight = reduceRight;\n/**\n * @category FoldableWithIndex\n * @since 2.5.0\n */\nvar reduceRightWithIndex = function (b, f) { return function (fa) { return fa.reduceRight(function (b, a, i) { return f(i, a, b); }, b); }; };\nexports.reduceRightWithIndex = reduceRightWithIndex;\n/**\n * @category Traversable\n * @since 2.6.3\n */\nvar traverse = function (F) {\n    var traverseWithIndexF = (0, exports.traverseWithIndex)(F);\n    return function (f) { return traverseWithIndexF(function (_, a) { return f(a); }); };\n};\nexports.traverse = traverse;\n/**\n * @category Traversable\n * @since 2.6.3\n */\nvar sequence = function (F) { return function (ta) {\n    return _reduce(ta, F.of((0, exports.zero)()), function (fas, fa) {\n        return F.ap(F.map(fas, function (as) { return function (a) { return (0, function_1.pipe)(as, (0, exports.append)(a)); }; }), fa);\n    });\n}; };\nexports.sequence = sequence;\n/**\n * @category TraversableWithIndex\n * @since 2.6.3\n */\nvar traverseWithIndex = function (F) { return function (f) {\n    return (0, exports.reduceWithIndex)(F.of((0, exports.zero)()), function (i, fbs, a) {\n        return F.ap(F.map(fbs, function (bs) { return function (b) { return (0, function_1.pipe)(bs, (0, exports.append)(b)); }; }), f(i, a));\n    });\n}; };\nexports.traverseWithIndex = traverseWithIndex;\n/**\n * @category Witherable\n * @since 2.6.5\n */\nvar wither = function (F) {\n    var _witherF = _wither(F);\n    return function (f) { return function (fa) { return _witherF(fa, f); }; };\n};\nexports.wither = wither;\n/**\n * @category Witherable\n * @since 2.6.5\n */\nvar wilt = function (F) {\n    var _wiltF = _wilt(F);\n    return function (f) { return function (fa) { return _wiltF(fa, f); }; };\n};\nexports.wilt = wilt;\n/**\n * @category Unfoldable\n * @since 2.6.6\n */\nvar unfold = function (b, f) {\n    var out = [];\n    var bb = b;\n    // eslint-disable-next-line no-constant-condition\n    while (true) {\n        var mt = f(bb);\n        if (_.isSome(mt)) {\n            var _a = mt.value, a = _a[0], b_1 = _a[1];\n            out.push(a);\n            bb = b_1;\n        }\n        else {\n            break;\n        }\n    }\n    return out;\n};\nexports.unfold = unfold;\n// -------------------------------------------------------------------------------------\n// instances\n// -------------------------------------------------------------------------------------\n/**\n * @category instances\n * @since 2.5.0\n */\nexports.URI = 'ReadonlyArray';\n/**\n * @category instances\n * @since 2.5.0\n */\nvar getShow = function (S) { return ({\n    show: function (as) { return \"[\".concat(as.map(S.show).join(', '), \"]\"); }\n}); };\nexports.getShow = getShow;\n/**\n * @category instances\n * @since 2.5.0\n */\nvar getSemigroup = function () { return ({\n    concat: function (first, second) { return ((0, exports.isEmpty)(first) ? second : (0, exports.isEmpty)(second) ? first : first.concat(second)); }\n}); };\nexports.getSemigroup = getSemigroup;\n/**\n * Returns a `Monoid` for `ReadonlyArray<A>`.\n *\n * @example\n * import { getMonoid } from 'fp-ts/ReadonlyArray'\n *\n * const M = getMonoid<number>()\n * assert.deepStrictEqual(M.concat([1, 2], [3, 4]), [1, 2, 3, 4])\n *\n * @category instances\n * @since 2.5.0\n */\nvar getMonoid = function () { return ({\n    concat: (0, exports.getSemigroup)().concat,\n    empty: exports.empty\n}); };\nexports.getMonoid = getMonoid;\n/**\n * Derives an `Eq` over the `ReadonlyArray` of a given element type from the `Eq` of that type. The derived `Eq` defines two\n * arrays as equal if all elements of both arrays are compared equal pairwise with the given `E`. In case of arrays of\n * different lengths, the result is non equality.\n *\n * @example\n * import * as S from 'fp-ts/string'\n * import { getEq } from 'fp-ts/ReadonlyArray'\n *\n * const E = getEq(S.Eq)\n * assert.strictEqual(E.equals(['a', 'b'], ['a', 'b']), true)\n * assert.strictEqual(E.equals(['a'], []), false)\n *\n * @category instances\n * @since 2.5.0\n */\nvar getEq = function (E) {\n    return (0, Eq_1.fromEquals)(function (xs, ys) { return xs.length === ys.length && xs.every(function (x, i) { return E.equals(x, ys[i]); }); });\n};\nexports.getEq = getEq;\n/**\n * Derives an `Ord` over the `ReadonlyArray` of a given element type from the `Ord` of that type. The ordering between two such\n * arrays is equal to: the first non equal comparison of each arrays elements taken pairwise in increasing order, in\n * case of equality over all the pairwise elements; the longest array is considered the greatest, if both arrays have\n * the same length, the result is equality.\n *\n * @example\n * import { getOrd } from 'fp-ts/ReadonlyArray'\n * import * as S from 'fp-ts/string'\n *\n * const O = getOrd(S.Ord)\n * assert.strictEqual(O.compare(['b'], ['a']), 1)\n * assert.strictEqual(O.compare(['a'], ['a']), 0)\n * assert.strictEqual(O.compare(['a'], ['b']), -1)\n *\n *\n * @category instances\n * @since 2.5.0\n */\nvar getOrd = function (O) {\n    return (0, Ord_1.fromCompare)(function (a, b) {\n        var aLen = a.length;\n        var bLen = b.length;\n        var len = Math.min(aLen, bLen);\n        for (var i = 0; i < len; i++) {\n            var ordering = O.compare(a[i], b[i]);\n            if (ordering !== 0) {\n                return ordering;\n            }\n        }\n        return N.Ord.compare(aLen, bLen);\n    });\n};\nexports.getOrd = getOrd;\n/**\n * @category instances\n * @since 2.11.0\n */\nvar getUnionSemigroup = function (E) {\n    var unionE = union(E);\n    return {\n        concat: function (first, second) { return unionE(second)(first); }\n    };\n};\nexports.getUnionSemigroup = getUnionSemigroup;\n/**\n * @category instances\n * @since 2.11.0\n */\nvar getUnionMonoid = function (E) { return ({\n    concat: (0, exports.getUnionSemigroup)(E).concat,\n    empty: exports.empty\n}); };\nexports.getUnionMonoid = getUnionMonoid;\n/**\n * @category instances\n * @since 2.11.0\n */\nvar getIntersectionSemigroup = function (E) {\n    var intersectionE = intersection(E);\n    return {\n        concat: function (first, second) { return intersectionE(second)(first); }\n    };\n};\nexports.getIntersectionSemigroup = getIntersectionSemigroup;\n/**\n * @category instances\n * @since 2.11.0\n */\nvar getDifferenceMagma = function (E) {\n    var differenceE = difference(E);\n    return {\n        concat: function (first, second) { return differenceE(second)(first); }\n    };\n};\nexports.getDifferenceMagma = getDifferenceMagma;\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Functor = {\n    URI: exports.URI,\n    map: _map\n};\n/**\n * Derivable from `Functor`.\n *\n * @category combinators\n * @since 2.10.0\n */\nexports.flap = (0, Functor_1.flap)(exports.Functor);\n/**\n * @category instances\n * @since 2.10.0\n */\nexports.Pointed = {\n    URI: exports.URI,\n    of: exports.of\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.FunctorWithIndex = {\n    URI: exports.URI,\n    map: _map,\n    mapWithIndex: _mapWithIndex\n};\n/**\n * @category instances\n * @since 2.10.0\n */\nexports.Apply = {\n    URI: exports.URI,\n    map: _map,\n    ap: _ap\n};\n/**\n * Combine two effectful actions, keeping only the result of the first.\n *\n * Derivable from `Apply`.\n *\n * @category combinators\n * @since 2.5.0\n */\nexports.apFirst = (0, Apply_1.apFirst)(exports.Apply);\n/**\n * Combine two effectful actions, keeping only the result of the second.\n *\n * Derivable from `Apply`.\n *\n * @category combinators\n * @since 2.5.0\n */\nexports.apSecond = (0, Apply_1.apSecond)(exports.Apply);\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Applicative = {\n    URI: exports.URI,\n    map: _map,\n    ap: _ap,\n    of: exports.of\n};\n/**\n * @category instances\n * @since 2.10.0\n */\nexports.Chain = {\n    URI: exports.URI,\n    map: _map,\n    ap: _ap,\n    chain: _chain\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Monad = {\n    URI: exports.URI,\n    map: _map,\n    ap: _ap,\n    of: exports.of,\n    chain: _chain\n};\n/**\n * Composes computations in sequence, using the return value of one computation to determine the next computation and\n * keeping only the result of the first.\n *\n * Derivable from `Chain`.\n *\n * @category combinators\n * @since 2.5.0\n */\nexports.chainFirst = (0, Chain_1.chainFirst)(exports.Chain);\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Unfoldable = {\n    URI: exports.URI,\n    unfold: exports.unfold\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Alt = {\n    URI: exports.URI,\n    map: _map,\n    alt: _alt\n};\n/**\n * @category instances\n * @since 2.11.0\n */\nexports.Zero = {\n    URI: exports.URI,\n    zero: exports.zero\n};\n/**\n * @category constructors\n * @since 2.11.0\n */\nexports.guard = (0, Zero_1.guard)(exports.Zero, exports.Pointed);\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Alternative = {\n    URI: exports.URI,\n    map: _map,\n    ap: _ap,\n    of: exports.of,\n    alt: _alt,\n    zero: exports.zero\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Extend = {\n    URI: exports.URI,\n    map: _map,\n    extend: _extend\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Compactable = {\n    URI: exports.URI,\n    compact: exports.compact,\n    separate: exports.separate\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Filterable = {\n    URI: exports.URI,\n    map: _map,\n    compact: exports.compact,\n    separate: exports.separate,\n    filter: _filter,\n    filterMap: _filterMap,\n    partition: _partition,\n    partitionMap: _partitionMap\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.FilterableWithIndex = {\n    URI: exports.URI,\n    map: _map,\n    mapWithIndex: _mapWithIndex,\n    compact: exports.compact,\n    separate: exports.separate,\n    filter: _filter,\n    filterMap: _filterMap,\n    partition: _partition,\n    partitionMap: _partitionMap,\n    partitionMapWithIndex: _partitionMapWithIndex,\n    partitionWithIndex: _partitionWithIndex,\n    filterMapWithIndex: _filterMapWithIndex,\n    filterWithIndex: _filterWithIndex\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Foldable = {\n    URI: exports.URI,\n    reduce: _reduce,\n    foldMap: _foldMap,\n    reduceRight: _reduceRight\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.FoldableWithIndex = {\n    URI: exports.URI,\n    reduce: _reduce,\n    foldMap: _foldMap,\n    reduceRight: _reduceRight,\n    reduceWithIndex: _reduceWithIndex,\n    foldMapWithIndex: _foldMapWithIndex,\n    reduceRightWithIndex: _reduceRightWithIndex\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Traversable = {\n    URI: exports.URI,\n    map: _map,\n    reduce: _reduce,\n    foldMap: _foldMap,\n    reduceRight: _reduceRight,\n    traverse: _traverse,\n    sequence: exports.sequence\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.TraversableWithIndex = {\n    URI: exports.URI,\n    map: _map,\n    mapWithIndex: _mapWithIndex,\n    reduce: _reduce,\n    foldMap: _foldMap,\n    reduceRight: _reduceRight,\n    reduceWithIndex: _reduceWithIndex,\n    foldMapWithIndex: _foldMapWithIndex,\n    reduceRightWithIndex: _reduceRightWithIndex,\n    traverse: _traverse,\n    sequence: exports.sequence,\n    traverseWithIndex: _traverseWithIndex\n};\n/**\n * @category ChainRec\n * @since 2.11.0\n */\nvar chainRecDepthFirst = function (f) { return function (a) {\n    var todo = __spreadArray([], f(a), true);\n    var out = [];\n    while (todo.length > 0) {\n        var e = todo.shift();\n        if (_.isLeft(e)) {\n            todo.unshift.apply(todo, f(e.left));\n        }\n        else {\n            out.push(e.right);\n        }\n    }\n    return out;\n}; };\nexports.chainRecDepthFirst = chainRecDepthFirst;\n/**\n * @category instances\n * @since 2.11.0\n */\nexports.ChainRecDepthFirst = {\n    URI: exports.URI,\n    map: _map,\n    ap: _ap,\n    chain: _chain,\n    chainRec: exports._chainRecDepthFirst\n};\n/**\n * @category ChainRec\n * @since 2.11.0\n */\nvar chainRecBreadthFirst = function (f) { return function (a) {\n    var initial = f(a);\n    var todo = [];\n    var out = [];\n    function go(e) {\n        if (_.isLeft(e)) {\n            f(e.left).forEach(function (v) { return todo.push(v); });\n        }\n        else {\n            out.push(e.right);\n        }\n    }\n    for (var _i = 0, initial_1 = initial; _i < initial_1.length; _i++) {\n        var e = initial_1[_i];\n        go(e);\n    }\n    while (todo.length > 0) {\n        go(todo.shift());\n    }\n    return out;\n}; };\nexports.chainRecBreadthFirst = chainRecBreadthFirst;\n/**\n * @category instances\n * @since 2.11.0\n */\nexports.ChainRecBreadthFirst = {\n    URI: exports.URI,\n    map: _map,\n    ap: _ap,\n    chain: _chain,\n    chainRec: exports._chainRecBreadthFirst\n};\nvar _wither = /*#__PURE__*/ (0, Witherable_1.witherDefault)(exports.Traversable, exports.Compactable);\nvar _wilt = /*#__PURE__*/ (0, Witherable_1.wiltDefault)(exports.Traversable, exports.Compactable);\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Witherable = {\n    URI: exports.URI,\n    map: _map,\n    compact: exports.compact,\n    separate: exports.separate,\n    filter: _filter,\n    filterMap: _filterMap,\n    partition: _partition,\n    partitionMap: _partitionMap,\n    reduce: _reduce,\n    foldMap: _foldMap,\n    reduceRight: _reduceRight,\n    traverse: _traverse,\n    sequence: exports.sequence,\n    wither: _wither,\n    wilt: _wilt\n};\n/**\n * Filter values inside a context.\n *\n * @example\n * import { pipe } from 'fp-ts/function'\n * import * as RA from 'fp-ts/ReadonlyArray'\n * import * as T from 'fp-ts/Task'\n *\n * const filterE = RA.filterE(T.ApplicativePar)\n * async function test() {\n *   assert.deepStrictEqual(\n *     await pipe(\n *       [-1, 2, 3],\n *       filterE((n) => T.of(n > 0))\n *     )(),\n *     [2, 3]\n *   )\n * }\n * test()\n *\n * @since 2.11.0\n */\nexports.filterE = (0, Witherable_1.filterE)(exports.Witherable);\n/**\n * @category instances\n * @since 2.11.0\n */\nexports.FromEither = {\n    URI: exports.URI,\n    fromEither: exports.fromEither\n};\n/**\n * @category combinators\n * @since 2.11.0\n */\nexports.fromEitherK = (0, FromEither_1.fromEitherK)(exports.FromEither);\n// -------------------------------------------------------------------------------------\n// unsafe\n// -------------------------------------------------------------------------------------\n/**\n * @category unsafe\n * @since 2.5.0\n */\nexports.unsafeInsertAt = RNEA.unsafeInsertAt;\n/**\n * @category unsafe\n * @since 2.5.0\n */\nvar unsafeUpdateAt = function (i, a, as) {\n    return (0, exports.isNonEmpty)(as) ? RNEA.unsafeUpdateAt(i, a, as) : as;\n};\nexports.unsafeUpdateAt = unsafeUpdateAt;\n/**\n * @category unsafe\n * @since 2.5.0\n */\nvar unsafeDeleteAt = function (i, as) {\n    var xs = as.slice();\n    xs.splice(i, 1);\n    return xs;\n};\nexports.unsafeDeleteAt = unsafeDeleteAt;\n// -------------------------------------------------------------------------------------\n// interop\n// -------------------------------------------------------------------------------------\n/**\n * @category interop\n * @since 2.5.0\n */\nvar toArray = function (as) { return as.slice(); };\nexports.toArray = toArray;\n/**\n * @category interop\n * @since 2.5.0\n */\nvar fromArray = function (as) { return ((0, exports.isEmpty)(as) ? exports.empty : as.slice()); };\nexports.fromArray = fromArray;\n// -------------------------------------------------------------------------------------\n// utils\n// -------------------------------------------------------------------------------------\n/**\n * An empty array\n *\n * @since 2.5.0\n */\nexports.empty = RNEA.empty;\nfunction every(predicate) {\n    return function (as) { return as.every(predicate); };\n}\nexports.every = every;\n/**\n * Check if a predicate holds true for any array member.\n *\n * @example\n * import { some } from 'fp-ts/ReadonlyArray'\n * import { pipe } from 'fp-ts/function'\n *\n * const isPositive = (n: number): boolean => n > 0\n *\n * assert.deepStrictEqual(pipe([-1, -2, 3], some(isPositive)), true)\n * assert.deepStrictEqual(pipe([-1, -2, -3], some(isPositive)), false)\n *\n * @since 2.9.0\n */\nvar some = function (predicate) { return function (as) {\n    return as.some(predicate);\n}; };\nexports.some = some;\n/**\n * Alias of [`some`](#some)\n *\n * @since 2.11.0\n */\nexports.exists = exports.some;\n/**\n * Places an element in between members of a `ReadonlyArray`, then folds the results using the provided `Monoid`.\n *\n * @example\n * import * as S from 'fp-ts/string'\n * import { intercalate } from 'fp-ts/ReadonlyArray'\n *\n * assert.deepStrictEqual(intercalate(S.Monoid)('-')(['a', 'b', 'c']), 'a-b-c')\n *\n * @since 2.12.0\n */\nvar intercalate = function (M) {\n    var intercalateM = RNEA.intercalate(M);\n    return function (middle) { return (0, exports.match)(function () { return M.empty; }, intercalateM(middle)); };\n};\nexports.intercalate = intercalate;\n// -------------------------------------------------------------------------------------\n// do notation\n// -------------------------------------------------------------------------------------\n/**\n * @since 2.9.0\n */\nexports.Do = (0, exports.of)(_.emptyRecord);\n/**\n * @since 2.8.0\n */\nexports.bindTo = (0, Functor_1.bindTo)(exports.Functor);\n/**\n * @since 2.8.0\n */\nexports.bind = (0, Chain_1.bind)(exports.Chain);\n// -------------------------------------------------------------------------------------\n// pipeable sequence S\n// -------------------------------------------------------------------------------------\n/**\n * @since 2.8.0\n */\nexports.apS = (0, Apply_1.apS)(exports.Apply);\n// -------------------------------------------------------------------------------------\n// deprecated\n// -------------------------------------------------------------------------------------\n/**\n * Use `ReadonlyNonEmptyArray` module instead.\n *\n * @category constructors\n * @since 2.5.0\n * @deprecated\n */\nexports.range = RNEA.range;\n/**\n * Use [`prepend`](#prepend) instead.\n *\n * @category constructors\n * @since 2.5.0\n * @deprecated\n */\nexports.cons = RNEA.cons;\n/**\n * Use [`append`](#append) instead.\n *\n * @category constructors\n * @since 2.5.0\n * @deprecated\n */\nexports.snoc = RNEA.snoc;\n/**\n * Use [`prependAll`](#prependall) instead.\n *\n * @category combinators\n * @since 2.9.0\n * @deprecated\n */\nexports.prependToAll = exports.prependAll;\n/**\n * This instance is deprecated, use small, specific instances instead.\n * For example if a function needs a `Functor` instance, pass `RA.Functor` instead of `RA.readonlyArray`\n * (where `RA` is from `import RA from 'fp-ts/ReadonlyArray'`)\n *\n * @category instances\n * @since 2.5.0\n * @deprecated\n */\nexports.readonlyArray = {\n    URI: exports.URI,\n    compact: exports.compact,\n    separate: exports.separate,\n    map: _map,\n    ap: _ap,\n    of: exports.of,\n    chain: _chain,\n    filter: _filter,\n    filterMap: _filterMap,\n    partition: _partition,\n    partitionMap: _partitionMap,\n    mapWithIndex: _mapWithIndex,\n    partitionMapWithIndex: _partitionMapWithIndex,\n    partitionWithIndex: _partitionWithIndex,\n    filterMapWithIndex: _filterMapWithIndex,\n    filterWithIndex: _filterWithIndex,\n    alt: _alt,\n    zero: exports.zero,\n    unfold: exports.unfold,\n    reduce: _reduce,\n    foldMap: _foldMap,\n    reduceRight: _reduceRight,\n    traverse: _traverse,\n    sequence: exports.sequence,\n    reduceWithIndex: _reduceWithIndex,\n    foldMapWithIndex: _foldMapWithIndex,\n    reduceRightWithIndex: _reduceRightWithIndex,\n    traverseWithIndex: _traverseWithIndex,\n    extend: _extend,\n    wither: _wither,\n    wilt: _wilt\n};\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.lefts = exports.rights = exports.reverse = exports.modifyAt = exports.deleteAt = exports.updateAt = exports.insertAt = exports.copy = exports.findLastIndex = exports.findLastMap = exports.findLast = exports.findFirstMap = exports.findFirst = exports.findIndex = exports.dropLeftWhile = exports.dropRight = exports.dropLeft = exports.spanLeft = exports.takeLeftWhile = exports.takeRight = exports.takeLeft = exports.init = exports.tail = exports.last = exports.head = exports.lookup = exports.isOutOfBound = exports.size = exports.scanRight = exports.scanLeft = exports.chainWithIndex = exports.foldRight = exports.matchRight = exports.matchRightW = exports.foldLeft = exports.matchLeft = exports.matchLeftW = exports.match = exports.matchW = exports.fromEither = exports.fromOption = exports.fromPredicate = exports.replicate = exports.makeBy = exports.appendW = exports.append = exports.prependW = exports.prepend = exports.isNonEmpty = exports.isEmpty = void 0;\nexports.traverseWithIndex = exports.sequence = exports.traverse = exports.reduceRightWithIndex = exports.reduceRight = exports.reduceWithIndex = exports.reduce = exports.foldMapWithIndex = exports.foldMap = exports.duplicate = exports.extend = exports.filterWithIndex = exports.alt = exports.altW = exports.partitionMapWithIndex = exports.partitionMap = exports.partitionWithIndex = exports.partition = exports.filter = exports.separate = exports.compact = exports.filterMap = exports.filterMapWithIndex = exports.mapWithIndex = exports.flatten = exports.chain = exports.ap = exports.map = exports.zero = exports.of = exports.difference = exports.intersection = exports.union = exports.concat = exports.concatW = exports.comprehension = exports.fromOptionK = exports.chunksOf = exports.splitAt = exports.chop = exports.sortBy = exports.uniq = exports.elem = exports.rotate = exports.intersperse = exports.prependAll = exports.unzip = exports.zip = exports.zipWith = exports.sort = void 0;\nexports.some = exports.every = exports.unsafeDeleteAt = exports.unsafeUpdateAt = exports.unsafeInsertAt = exports.fromEitherK = exports.FromEither = exports.filterE = exports.ChainRecBreadthFirst = exports.chainRecBreadthFirst = exports.ChainRecDepthFirst = exports.chainRecDepthFirst = exports.Witherable = exports.TraversableWithIndex = exports.Traversable = exports.FoldableWithIndex = exports.Foldable = exports.FilterableWithIndex = exports.Filterable = exports.Compactable = exports.Extend = exports.Alternative = exports.guard = exports.Zero = exports.Alt = exports.Unfoldable = exports.Monad = exports.chainFirst = exports.Chain = exports.Applicative = exports.apSecond = exports.apFirst = exports.Apply = exports.FunctorWithIndex = exports.Pointed = exports.flap = exports.Functor = exports.getDifferenceMagma = exports.getIntersectionSemigroup = exports.getUnionMonoid = exports.getUnionSemigroup = exports.getOrd = exports.getEq = exports.getMonoid = exports.getSemigroup = exports.getShow = exports.URI = exports.unfold = exports.wilt = exports.wither = void 0;\nexports.array = exports.prependToAll = exports.snoc = exports.cons = exports.empty = exports.range = exports.apS = exports.bind = exports.bindTo = exports.Do = exports.intercalate = exports.exists = void 0;\nvar Apply_1 = require(\"./Apply\");\nvar Chain_1 = require(\"./Chain\");\nvar FromEither_1 = require(\"./FromEither\");\nvar function_1 = require(\"./function\");\nvar Functor_1 = require(\"./Functor\");\nvar _ = __importStar(require(\"./internal\"));\nvar NEA = __importStar(require(\"./NonEmptyArray\"));\nvar RA = __importStar(require(\"./ReadonlyArray\"));\nvar Separated_1 = require(\"./Separated\");\nvar Witherable_1 = require(\"./Witherable\");\nvar Zero_1 = require(\"./Zero\");\n// -------------------------------------------------------------------------------------\n// refinements\n// -------------------------------------------------------------------------------------\n/**\n * Test whether an array is empty\n *\n * @example\n * import { isEmpty } from 'fp-ts/Array'\n *\n * assert.strictEqual(isEmpty([]), true)\n * assert.strictEqual(isEmpty(['a']), false)\n *\n * @category refinements\n * @since 2.0.0\n */\nvar isEmpty = function (as) { return as.length === 0; };\nexports.isEmpty = isEmpty;\n/**\n * Test whether an array is non empty narrowing down the type to `NonEmptyArray<A>`\n *\n * @example\n * import { isNonEmpty } from 'fp-ts/Array'\n *\n * assert.strictEqual(isNonEmpty([]), false)\n * assert.strictEqual(isNonEmpty(['a']), true)\n *\n * @category refinements\n * @since 2.0.0\n */\nexports.isNonEmpty = NEA.isNonEmpty;\n// -------------------------------------------------------------------------------------\n// constructors\n// -------------------------------------------------------------------------------------\n/**\n * Prepend an element to the front of a `Array`, creating a new `NonEmptyArray`.\n *\n * @example\n * import { prepend } from 'fp-ts/Array'\n * import { pipe } from 'fp-ts/function'\n *\n * assert.deepStrictEqual(pipe([2, 3, 4], prepend(1)), [1, 2, 3, 4])\n *\n * @category constructors\n * @since 2.10.0\n */\nexports.prepend = NEA.prepend;\n/**\n * Less strict version of [`prepend`](#prepend).\n *\n * @example\n * import { prependW } from 'fp-ts/Array'\n * import { pipe } from 'fp-ts/function'\n *\n * assert.deepStrictEqual(pipe([2, 3, 4], prependW(\"a\")), [\"a\", 2, 3, 4]);\n *\n * @category constructors\n * @since 2.11.0\n */\nexports.prependW = NEA.prependW;\n/**\n * Append an element to the end of a `Array`, creating a new `NonEmptyArray`.\n *\n * @example\n * import { append } from 'fp-ts/Array'\n * import { pipe } from 'fp-ts/function'\n *\n * assert.deepStrictEqual(pipe([1, 2, 3], append(4)), [1, 2, 3, 4])\n *\n * @category constructors\n * @since 2.10.0\n */\nexports.append = NEA.append;\n/**\n * Less strict version of [`append`](#append).\n *\n * @example\n * import { appendW } from 'fp-ts/Array'\n * import { pipe } from 'fp-ts/function'\n *\n * assert.deepStrictEqual(pipe([1, 2, 3], appendW(\"d\")), [1, 2, 3, \"d\"]);\n *\n * @category constructors\n * @since 2.11.0\n */\nexports.appendW = NEA.appendW;\n/**\n * Return a `Array` of length `n` with element `i` initialized with `f(i)`.\n *\n * **Note**. `n` is normalized to a non negative integer.\n *\n * @example\n * import { makeBy } from 'fp-ts/Array'\n *\n * const double = (i: number): number => i * 2\n * assert.deepStrictEqual(makeBy(5, double), [0, 2, 4, 6, 8])\n * assert.deepStrictEqual(makeBy(-3, double), [])\n * assert.deepStrictEqual(makeBy(4.32164, double), [0, 2, 4, 6])\n *\n * @category constructors\n * @since 2.0.0\n */\nvar makeBy = function (n, f) { return (n <= 0 ? [] : NEA.makeBy(f)(n)); };\nexports.makeBy = makeBy;\n/**\n * Create a `Array` containing a value repeated the specified number of times.\n *\n * **Note**. `n` is normalized to a non negative integer.\n *\n * @example\n * import { replicate } from 'fp-ts/Array'\n *\n * assert.deepStrictEqual(replicate(3, 'a'), ['a', 'a', 'a'])\n * assert.deepStrictEqual(replicate(-3, 'a'), [])\n * assert.deepStrictEqual(replicate(2.985647, 'a'), ['a', 'a'])\n *\n * @category constructors\n * @since 2.0.0\n */\nvar replicate = function (n, a) { return (0, exports.makeBy)(n, function () { return a; }); };\nexports.replicate = replicate;\nfunction fromPredicate(predicate) {\n    return function (a) { return (predicate(a) ? [a] : []); };\n}\nexports.fromPredicate = fromPredicate;\n// -------------------------------------------------------------------------------------\n// natural transformations\n// -------------------------------------------------------------------------------------\n/**\n * Create an array from an `Option`. The resulting array will contain the content of the\n * `Option` if it is `Some` and it will be empty if the `Option` is `None`.\n *\n * @example\n * import { fromOption } from 'fp-ts/Array'\n * import { option } from \"fp-ts\";\n * import { pipe } from 'fp-ts/function'\n *\n * assert.deepStrictEqual(pipe(option.some(\"a\"), fromOption),[\"a\"])\n * assert.deepStrictEqual(pipe(option.none, fromOption),[])\n *\n * @category natural transformations\n * @since 2.11.0\n */\nvar fromOption = function (ma) { return (_.isNone(ma) ? [] : [ma.value]); };\nexports.fromOption = fromOption;\n/**\n * Create an array from an `Either`. The resulting array will contain the content of the\n * `Either` if it is `Right` and it will be empty if the `Either` is `Left`.\n *\n * @example\n * import { fromEither } from 'fp-ts/Array'\n * import { either } from \"fp-ts\";\n * import { pipe } from 'fp-ts/function'\n *\n * assert.deepStrictEqual(pipe(either.right(\"r\"), fromEither), [\"r\"]);\n * assert.deepStrictEqual(pipe(either.left(\"l\"), fromEither), []);\n *\n * @category natural transformations\n * @since 2.11.0\n */\nvar fromEither = function (e) { return (_.isLeft(e) ? [] : [e.right]); };\nexports.fromEither = fromEither;\n// -------------------------------------------------------------------------------------\n// destructors\n// -------------------------------------------------------------------------------------\n/**\n * Less strict version of [`match`](#match). It will work when `onEmpty` and `onNonEmpty`\n * have different return types.\n *\n * @example\n * import { matchW } from 'fp-ts/Array'\n * import { pipe } from 'fp-ts/function'\n *\n * const matcherW = matchW(\n *   () => \"No elements\",\n *   (as) => as.length\n * );\n * assert.deepStrictEqual(pipe([1, 2, 3, 4], matcherW), 4);\n * assert.deepStrictEqual(pipe([], matcherW), \"No elements\");\n *\n * @category destructors\n * @since 2.11.0\n */\nvar matchW = function (onEmpty, onNonEmpty) { return function (as) {\n    return (0, exports.isNonEmpty)(as) ? onNonEmpty(as) : onEmpty();\n}; };\nexports.matchW = matchW;\n/**\n * Takes an array, if the array is empty it returns the result of `onEmpty`, otherwise\n * it passes the array to `onNonEmpty` and returns the result.\n *\n * @example\n * import { match } from 'fp-ts/Array'\n * import { pipe } from 'fp-ts/function'\n *\n * const matcher = match(\n *   () => \"No elements\",\n *   (as) => `Found ${as.length} element(s)`\n * );\n * assert.deepStrictEqual(pipe([1, 2, 3, 4], matcher), \"Found 4 element(s)\");\n * assert.deepStrictEqual(pipe([], matcher), \"No elements\");\n *\n * @category destructors\n * @since 2.11.0\n */\nexports.match = exports.matchW;\n/**\n * Less strict version of [`matchLeft`](#matchleft). It will work when `onEmpty` and\n * `onNonEmpty` have different return types.\n *\n * @example\n * import { matchLeftW } from 'fp-ts/Array'\n *\n * const f = matchLeftW(\n *   () => 0,\n *   (head: string, tail: string[]) => `Found \"${head}\" followed by ${tail.length} elements`\n * );\n * assert.strictEqual(f([\"a\", \"b\", \"c\"]), 'Found \"a\" followed by 2 elements');\n * assert.strictEqual(f([]), 0);\n *\n * @category destructors\n * @since 2.11.0\n */\nvar matchLeftW = function (onEmpty, onNonEmpty) { return function (as) { return ((0, exports.isNonEmpty)(as) ? onNonEmpty(NEA.head(as), NEA.tail(as)) : onEmpty()); }; };\nexports.matchLeftW = matchLeftW;\n/**\n * Takes an array, if the array is empty it returns the result of `onEmpty`, otherwise\n * it passes the array to `onNonEmpty` broken into its first element and remaining elements.\n *\n * @example\n * import { matchLeft } from 'fp-ts/Array'\n *\n * const len: <A>(as: Array<A>) => number = matchLeft(() => 0, (_, tail) => 1 + len(tail))\n * assert.strictEqual(len([1, 2, 3]), 3)\n *\n * @category destructors\n * @since 2.10.0\n */\nexports.matchLeft = exports.matchLeftW;\n/**\n * Alias of [`matchLeft`](#matchleft).\n *\n * @category destructors\n * @since 2.0.0\n */\nexports.foldLeft = exports.matchLeft;\n/**\n * Less strict version of [`matchRight`](#matchright). It will work when `onEmpty` and\n * `onNonEmpty` have different return types.\n *\n * @example\n * import { matchRightW } from 'fp-ts/Array'\n *\n * const f = matchRightW(\n *   () => 0,\n *   (head: string[], tail: string) => `Found ${head.length} elements folllowed by \"${tail}\"`\n * );\n * assert.strictEqual(f([\"a\", \"b\", \"c\"]), 'Found 2 elements folllowed by \"c\"');\n * assert.strictEqual(f([]), 0);\n *\n * @category destructors\n * @since 2.11.0\n */\nvar matchRightW = function (onEmpty, onNonEmpty) { return function (as) { return ((0, exports.isNonEmpty)(as) ? onNonEmpty(NEA.init(as), NEA.last(as)) : onEmpty()); }; };\nexports.matchRightW = matchRightW;\n/**\n * Takes an array, if the array is empty it returns the result of `onEmpty`, otherwise\n * it passes the array to `onNonEmpty` broken  into its initial elements and the last element.\n *\n * @example\n * import { matchRight } from 'fp-ts/Array'\n *\n * const len: <A>(as: Array<A>) => number = matchRight(\n *   () => 0,\n *   (head, _) => 1 + len(head)\n * );\n * assert.strictEqual(len([1, 2, 3]), 3);\n *\n * @category destructors\n * @since 2.10.0\n */\nexports.matchRight = exports.matchRightW;\n/**\n * Alias of [`matchRight`](#matchright).\n *\n * @category destructors\n * @since 2.0.0\n */\nexports.foldRight = exports.matchRight;\n// -------------------------------------------------------------------------------------\n// combinators\n// -------------------------------------------------------------------------------------\n/**\n * Same as [`chain`](#chain), but passing also the index to the iterating function.\n *\n * @example\n * import { chainWithIndex, replicate } from 'fp-ts/Array'\n * import { pipe } from 'fp-ts/function'\n *\n * const f = (index: number, x: string) => replicate(2, `${x}${index}`);\n * assert.deepStrictEqual(pipe([\"a\", \"b\", \"c\"], chainWithIndex(f)), [\"a0\", \"a0\", \"b1\", \"b1\", \"c2\", \"c2\"]);\n *\n * @category combinators\n * @since 2.7.0\n */\nvar chainWithIndex = function (f) { return function (as) {\n    var out = [];\n    for (var i = 0; i < as.length; i++) {\n        out.push.apply(out, f(i, as[i]));\n    }\n    return out;\n}; };\nexports.chainWithIndex = chainWithIndex;\n/**\n * Same as `reduce` but it carries over the intermediate steps\n *\n * @example\n * import { scanLeft } from 'fp-ts/Array'\n *\n * assert.deepStrictEqual(scanLeft(10, (b, a: number) => b - a)([1, 2, 3]), [10, 9, 7, 4])\n *\n * @category combinators\n * @since 2.0.0\n */\nvar scanLeft = function (b, f) { return function (as) {\n    var len = as.length;\n    var out = new Array(len + 1);\n    out[0] = b;\n    for (var i = 0; i < len; i++) {\n        out[i + 1] = f(out[i], as[i]);\n    }\n    return out;\n}; };\nexports.scanLeft = scanLeft;\n/**\n * Fold an array from the right, keeping all intermediate results instead of only the final result\n *\n * @example\n * import { scanRight } from 'fp-ts/Array'\n *\n * assert.deepStrictEqual(scanRight(10, (a: number, b) => b - a)([1, 2, 3]), [4, 5, 7, 10])\n *\n * @category combinators\n * @since 2.0.0\n */\nvar scanRight = function (b, f) { return function (as) {\n    var len = as.length;\n    var out = new Array(len + 1);\n    out[len] = b;\n    for (var i = len - 1; i >= 0; i--) {\n        out[i] = f(as[i], out[i + 1]);\n    }\n    return out;\n}; };\nexports.scanRight = scanRight;\n/**\n * Calculate the number of elements in a `Array`.\n *\n * @example\n * import { size } from 'fp-ts/Array'\n *\n * assert.strictEqual(size([\"a\",\"b\",\"c\"]),3)\n *\n * @since 2.10.0\n */\nvar size = function (as) { return as.length; };\nexports.size = size;\n/**\n * Test whether an array contains a particular index\n *\n * @example\n * import { isOutOfBound } from 'fp-ts/Array'\n *\n * assert.strictEqual(isOutOfBound(1,[\"a\",\"b\",\"c\"]),false)\n * assert.strictEqual(isOutOfBound(-1,[\"a\",\"b\",\"c\"]),true)\n * assert.strictEqual(isOutOfBound(3,[\"a\",\"b\",\"c\"]),true)\n *\n * @since 2.0.0\n */\nexports.isOutOfBound = NEA.isOutOfBound;\n// TODO: remove non-curried overloading in v3\n/**\n * This function provides a safe way to read a value at a particular index from an array.\n * It returns a `none` if the index is out of bounds, and a `some` of the element if the\n * index is valid.\n *\n * @example\n * import { lookup } from 'fp-ts/Array'\n * import { some, none } from 'fp-ts/Option'\n * import { pipe } from 'fp-ts/function'\n *\n * assert.deepStrictEqual(pipe([1, 2, 3], lookup(1)), some(2))\n * assert.deepStrictEqual(pipe([1, 2, 3], lookup(3)), none)\n *\n * @since 2.0.0\n */\nexports.lookup = RA.lookup;\n/**\n * Get the first element in an array, or `None` if the array is empty\n *\n * @example\n * import { head } from 'fp-ts/Array'\n * import { some, none } from 'fp-ts/Option'\n *\n * assert.deepStrictEqual(head([1, 2, 3]), some(1))\n * assert.deepStrictEqual(head([]), none)\n *\n * @category destructors\n * @since 2.0.0\n */\nexports.head = RA.head;\n/**\n * Get the last element in an array, or `None` if the array is empty\n *\n * @example\n * import { last } from 'fp-ts/Array'\n * import { some, none } from 'fp-ts/Option'\n *\n * assert.deepStrictEqual(last([1, 2, 3]), some(3))\n * assert.deepStrictEqual(last([]), none)\n *\n * @category destructors\n * @since 2.0.0\n */\nexports.last = RA.last;\n/**\n * Get all but the first element of an array, creating a new array, or `None` if the array is empty\n *\n * @example\n * import { tail } from 'fp-ts/Array'\n * import { some, none } from 'fp-ts/Option'\n *\n * assert.deepStrictEqual(tail([1, 2, 3]), some([2, 3]))\n * assert.deepStrictEqual(tail([]), none)\n *\n * @category destructors\n * @since 2.0.0\n */\nvar tail = function (as) { return ((0, exports.isNonEmpty)(as) ? _.some(NEA.tail(as)) : _.none); };\nexports.tail = tail;\n/**\n * Get all but the last element of an array, creating a new array, or `None` if the array is empty\n *\n * @example\n * import { init } from 'fp-ts/Array'\n * import { some, none } from 'fp-ts/Option'\n *\n * assert.deepStrictEqual(init([1, 2, 3]), some([1, 2]))\n * assert.deepStrictEqual(init([]), none)\n *\n * @category destructors\n * @since 2.0.0\n */\nvar init = function (as) { return ((0, exports.isNonEmpty)(as) ? _.some(NEA.init(as)) : _.none); };\nexports.init = init;\n/**\n * Keep only a max number of elements from the start of an `Array`, creating a new `Array`.\n *\n * **Note**. `n` is normalized to a non negative integer.\n *\n * @example\n * import { takeLeft } from 'fp-ts/Array'\n *\n * assert.deepStrictEqual(takeLeft(2)([1, 2, 3, 4, 5]), [1, 2]);\n * assert.deepStrictEqual(takeLeft(7)([1, 2, 3, 4, 5]), [1, 2, 3, 4, 5]);\n * assert.deepStrictEqual(takeLeft(0)([1, 2, 3, 4, 5]), []);\n * assert.deepStrictEqual(takeLeft(-1)([1, 2, 3, 4, 5]), [1, 2, 3, 4, 5]);\n *\n * @category combinators\n * @since 2.0.0\n */\nvar takeLeft = function (n) { return function (as) { return ((0, exports.isOutOfBound)(n, as) ? (0, exports.copy)(as) : as.slice(0, n)); }; };\nexports.takeLeft = takeLeft;\n/**\n * Keep only a max number of elements from the end of an `Array`, creating a new `Array`.\n *\n * **Note**. `n` is normalized to a non negative integer.\n *\n * @example\n * import { takeRight } from 'fp-ts/Array'\n *\n * assert.deepStrictEqual(takeRight(2)([1, 2, 3, 4, 5]), [4, 5]);\n * assert.deepStrictEqual(takeRight(7)([1, 2, 3, 4, 5]), [1, 2, 3, 4, 5]);\n * assert.deepStrictEqual(takeRight(0)([1, 2, 3, 4, 5]), []);\n * assert.deepStrictEqual(takeRight(-1)([1, 2, 3, 4, 5]), [1, 2, 3, 4, 5]);\n *\n * @category combinators\n * @since 2.0.0\n */\nvar takeRight = function (n) { return function (as) {\n    return (0, exports.isOutOfBound)(n, as) ? (0, exports.copy)(as) : n === 0 ? [] : as.slice(-n);\n}; };\nexports.takeRight = takeRight;\nfunction takeLeftWhile(predicate) {\n    return function (as) {\n        var out = [];\n        for (var _i = 0, as_1 = as; _i < as_1.length; _i++) {\n            var a = as_1[_i];\n            if (!predicate(a)) {\n                break;\n            }\n            out.push(a);\n        }\n        return out;\n    };\n}\nexports.takeLeftWhile = takeLeftWhile;\nvar spanLeftIndex = function (as, predicate) {\n    var l = as.length;\n    var i = 0;\n    for (; i < l; i++) {\n        if (!predicate(as[i])) {\n            break;\n        }\n    }\n    return i;\n};\nfunction spanLeft(predicate) {\n    return function (as) {\n        var _a = (0, exports.splitAt)(spanLeftIndex(as, predicate))(as), init = _a[0], rest = _a[1];\n        return { init: init, rest: rest };\n    };\n}\nexports.spanLeft = spanLeft;\n/**\n * Creates a new `Array` which is a copy of the input dropping a max number of elements from the start.\n *\n * **Note**. `n` is normalized to a non negative integer.\n *\n * @example\n * import { dropLeft } from 'fp-ts/Array'\n *\n * assert.deepStrictEqual(dropLeft(2)([1, 2, 3]), [3]);\n * assert.deepStrictEqual(dropLeft(5)([1, 2, 3]), []);\n * assert.deepStrictEqual(dropLeft(0)([1, 2, 3]), [1, 2, 3]);\n * assert.deepStrictEqual(dropLeft(-2)([1, 2, 3]), [1, 2, 3]);\n *\n * @category combinators\n * @since 2.0.0\n */\nvar dropLeft = function (n) { return function (as) {\n    return n <= 0 || (0, exports.isEmpty)(as) ? (0, exports.copy)(as) : n >= as.length ? [] : as.slice(n, as.length);\n}; };\nexports.dropLeft = dropLeft;\n/**\n * Creates a new `Array` which is a copy of the input dropping a max number of elements from the end.\n *\n * **Note**. `n` is normalized to a non negative integer.\n *\n * @example\n * import { dropRight } from 'fp-ts/Array'\n *\n * assert.deepStrictEqual(dropRight(2)([1, 2, 3]), [1]);\n * assert.deepStrictEqual(dropRight(5)([1, 2, 3]), []);\n * assert.deepStrictEqual(dropRight(0)([1, 2, 3]), [1, 2, 3]);\n * assert.deepStrictEqual(dropRight(-2)([1, 2, 3]), [1, 2, 3]);\n *\n * @category combinators\n * @since 2.0.0\n */\nvar dropRight = function (n) { return function (as) {\n    return n <= 0 || (0, exports.isEmpty)(as) ? (0, exports.copy)(as) : n >= as.length ? [] : as.slice(0, as.length - n);\n}; };\nexports.dropRight = dropRight;\nfunction dropLeftWhile(predicate) {\n    return function (as) { return as.slice(spanLeftIndex(as, predicate)); };\n}\nexports.dropLeftWhile = dropLeftWhile;\n/**\n * `findIndex` returns an `Option` containing the first index for which a predicate holds.\n * It returns `None` if no element satisfies the predicate.\n * Similar to [`findFirst`](#findFirst) but returning the index instead of the element.\n *\n * @example\n * import { findIndex } from 'fp-ts/Array'\n * import { some, none } from 'fp-ts/Option'\n *\n * assert.deepStrictEqual(findIndex((n: number) => n === 2)([1, 2, 3]), some(1))\n * assert.deepStrictEqual(findIndex((n: number) => n === 2)([]), none)\n *\n * @since 2.0.0\n */\nexports.findIndex = RA.findIndex;\nfunction findFirst(predicate) {\n    return RA.findFirst(predicate);\n}\nexports.findFirst = findFirst;\n/**\n * Given a selector function which takes an element and returns an option,\n * this function applies the selector to each element of the array and\n * returns the first `Some` result. Otherwise it returns `None`.\n *\n * @example\n * import { findFirstMap } from 'fp-ts/Array'\n * import { some, none } from 'fp-ts/Option'\n *\n * interface Person {\n *   readonly name: string;\n *   readonly age: number;\n * }\n *\n * const persons: Array<Person> = [\n *   { name: \"John\", age: 16 },\n *   { name: \"Mary\", age: 45 },\n *   { name: \"Joey\", age: 28 },\n * ];\n *\n * const nameOfPersonAbove18 = (p: Person) => (p.age <= 18 ? none : some(p.name));\n * const nameOfPersonAbove70 = (p: Person) => (p.age <= 70 ? none : some(p.name));\n * assert.deepStrictEqual(findFirstMap(nameOfPersonAbove18)(persons), some(\"Mary\"));\n * assert.deepStrictEqual(findFirstMap(nameOfPersonAbove70)(persons), none);\n *\n * @category destructors\n * @since 2.0.0\n */\nexports.findFirstMap = RA.findFirstMap;\nfunction findLast(predicate) {\n    return RA.findLast(predicate);\n}\nexports.findLast = findLast;\n/**\n * Given a selector function which takes an element and returns an option,\n * this function applies the selector to each element of the array starting from the\n * end and returns the last `Some` result. Otherwise it returns `None`.\n *\n * @example\n * import { findLastMap } from 'fp-ts/Array'\n * import { some, none } from 'fp-ts/Option'\n *\n * interface Person {\n *   readonly name: string;\n *   readonly age: number;\n * }\n *\n * const persons: Array<Person> = [\n *   { name: \"John\", age: 16 },\n *   { name: \"Mary\", age: 45 },\n *   { name: \"Joey\", age: 28 },\n * ];\n *\n * const nameOfPersonAbove18 = (p: Person) => (p.age <= 18 ? none : some(p.name));\n * const nameOfPersonAbove70 = (p: Person) => (p.age <= 70 ? none : some(p.name));\n * assert.deepStrictEqual(findLastMap(nameOfPersonAbove18)(persons), some(\"Joey\"));\n * assert.deepStrictEqual(findLastMap(nameOfPersonAbove70)(persons), none);\n *\n * @category destructors\n * @since 2.0.0\n */\nexports.findLastMap = RA.findLastMap;\n/**\n * Returns the index of the last element of the list which matches the predicate.\n * It returns an `Option` containing the index or `None` if not found.\n *\n * @example\n * import { findLastIndex } from 'fp-ts/Array'\n * import { some, none } from 'fp-ts/Option'\n *\n * interface X {\n *   readonly a: number\n *   readonly b: number\n * }\n * const xs: Array<X> = [{ a: 1, b: 0 }, { a: 1, b: 1 }]\n * assert.deepStrictEqual(findLastIndex((x: { readonly a: number }) => x.a === 1)(xs), some(1))\n * assert.deepStrictEqual(findLastIndex((x: { readonly a: number }) => x.a === 4)(xs), none)\n *\n * @since 2.0.0\n */\nexports.findLastIndex = RA.findLastIndex;\n/**\n * This function takes an array and makes a new array containing the same elements.\n *\n * @category combinators\n * @since 2.0.0\n */\nvar copy = function (as) { return as.slice(); };\nexports.copy = copy;\n/**\n * Insert an element at the specified index, creating a new array,\n * or returning `None` if the index is out of bounds.\n *\n * @example\n * import { insertAt } from 'fp-ts/Array'\n * import { some } from 'fp-ts/Option'\n *\n * assert.deepStrictEqual(insertAt(2, 5)([1, 2, 3, 4]), some([1, 2, 5, 3, 4]))\n *\n * @since 2.0.0\n */\nvar insertAt = function (i, a) { return function (as) {\n    return i < 0 || i > as.length ? _.none : _.some((0, exports.unsafeInsertAt)(i, a, as));\n}; };\nexports.insertAt = insertAt;\n/**\n * Change the element at the specified index, creating a new array,\n * or returning `None` if the index is out of bounds.\n *\n * @example\n * import { updateAt } from 'fp-ts/Array'\n * import { some, none } from 'fp-ts/Option'\n *\n * assert.deepStrictEqual(updateAt(1, 1)([1, 2, 3]), some([1, 1, 3]))\n * assert.deepStrictEqual(updateAt(1, 1)([]), none)\n *\n * @since 2.0.0\n */\nvar updateAt = function (i, a) { return (0, exports.modifyAt)(i, function () { return a; }); };\nexports.updateAt = updateAt;\n/**\n * Delete the element at the specified index, creating a new array, or returning `None` if the index is out of bounds.\n *\n * @example\n * import { deleteAt } from 'fp-ts/Array'\n * import { some, none } from 'fp-ts/Option'\n *\n * assert.deepStrictEqual(deleteAt(0)([1, 2, 3]), some([2, 3]))\n * assert.deepStrictEqual(deleteAt(1)([]), none)\n *\n * @since 2.0.0\n */\nvar deleteAt = function (i) { return function (as) {\n    return (0, exports.isOutOfBound)(i, as) ? _.none : _.some((0, exports.unsafeDeleteAt)(i, as));\n}; };\nexports.deleteAt = deleteAt;\n/**\n * Apply a function to the element at the specified index, creating a new array, or returning `None` if the index is out\n * of bounds.\n *\n * @example\n * import { modifyAt } from 'fp-ts/Array'\n * import { some, none } from 'fp-ts/Option'\n *\n * const double = (x: number): number => x * 2\n * assert.deepStrictEqual(modifyAt(1, double)([1, 2, 3]), some([1, 4, 3]))\n * assert.deepStrictEqual(modifyAt(1, double)([]), none)\n *\n * @since 2.0.0\n */\nvar modifyAt = function (i, f) { return function (as) {\n    return (0, exports.isOutOfBound)(i, as) ? _.none : _.some((0, exports.unsafeUpdateAt)(i, f(as[i]), as));\n}; };\nexports.modifyAt = modifyAt;\n/**\n * Reverse an array, creating a new array\n *\n * @example\n * import { reverse } from 'fp-ts/Array'\n *\n * assert.deepStrictEqual(reverse([1, 2, 3]), [3, 2, 1])\n *\n * @category combinators\n * @since 2.0.0\n */\nvar reverse = function (as) { return ((0, exports.isEmpty)(as) ? [] : as.slice().reverse()); };\nexports.reverse = reverse;\n/**\n * Takes an `Array` of `Either` and produces a new `Array` containing\n * the values of all the `Right` elements in the same order.\n *\n * @example\n * import { rights } from 'fp-ts/Array'\n * import { right, left } from 'fp-ts/Either'\n *\n * assert.deepStrictEqual(rights([right(1), left('foo'), right(2)]), [1, 2])\n *\n * @category combinators\n * @since 2.0.0\n */\nvar rights = function (as) {\n    var r = [];\n    for (var i = 0; i < as.length; i++) {\n        var a = as[i];\n        if (a._tag === 'Right') {\n            r.push(a.right);\n        }\n    }\n    return r;\n};\nexports.rights = rights;\n/**\n * Takes an `Array` of `Either` and produces a new `Array` containing\n * the values of all the `Left` elements in the same order.\n *\n * @example\n * import { lefts } from 'fp-ts/Array'\n * import { left, right } from 'fp-ts/Either'\n *\n * assert.deepStrictEqual(lefts([right(1), left('foo'), right(2)]), ['foo'])\n *\n * @category combinators\n * @since 2.0.0\n */\nvar lefts = function (as) {\n    var r = [];\n    for (var i = 0; i < as.length; i++) {\n        var a = as[i];\n        if (a._tag === 'Left') {\n            r.push(a.left);\n        }\n    }\n    return r;\n};\nexports.lefts = lefts;\n/**\n * Sort the elements of an array in increasing order, creating a new array\n *\n * @example\n * import { sort } from 'fp-ts/Array'\n * import * as N from 'fp-ts/number'\n *\n * assert.deepStrictEqual(sort(N.Ord)([3, 2, 1]), [1, 2, 3])\n *\n * @category combinators\n * @since 2.0.0\n */\nvar sort = function (O) { return function (as) {\n    return as.length <= 1 ? (0, exports.copy)(as) : as.slice().sort(O.compare);\n}; };\nexports.sort = sort;\n/**\n * Apply a function to pairs of elements at the same index in two arrays, collecting the results in a new array. If one\n * input array is short, excess elements of the longer array are discarded.\n *\n * @example\n * import { zipWith } from 'fp-ts/Array'\n *\n * assert.deepStrictEqual(zipWith([1, 2, 3], ['a', 'b', 'c', 'd'], (n, s) => s + n), ['a1', 'b2', 'c3'])\n *\n * @category combinators\n * @since 2.0.0\n */\nvar zipWith = function (fa, fb, f) {\n    var fc = [];\n    var len = Math.min(fa.length, fb.length);\n    for (var i = 0; i < len; i++) {\n        fc[i] = f(fa[i], fb[i]);\n    }\n    return fc;\n};\nexports.zipWith = zipWith;\nfunction zip(as, bs) {\n    if (bs === undefined) {\n        return function (bs) { return zip(bs, as); };\n    }\n    return (0, exports.zipWith)(as, bs, function (a, b) { return [a, b]; });\n}\nexports.zip = zip;\n/**\n * The function is reverse of `zip`. Takes an array of pairs and return two corresponding arrays\n *\n * @example\n * import { unzip } from 'fp-ts/Array'\n *\n * assert.deepStrictEqual(unzip([[1, 'a'], [2, 'b'], [3, 'c']]), [[1, 2, 3], ['a', 'b', 'c']])\n *\n * @since 2.0.0\n */\nvar unzip = function (as) {\n    var fa = [];\n    var fb = [];\n    for (var i = 0; i < as.length; i++) {\n        fa[i] = as[i][0];\n        fb[i] = as[i][1];\n    }\n    return [fa, fb];\n};\nexports.unzip = unzip;\n/**\n * Creates a new `Array`, prepending an element to every member of the input `Array`.\n *\n * @example\n * import { prependAll } from 'fp-ts/Array'\n *\n * assert.deepStrictEqual(prependAll(9)([1, 2, 3, 4]), [9, 1, 9, 2, 9, 3, 9, 4])\n *\n * @category combinators\n * @since 2.10.0\n */\nvar prependAll = function (middle) {\n    var f = NEA.prependAll(middle);\n    return function (as) { return ((0, exports.isNonEmpty)(as) ? f(as) : []); };\n};\nexports.prependAll = prependAll;\n/**\n * Creates a new `Array` placing an element in between members of the input `Array`.\n *\n * @example\n * import { intersperse } from 'fp-ts/Array'\n *\n * assert.deepStrictEqual(intersperse(9)([1, 2, 3, 4]), [1, 9, 2, 9, 3, 9, 4])\n *\n * @category combinators\n * @since 2.9.0\n */\nvar intersperse = function (middle) {\n    var f = NEA.intersperse(middle);\n    return function (as) { return ((0, exports.isNonEmpty)(as) ? f(as) : (0, exports.copy)(as)); };\n};\nexports.intersperse = intersperse;\n/**\n * Creates a new `Array` rotating the input `Array` by `n` steps.\n *\n * @example\n * import { rotate } from 'fp-ts/Array'\n *\n * assert.deepStrictEqual(rotate(2)([1, 2, 3, 4, 5]), [4, 5, 1, 2, 3])\n *\n * @category combinators\n * @since 2.0.0\n */\nvar rotate = function (n) {\n    var f = NEA.rotate(n);\n    return function (as) { return ((0, exports.isNonEmpty)(as) ? f(as) : (0, exports.copy)(as)); };\n};\nexports.rotate = rotate;\n// TODO: remove non-curried overloading in v3\n/**\n * Test if a value is a member of an `Array`. Takes a `Eq<A>` as a single\n * argument which returns the function to use to search for a value of type `A` in\n * an `Array<A>`.\n *\n * @example\n * import { elem } from 'fp-ts/Array'\n * import * as N from 'fp-ts/number'\n * import { pipe } from 'fp-ts/function'\n *\n * assert.strictEqual(pipe([1, 2, 3], elem(N.Eq)(2)), true)\n * assert.strictEqual(pipe([1, 2, 3], elem(N.Eq)(0)), false)\n *\n * @since 2.0.0\n */\nexports.elem = RA.elem;\n/**\n * Creates a new `Array` removing duplicate elements, keeping the first occurrence of an element,\n * based on a `Eq<A>`.\n *\n * @example\n * import { uniq } from 'fp-ts/Array'\n * import * as N from 'fp-ts/number'\n *\n * assert.deepStrictEqual(uniq(N.Eq)([1, 2, 1]), [1, 2])\n *\n * @category combinators\n * @since 2.0.0\n */\nvar uniq = function (E) {\n    var f = NEA.uniq(E);\n    return function (as) { return ((0, exports.isNonEmpty)(as) ? f(as) : (0, exports.copy)(as)); };\n};\nexports.uniq = uniq;\n/**\n * Sort the elements of an array in increasing order, where elements are compared using first `ords[0]`, then `ords[1]`,\n * etc...\n *\n * @example\n * import { sortBy } from 'fp-ts/Array'\n * import { contramap } from 'fp-ts/Ord'\n * import * as S from 'fp-ts/string'\n * import * as N from 'fp-ts/number'\n * import { pipe } from 'fp-ts/function'\n *\n * interface Person {\n *   readonly name: string\n *   readonly age: number\n * }\n * const byName = pipe(S.Ord, contramap((p: Person) => p.name))\n * const byAge = pipe(N.Ord, contramap((p: Person) => p.age))\n *\n * const sortByNameByAge = sortBy([byName, byAge])\n *\n * const persons = [{ name: 'a', age: 1 }, { name: 'b', age: 3 }, { name: 'c', age: 2 }, { name: 'b', age: 2 }]\n * assert.deepStrictEqual(sortByNameByAge(persons), [\n *   { name: 'a', age: 1 },\n *   { name: 'b', age: 2 },\n *   { name: 'b', age: 3 },\n *   { name: 'c', age: 2 }\n * ])\n *\n * @category combinators\n * @since 2.0.0\n */\nvar sortBy = function (ords) {\n    var f = NEA.sortBy(ords);\n    return function (as) { return ((0, exports.isNonEmpty)(as) ? f(as) : (0, exports.copy)(as)); };\n};\nexports.sortBy = sortBy;\n/**\n * A useful recursion pattern for processing an array to produce a new array, often used for \"chopping\" up the input\n * array. Typically chop is called with some function that will consume an initial prefix of the array and produce a\n * value and the rest of the array.\n *\n * @example\n * import { Eq } from 'fp-ts/Eq'\n * import * as A from 'fp-ts/Array'\n * import * as N from 'fp-ts/number'\n * import { pipe } from 'fp-ts/function'\n *\n * const group = <A>(S: Eq<A>): ((as: Array<A>) => Array<Array<A>>) => {\n *   return A.chop(as => {\n *     const { init, rest } = pipe(as, A.spanLeft((a: A) => S.equals(a, as[0])))\n *     return [init, rest]\n *   })\n * }\n * assert.deepStrictEqual(group(N.Eq)([1, 1, 2, 3, 3, 4]), [[1, 1], [2], [3, 3], [4]])\n *\n * @category combinators\n * @since 2.0.0\n */\nvar chop = function (f) {\n    var g = NEA.chop(f);\n    return function (as) { return ((0, exports.isNonEmpty)(as) ? g(as) : []); };\n};\nexports.chop = chop;\n/**\n * Splits an `Array` into two pieces, the first piece has max `n` elements.\n *\n * @example\n * import { splitAt } from 'fp-ts/Array'\n *\n * assert.deepStrictEqual(splitAt(2)([1, 2, 3, 4, 5]), [[1, 2], [3, 4, 5]])\n *\n * @category combinators\n * @since 2.0.0\n */\nvar splitAt = function (n) { return function (as) {\n    return n >= 1 && (0, exports.isNonEmpty)(as) ? NEA.splitAt(n)(as) : (0, exports.isEmpty)(as) ? [(0, exports.copy)(as), []] : [[], (0, exports.copy)(as)];\n}; };\nexports.splitAt = splitAt;\n/**\n * Splits an array into length-`n` pieces. The last piece will be shorter if `n` does not evenly divide the length of\n * the array. Note that `chunksOf(n)([])` is `[]`, not `[[]]`. This is intentional, and is consistent with a recursive\n * definition of `chunksOf`; it satisfies the property that\n *\n * ```ts\n * chunksOf(n)(xs).concat(chunksOf(n)(ys)) == chunksOf(n)(xs.concat(ys)))\n * ```\n *\n * whenever `n` evenly divides the length of `xs`.\n *\n * @example\n * import { chunksOf } from 'fp-ts/Array'\n *\n * assert.deepStrictEqual(chunksOf(2)([1, 2, 3, 4, 5]), [[1, 2], [3, 4], [5]])\n *\n * @category combinators\n * @since 2.0.0\n */\nvar chunksOf = function (n) {\n    var f = NEA.chunksOf(n);\n    return function (as) { return ((0, exports.isNonEmpty)(as) ? f(as) : []); };\n};\nexports.chunksOf = chunksOf;\n/**\n * @category combinators\n * @since 2.11.0\n */\nvar fromOptionK = function (f) { return function () {\n    var a = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        a[_i] = arguments[_i];\n    }\n    return (0, exports.fromOption)(f.apply(void 0, a));\n}; };\nexports.fromOptionK = fromOptionK;\nfunction comprehension(input, f, g) {\n    if (g === void 0) { g = function () { return true; }; }\n    var go = function (scope, input) {\n        return (0, exports.isNonEmpty)(input)\n            ? (0, function_1.pipe)(NEA.head(input), (0, exports.chain)(function (x) { return go((0, function_1.pipe)(scope, (0, exports.append)(x)), NEA.tail(input)); }))\n            : g.apply(void 0, scope) ? [f.apply(void 0, scope)]\n                : [];\n    };\n    return go([], input);\n}\nexports.comprehension = comprehension;\n/**\n * @category combinators\n * @since 2.11.0\n */\nvar concatW = function (second) { return function (first) {\n    return (0, exports.isEmpty)(first) ? (0, exports.copy)(second) : (0, exports.isEmpty)(second) ? (0, exports.copy)(first) : first.concat(second);\n}; };\nexports.concatW = concatW;\n/**\n * @category combinators\n * @since 2.11.0\n */\nexports.concat = exports.concatW;\nfunction union(E) {\n    var unionE = NEA.union(E);\n    return function (first, second) {\n        if (second === undefined) {\n            var unionE_1 = union(E);\n            return function (second) { return unionE_1(second, first); };\n        }\n        return (0, exports.isNonEmpty)(first) && (0, exports.isNonEmpty)(second)\n            ? unionE(second)(first)\n            : (0, exports.isNonEmpty)(first)\n                ? (0, exports.copy)(first)\n                : (0, exports.copy)(second);\n    };\n}\nexports.union = union;\nfunction intersection(E) {\n    var elemE = (0, exports.elem)(E);\n    return function (xs, ys) {\n        if (ys === undefined) {\n            var intersectionE_1 = intersection(E);\n            return function (ys) { return intersectionE_1(ys, xs); };\n        }\n        return xs.filter(function (a) { return elemE(a, ys); });\n    };\n}\nexports.intersection = intersection;\nfunction difference(E) {\n    var elemE = (0, exports.elem)(E);\n    return function (xs, ys) {\n        if (ys === undefined) {\n            var differenceE_1 = difference(E);\n            return function (ys) { return differenceE_1(ys, xs); };\n        }\n        return xs.filter(function (a) { return !elemE(a, ys); });\n    };\n}\nexports.difference = difference;\n// -------------------------------------------------------------------------------------\n// non-pipeables\n// -------------------------------------------------------------------------------------\nvar _map = function (fa, f) { return (0, function_1.pipe)(fa, (0, exports.map)(f)); };\n/* istanbul ignore next */\nvar _mapWithIndex = function (fa, f) { return (0, function_1.pipe)(fa, (0, exports.mapWithIndex)(f)); };\nvar _ap = function (fab, fa) { return (0, function_1.pipe)(fab, (0, exports.ap)(fa)); };\nvar _chain = function (ma, f) { return (0, function_1.pipe)(ma, (0, exports.chain)(f)); };\n/* istanbul ignore next */\nvar _filter = function (fa, predicate) { return (0, function_1.pipe)(fa, (0, exports.filter)(predicate)); };\n/* istanbul ignore next */\nvar _filterMap = function (fa, f) { return (0, function_1.pipe)(fa, (0, exports.filterMap)(f)); };\n/* istanbul ignore next */\nvar _partition = function (fa, predicate) {\n    return (0, function_1.pipe)(fa, (0, exports.partition)(predicate));\n};\n/* istanbul ignore next */\nvar _partitionMap = function (fa, f) { return (0, function_1.pipe)(fa, (0, exports.partitionMap)(f)); };\n/* istanbul ignore next */\nvar _partitionWithIndex = function (fa, predicateWithIndex) { return (0, function_1.pipe)(fa, (0, exports.partitionWithIndex)(predicateWithIndex)); };\n/* istanbul ignore next */\nvar _partitionMapWithIndex = function (fa, f) { return (0, function_1.pipe)(fa, (0, exports.partitionMapWithIndex)(f)); };\n/* istanbul ignore next */\nvar _alt = function (fa, that) { return (0, function_1.pipe)(fa, (0, exports.alt)(that)); };\nvar _reduce = function (fa, b, f) { return (0, function_1.pipe)(fa, (0, exports.reduce)(b, f)); };\n/* istanbul ignore next */\nvar _foldMap = function (M) {\n    var foldMapM = (0, exports.foldMap)(M);\n    return function (fa, f) { return (0, function_1.pipe)(fa, foldMapM(f)); };\n};\n/* istanbul ignore next */\nvar _reduceRight = function (fa, b, f) { return (0, function_1.pipe)(fa, (0, exports.reduceRight)(b, f)); };\n/* istanbul ignore next */\nvar _reduceWithIndex = function (fa, b, f) {\n    return (0, function_1.pipe)(fa, (0, exports.reduceWithIndex)(b, f));\n};\n/* istanbul ignore next */\nvar _foldMapWithIndex = function (M) {\n    var foldMapWithIndexM = (0, exports.foldMapWithIndex)(M);\n    return function (fa, f) { return (0, function_1.pipe)(fa, foldMapWithIndexM(f)); };\n};\n/* istanbul ignore next */\nvar _reduceRightWithIndex = function (fa, b, f) {\n    return (0, function_1.pipe)(fa, (0, exports.reduceRightWithIndex)(b, f));\n};\n/* istanbul ignore next */\nvar _filterMapWithIndex = function (fa, f) { return (0, function_1.pipe)(fa, (0, exports.filterMapWithIndex)(f)); };\n/* istanbul ignore next */\nvar _filterWithIndex = function (fa, predicateWithIndex) { return (0, function_1.pipe)(fa, (0, exports.filterWithIndex)(predicateWithIndex)); };\n/* istanbul ignore next */\nvar _extend = function (fa, f) { return (0, function_1.pipe)(fa, (0, exports.extend)(f)); };\n/* istanbul ignore next */\nvar _traverse = function (F) {\n    var traverseF = (0, exports.traverse)(F);\n    return function (ta, f) { return (0, function_1.pipe)(ta, traverseF(f)); };\n};\n/* istanbul ignore next */\nvar _traverseWithIndex = function (F) {\n    var traverseWithIndexF = (0, exports.traverseWithIndex)(F);\n    return function (ta, f) { return (0, function_1.pipe)(ta, traverseWithIndexF(f)); };\n};\nvar _chainRecDepthFirst = RA._chainRecDepthFirst;\nvar _chainRecBreadthFirst = RA._chainRecBreadthFirst;\n// -------------------------------------------------------------------------------------\n// type class members\n// -------------------------------------------------------------------------------------\n/**\n * Given an element of the base type, `of` builds an `Array` containing just that\n * element of the base type (this is useful for building a `Monad`).\n *\n * @example\n * import { of } from 'fp-ts/Array'\n *\n * assert.deepStrictEqual(of(\"a\"), [\"a\"]);\n *\n * @category Pointed\n * @since 2.0.0\n */\nexports.of = NEA.of;\n/**\n * Makes an empty `Array`, useful for building a [`Monoid`](#Monoid)\n *\n * @category Zero\n * @since 2.7.0\n */\nvar zero = function () { return []; };\nexports.zero = zero;\n/**\n * `map` can be used to turn functions `(a: A) => B` into functions `(fa: Array<A>) => Array<B>`.\n * In practice it applies the base function to each element of the array and collects the\n * results in a new array.\n *\n * @example\n * import { map } from 'fp-ts/Array'\n * import { pipe } from 'fp-ts/function'\n *\n * const f = (n: number) => n * 2;\n * assert.deepStrictEqual(pipe([1, 2, 3], map(f)), [2, 4, 6]);\n *\n * @category Functor\n * @since 2.0.0\n */\nvar map = function (f) { return function (fa) { return fa.map(function (a) { return f(a); }); }; };\nexports.map = map;\n/**\n * Apply a function to an argument under a type constructor.\n *\n * It can be used to extend the concept of [`map`](#map) to a function that\n * takes more than one parameter as described\n * read [here](https://dev.to/gcanti/getting-started-with-fp-ts-applicative-1kb3)\n *\n * @example\n * import { ap, map, of } from 'fp-ts/Array'\n * import { pipe } from 'fp-ts/function'\n *\n * // a curried function with 3 input parameteres\n * const f = (s1: string) => (n: number) => (s2: string) => s1 + n + s2;\n *\n * // let's use `ap` to iterate `f` over an array for each input parameter\n * assert.deepStrictEqual(pipe([\"a\", \"b\"], map(f), ap([1, 2]), ap([\"\", \"\", \"\"])), [\n *   \"a1\", \"a1\", \"a1\",\n *   \"a2\", \"a2\", \"a2\",\n *   \"b1\", \"b1\", \"b1\",\n *   \"b2\", \"b2\", \"b2\",\n * ]);\n *\n * // given Array implements the Applicative interface with the `of` method,\n * // we can write exactly the same thing in a more symmetric way\n * // using `of` on `f` and `ap` on each array in input\n * assert.deepStrictEqual(\n *   pipe(of(f), ap([\"a\", \"b\"]), ap([1, 2]), ap([\"\", \"\", \"\"])),\n *   pipe([\"a\", \"b\"], map(f), ap([1, 2]), ap([\"\", \"\", \"\"]))\n * );\n *\n * @category Apply\n * @since 2.0.0\n */\nvar ap = function (fa) { return (0, exports.chain)(function (f) { return (0, function_1.pipe)(fa, (0, exports.map)(f)); }); };\nexports.ap = ap;\n/**\n * Composes computations in sequence, using the return value of one computation to\n * determine the next computation.\n *\n * In other words it takes a function `f` that produces an array from a single element of\n * the base type `A` and returns a new function which applies `f` to each element of the\n * input array (like [`map`](#map)) and, instead of returning an array of arrays, concatenates the\n * results into a single array (like [`flatten`](#flatten)).\n *\n * This is the `chain` component of the array `Monad`.\n *\n * @example\n * import { chain, map, replicate } from 'fp-ts/Array'\n * import { pipe } from 'fp-ts/function'\n *\n * const f = (n: number) => replicate(n, `${n}`);\n * assert.deepStrictEqual(pipe([1, 2, 3], map(f)), [[\"1\"], [\"2\", \"2\"], [\"3\", \"3\", \"3\"]]);\n * assert.deepStrictEqual(pipe([1, 2, 3], chain(f)), [\"1\", \"2\", \"2\", \"3\", \"3\", \"3\"]);\n *\n * @category Monad\n * @since 2.0.0\n */\nvar chain = function (f) { return function (ma) {\n    return (0, function_1.pipe)(ma, (0, exports.chainWithIndex)(function (_, a) { return f(a); }));\n}; };\nexports.chain = chain;\n/**\n * Takes an array of arrays of `A` and flattens them into an array of `A`\n * by concatenating the elements of each array in order.\n *\n * Derivable from [`chain`](#chain).\n *\n * @example\n * import { flatten } from 'fp-ts/Array'\n *\n * assert.deepStrictEqual(flatten([[\"a\"], [\"b\", \"c\"], [\"d\", \"e\", \"f\"]]), [\"a\", \"b\", \"c\", \"d\", \"e\", \"f\"]);\n *\n * @category combinators\n * @since 2.5.0\n */\nexports.flatten = (0, exports.chain)(function_1.identity);\n/**\n * Same as [`map`](#map), but the iterating function takes both the index and the value\n * of the element.\n *\n * @example\n * import { mapWithIndex } from 'fp-ts/Array'\n * import { pipe } from 'fp-ts/function'\n *\n * const f = (i: number, s: string) => `${s} - ${i}`;\n * assert.deepStrictEqual(pipe([\"a\", \"b\", \"c\"], mapWithIndex(f)), [\"a - 0\", \"b - 1\", \"c - 2\"]);\n *\n * @category FunctorWithIndex\n * @since 2.0.0\n */\nvar mapWithIndex = function (f) { return function (fa) {\n    return fa.map(function (a, i) { return f(i, a); });\n}; };\nexports.mapWithIndex = mapWithIndex;\n/**\n * Maps an array with an iterating function that takes the index and the value of\n * each element and returns an `Option`. It keeps only the `Some` values discarding\n * the `None`s.\n *\n * Same as [`filterMap`](#filterMap), but with an iterating function which takes also\n * the index as input.\n *\n * @example\n * import { filterMapWithIndex } from 'fp-ts/Array'\n * import { pipe } from 'fp-ts/function'\n * import { option } from \"fp-ts\";\n *\n * const f = (i: number, s: string) => (i % 2 === 1 ? option.some(s.toUpperCase()) : option.none);\n * assert.deepStrictEqual(pipe([\"a\", \"no\", \"neither\", \"b\"], filterMapWithIndex(f)), [\"NO\", \"B\"]);\n *\n * @category FilterableWithIndex\n * @since 2.0.0\n */\nvar filterMapWithIndex = function (f) { return function (fa) {\n    var out = [];\n    for (var i = 0; i < fa.length; i++) {\n        var optionB = f(i, fa[i]);\n        if (_.isSome(optionB)) {\n            out.push(optionB.value);\n        }\n    }\n    return out;\n}; };\nexports.filterMapWithIndex = filterMapWithIndex;\n/**\n * Maps an array with an iterating function that returns an `Option`\n * and it keeps only the `Some` values discarding the `None`s.\n *\n * @example\n * import { filterMap } from 'fp-ts/Array'\n * import { pipe } from 'fp-ts/function'\n * import { option } from \"fp-ts\";\n *\n * const f = (s: string) => s.length === 1 ? option.some(s.toUpperCase()) : option.none;\n * assert.deepStrictEqual(pipe([\"a\", \"no\", \"neither\", \"b\"], filterMap(f)), [\"A\", \"B\"]);\n *\n * @category Filterable\n * @since 2.0.0\n */\nvar filterMap = function (f) {\n    return (0, exports.filterMapWithIndex)(function (_, a) { return f(a); });\n};\nexports.filterMap = filterMap;\n/**\n * Compact an array of `Option`s discarding the `None` values and\n * keeping the `Some` values. It returns a new array containing the values of\n * the `Some` options.\n *\n * @example\n * import { compact } from 'fp-ts/Array'\n * import { option } from \"fp-ts\";\n *\n * assert.deepStrictEqual(compact([option.some(\"a\"), option.none, option.some(\"b\")]), [\"a\", \"b\"]);\n *\n * @category Compactable\n * @since 2.0.0\n */\nexports.compact = (0, exports.filterMap)(function_1.identity);\n/**\n * Separate an array of `Either`s into `Left`s and `Right`s, creating two new arrays:\n * one containing all the left values and one containing all the right values.\n *\n * @example\n * import { separate } from 'fp-ts/Array'\n * import { either } from \"fp-ts\";\n *\n * assert.deepStrictEqual(separate([either.right(\"r1\"), either.left(\"l1\"), either.right(\"r2\")]), {\n *   left: [\"l1\"],\n *   right: [\"r1\", \"r2\"],\n * });\n *\n * @category Compactable\n * @since 2.0.0\n */\nvar separate = function (fa) {\n    var left = [];\n    var right = [];\n    for (var _i = 0, fa_1 = fa; _i < fa_1.length; _i++) {\n        var e = fa_1[_i];\n        if (e._tag === 'Left') {\n            left.push(e.left);\n        }\n        else {\n            right.push(e.right);\n        }\n    }\n    return (0, Separated_1.separated)(left, right);\n};\nexports.separate = separate;\n/**\n * Given an iterating function that is a `Predicate` or a `Refinement`,\n * `filter` creates a new `Array` containing the elements of the original\n * `Array` for which the iterating function is `true`.\n *\n * @example\n * import { filter } from 'fp-ts/Array'\n * import { isString } from \"fp-ts/lib/string\";\n *\n * assert.deepStrictEqual(filter(isString)([\"a\", 1, {}, \"b\", 5]), [\"a\", \"b\"]);\n * assert.deepStrictEqual(filter((x:number) => x > 0)([-3, 1, -2, 5]), [1, 5]);\n *\n * @category Filterable\n * @since 2.0.0\n */\nvar filter = function (predicate) { return function (as) { return as.filter(predicate); }; };\nexports.filter = filter;\n/**\n * Given an iterating function that is a `Predicate` or a `Refinement`,\n * `partition` creates two new `Array`s: `right` containing the elements of the original\n * `Array` for which the iterating function is `true`, `left` containing the elements\n * for which it is false.\n *\n * @example\n * import { partition } from 'fp-ts/Array'\n * import { isString } from \"fp-ts/lib/string\";\n *\n * assert.deepStrictEqual(partition(isString)([\"a\", 1, {}, \"b\", 5]), { left: [1, {}, 5], right: [\"a\", \"b\"] });\n * assert.deepStrictEqual(partition((x: number) => x > 0)([-3, 1, -2, 5]), { left: [-3, -2], right: [1, 5] });\n *\n * @category Filterable\n * @since 2.0.0\n */\nvar partition = function (predicate) {\n    return (0, exports.partitionWithIndex)(function (_, a) { return predicate(a); });\n};\nexports.partition = partition;\n/**\n * Same as [`partition`](#partition), but passing also the index to the iterating function.\n *\n * @example\n * import { partitionWithIndex } from 'fp-ts/Array'\n *\n * assert.deepStrictEqual(partitionWithIndex((index, x: number) => index < 3 && x > 0)([-2, 5, 6, 7]), {\n *   left: [-2, 7],\n *   right: [5, 6],\n * });\n *\n * @category FilterableWithIndex\n * @since 2.0.0\n */\nvar partitionWithIndex = function (predicateWithIndex) { return function (as) {\n    var left = [];\n    var right = [];\n    for (var i = 0; i < as.length; i++) {\n        var b = as[i];\n        if (predicateWithIndex(i, b)) {\n            right.push(b);\n        }\n        else {\n            left.push(b);\n        }\n    }\n    return (0, Separated_1.separated)(left, right);\n}; };\nexports.partitionWithIndex = partitionWithIndex;\n/**\n * Given an iterating function that returns an `Either`,\n * `partitionMap` applies the iterating function to each element and it creates two `Array`s:\n * `right` containing the values of `Right` results, `left` containing the values of `Left` results.\n *\n * @example\n * import { partitionMap } from 'fp-ts/Array'\n * import { Either, left, right } from \"fp-ts/lib/Either\";\n *\n * const upperIfString = <B>(x: B): Either<B, string> =>\n *   typeof x === \"string\" ? right(x.toUpperCase()) : left(x);\n * assert.deepStrictEqual(partitionMap(upperIfString)([-2, \"hello\", 6, 7, \"world\"]), {\n *   left: [-2, 6, 7],\n *   right: [ 'HELLO', 'WORLD' ],\n * });\n *\n * @category Filterable\n * @since 2.0.0\n */\nvar partitionMap = function (f) { return (0, exports.partitionMapWithIndex)(function (_, a) { return f(a); }); };\nexports.partitionMap = partitionMap;\n/**\n * Same as [`partitionMap`](#partitionMap), but passing also the index to the iterating function.\n *\n * @example\n * import { partitionMapWithIndex } from 'fp-ts/Array'\n * import { Either, left, right } from \"fp-ts/lib/Either\";\n *\n * const upperIfStringBefore3 = <B>(index: number, x: B): Either<B, string> =>\n *   index < 3 && typeof x === \"string\" ? right(x.toUpperCase()) : left(x);\n * assert.deepStrictEqual(partitionMapWithIndex(upperIfStringBefore3)([-2, \"hello\", 6, 7, \"world\"]), {\n *   left: [-2, 6, 7, \"world\"],\n *   right: [\"HELLO\"],\n * });\n *\n * @category FilterableWithIndex\n * @since 2.0.0\n */\nvar partitionMapWithIndex = function (f) { return function (fa) {\n    var left = [];\n    var right = [];\n    for (var i = 0; i < fa.length; i++) {\n        var e = f(i, fa[i]);\n        if (e._tag === 'Left') {\n            left.push(e.left);\n        }\n        else {\n            right.push(e.right);\n        }\n    }\n    return (0, Separated_1.separated)(left, right);\n}; };\nexports.partitionMapWithIndex = partitionMapWithIndex;\n/**\n * Less strict version of [`alt`](#alt), it can concatenate `Array`s of different base types.\n *\n * @example\n * import { altW } from 'fp-ts/Array';\n *\n * assert.deepStrictEqual(altW(() => [2, 3, 4])([\"a\"]), [\"a\", 2, 3, 4]);\n *\n * @category Alt\n * @since 2.9.0\n */\nvar altW = function (that) { return function (fa) { return fa.concat(that()); }; };\nexports.altW = altW;\n/**\n * `alt` implements the `Alt` iterface by concatenation of `Array`s.\n * `Alt` interface is similar to `Semigroup` for higher-kinded types such\n * as `Array` and `Option`: the example below shows both `Alt`'s `alt` and\n * `Semigroup`'s `concat` functions.\n *\n * @example\n * import { alt, concat } from 'fp-ts/Array';\n *\n * assert.deepStrictEqual(alt(() => [2, 3, 4])([1]), [1, 2, 3, 4]);\n * assert.deepStrictEqual(concat([2, 3, 4])([1]), [1, 2, 3, 4]);\n *\n * @category Alt\n * @since 2.0.0\n */\nexports.alt = exports.altW;\n/**\n * Same as [`filter`](#filter), but passing also the index to the iterating function.\n *\n * @example\n * import { filterWithIndex } from 'fp-ts/Array';\n *\n * const f = (index: number, x: number) => x > 0 && index <= 2;\n * assert.deepStrictEqual(filterWithIndex(f)([-3, 1, -2, 5]), [1]);\n *\n * @category FilterableWithIndex\n * @since 2.0.0\n */\nvar filterWithIndex = function (predicateWithIndex) { return function (as) {\n    return as.filter(function (b, i) { return predicateWithIndex(i, b); });\n}; };\nexports.filterWithIndex = filterWithIndex;\n/**\n * Given an iterating function that takes `Array<A>` as input, `extend` returns\n * an array containing the results of the iterating function applied to the whole input\n * `Array`, then to the input `Array` without the first element, then to the input\n * `Array` without the first two elements, etc.\n *\n * @example\n * import { extend } from 'fp-ts/Array'\n *\n * const f = (a: string[]) => a.join(\",\");\n * assert.deepStrictEqual(extend(f)([\"a\", \"b\", \"c\"]), [\"a,b,c\", \"b,c\", \"c\"]);\n *\n * @category Extend\n * @since 2.0.0\n */\nvar extend = function (f) { return function (wa) {\n    return wa.map(function (_, i) { return f(wa.slice(i)); });\n}; };\nexports.extend = extend;\n/**\n * `duplicate` returns an array containing the whole input `Array`,\n * then to the input `Array` dropping the first element, then to the input\n * `Array` dropping the first two elements, etc.\n * Derivable from `Extend`.\n *\n * @example\n * import { duplicate } from 'fp-ts/Array'\n *\n * assert.deepStrictEqual(duplicate([\"a\", \"b\", \"c\"]), [[\"a\", \"b\", \"c\"], [\"b\", \"c\"], [\"c\"]]);\n *\n * @category combinators\n * @since 2.0.0\n */\nexports.duplicate = (0, exports.extend)(function_1.identity);\n/**\n * Map and fold an `Array`.\n * Map the `Array` passing each value to the iterating function.\n * Then fold the results using the provided `Monoid`.\n *\n * @example\n * import { foldMap } from 'fp-ts/Array'\n *\n * const monoid = { concat: (a: string, b: string) => a + b, empty: \"\" };\n * const f = (s: string) => s.toUpperCase()\n * assert.deepStrictEqual(foldMap(monoid)(f)([\"a\", \"b\", \"c\"]), \"ABC\");\n *\n * @category Foldable\n * @since 2.0.0\n */\nexports.foldMap = RA.foldMap;\n/**\n * Same as [`foldMap`](#foldMap) but passing also the index to the iterating function.\n *\n * @example\n * import { foldMapWithIndex } from 'fp-ts/Array'\n *\n * const monoid = { concat: (a: string, b: string) => a + b, empty: \"\" };\n * const f = (index:number, s: string) => `${s.toUpperCase()}(${index})`\n * assert.deepStrictEqual(foldMapWithIndex(monoid)(f)([\"a\", \"b\", \"c\"]), \"A(0)B(1)C(2)\");\n *\n * @category FoldableWithIndex\n * @since 2.0.0\n */\nexports.foldMapWithIndex = RA.foldMapWithIndex;\n/**\n * Reduces an `Array`.\n *\n * `reduce` executes the supplied iterating function on each element of the array,\n * in order, passing in the element and the return value from the calculation on the preceding element.\n *\n * The first time that the iterating function is called there is no \"return value of the\n * previous calculation\", the initial value is used in its place.\n *\n * @example\n * import { reduce } from 'fp-ts/Array'\n *\n * assert.deepStrictEqual(reduce(5, (acc: number, cur: number) => acc * cur)([2, 3]), 5 * 2 * 3);\n *\n * @category Foldable\n * @since 2.0.0\n */\nexports.reduce = RA.reduce;\n/**\n * Same as [`reduce`](#reduce) but passing also the index to the iterating function.\n *\n * @example\n * import { reduceWithIndex } from 'fp-ts/Array'\n *\n * const f = (index: number, acc: string, cur: unknown) =>\n *   acc + (typeof cur === \"string\" ? cur.toUpperCase() + index : \"\");\n * assert.deepStrictEqual(reduceWithIndex(\"\", f)([2, \"a\", \"b\", null]), \"A1B2\");\n *\n * @category FoldableWithIndex\n * @since 2.0.0\n */\nexports.reduceWithIndex = RA.reduceWithIndex;\n/**\n * Same as [`reduce`](#reduce) but applied from the end to the start.\n *\n * *Note*: the iterating function in this case takes the accumulator as the last argument.\n *\n * @example\n * import { reduceRight } from 'fp-ts/Array'\n *\n * assert.deepStrictEqual(reduceRight(\"\", (cur: string, acc: string) => acc + cur)([\"a\", \"b\", \"c\"]), \"cba\");\n *\n * @category Foldable\n * @since 2.0.0\n */\nexports.reduceRight = RA.reduceRight;\n/**\n * Same as [`reduceRight`](#reduceRight) but passing also the index to the iterating function.\n *\n * @example\n * import { reduceRightWithIndex } from 'fp-ts/Array'\n *\n * const f = (index: number, cur: unknown, acc: string) =>\n *   acc + (typeof cur === \"string\" ? cur.toUpperCase() + index : \"\");\n * assert.deepStrictEqual(reduceRightWithIndex(\"\", f)([2, \"a\", \"b\", null]), \"B2A1\");\n *\n * @category FoldableWithIndex\n * @since 2.0.0\n */\nexports.reduceRightWithIndex = RA.reduceRightWithIndex;\n/**\n * Given an iterating function that returns a `HKT` (higher kinded type), `traverse`\n * applies the iterating function to each element of the `Array` and then [`sequence`](#sequence)-s\n * the results using the provided `Applicative`.\n *\n * E.g. suppose you have an `Array` and you want to format each element with a function\n * that returns a result or an error as `f = (a: A) => Either<Error, B>`, using `traverse`\n * you can apply `f` to all elements and directly obtain as a result an `Either<Error,Array<B>>`\n * i.e. an `Array<B>` if all the results are `B`, or an `Error` if some of the results\n * are `Error`s.\n *\n * @example\n * import { traverse } from 'fp-ts/Array'\n * import { Applicative, left, right } from \"fp-ts/lib/Either\";\n *\n * const f = (x: unknown) =>\n *   typeof x === \"string\" ? right(x.toUpperCase()) : left(new Error(\"not a string\"));\n * assert.deepStrictEqual(traverse(Applicative)(f)([\"a\", \"b\"]), right([\"A\", \"B\"]));\n * assert.deepStrictEqual(traverse(Applicative)(f)([\"a\", 5]), left(new Error(\"not a string\")));\n *\n * @category Traversable\n * @since 2.6.3\n */\nvar traverse = function (F) {\n    var traverseWithIndexF = (0, exports.traverseWithIndex)(F);\n    return function (f) { return traverseWithIndexF(function (_, a) { return f(a); }); };\n};\nexports.traverse = traverse;\n/**\n * `sequence` takes an `Array` where elements are `HKT<A>` (higher kinded type) and,\n * using an applicative of that `HKT`, returns an `HKT` of `Array<A>`.\n * E.g. it can turn an `Array<Either<Error, string>>` into an `Either<Error, Array<string>>`.\n *\n * `sequence` requires an `Applicative` of the `HKT` you are targeting, e.g. to turn an\n * `Array<Either<E, A>>` into an `Either<E, Array<A>>`, it needs an\n * `Applicative` for `Either`, to to turn an `Array<Option<A>>` into an `Option<Array<A>>`,\n * it needs an `Applicative` for `Option`.\n *\n * @example\n * import { sequence } from 'fp-ts/Array'\n * import { Applicative, left, right } from \"fp-ts/lib/Either\";\n *\n * assert.deepStrictEqual(sequence(Applicative)([right(\"a\"), right(\"b\")]), right([\"a\", \"b\"]));\n * assert.deepStrictEqual(\n *   sequence(Applicative)([right(\"a\"), left(new Error(\"not a string\"))]),\n *   left(new Error(\"not a string\"))\n * );\n *\n * @category Traversable\n * @since 2.6.3\n */\nvar sequence = function (F) { return function (ta) {\n    return _reduce(ta, F.of((0, exports.zero)()), function (fas, fa) {\n        return F.ap(F.map(fas, function (as) { return function (a) { return (0, function_1.pipe)(as, (0, exports.append)(a)); }; }), fa);\n    });\n}; };\nexports.sequence = sequence;\n/**\n * Same as [`traverse`](#traverse) but passing also the index to the iterating function.\n *\n * @example\n * import { traverseWithIndex } from 'fp-ts/Array'\n * import { Applicative, left, right } from \"fp-ts/lib/Either\";\n *\n * const f = (index:number, x:unknown) =>\n *   typeof x === \"string\" ? right(x.toUpperCase() + index) : left(new Error(\"not a string\"));\n * assert.deepStrictEqual(traverseWithIndex(Applicative)(f)([\"a\", \"b\"]), right([\"A0\", \"B1\"]));\n * assert.deepStrictEqual(traverseWithIndex(Applicative)(f)([\"a\", 5]), left(new Error(\"not a string\")));\n *\n * @category TraversableWithIndex\n * @since 2.6.3\n */\nvar traverseWithIndex = function (F) { return function (f) {\n    return (0, exports.reduceWithIndex)(F.of((0, exports.zero)()), function (i, fbs, a) {\n        return F.ap(F.map(fbs, function (bs) { return function (b) { return (0, function_1.pipe)(bs, (0, exports.append)(b)); }; }), f(i, a));\n    });\n}; };\nexports.traverseWithIndex = traverseWithIndex;\n/**\n * @category Witherable\n * @since 2.6.5\n */\nvar wither = function (F) {\n    var _witherF = _wither(F);\n    return function (f) { return function (fa) { return _witherF(fa, f); }; };\n};\nexports.wither = wither;\n/**\n * @category Witherable\n * @since 2.6.5\n */\nvar wilt = function (F) {\n    var _wiltF = _wilt(F);\n    return function (f) { return function (fa) { return _wiltF(fa, f); }; };\n};\nexports.wilt = wilt;\n/**\n * `unfold` takes a function `f` which returns an `Option` of a tuple containing an outcome\n * value and an input for the following iteration.\n * `unfold` applies `f` to the initial value `b` and then recursively to the second\n * element of the tuple contained in the returned `option` of the previous\n * calculation until `f` returns `Option.none`.\n *\n * @example\n * import { unfold } from 'fp-ts/Array'\n * import { option } from 'fp-ts'\n *\n * const f = (n: number) => {\n *   if (n <= 0) return option.none;\n *   const returnValue = n * 2;\n *   const inputForNextRound = n - 1;\n *   return option.some([returnValue, inputForNextRound] as const);\n * };\n * assert.deepStrictEqual(unfold(5, f), [10, 8, 6, 4, 2]);\n *\n * @category Unfoldable\n * @since 2.6.6\n */\nvar unfold = function (b, f) {\n    var out = [];\n    var bb = b;\n    // eslint-disable-next-line no-constant-condition\n    while (true) {\n        var mt = f(bb);\n        if (_.isSome(mt)) {\n            var _a = mt.value, a = _a[0], b_1 = _a[1];\n            out.push(a);\n            bb = b_1;\n        }\n        else {\n            break;\n        }\n    }\n    return out;\n};\nexports.unfold = unfold;\n// -------------------------------------------------------------------------------------\n// instances\n// -------------------------------------------------------------------------------------\n/**\n * @category instances\n * @since 2.0.0\n */\nexports.URI = 'Array';\n/**\n * `getShow` makes a `Show` for an `Array<A>` from a `Show` for\n * an `A`.\n *\n * @example\n * import { getShow } from 'fp-ts/Array'\n *\n * const numShow = { show: (n: number) => (n >= 0 ? `${n}` : `(${-n})`) };\n * assert.deepStrictEqual(getShow(numShow).show([-2, -1, 0, 1]), \"[(2), (1), 0, 1]\");\n *\n * @category instances\n * @since 2.0.0\n */\nexports.getShow = RA.getShow;\n/**\n * Get a `Semigroup` based on the concatenation of `Array`s.\n * See also [`getMonoid`](#getMonoid).\n *\n * @example\n * import { getSemigroup } from 'fp-ts/Array'\n *\n * const S = getSemigroup<number>();\n * assert.deepStrictEqual(S.concat([1, 2], [2, 3]), [1, 2, 2, 3]);\n *\n * @category instances\n * @since 2.10.0\n */\nvar getSemigroup = function () { return ({\n    concat: function (first, second) { return first.concat(second); }\n}); };\nexports.getSemigroup = getSemigroup;\n/**\n * Returns a `Monoid` for `Array<A>` based on the concatenation of `Array`s.\n *\n * @example\n * import { getMonoid } from 'fp-ts/Array'\n *\n * const M = getMonoid<number>()\n * assert.deepStrictEqual(M.concat([1, 2], [3, 4]), [1, 2, 3, 4])\n *\n * @category instances\n * @since 2.0.0\n */\nvar getMonoid = function () { return ({\n    concat: (0, exports.getSemigroup)().concat,\n    empty: []\n}); };\nexports.getMonoid = getMonoid;\n/**\n * Derives an `Eq` over the `Array` of a given element type from the `Eq` of that type. The derived `Eq` defines two\n * arrays as equal if all elements of both arrays are compared equal pairwise with the given `E`. In case of arrays of\n * different lengths, the result is non equality.\n *\n * @example\n * import * as S from 'fp-ts/string'\n * import { getEq } from 'fp-ts/Array'\n *\n * const E = getEq(S.Eq)\n * assert.strictEqual(E.equals(['a', 'b'], ['a', 'b']), true)\n * assert.strictEqual(E.equals(['a'], []), false)\n *\n * @category instances\n * @since 2.0.0\n */\nexports.getEq = RA.getEq;\n/**\n * Derives an `Ord` over the `Array` of a given element type from the `Ord` of that type. The ordering between two such\n * arrays is equal to: the first non equal comparison of each arrays elements taken pairwise in increasing order, in\n * case of equality over all the pairwise elements; the longest array is considered the greatest, if both arrays have\n * the same length, the result is equality.\n *\n * @example\n * import { getOrd } from 'fp-ts/Array'\n * import * as S from 'fp-ts/string'\n *\n * const O = getOrd(S.Ord)\n * assert.strictEqual(O.compare(['b'], ['a']), 1)\n * assert.strictEqual(O.compare(['a'], ['a']), 0)\n * assert.strictEqual(O.compare(['a'], ['b']), -1)\n *\n * @category instances\n * @since 2.0.0\n */\nexports.getOrd = RA.getOrd;\n/**\n * Get a `Semigroup` based on the union of the elements of `Array`s.\n * Elements which equal according to the provided `Eq` are included\n * only once in the result.\n * See also [`getUnionMonoid`](#getUnionMonoid).\n *\n * @example\n * import { getUnionSemigroup } from 'fp-ts/Array';\n * import { Eq } from 'fp-ts/number';\n *\n * const S = getUnionSemigroup<number>(Eq);\n * assert.deepStrictEqual(S.concat([1, 2], [2, 3]), [1, 2, 3]);\n *\n * @category instances\n * @since 2.11.0\n */\nvar getUnionSemigroup = function (E) {\n    var unionE = union(E);\n    return {\n        concat: function (first, second) { return unionE(second)(first); }\n    };\n};\nexports.getUnionSemigroup = getUnionSemigroup;\n/**\n * Get a `Monoid` based on the union of the elements of `Array`s.\n * Elements which equal according to the provided `Eq` are included\n * only once in the result.\n *\n * @example\n * import { getUnionMonoid } from 'fp-ts/Array'\n * import { Eq } from 'fp-ts/number';\n *\n * const M = getUnionMonoid<number>(Eq);\n * assert.deepStrictEqual(M.concat([1, 2], [2, 3]), [1, 2, 3]);\n * assert.deepStrictEqual(M.empty,[]);\n *\n * @category instances\n * @since 2.11.0\n */\nvar getUnionMonoid = function (E) { return ({\n    concat: (0, exports.getUnionSemigroup)(E).concat,\n    empty: []\n}); };\nexports.getUnionMonoid = getUnionMonoid;\n/**\n * Get a `Semigroup` based on the intersection of the elements of `Array`s.\n * Only elements present in the two arrays which are equal according to the\n * provided `Eq` are included in the result.\n *\n * @example\n * import { getIntersectionSemigroup } from 'fp-ts/Array'\n * import { Eq } from 'fp-ts/number';\n *\n * const S = getIntersectionSemigroup<number>(Eq);\n * assert.deepStrictEqual(S.concat([1, 2], [2, 3]), [2]);\n *\n * @category instances\n * @since 2.11.0\n */\nvar getIntersectionSemigroup = function (E) {\n    var intersectionE = intersection(E);\n    return {\n        concat: function (first, second) { return intersectionE(second)(first); }\n    };\n};\nexports.getIntersectionSemigroup = getIntersectionSemigroup;\n/**\n * Get a `Magma` for `Array` where the `concat` function is the differnce between\n * the first and the second array, i.e. the result contains all the elements of the\n * first array for which their is no equal element in the second array according\n * to the `Eq` provided.\n *\n *\n * @example\n * import { getDifferenceMagma } from 'fp-ts/Array'\n * import { Eq } from 'fp-ts/number';\n *\n * const S = getDifferenceMagma<number>(Eq);\n * assert.deepStrictEqual(S.concat([1, 2], [2, 3]), [1]);\n *\n * @category instances\n * @since 2.11.0\n */\nvar getDifferenceMagma = function (E) {\n    var differenceE = difference(E);\n    return {\n        concat: function (first, second) { return differenceE(second)(first); }\n    };\n};\nexports.getDifferenceMagma = getDifferenceMagma;\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Functor = {\n    URI: exports.URI,\n    map: _map\n};\n/**\n * Given an input an `Array` of functions, `flap` returns an `Array` containing\n * the results of applying each function to the given input.\n *\n * @example\n * import { flap } from 'fp-ts/Array'\n *\n * const funs = [\n *   (n: number) => `Double: ${n * 2}`,\n *   (n: number) => `Triple: ${n * 3}`,\n *   (n: number) => `Square: ${n * n}`,\n * ];\n * assert.deepStrictEqual(flap(4)(funs), ['Double: 8', 'Triple: 12', 'Square: 16']);\n *\n * @category combinators\n * @since 2.10.0\n */\nexports.flap = (0, Functor_1.flap)(exports.Functor);\n/**\n * @category instances\n * @since 2.10.0\n */\nexports.Pointed = {\n    URI: exports.URI,\n    of: exports.of\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.FunctorWithIndex = {\n    URI: exports.URI,\n    map: _map,\n    mapWithIndex: _mapWithIndex\n};\n/**\n * @category instances\n * @since 2.10.0\n */\nexports.Apply = {\n    URI: exports.URI,\n    map: _map,\n    ap: _ap\n};\n/**\n * Combine two effectful actions, keeping only the result of the first.\n *\n * Derivable from `Apply`.\n *\n * @category combinators\n * @since 2.5.0\n */\nexports.apFirst = (0, Apply_1.apFirst)(exports.Apply);\n/**\n * Combine two effectful actions, keeping only the result of the second.\n *\n * Derivable from `Apply`.\n *\n * @category combinators\n * @since 2.5.0\n */\nexports.apSecond = (0, Apply_1.apSecond)(exports.Apply);\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Applicative = {\n    URI: exports.URI,\n    map: _map,\n    ap: _ap,\n    of: exports.of\n};\n/**\n * @category instances\n * @since 2.10.0\n */\nexports.Chain = {\n    URI: exports.URI,\n    map: _map,\n    ap: _ap,\n    chain: _chain\n};\n/**\n * Composes computations in sequence, using the return value of one computation to determine the next computation and\n * keeping only the result of the first.\n *\n * Derivable from `Chain`.\n *\n * @category combinators\n * @since 2.0.0\n */\nexports.chainFirst = (0, Chain_1.chainFirst)(exports.Chain);\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Monad = {\n    URI: exports.URI,\n    map: _map,\n    ap: _ap,\n    of: exports.of,\n    chain: _chain\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Unfoldable = {\n    URI: exports.URI,\n    unfold: exports.unfold\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Alt = {\n    URI: exports.URI,\n    map: _map,\n    alt: _alt\n};\n/**\n * @category instances\n * @since 2.11.0\n */\nexports.Zero = {\n    URI: exports.URI,\n    zero: exports.zero\n};\n/**\n * @category constructors\n * @since 2.11.0\n */\nexports.guard = (0, Zero_1.guard)(exports.Zero, exports.Pointed);\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Alternative = {\n    URI: exports.URI,\n    map: _map,\n    ap: _ap,\n    of: exports.of,\n    alt: _alt,\n    zero: exports.zero\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Extend = {\n    URI: exports.URI,\n    map: _map,\n    extend: _extend\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Compactable = {\n    URI: exports.URI,\n    compact: exports.compact,\n    separate: exports.separate\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Filterable = {\n    URI: exports.URI,\n    map: _map,\n    compact: exports.compact,\n    separate: exports.separate,\n    filter: _filter,\n    filterMap: _filterMap,\n    partition: _partition,\n    partitionMap: _partitionMap\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.FilterableWithIndex = {\n    URI: exports.URI,\n    map: _map,\n    mapWithIndex: _mapWithIndex,\n    compact: exports.compact,\n    separate: exports.separate,\n    filter: _filter,\n    filterMap: _filterMap,\n    partition: _partition,\n    partitionMap: _partitionMap,\n    partitionMapWithIndex: _partitionMapWithIndex,\n    partitionWithIndex: _partitionWithIndex,\n    filterMapWithIndex: _filterMapWithIndex,\n    filterWithIndex: _filterWithIndex\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Foldable = {\n    URI: exports.URI,\n    reduce: _reduce,\n    foldMap: _foldMap,\n    reduceRight: _reduceRight\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.FoldableWithIndex = {\n    URI: exports.URI,\n    reduce: _reduce,\n    foldMap: _foldMap,\n    reduceRight: _reduceRight,\n    reduceWithIndex: _reduceWithIndex,\n    foldMapWithIndex: _foldMapWithIndex,\n    reduceRightWithIndex: _reduceRightWithIndex\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Traversable = {\n    URI: exports.URI,\n    map: _map,\n    reduce: _reduce,\n    foldMap: _foldMap,\n    reduceRight: _reduceRight,\n    traverse: _traverse,\n    sequence: exports.sequence\n};\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.TraversableWithIndex = {\n    URI: exports.URI,\n    map: _map,\n    mapWithIndex: _mapWithIndex,\n    reduce: _reduce,\n    foldMap: _foldMap,\n    reduceRight: _reduceRight,\n    reduceWithIndex: _reduceWithIndex,\n    foldMapWithIndex: _foldMapWithIndex,\n    reduceRightWithIndex: _reduceRightWithIndex,\n    traverse: _traverse,\n    sequence: exports.sequence,\n    traverseWithIndex: _traverseWithIndex\n};\nvar _wither = /*#__PURE__*/ (0, Witherable_1.witherDefault)(exports.Traversable, exports.Compactable);\nvar _wilt = /*#__PURE__*/ (0, Witherable_1.wiltDefault)(exports.Traversable, exports.Compactable);\n/**\n * @category instances\n * @since 2.7.0\n */\nexports.Witherable = {\n    URI: exports.URI,\n    map: _map,\n    compact: exports.compact,\n    separate: exports.separate,\n    filter: _filter,\n    filterMap: _filterMap,\n    partition: _partition,\n    partitionMap: _partitionMap,\n    reduce: _reduce,\n    foldMap: _foldMap,\n    reduceRight: _reduceRight,\n    traverse: _traverse,\n    sequence: exports.sequence,\n    wither: _wither,\n    wilt: _wilt\n};\n/**\n * @category ChainRec\n * @since 2.11.0\n */\nexports.chainRecDepthFirst = RA.chainRecDepthFirst;\n/**\n * @category instances\n * @since 2.11.0\n */\nexports.ChainRecDepthFirst = {\n    URI: exports.URI,\n    map: _map,\n    ap: _ap,\n    chain: _chain,\n    chainRec: _chainRecDepthFirst\n};\n/**\n * @category ChainRec\n * @since 2.11.0\n */\nexports.chainRecBreadthFirst = RA.chainRecBreadthFirst;\n/**\n * @category instances\n * @since 2.11.0\n */\nexports.ChainRecBreadthFirst = {\n    URI: exports.URI,\n    map: _map,\n    ap: _ap,\n    chain: _chain,\n    chainRec: _chainRecBreadthFirst\n};\n/**\n * Filter values inside a context.\n *\n * @since 2.11.0\n */\nexports.filterE = (0, Witherable_1.filterE)(exports.Witherable);\n/**\n * @category instances\n * @since 2.11.0\n */\nexports.FromEither = {\n    URI: exports.URI,\n    fromEither: exports.fromEither\n};\n/**\n * @category combinators\n * @since 2.11.0\n */\nexports.fromEitherK = (0, FromEither_1.fromEitherK)(exports.FromEither);\n// -------------------------------------------------------------------------------------\n// unsafe\n// -------------------------------------------------------------------------------------\n/**\n * @category unsafe\n * @since 2.0.0\n */\nexports.unsafeInsertAt = NEA.unsafeInsertAt;\n/**\n * @category unsafe\n * @since 2.0.0\n */\nvar unsafeUpdateAt = function (i, a, as) {\n    return (0, exports.isNonEmpty)(as) ? NEA.unsafeUpdateAt(i, a, as) : [];\n};\nexports.unsafeUpdateAt = unsafeUpdateAt;\n/**\n * @category unsafe\n * @since 2.0.0\n */\nvar unsafeDeleteAt = function (i, as) {\n    var xs = as.slice();\n    xs.splice(i, 1);\n    return xs;\n};\nexports.unsafeDeleteAt = unsafeDeleteAt;\n// -------------------------------------------------------------------------------------\n// utils\n// -------------------------------------------------------------------------------------\n/**\n * `every` tells if the provided predicate holds true for every element in the `Array`.\n *\n * @example\n * import { every } from 'fp-ts/Array'\n *\n * assert.equal(every((x: number) => x >= 0)([1, 2, 3]), true);\n * assert.equal(every((x: number) => x >= 0)([-1, 2, 3]), false);\n *\n * @since 2.9.0\n */\nexports.every = RA.every;\n/**\n * `some` tells if the provided predicate holds true at least for one element in the `Array`.\n *\n * @example\n * import { some } from 'fp-ts/Array'\n *\n * assert.equal(some((x: number) => x >= 0)([1, 2, 3]), true);\n * assert.equal(some((x: number) => x >= 10)([1, 2, 3]), false);\n *\n * @since 2.9.0\n */\nvar some = function (predicate) { return function (as) { return as.some(predicate); }; };\nexports.some = some;\n/**\n * Alias of [`some`](#some)\n *\n * @since 2.11.0\n */\nexports.exists = exports.some;\n/**\n * Places an element in between members of an `Array`, then folds the results using the provided `Monoid`.\n *\n * @example\n * import * as S from 'fp-ts/string'\n * import { intercalate } from 'fp-ts/Array'\n *\n * assert.deepStrictEqual(intercalate(S.Monoid)('-')(['a', 'b', 'c']), 'a-b-c')\n *\n * @since 2.12.0\n */\nexports.intercalate = RA.intercalate;\n// -------------------------------------------------------------------------------------\n// do notation\n// -------------------------------------------------------------------------------------\n/**\n * @since 2.9.0\n */\nexports.Do = (0, exports.of)(_.emptyRecord);\n/**\n * @since 2.8.0\n */\nexports.bindTo = (0, Functor_1.bindTo)(exports.Functor);\n/**\n * @since 2.8.0\n */\nexports.bind = (0, Chain_1.bind)(exports.Chain);\n// -------------------------------------------------------------------------------------\n// pipeable sequence S\n// -------------------------------------------------------------------------------------\n/**\n * @since 2.8.0\n */\nexports.apS = (0, Apply_1.apS)(exports.Apply);\n// -------------------------------------------------------------------------------------\n// deprecated\n// -------------------------------------------------------------------------------------\n/**\n * Use `NonEmptyArray` module instead.\n *\n * @category constructors\n * @since 2.0.0\n * @deprecated\n */\nexports.range = NEA.range;\n/**\n * Use a new `[]` instead.\n *\n * @since 2.0.0\n * @deprecated\n */\nexports.empty = [];\n/**\n * Use `prepend` instead.\n *\n * @category constructors\n * @since 2.0.0\n * @deprecated\n */\nexports.cons = NEA.cons;\n/**\n * Use `append` instead.\n *\n * @category constructors\n * @since 2.0.0\n * @deprecated\n */\nexports.snoc = NEA.snoc;\n/**\n * Use `prependAll` instead\n *\n * @category combinators\n * @since 2.9.0\n * @deprecated\n */\nexports.prependToAll = exports.prependAll;\n/**\n * This instance is deprecated, use small, specific instances instead.\n * For example if a function needs a `Functor` instance, pass `A.Functor` instead of `A.array`\n * (where `A` is from `import A from 'fp-ts/Array'`)\n *\n * @category instances\n * @since 2.0.0\n * @deprecated\n */\nexports.array = {\n    URI: exports.URI,\n    compact: exports.compact,\n    separate: exports.separate,\n    map: _map,\n    ap: _ap,\n    of: exports.of,\n    chain: _chain,\n    filter: _filter,\n    filterMap: _filterMap,\n    partition: _partition,\n    partitionMap: _partitionMap,\n    mapWithIndex: _mapWithIndex,\n    partitionMapWithIndex: _partitionMapWithIndex,\n    partitionWithIndex: _partitionWithIndex,\n    filterMapWithIndex: _filterMapWithIndex,\n    filterWithIndex: _filterWithIndex,\n    alt: _alt,\n    zero: exports.zero,\n    unfold: exports.unfold,\n    reduce: _reduce,\n    foldMap: _foldMap,\n    reduceRight: _reduceRight,\n    traverse: _traverse,\n    sequence: exports.sequence,\n    reduceWithIndex: _reduceWithIndex,\n    foldMapWithIndex: _foldMapWithIndex,\n    reduceRightWithIndex: _reduceRightWithIndex,\n    traverseWithIndex: _traverseWithIndex,\n    extend: _extend,\n    wither: _wither,\n    wilt: _wilt\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.endsWith = exports.startsWith = exports.includes = exports.split = exports.size = exports.isEmpty = exports.slice = exports.trimRight = exports.trimLeft = exports.trim = exports.replace = exports.toLowerCase = exports.toUpperCase = exports.isString = exports.Show = exports.Ord = exports.Monoid = exports.empty = exports.Semigroup = exports.Eq = void 0;\nvar ReadonlyNonEmptyArray_1 = require(\"./ReadonlyNonEmptyArray\");\n// -------------------------------------------------------------------------------------\n// instances\n// -------------------------------------------------------------------------------------\n/**\n * @example\n * import * as S from 'fp-ts/string'\n *\n * assert.deepStrictEqual(S.Eq.equals('a', 'a'), true)\n * assert.deepStrictEqual(S.Eq.equals('a', 'b'), false)\n *\n * @category instances\n * @since 2.10.0\n */\nexports.Eq = {\n    equals: function (first, second) { return first === second; }\n};\n/**\n * `string` semigroup under concatenation.\n *\n * @example\n * import * as S from 'fp-ts/string'\n *\n * assert.deepStrictEqual(S.Semigroup.concat('a', 'b'), 'ab')\n *\n * @category instances\n * @since 2.10.0\n */\nexports.Semigroup = {\n    concat: function (first, second) { return first + second; }\n};\n/**\n * An empty `string`.\n *\n * @since 2.10.0\n */\nexports.empty = '';\n/**\n * `string` monoid under concatenation.\n *\n * The `empty` value is `''`.\n *\n * @example\n * import * as S from 'fp-ts/string'\n *\n * assert.deepStrictEqual(S.Monoid.concat('a', 'b'), 'ab')\n * assert.deepStrictEqual(S.Monoid.concat('a', S.Monoid.empty), 'a')\n *\n * @category instances\n * @since 2.10.0\n */\nexports.Monoid = {\n    concat: exports.Semigroup.concat,\n    empty: exports.empty\n};\n/**\n * @example\n * import * as S from 'fp-ts/string'\n *\n * assert.deepStrictEqual(S.Ord.compare('a', 'a'), 0)\n * assert.deepStrictEqual(S.Ord.compare('a', 'b'), -1)\n * assert.deepStrictEqual(S.Ord.compare('b', 'a'), 1)\n *\n * @category instances\n * @since 2.10.0\n */\nexports.Ord = {\n    equals: exports.Eq.equals,\n    compare: function (first, second) { return (first < second ? -1 : first > second ? 1 : 0); }\n};\n/**\n * @example\n * import * as S from 'fp-ts/string'\n *\n * assert.deepStrictEqual(S.Show.show('a'), '\"a\"')\n *\n * @category instances\n * @since 2.10.0\n */\nexports.Show = {\n    show: function (s) { return JSON.stringify(s); }\n};\n// -------------------------------------------------------------------------------------\n// refinements\n// -------------------------------------------------------------------------------------\n/**\n * @example\n * import * as S from 'fp-ts/string'\n *\n * assert.deepStrictEqual(S.isString('a'), true)\n * assert.deepStrictEqual(S.isString(1), false)\n *\n * @category refinements\n * @since 2.11.0\n */\nvar isString = function (u) { return typeof u === 'string'; };\nexports.isString = isString;\n// -------------------------------------------------------------------------------------\n// combinators\n// -------------------------------------------------------------------------------------\n/**\n * @example\n * import * as S from 'fp-ts/string'\n * import { pipe } from 'fp-ts/function'\n *\n * assert.deepStrictEqual(pipe('a', S.toUpperCase), 'A')\n *\n * @category combinators\n * @since 2.11.0\n */\nvar toUpperCase = function (s) { return s.toUpperCase(); };\nexports.toUpperCase = toUpperCase;\n/**\n * @example\n * import * as S from 'fp-ts/string'\n * import { pipe } from 'fp-ts/function'\n *\n * assert.deepStrictEqual(pipe('A', S.toLowerCase), 'a')\n *\n * @category combinators\n * @since 2.11.0\n */\nvar toLowerCase = function (s) { return s.toLowerCase(); };\nexports.toLowerCase = toLowerCase;\n/**\n * @example\n * import * as S from 'fp-ts/string'\n * import { pipe } from 'fp-ts/function'\n *\n * assert.deepStrictEqual(pipe('abc', S.replace('b', 'd')), 'adc')\n *\n * @category combinators\n * @since 2.11.0\n */\nvar replace = function (searchValue, replaceValue) { return function (s) {\n    return s.replace(searchValue, replaceValue);\n}; };\nexports.replace = replace;\n/**\n * @example\n * import * as S from 'fp-ts/string'\n * import { pipe } from 'fp-ts/function'\n *\n * assert.deepStrictEqual(pipe(' a ', S.trim), 'a')\n *\n * @category combinators\n * @since 2.11.0\n */\nvar trim = function (s) { return s.trim(); };\nexports.trim = trim;\n/**\n * @example\n * import * as S from 'fp-ts/string'\n * import { pipe } from 'fp-ts/function'\n *\n * assert.deepStrictEqual(pipe(' a ', S.trimLeft), 'a ')\n *\n * @category combinators\n * @since 2.11.0\n */\nvar trimLeft = function (s) { return s.trimLeft(); };\nexports.trimLeft = trimLeft;\n/**\n * @example\n * import * as S from 'fp-ts/string'\n * import { pipe } from 'fp-ts/function'\n *\n * assert.deepStrictEqual(pipe(' a ', S.trimRight), ' a')\n *\n * @category combinators\n * @since 2.11.0\n */\nvar trimRight = function (s) { return s.trimRight(); };\nexports.trimRight = trimRight;\n/**\n * @example\n * import * as S from 'fp-ts/string'\n * import { pipe } from 'fp-ts/function'\n *\n * assert.deepStrictEqual(pipe('abcd', S.slice(1, 3)), 'bc')\n *\n * @category combinators\n * @since 2.11.0\n */\nvar slice = function (start, end) { return function (s) { return s.slice(start, end); }; };\nexports.slice = slice;\n// -------------------------------------------------------------------------------------\n// utils\n// -------------------------------------------------------------------------------------\n/**\n * Test whether a `string` is empty.\n *\n * @example\n * import * as S from 'fp-ts/string'\n * import { pipe } from 'fp-ts/function'\n *\n * assert.deepStrictEqual(pipe('', S.isEmpty), true)\n * assert.deepStrictEqual(pipe('a', S.isEmpty), false)\n *\n * @since 2.10.0\n */\nvar isEmpty = function (s) { return s.length === 0; };\nexports.isEmpty = isEmpty;\n/**\n * Calculate the number of characters in a `string`.\n *\n * @example\n * import * as S from 'fp-ts/string'\n * import { pipe } from 'fp-ts/function'\n *\n * assert.deepStrictEqual(pipe('abc', S.size), 3)\n *\n * @since 2.10.0\n */\nvar size = function (s) { return s.length; };\nexports.size = size;\n/**\n * @example\n * import * as S from 'fp-ts/string'\n * import { pipe } from 'fp-ts/function'\n *\n * assert.deepStrictEqual(pipe('abc', S.split('')), ['a', 'b', 'c'])\n * assert.deepStrictEqual(pipe('', S.split('')), [''])\n *\n * @since 2.11.0\n */\nvar split = function (separator) { return function (s) {\n    var out = s.split(separator);\n    return (0, ReadonlyNonEmptyArray_1.isNonEmpty)(out) ? out : [s];\n}; };\nexports.split = split;\n/**\n * @example\n * import * as S from 'fp-ts/string'\n * import { pipe } from 'fp-ts/function'\n *\n * assert.deepStrictEqual(pipe('abc', S.includes('b')), true)\n * assert.deepStrictEqual(pipe('abc', S.includes('d')), false)\n *\n * @since 2.11.0\n */\nvar includes = function (searchString, position) { return function (s) {\n    return s.includes(searchString, position);\n}; };\nexports.includes = includes;\n/**\n * @example\n * import * as S from 'fp-ts/string'\n * import { pipe } from 'fp-ts/function'\n *\n * assert.deepStrictEqual(pipe('abc', S.startsWith('a')), true)\n * assert.deepStrictEqual(pipe('bc', S.startsWith('a')), false)\n *\n * @since 2.11.0\n */\nvar startsWith = function (searchString, position) { return function (s) {\n    return s.startsWith(searchString, position);\n}; };\nexports.startsWith = startsWith;\n/**\n * @example\n * import * as S from 'fp-ts/string'\n * import { pipe } from 'fp-ts/function'\n *\n * assert.deepStrictEqual(pipe('abc', S.endsWith('c')), true)\n * assert.deepStrictEqual(pipe('ab', S.endsWith('c')), false)\n *\n * @since 2.11.0\n */\nvar endsWith = function (searchString, position) { return function (s) {\n    return s.endsWith(searchString, position);\n}; };\nexports.endsWith = endsWith;\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global global, define, System, Reflect, Promise */\r\nvar __extends;\r\nvar __assign;\r\nvar __rest;\r\nvar __decorate;\r\nvar __param;\r\nvar __metadata;\r\nvar __awaiter;\r\nvar __generator;\r\nvar __exportStar;\r\nvar __values;\r\nvar __read;\r\nvar __spread;\r\nvar __spreadArrays;\r\nvar __spreadArray;\r\nvar __await;\r\nvar __asyncGenerator;\r\nvar __asyncDelegator;\r\nvar __asyncValues;\r\nvar __makeTemplateObject;\r\nvar __importStar;\r\nvar __importDefault;\r\nvar __classPrivateFieldGet;\r\nvar __classPrivateFieldSet;\r\nvar __createBinding;\r\n(function (factory) {\r\n    var root = typeof global === \"object\" ? global : typeof self === \"object\" ? self : typeof this === \"object\" ? this : {};\r\n    if (typeof define === \"function\" && define.amd) {\r\n        define(\"tslib\", [\"exports\"], function (exports) { factory(createExporter(root, createExporter(exports))); });\r\n    }\r\n    else if (typeof module === \"object\" && typeof module.exports === \"object\") {\r\n        factory(createExporter(root, createExporter(module.exports)));\r\n    }\r\n    else {\r\n        factory(createExporter(root));\r\n    }\r\n    function createExporter(exports, previous) {\r\n        if (exports !== root) {\r\n            if (typeof Object.create === \"function\") {\r\n                Object.defineProperty(exports, \"__esModule\", { value: true });\r\n            }\r\n            else {\r\n                exports.__esModule = true;\r\n            }\r\n        }\r\n        return function (id, v) { return exports[id] = previous ? previous(id, v) : v; };\r\n    }\r\n})\r\n(function (exporter) {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n\r\n    __extends = function (d, b) {\r\n        if (typeof b !== \"function\" && b !== null)\r\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n\r\n    __assign = Object.assign || function (t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n\r\n    __rest = function (s, e) {\r\n        var t = {};\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n            t[p] = s[p];\r\n        if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n            for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n                if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                    t[p[i]] = s[p[i]];\r\n            }\r\n        return t;\r\n    };\r\n\r\n    __decorate = function (decorators, target, key, desc) {\r\n        var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n        if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n        else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n        return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n    };\r\n\r\n    __param = function (paramIndex, decorator) {\r\n        return function (target, key) { decorator(target, key, paramIndex); }\r\n    };\r\n\r\n    __metadata = function (metadataKey, metadataValue) {\r\n        if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n    };\r\n\r\n    __awaiter = function (thisArg, _arguments, P, generator) {\r\n        function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n        return new (P || (P = Promise))(function (resolve, reject) {\r\n            function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n            function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n            function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n            step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n        });\r\n    };\r\n\r\n    __generator = function (thisArg, body) {\r\n        var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n        return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n        function verb(n) { return function (v) { return step([n, v]); }; }\r\n        function step(op) {\r\n            if (f) throw new TypeError(\"Generator is already executing.\");\r\n            while (_) try {\r\n                if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n                if (y = 0, t) op = [op[0] & 2, t.value];\r\n                switch (op[0]) {\r\n                    case 0: case 1: t = op; break;\r\n                    case 4: _.label++; return { value: op[1], done: false };\r\n                    case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                    case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                    default:\r\n                        if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                        if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                        if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                        if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                        if (t[2]) _.ops.pop();\r\n                        _.trys.pop(); continue;\r\n                }\r\n                op = body.call(thisArg, _);\r\n            } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n            if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n        }\r\n    };\r\n\r\n    __exportStar = function(m, o) {\r\n        for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n    };\r\n\r\n    __createBinding = Object.create ? (function(o, m, k, k2) {\r\n        if (k2 === undefined) k2 = k;\r\n        Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n    }) : (function(o, m, k, k2) {\r\n        if (k2 === undefined) k2 = k;\r\n        o[k2] = m[k];\r\n    });\r\n\r\n    __values = function (o) {\r\n        var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n        if (m) return m.call(o);\r\n        if (o && typeof o.length === \"number\") return {\r\n            next: function () {\r\n                if (o && i >= o.length) o = void 0;\r\n                return { value: o && o[i++], done: !o };\r\n            }\r\n        };\r\n        throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n    };\r\n\r\n    __read = function (o, n) {\r\n        var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n        if (!m) return o;\r\n        var i = m.call(o), r, ar = [], e;\r\n        try {\r\n            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n        }\r\n        catch (error) { e = { error: error }; }\r\n        finally {\r\n            try {\r\n                if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n            }\r\n            finally { if (e) throw e.error; }\r\n        }\r\n        return ar;\r\n    };\r\n\r\n    /** @deprecated */\r\n    __spread = function () {\r\n        for (var ar = [], i = 0; i < arguments.length; i++)\r\n            ar = ar.concat(__read(arguments[i]));\r\n        return ar;\r\n    };\r\n\r\n    /** @deprecated */\r\n    __spreadArrays = function () {\r\n        for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n        for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n            for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n                r[k] = a[j];\r\n        return r;\r\n    };\r\n\r\n    __spreadArray = function (to, from, pack) {\r\n        if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n            if (ar || !(i in from)) {\r\n                if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n                ar[i] = from[i];\r\n            }\r\n        }\r\n        return to.concat(ar || Array.prototype.slice.call(from));\r\n    };\r\n\r\n    __await = function (v) {\r\n        return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n    };\r\n\r\n    __asyncGenerator = function (thisArg, _arguments, generator) {\r\n        if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n        var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n        return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n        function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n        function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n        function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r);  }\r\n        function fulfill(value) { resume(\"next\", value); }\r\n        function reject(value) { resume(\"throw\", value); }\r\n        function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n    };\r\n\r\n    __asyncDelegator = function (o) {\r\n        var i, p;\r\n        return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n        function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n    };\r\n\r\n    __asyncValues = function (o) {\r\n        if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n        var m = o[Symbol.asyncIterator], i;\r\n        return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n        function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n        function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n    };\r\n\r\n    __makeTemplateObject = function (cooked, raw) {\r\n        if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n        return cooked;\r\n    };\r\n\r\n    var __setModuleDefault = Object.create ? (function(o, v) {\r\n        Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n    }) : function(o, v) {\r\n        o[\"default\"] = v;\r\n    };\r\n\r\n    __importStar = function (mod) {\r\n        if (mod && mod.__esModule) return mod;\r\n        var result = {};\r\n        if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n        __setModuleDefault(result, mod);\r\n        return result;\r\n    };\r\n\r\n    __importDefault = function (mod) {\r\n        return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n    };\r\n\r\n    __classPrivateFieldGet = function (receiver, state, kind, f) {\r\n        if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n        if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n        return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n    };\r\n\r\n    __classPrivateFieldSet = function (receiver, state, value, kind, f) {\r\n        if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n        if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n        if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n        return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n    };\r\n\r\n    exporter(\"__extends\", __extends);\r\n    exporter(\"__assign\", __assign);\r\n    exporter(\"__rest\", __rest);\r\n    exporter(\"__decorate\", __decorate);\r\n    exporter(\"__param\", __param);\r\n    exporter(\"__metadata\", __metadata);\r\n    exporter(\"__awaiter\", __awaiter);\r\n    exporter(\"__generator\", __generator);\r\n    exporter(\"__exportStar\", __exportStar);\r\n    exporter(\"__createBinding\", __createBinding);\r\n    exporter(\"__values\", __values);\r\n    exporter(\"__read\", __read);\r\n    exporter(\"__spread\", __spread);\r\n    exporter(\"__spreadArrays\", __spreadArrays);\r\n    exporter(\"__spreadArray\", __spreadArray);\r\n    exporter(\"__await\", __await);\r\n    exporter(\"__asyncGenerator\", __asyncGenerator);\r\n    exporter(\"__asyncDelegator\", __asyncDelegator);\r\n    exporter(\"__asyncValues\", __asyncValues);\r\n    exporter(\"__makeTemplateObject\", __makeTemplateObject);\r\n    exporter(\"__importStar\", __importStar);\r\n    exporter(\"__importDefault\", __importDefault);\r\n    exporter(\"__classPrivateFieldGet\", __classPrivateFieldGet);\r\n    exporter(\"__classPrivateFieldSet\", __classPrivateFieldSet);\r\n});\r\n","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.JSON5 = factory());\n}(this, (function () { 'use strict';\n\n\tfunction createCommonjsModule(fn, module) {\n\t\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n\t}\n\n\tvar _global = createCommonjsModule(function (module) {\n\t// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\n\tvar global = module.exports = typeof window != 'undefined' && window.Math == Math\n\t  ? window : typeof self != 'undefined' && self.Math == Math ? self\n\t  // eslint-disable-next-line no-new-func\n\t  : Function('return this')();\n\tif (typeof __g == 'number') { __g = global; } // eslint-disable-line no-undef\n\t});\n\n\tvar _core = createCommonjsModule(function (module) {\n\tvar core = module.exports = { version: '2.6.5' };\n\tif (typeof __e == 'number') { __e = core; } // eslint-disable-line no-undef\n\t});\n\tvar _core_1 = _core.version;\n\n\tvar _isObject = function (it) {\n\t  return typeof it === 'object' ? it !== null : typeof it === 'function';\n\t};\n\n\tvar _anObject = function (it) {\n\t  if (!_isObject(it)) { throw TypeError(it + ' is not an object!'); }\n\t  return it;\n\t};\n\n\tvar _fails = function (exec) {\n\t  try {\n\t    return !!exec();\n\t  } catch (e) {\n\t    return true;\n\t  }\n\t};\n\n\t// Thank's IE8 for his funny defineProperty\n\tvar _descriptors = !_fails(function () {\n\t  return Object.defineProperty({}, 'a', { get: function () { return 7; } }).a != 7;\n\t});\n\n\tvar document = _global.document;\n\t// typeof document.createElement is 'object' in old IE\n\tvar is = _isObject(document) && _isObject(document.createElement);\n\tvar _domCreate = function (it) {\n\t  return is ? document.createElement(it) : {};\n\t};\n\n\tvar _ie8DomDefine = !_descriptors && !_fails(function () {\n\t  return Object.defineProperty(_domCreate('div'), 'a', { get: function () { return 7; } }).a != 7;\n\t});\n\n\t// 7.1.1 ToPrimitive(input [, PreferredType])\n\n\t// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n\t// and the second argument - flag - preferred type is a string\n\tvar _toPrimitive = function (it, S) {\n\t  if (!_isObject(it)) { return it; }\n\t  var fn, val;\n\t  if (S && typeof (fn = it.toString) == 'function' && !_isObject(val = fn.call(it))) { return val; }\n\t  if (typeof (fn = it.valueOf) == 'function' && !_isObject(val = fn.call(it))) { return val; }\n\t  if (!S && typeof (fn = it.toString) == 'function' && !_isObject(val = fn.call(it))) { return val; }\n\t  throw TypeError(\"Can't convert object to primitive value\");\n\t};\n\n\tvar dP = Object.defineProperty;\n\n\tvar f = _descriptors ? Object.defineProperty : function defineProperty(O, P, Attributes) {\n\t  _anObject(O);\n\t  P = _toPrimitive(P, true);\n\t  _anObject(Attributes);\n\t  if (_ie8DomDefine) { try {\n\t    return dP(O, P, Attributes);\n\t  } catch (e) { /* empty */ } }\n\t  if ('get' in Attributes || 'set' in Attributes) { throw TypeError('Accessors not supported!'); }\n\t  if ('value' in Attributes) { O[P] = Attributes.value; }\n\t  return O;\n\t};\n\n\tvar _objectDp = {\n\t\tf: f\n\t};\n\n\tvar _propertyDesc = function (bitmap, value) {\n\t  return {\n\t    enumerable: !(bitmap & 1),\n\t    configurable: !(bitmap & 2),\n\t    writable: !(bitmap & 4),\n\t    value: value\n\t  };\n\t};\n\n\tvar _hide = _descriptors ? function (object, key, value) {\n\t  return _objectDp.f(object, key, _propertyDesc(1, value));\n\t} : function (object, key, value) {\n\t  object[key] = value;\n\t  return object;\n\t};\n\n\tvar hasOwnProperty = {}.hasOwnProperty;\n\tvar _has = function (it, key) {\n\t  return hasOwnProperty.call(it, key);\n\t};\n\n\tvar id = 0;\n\tvar px = Math.random();\n\tvar _uid = function (key) {\n\t  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));\n\t};\n\n\tvar _library = false;\n\n\tvar _shared = createCommonjsModule(function (module) {\n\tvar SHARED = '__core-js_shared__';\n\tvar store = _global[SHARED] || (_global[SHARED] = {});\n\n\t(module.exports = function (key, value) {\n\t  return store[key] || (store[key] = value !== undefined ? value : {});\n\t})('versions', []).push({\n\t  version: _core.version,\n\t  mode: _library ? 'pure' : 'global',\n\t  copyright: ' 2019 Denis Pushkarev (zloirock.ru)'\n\t});\n\t});\n\n\tvar _functionToString = _shared('native-function-to-string', Function.toString);\n\n\tvar _redefine = createCommonjsModule(function (module) {\n\tvar SRC = _uid('src');\n\n\tvar TO_STRING = 'toString';\n\tvar TPL = ('' + _functionToString).split(TO_STRING);\n\n\t_core.inspectSource = function (it) {\n\t  return _functionToString.call(it);\n\t};\n\n\t(module.exports = function (O, key, val, safe) {\n\t  var isFunction = typeof val == 'function';\n\t  if (isFunction) { _has(val, 'name') || _hide(val, 'name', key); }\n\t  if (O[key] === val) { return; }\n\t  if (isFunction) { _has(val, SRC) || _hide(val, SRC, O[key] ? '' + O[key] : TPL.join(String(key))); }\n\t  if (O === _global) {\n\t    O[key] = val;\n\t  } else if (!safe) {\n\t    delete O[key];\n\t    _hide(O, key, val);\n\t  } else if (O[key]) {\n\t    O[key] = val;\n\t  } else {\n\t    _hide(O, key, val);\n\t  }\n\t// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative\n\t})(Function.prototype, TO_STRING, function toString() {\n\t  return typeof this == 'function' && this[SRC] || _functionToString.call(this);\n\t});\n\t});\n\n\tvar _aFunction = function (it) {\n\t  if (typeof it != 'function') { throw TypeError(it + ' is not a function!'); }\n\t  return it;\n\t};\n\n\t// optional / simple context binding\n\n\tvar _ctx = function (fn, that, length) {\n\t  _aFunction(fn);\n\t  if (that === undefined) { return fn; }\n\t  switch (length) {\n\t    case 1: return function (a) {\n\t      return fn.call(that, a);\n\t    };\n\t    case 2: return function (a, b) {\n\t      return fn.call(that, a, b);\n\t    };\n\t    case 3: return function (a, b, c) {\n\t      return fn.call(that, a, b, c);\n\t    };\n\t  }\n\t  return function (/* ...args */) {\n\t    return fn.apply(that, arguments);\n\t  };\n\t};\n\n\tvar PROTOTYPE = 'prototype';\n\n\tvar $export = function (type, name, source) {\n\t  var IS_FORCED = type & $export.F;\n\t  var IS_GLOBAL = type & $export.G;\n\t  var IS_STATIC = type & $export.S;\n\t  var IS_PROTO = type & $export.P;\n\t  var IS_BIND = type & $export.B;\n\t  var target = IS_GLOBAL ? _global : IS_STATIC ? _global[name] || (_global[name] = {}) : (_global[name] || {})[PROTOTYPE];\n\t  var exports = IS_GLOBAL ? _core : _core[name] || (_core[name] = {});\n\t  var expProto = exports[PROTOTYPE] || (exports[PROTOTYPE] = {});\n\t  var key, own, out, exp;\n\t  if (IS_GLOBAL) { source = name; }\n\t  for (key in source) {\n\t    // contains in native\n\t    own = !IS_FORCED && target && target[key] !== undefined;\n\t    // export native or passed\n\t    out = (own ? target : source)[key];\n\t    // bind timers to global for call from export context\n\t    exp = IS_BIND && own ? _ctx(out, _global) : IS_PROTO && typeof out == 'function' ? _ctx(Function.call, out) : out;\n\t    // extend global\n\t    if (target) { _redefine(target, key, out, type & $export.U); }\n\t    // export\n\t    if (exports[key] != out) { _hide(exports, key, exp); }\n\t    if (IS_PROTO && expProto[key] != out) { expProto[key] = out; }\n\t  }\n\t};\n\t_global.core = _core;\n\t// type bitmap\n\t$export.F = 1;   // forced\n\t$export.G = 2;   // global\n\t$export.S = 4;   // static\n\t$export.P = 8;   // proto\n\t$export.B = 16;  // bind\n\t$export.W = 32;  // wrap\n\t$export.U = 64;  // safe\n\t$export.R = 128; // real proto method for `library`\n\tvar _export = $export;\n\n\t// 7.1.4 ToInteger\n\tvar ceil = Math.ceil;\n\tvar floor = Math.floor;\n\tvar _toInteger = function (it) {\n\t  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);\n\t};\n\n\t// 7.2.1 RequireObjectCoercible(argument)\n\tvar _defined = function (it) {\n\t  if (it == undefined) { throw TypeError(\"Can't call method on  \" + it); }\n\t  return it;\n\t};\n\n\t// true  -> String#at\n\t// false -> String#codePointAt\n\tvar _stringAt = function (TO_STRING) {\n\t  return function (that, pos) {\n\t    var s = String(_defined(that));\n\t    var i = _toInteger(pos);\n\t    var l = s.length;\n\t    var a, b;\n\t    if (i < 0 || i >= l) { return TO_STRING ? '' : undefined; }\n\t    a = s.charCodeAt(i);\n\t    return a < 0xd800 || a > 0xdbff || i + 1 === l || (b = s.charCodeAt(i + 1)) < 0xdc00 || b > 0xdfff\n\t      ? TO_STRING ? s.charAt(i) : a\n\t      : TO_STRING ? s.slice(i, i + 2) : (a - 0xd800 << 10) + (b - 0xdc00) + 0x10000;\n\t  };\n\t};\n\n\tvar $at = _stringAt(false);\n\t_export(_export.P, 'String', {\n\t  // 21.1.3.3 String.prototype.codePointAt(pos)\n\t  codePointAt: function codePointAt(pos) {\n\t    return $at(this, pos);\n\t  }\n\t});\n\n\tvar codePointAt = _core.String.codePointAt;\n\n\tvar max = Math.max;\n\tvar min = Math.min;\n\tvar _toAbsoluteIndex = function (index, length) {\n\t  index = _toInteger(index);\n\t  return index < 0 ? max(index + length, 0) : min(index, length);\n\t};\n\n\tvar fromCharCode = String.fromCharCode;\n\tvar $fromCodePoint = String.fromCodePoint;\n\n\t// length should be 1, old FF problem\n\t_export(_export.S + _export.F * (!!$fromCodePoint && $fromCodePoint.length != 1), 'String', {\n\t  // 21.1.2.2 String.fromCodePoint(...codePoints)\n\t  fromCodePoint: function fromCodePoint(x) {\n\t    var arguments$1 = arguments;\n\t // eslint-disable-line no-unused-vars\n\t    var res = [];\n\t    var aLen = arguments.length;\n\t    var i = 0;\n\t    var code;\n\t    while (aLen > i) {\n\t      code = +arguments$1[i++];\n\t      if (_toAbsoluteIndex(code, 0x10ffff) !== code) { throw RangeError(code + ' is not a valid code point'); }\n\t      res.push(code < 0x10000\n\t        ? fromCharCode(code)\n\t        : fromCharCode(((code -= 0x10000) >> 10) + 0xd800, code % 0x400 + 0xdc00)\n\t      );\n\t    } return res.join('');\n\t  }\n\t});\n\n\tvar fromCodePoint = _core.String.fromCodePoint;\n\n\t// This is a generated file. Do not edit.\n\tvar Space_Separator = /[\\u1680\\u2000-\\u200A\\u202F\\u205F\\u3000]/;\n\tvar ID_Start = /[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u0860-\\u086A\\u08A0-\\u08B4\\u08B6-\\u08BD\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u09FC\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0AF9\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58-\\u0C5A\\u0C60\\u0C61\\u0C80\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D54-\\u0D56\\u0D5F-\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F5\\u13F8-\\u13FD\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u1884\\u1887-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1C80-\\u1C88\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312E\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FEA\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA7AE\\uA7B0-\\uA7B7\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA8FD\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB65\\uAB70-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]|\\uD800[\\uDC00-\\uDC0B\\uDC0D-\\uDC26\\uDC28-\\uDC3A\\uDC3C\\uDC3D\\uDC3F-\\uDC4D\\uDC50-\\uDC5D\\uDC80-\\uDCFA\\uDD40-\\uDD74\\uDE80-\\uDE9C\\uDEA0-\\uDED0\\uDF00-\\uDF1F\\uDF2D-\\uDF4A\\uDF50-\\uDF75\\uDF80-\\uDF9D\\uDFA0-\\uDFC3\\uDFC8-\\uDFCF\\uDFD1-\\uDFD5]|\\uD801[\\uDC00-\\uDC9D\\uDCB0-\\uDCD3\\uDCD8-\\uDCFB\\uDD00-\\uDD27\\uDD30-\\uDD63\\uDE00-\\uDF36\\uDF40-\\uDF55\\uDF60-\\uDF67]|\\uD802[\\uDC00-\\uDC05\\uDC08\\uDC0A-\\uDC35\\uDC37\\uDC38\\uDC3C\\uDC3F-\\uDC55\\uDC60-\\uDC76\\uDC80-\\uDC9E\\uDCE0-\\uDCF2\\uDCF4\\uDCF5\\uDD00-\\uDD15\\uDD20-\\uDD39\\uDD80-\\uDDB7\\uDDBE\\uDDBF\\uDE00\\uDE10-\\uDE13\\uDE15-\\uDE17\\uDE19-\\uDE33\\uDE60-\\uDE7C\\uDE80-\\uDE9C\\uDEC0-\\uDEC7\\uDEC9-\\uDEE4\\uDF00-\\uDF35\\uDF40-\\uDF55\\uDF60-\\uDF72\\uDF80-\\uDF91]|\\uD803[\\uDC00-\\uDC48\\uDC80-\\uDCB2\\uDCC0-\\uDCF2]|\\uD804[\\uDC03-\\uDC37\\uDC83-\\uDCAF\\uDCD0-\\uDCE8\\uDD03-\\uDD26\\uDD50-\\uDD72\\uDD76\\uDD83-\\uDDB2\\uDDC1-\\uDDC4\\uDDDA\\uDDDC\\uDE00-\\uDE11\\uDE13-\\uDE2B\\uDE80-\\uDE86\\uDE88\\uDE8A-\\uDE8D\\uDE8F-\\uDE9D\\uDE9F-\\uDEA8\\uDEB0-\\uDEDE\\uDF05-\\uDF0C\\uDF0F\\uDF10\\uDF13-\\uDF28\\uDF2A-\\uDF30\\uDF32\\uDF33\\uDF35-\\uDF39\\uDF3D\\uDF50\\uDF5D-\\uDF61]|\\uD805[\\uDC00-\\uDC34\\uDC47-\\uDC4A\\uDC80-\\uDCAF\\uDCC4\\uDCC5\\uDCC7\\uDD80-\\uDDAE\\uDDD8-\\uDDDB\\uDE00-\\uDE2F\\uDE44\\uDE80-\\uDEAA\\uDF00-\\uDF19]|\\uD806[\\uDCA0-\\uDCDF\\uDCFF\\uDE00\\uDE0B-\\uDE32\\uDE3A\\uDE50\\uDE5C-\\uDE83\\uDE86-\\uDE89\\uDEC0-\\uDEF8]|\\uD807[\\uDC00-\\uDC08\\uDC0A-\\uDC2E\\uDC40\\uDC72-\\uDC8F\\uDD00-\\uDD06\\uDD08\\uDD09\\uDD0B-\\uDD30\\uDD46]|\\uD808[\\uDC00-\\uDF99]|\\uD809[\\uDC00-\\uDC6E\\uDC80-\\uDD43]|[\\uD80C\\uD81C-\\uD820\\uD840-\\uD868\\uD86A-\\uD86C\\uD86F-\\uD872\\uD874-\\uD879][\\uDC00-\\uDFFF]|\\uD80D[\\uDC00-\\uDC2E]|\\uD811[\\uDC00-\\uDE46]|\\uD81A[\\uDC00-\\uDE38\\uDE40-\\uDE5E\\uDED0-\\uDEED\\uDF00-\\uDF2F\\uDF40-\\uDF43\\uDF63-\\uDF77\\uDF7D-\\uDF8F]|\\uD81B[\\uDF00-\\uDF44\\uDF50\\uDF93-\\uDF9F\\uDFE0\\uDFE1]|\\uD821[\\uDC00-\\uDFEC]|\\uD822[\\uDC00-\\uDEF2]|\\uD82C[\\uDC00-\\uDD1E\\uDD70-\\uDEFB]|\\uD82F[\\uDC00-\\uDC6A\\uDC70-\\uDC7C\\uDC80-\\uDC88\\uDC90-\\uDC99]|\\uD835[\\uDC00-\\uDC54\\uDC56-\\uDC9C\\uDC9E\\uDC9F\\uDCA2\\uDCA5\\uDCA6\\uDCA9-\\uDCAC\\uDCAE-\\uDCB9\\uDCBB\\uDCBD-\\uDCC3\\uDCC5-\\uDD05\\uDD07-\\uDD0A\\uDD0D-\\uDD14\\uDD16-\\uDD1C\\uDD1E-\\uDD39\\uDD3B-\\uDD3E\\uDD40-\\uDD44\\uDD46\\uDD4A-\\uDD50\\uDD52-\\uDEA5\\uDEA8-\\uDEC0\\uDEC2-\\uDEDA\\uDEDC-\\uDEFA\\uDEFC-\\uDF14\\uDF16-\\uDF34\\uDF36-\\uDF4E\\uDF50-\\uDF6E\\uDF70-\\uDF88\\uDF8A-\\uDFA8\\uDFAA-\\uDFC2\\uDFC4-\\uDFCB]|\\uD83A[\\uDC00-\\uDCC4\\uDD00-\\uDD43]|\\uD83B[\\uDE00-\\uDE03\\uDE05-\\uDE1F\\uDE21\\uDE22\\uDE24\\uDE27\\uDE29-\\uDE32\\uDE34-\\uDE37\\uDE39\\uDE3B\\uDE42\\uDE47\\uDE49\\uDE4B\\uDE4D-\\uDE4F\\uDE51\\uDE52\\uDE54\\uDE57\\uDE59\\uDE5B\\uDE5D\\uDE5F\\uDE61\\uDE62\\uDE64\\uDE67-\\uDE6A\\uDE6C-\\uDE72\\uDE74-\\uDE77\\uDE79-\\uDE7C\\uDE7E\\uDE80-\\uDE89\\uDE8B-\\uDE9B\\uDEA1-\\uDEA3\\uDEA5-\\uDEA9\\uDEAB-\\uDEBB]|\\uD869[\\uDC00-\\uDED6\\uDF00-\\uDFFF]|\\uD86D[\\uDC00-\\uDF34\\uDF40-\\uDFFF]|\\uD86E[\\uDC00-\\uDC1D\\uDC20-\\uDFFF]|\\uD873[\\uDC00-\\uDEA1\\uDEB0-\\uDFFF]|\\uD87A[\\uDC00-\\uDFE0]|\\uD87E[\\uDC00-\\uDE1D]/;\n\tvar ID_Continue = /[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u0860-\\u086A\\u08A0-\\u08B4\\u08B6-\\u08BD\\u08D4-\\u08E1\\u08E3-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u09FC\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0AF9-\\u0AFF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58-\\u0C5A\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C80-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D00-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D54-\\u0D57\\u0D5F-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F5\\u13F8-\\u13FD\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1C80-\\u1C88\\u1CD0-\\u1CD2\\u1CD4-\\u1CF9\\u1D00-\\u1DF9\\u1DFB-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312E\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FEA\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA7AE\\uA7B0-\\uA7B7\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C5\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA8FD\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB65\\uAB70-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2F\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]|\\uD800[\\uDC00-\\uDC0B\\uDC0D-\\uDC26\\uDC28-\\uDC3A\\uDC3C\\uDC3D\\uDC3F-\\uDC4D\\uDC50-\\uDC5D\\uDC80-\\uDCFA\\uDD40-\\uDD74\\uDDFD\\uDE80-\\uDE9C\\uDEA0-\\uDED0\\uDEE0\\uDF00-\\uDF1F\\uDF2D-\\uDF4A\\uDF50-\\uDF7A\\uDF80-\\uDF9D\\uDFA0-\\uDFC3\\uDFC8-\\uDFCF\\uDFD1-\\uDFD5]|\\uD801[\\uDC00-\\uDC9D\\uDCA0-\\uDCA9\\uDCB0-\\uDCD3\\uDCD8-\\uDCFB\\uDD00-\\uDD27\\uDD30-\\uDD63\\uDE00-\\uDF36\\uDF40-\\uDF55\\uDF60-\\uDF67]|\\uD802[\\uDC00-\\uDC05\\uDC08\\uDC0A-\\uDC35\\uDC37\\uDC38\\uDC3C\\uDC3F-\\uDC55\\uDC60-\\uDC76\\uDC80-\\uDC9E\\uDCE0-\\uDCF2\\uDCF4\\uDCF5\\uDD00-\\uDD15\\uDD20-\\uDD39\\uDD80-\\uDDB7\\uDDBE\\uDDBF\\uDE00-\\uDE03\\uDE05\\uDE06\\uDE0C-\\uDE13\\uDE15-\\uDE17\\uDE19-\\uDE33\\uDE38-\\uDE3A\\uDE3F\\uDE60-\\uDE7C\\uDE80-\\uDE9C\\uDEC0-\\uDEC7\\uDEC9-\\uDEE6\\uDF00-\\uDF35\\uDF40-\\uDF55\\uDF60-\\uDF72\\uDF80-\\uDF91]|\\uD803[\\uDC00-\\uDC48\\uDC80-\\uDCB2\\uDCC0-\\uDCF2]|\\uD804[\\uDC00-\\uDC46\\uDC66-\\uDC6F\\uDC7F-\\uDCBA\\uDCD0-\\uDCE8\\uDCF0-\\uDCF9\\uDD00-\\uDD34\\uDD36-\\uDD3F\\uDD50-\\uDD73\\uDD76\\uDD80-\\uDDC4\\uDDCA-\\uDDCC\\uDDD0-\\uDDDA\\uDDDC\\uDE00-\\uDE11\\uDE13-\\uDE37\\uDE3E\\uDE80-\\uDE86\\uDE88\\uDE8A-\\uDE8D\\uDE8F-\\uDE9D\\uDE9F-\\uDEA8\\uDEB0-\\uDEEA\\uDEF0-\\uDEF9\\uDF00-\\uDF03\\uDF05-\\uDF0C\\uDF0F\\uDF10\\uDF13-\\uDF28\\uDF2A-\\uDF30\\uDF32\\uDF33\\uDF35-\\uDF39\\uDF3C-\\uDF44\\uDF47\\uDF48\\uDF4B-\\uDF4D\\uDF50\\uDF57\\uDF5D-\\uDF63\\uDF66-\\uDF6C\\uDF70-\\uDF74]|\\uD805[\\uDC00-\\uDC4A\\uDC50-\\uDC59\\uDC80-\\uDCC5\\uDCC7\\uDCD0-\\uDCD9\\uDD80-\\uDDB5\\uDDB8-\\uDDC0\\uDDD8-\\uDDDD\\uDE00-\\uDE40\\uDE44\\uDE50-\\uDE59\\uDE80-\\uDEB7\\uDEC0-\\uDEC9\\uDF00-\\uDF19\\uDF1D-\\uDF2B\\uDF30-\\uDF39]|\\uD806[\\uDCA0-\\uDCE9\\uDCFF\\uDE00-\\uDE3E\\uDE47\\uDE50-\\uDE83\\uDE86-\\uDE99\\uDEC0-\\uDEF8]|\\uD807[\\uDC00-\\uDC08\\uDC0A-\\uDC36\\uDC38-\\uDC40\\uDC50-\\uDC59\\uDC72-\\uDC8F\\uDC92-\\uDCA7\\uDCA9-\\uDCB6\\uDD00-\\uDD06\\uDD08\\uDD09\\uDD0B-\\uDD36\\uDD3A\\uDD3C\\uDD3D\\uDD3F-\\uDD47\\uDD50-\\uDD59]|\\uD808[\\uDC00-\\uDF99]|\\uD809[\\uDC00-\\uDC6E\\uDC80-\\uDD43]|[\\uD80C\\uD81C-\\uD820\\uD840-\\uD868\\uD86A-\\uD86C\\uD86F-\\uD872\\uD874-\\uD879][\\uDC00-\\uDFFF]|\\uD80D[\\uDC00-\\uDC2E]|\\uD811[\\uDC00-\\uDE46]|\\uD81A[\\uDC00-\\uDE38\\uDE40-\\uDE5E\\uDE60-\\uDE69\\uDED0-\\uDEED\\uDEF0-\\uDEF4\\uDF00-\\uDF36\\uDF40-\\uDF43\\uDF50-\\uDF59\\uDF63-\\uDF77\\uDF7D-\\uDF8F]|\\uD81B[\\uDF00-\\uDF44\\uDF50-\\uDF7E\\uDF8F-\\uDF9F\\uDFE0\\uDFE1]|\\uD821[\\uDC00-\\uDFEC]|\\uD822[\\uDC00-\\uDEF2]|\\uD82C[\\uDC00-\\uDD1E\\uDD70-\\uDEFB]|\\uD82F[\\uDC00-\\uDC6A\\uDC70-\\uDC7C\\uDC80-\\uDC88\\uDC90-\\uDC99\\uDC9D\\uDC9E]|\\uD834[\\uDD65-\\uDD69\\uDD6D-\\uDD72\\uDD7B-\\uDD82\\uDD85-\\uDD8B\\uDDAA-\\uDDAD\\uDE42-\\uDE44]|\\uD835[\\uDC00-\\uDC54\\uDC56-\\uDC9C\\uDC9E\\uDC9F\\uDCA2\\uDCA5\\uDCA6\\uDCA9-\\uDCAC\\uDCAE-\\uDCB9\\uDCBB\\uDCBD-\\uDCC3\\uDCC5-\\uDD05\\uDD07-\\uDD0A\\uDD0D-\\uDD14\\uDD16-\\uDD1C\\uDD1E-\\uDD39\\uDD3B-\\uDD3E\\uDD40-\\uDD44\\uDD46\\uDD4A-\\uDD50\\uDD52-\\uDEA5\\uDEA8-\\uDEC0\\uDEC2-\\uDEDA\\uDEDC-\\uDEFA\\uDEFC-\\uDF14\\uDF16-\\uDF34\\uDF36-\\uDF4E\\uDF50-\\uDF6E\\uDF70-\\uDF88\\uDF8A-\\uDFA8\\uDFAA-\\uDFC2\\uDFC4-\\uDFCB\\uDFCE-\\uDFFF]|\\uD836[\\uDE00-\\uDE36\\uDE3B-\\uDE6C\\uDE75\\uDE84\\uDE9B-\\uDE9F\\uDEA1-\\uDEAF]|\\uD838[\\uDC00-\\uDC06\\uDC08-\\uDC18\\uDC1B-\\uDC21\\uDC23\\uDC24\\uDC26-\\uDC2A]|\\uD83A[\\uDC00-\\uDCC4\\uDCD0-\\uDCD6\\uDD00-\\uDD4A\\uDD50-\\uDD59]|\\uD83B[\\uDE00-\\uDE03\\uDE05-\\uDE1F\\uDE21\\uDE22\\uDE24\\uDE27\\uDE29-\\uDE32\\uDE34-\\uDE37\\uDE39\\uDE3B\\uDE42\\uDE47\\uDE49\\uDE4B\\uDE4D-\\uDE4F\\uDE51\\uDE52\\uDE54\\uDE57\\uDE59\\uDE5B\\uDE5D\\uDE5F\\uDE61\\uDE62\\uDE64\\uDE67-\\uDE6A\\uDE6C-\\uDE72\\uDE74-\\uDE77\\uDE79-\\uDE7C\\uDE7E\\uDE80-\\uDE89\\uDE8B-\\uDE9B\\uDEA1-\\uDEA3\\uDEA5-\\uDEA9\\uDEAB-\\uDEBB]|\\uD869[\\uDC00-\\uDED6\\uDF00-\\uDFFF]|\\uD86D[\\uDC00-\\uDF34\\uDF40-\\uDFFF]|\\uD86E[\\uDC00-\\uDC1D\\uDC20-\\uDFFF]|\\uD873[\\uDC00-\\uDEA1\\uDEB0-\\uDFFF]|\\uD87A[\\uDC00-\\uDFE0]|\\uD87E[\\uDC00-\\uDE1D]|\\uDB40[\\uDD00-\\uDDEF]/;\n\n\tvar unicode = {\n\t\tSpace_Separator: Space_Separator,\n\t\tID_Start: ID_Start,\n\t\tID_Continue: ID_Continue\n\t};\n\n\tvar util = {\n\t    isSpaceSeparator: function isSpaceSeparator (c) {\n\t        return typeof c === 'string' && unicode.Space_Separator.test(c)\n\t    },\n\n\t    isIdStartChar: function isIdStartChar (c) {\n\t        return typeof c === 'string' && (\n\t            (c >= 'a' && c <= 'z') ||\n\t        (c >= 'A' && c <= 'Z') ||\n\t        (c === '$') || (c === '_') ||\n\t        unicode.ID_Start.test(c)\n\t        )\n\t    },\n\n\t    isIdContinueChar: function isIdContinueChar (c) {\n\t        return typeof c === 'string' && (\n\t            (c >= 'a' && c <= 'z') ||\n\t        (c >= 'A' && c <= 'Z') ||\n\t        (c >= '0' && c <= '9') ||\n\t        (c === '$') || (c === '_') ||\n\t        (c === '\\u200C') || (c === '\\u200D') ||\n\t        unicode.ID_Continue.test(c)\n\t        )\n\t    },\n\n\t    isDigit: function isDigit (c) {\n\t        return typeof c === 'string' && /[0-9]/.test(c)\n\t    },\n\n\t    isHexDigit: function isHexDigit (c) {\n\t        return typeof c === 'string' && /[0-9A-Fa-f]/.test(c)\n\t    },\n\t};\n\n\tvar source;\n\tvar parseState;\n\tvar stack;\n\tvar pos;\n\tvar line;\n\tvar column;\n\tvar token;\n\tvar key;\n\tvar root;\n\n\tvar parse = function parse (text, reviver) {\n\t    source = String(text);\n\t    parseState = 'start';\n\t    stack = [];\n\t    pos = 0;\n\t    line = 1;\n\t    column = 0;\n\t    token = undefined;\n\t    key = undefined;\n\t    root = undefined;\n\n\t    do {\n\t        token = lex();\n\n\t        // This code is unreachable.\n\t        // if (!parseStates[parseState]) {\n\t        //     throw invalidParseState()\n\t        // }\n\n\t        parseStates[parseState]();\n\t    } while (token.type !== 'eof')\n\n\t    if (typeof reviver === 'function') {\n\t        return internalize({'': root}, '', reviver)\n\t    }\n\n\t    return root\n\t};\n\n\tfunction internalize (holder, name, reviver) {\n\t    var value = holder[name];\n\t    if (value != null && typeof value === 'object') {\n\t        for (var key in value) {\n\t            var replacement = internalize(value, key, reviver);\n\t            if (replacement === undefined) {\n\t                delete value[key];\n\t            } else {\n\t                value[key] = replacement;\n\t            }\n\t        }\n\t    }\n\n\t    return reviver.call(holder, name, value)\n\t}\n\n\tvar lexState;\n\tvar buffer;\n\tvar doubleQuote;\n\tvar sign;\n\tvar c;\n\n\tfunction lex () {\n\t    lexState = 'default';\n\t    buffer = '';\n\t    doubleQuote = false;\n\t    sign = 1;\n\n\t    for (;;) {\n\t        c = peek();\n\n\t        // This code is unreachable.\n\t        // if (!lexStates[lexState]) {\n\t        //     throw invalidLexState(lexState)\n\t        // }\n\n\t        var token = lexStates[lexState]();\n\t        if (token) {\n\t            return token\n\t        }\n\t    }\n\t}\n\n\tfunction peek () {\n\t    if (source[pos]) {\n\t        return String.fromCodePoint(source.codePointAt(pos))\n\t    }\n\t}\n\n\tfunction read () {\n\t    var c = peek();\n\n\t    if (c === '\\n') {\n\t        line++;\n\t        column = 0;\n\t    } else if (c) {\n\t        column += c.length;\n\t    } else {\n\t        column++;\n\t    }\n\n\t    if (c) {\n\t        pos += c.length;\n\t    }\n\n\t    return c\n\t}\n\n\tvar lexStates = {\n\t    default: function default$1 () {\n\t        switch (c) {\n\t        case '\\t':\n\t        case '\\v':\n\t        case '\\f':\n\t        case ' ':\n\t        case '\\u00A0':\n\t        case '\\uFEFF':\n\t        case '\\n':\n\t        case '\\r':\n\t        case '\\u2028':\n\t        case '\\u2029':\n\t            read();\n\t            return\n\n\t        case '/':\n\t            read();\n\t            lexState = 'comment';\n\t            return\n\n\t        case undefined:\n\t            read();\n\t            return newToken('eof')\n\t        }\n\n\t        if (util.isSpaceSeparator(c)) {\n\t            read();\n\t            return\n\t        }\n\n\t        // This code is unreachable.\n\t        // if (!lexStates[parseState]) {\n\t        //     throw invalidLexState(parseState)\n\t        // }\n\n\t        return lexStates[parseState]()\n\t    },\n\n\t    comment: function comment () {\n\t        switch (c) {\n\t        case '*':\n\t            read();\n\t            lexState = 'multiLineComment';\n\t            return\n\n\t        case '/':\n\t            read();\n\t            lexState = 'singleLineComment';\n\t            return\n\t        }\n\n\t        throw invalidChar(read())\n\t    },\n\n\t    multiLineComment: function multiLineComment () {\n\t        switch (c) {\n\t        case '*':\n\t            read();\n\t            lexState = 'multiLineCommentAsterisk';\n\t            return\n\n\t        case undefined:\n\t            throw invalidChar(read())\n\t        }\n\n\t        read();\n\t    },\n\n\t    multiLineCommentAsterisk: function multiLineCommentAsterisk () {\n\t        switch (c) {\n\t        case '*':\n\t            read();\n\t            return\n\n\t        case '/':\n\t            read();\n\t            lexState = 'default';\n\t            return\n\n\t        case undefined:\n\t            throw invalidChar(read())\n\t        }\n\n\t        read();\n\t        lexState = 'multiLineComment';\n\t    },\n\n\t    singleLineComment: function singleLineComment () {\n\t        switch (c) {\n\t        case '\\n':\n\t        case '\\r':\n\t        case '\\u2028':\n\t        case '\\u2029':\n\t            read();\n\t            lexState = 'default';\n\t            return\n\n\t        case undefined:\n\t            read();\n\t            return newToken('eof')\n\t        }\n\n\t        read();\n\t    },\n\n\t    value: function value () {\n\t        switch (c) {\n\t        case '{':\n\t        case '[':\n\t            return newToken('punctuator', read())\n\n\t        case 'n':\n\t            read();\n\t            literal('ull');\n\t            return newToken('null', null)\n\n\t        case 't':\n\t            read();\n\t            literal('rue');\n\t            return newToken('boolean', true)\n\n\t        case 'f':\n\t            read();\n\t            literal('alse');\n\t            return newToken('boolean', false)\n\n\t        case '-':\n\t        case '+':\n\t            if (read() === '-') {\n\t                sign = -1;\n\t            }\n\n\t            lexState = 'sign';\n\t            return\n\n\t        case '.':\n\t            buffer = read();\n\t            lexState = 'decimalPointLeading';\n\t            return\n\n\t        case '0':\n\t            buffer = read();\n\t            lexState = 'zero';\n\t            return\n\n\t        case '1':\n\t        case '2':\n\t        case '3':\n\t        case '4':\n\t        case '5':\n\t        case '6':\n\t        case '7':\n\t        case '8':\n\t        case '9':\n\t            buffer = read();\n\t            lexState = 'decimalInteger';\n\t            return\n\n\t        case 'I':\n\t            read();\n\t            literal('nfinity');\n\t            return newToken('numeric', Infinity)\n\n\t        case 'N':\n\t            read();\n\t            literal('aN');\n\t            return newToken('numeric', NaN)\n\n\t        case '\"':\n\t        case \"'\":\n\t            doubleQuote = (read() === '\"');\n\t            buffer = '';\n\t            lexState = 'string';\n\t            return\n\t        }\n\n\t        throw invalidChar(read())\n\t    },\n\n\t    identifierNameStartEscape: function identifierNameStartEscape () {\n\t        if (c !== 'u') {\n\t            throw invalidChar(read())\n\t        }\n\n\t        read();\n\t        var u = unicodeEscape();\n\t        switch (u) {\n\t        case '$':\n\t        case '_':\n\t            break\n\n\t        default:\n\t            if (!util.isIdStartChar(u)) {\n\t                throw invalidIdentifier()\n\t            }\n\n\t            break\n\t        }\n\n\t        buffer += u;\n\t        lexState = 'identifierName';\n\t    },\n\n\t    identifierName: function identifierName () {\n\t        switch (c) {\n\t        case '$':\n\t        case '_':\n\t        case '\\u200C':\n\t        case '\\u200D':\n\t            buffer += read();\n\t            return\n\n\t        case '\\\\':\n\t            read();\n\t            lexState = 'identifierNameEscape';\n\t            return\n\t        }\n\n\t        if (util.isIdContinueChar(c)) {\n\t            buffer += read();\n\t            return\n\t        }\n\n\t        return newToken('identifier', buffer)\n\t    },\n\n\t    identifierNameEscape: function identifierNameEscape () {\n\t        if (c !== 'u') {\n\t            throw invalidChar(read())\n\t        }\n\n\t        read();\n\t        var u = unicodeEscape();\n\t        switch (u) {\n\t        case '$':\n\t        case '_':\n\t        case '\\u200C':\n\t        case '\\u200D':\n\t            break\n\n\t        default:\n\t            if (!util.isIdContinueChar(u)) {\n\t                throw invalidIdentifier()\n\t            }\n\n\t            break\n\t        }\n\n\t        buffer += u;\n\t        lexState = 'identifierName';\n\t    },\n\n\t    sign: function sign$1 () {\n\t        switch (c) {\n\t        case '.':\n\t            buffer = read();\n\t            lexState = 'decimalPointLeading';\n\t            return\n\n\t        case '0':\n\t            buffer = read();\n\t            lexState = 'zero';\n\t            return\n\n\t        case '1':\n\t        case '2':\n\t        case '3':\n\t        case '4':\n\t        case '5':\n\t        case '6':\n\t        case '7':\n\t        case '8':\n\t        case '9':\n\t            buffer = read();\n\t            lexState = 'decimalInteger';\n\t            return\n\n\t        case 'I':\n\t            read();\n\t            literal('nfinity');\n\t            return newToken('numeric', sign * Infinity)\n\n\t        case 'N':\n\t            read();\n\t            literal('aN');\n\t            return newToken('numeric', NaN)\n\t        }\n\n\t        throw invalidChar(read())\n\t    },\n\n\t    zero: function zero () {\n\t        switch (c) {\n\t        case '.':\n\t            buffer += read();\n\t            lexState = 'decimalPoint';\n\t            return\n\n\t        case 'e':\n\t        case 'E':\n\t            buffer += read();\n\t            lexState = 'decimalExponent';\n\t            return\n\n\t        case 'x':\n\t        case 'X':\n\t            buffer += read();\n\t            lexState = 'hexadecimal';\n\t            return\n\t        }\n\n\t        return newToken('numeric', sign * 0)\n\t    },\n\n\t    decimalInteger: function decimalInteger () {\n\t        switch (c) {\n\t        case '.':\n\t            buffer += read();\n\t            lexState = 'decimalPoint';\n\t            return\n\n\t        case 'e':\n\t        case 'E':\n\t            buffer += read();\n\t            lexState = 'decimalExponent';\n\t            return\n\t        }\n\n\t        if (util.isDigit(c)) {\n\t            buffer += read();\n\t            return\n\t        }\n\n\t        return newToken('numeric', sign * Number(buffer))\n\t    },\n\n\t    decimalPointLeading: function decimalPointLeading () {\n\t        if (util.isDigit(c)) {\n\t            buffer += read();\n\t            lexState = 'decimalFraction';\n\t            return\n\t        }\n\n\t        throw invalidChar(read())\n\t    },\n\n\t    decimalPoint: function decimalPoint () {\n\t        switch (c) {\n\t        case 'e':\n\t        case 'E':\n\t            buffer += read();\n\t            lexState = 'decimalExponent';\n\t            return\n\t        }\n\n\t        if (util.isDigit(c)) {\n\t            buffer += read();\n\t            lexState = 'decimalFraction';\n\t            return\n\t        }\n\n\t        return newToken('numeric', sign * Number(buffer))\n\t    },\n\n\t    decimalFraction: function decimalFraction () {\n\t        switch (c) {\n\t        case 'e':\n\t        case 'E':\n\t            buffer += read();\n\t            lexState = 'decimalExponent';\n\t            return\n\t        }\n\n\t        if (util.isDigit(c)) {\n\t            buffer += read();\n\t            return\n\t        }\n\n\t        return newToken('numeric', sign * Number(buffer))\n\t    },\n\n\t    decimalExponent: function decimalExponent () {\n\t        switch (c) {\n\t        case '+':\n\t        case '-':\n\t            buffer += read();\n\t            lexState = 'decimalExponentSign';\n\t            return\n\t        }\n\n\t        if (util.isDigit(c)) {\n\t            buffer += read();\n\t            lexState = 'decimalExponentInteger';\n\t            return\n\t        }\n\n\t        throw invalidChar(read())\n\t    },\n\n\t    decimalExponentSign: function decimalExponentSign () {\n\t        if (util.isDigit(c)) {\n\t            buffer += read();\n\t            lexState = 'decimalExponentInteger';\n\t            return\n\t        }\n\n\t        throw invalidChar(read())\n\t    },\n\n\t    decimalExponentInteger: function decimalExponentInteger () {\n\t        if (util.isDigit(c)) {\n\t            buffer += read();\n\t            return\n\t        }\n\n\t        return newToken('numeric', sign * Number(buffer))\n\t    },\n\n\t    hexadecimal: function hexadecimal () {\n\t        if (util.isHexDigit(c)) {\n\t            buffer += read();\n\t            lexState = 'hexadecimalInteger';\n\t            return\n\t        }\n\n\t        throw invalidChar(read())\n\t    },\n\n\t    hexadecimalInteger: function hexadecimalInteger () {\n\t        if (util.isHexDigit(c)) {\n\t            buffer += read();\n\t            return\n\t        }\n\n\t        return newToken('numeric', sign * Number(buffer))\n\t    },\n\n\t    string: function string () {\n\t        switch (c) {\n\t        case '\\\\':\n\t            read();\n\t            buffer += escape();\n\t            return\n\n\t        case '\"':\n\t            if (doubleQuote) {\n\t                read();\n\t                return newToken('string', buffer)\n\t            }\n\n\t            buffer += read();\n\t            return\n\n\t        case \"'\":\n\t            if (!doubleQuote) {\n\t                read();\n\t                return newToken('string', buffer)\n\t            }\n\n\t            buffer += read();\n\t            return\n\n\t        case '\\n':\n\t        case '\\r':\n\t            throw invalidChar(read())\n\n\t        case '\\u2028':\n\t        case '\\u2029':\n\t            separatorChar(c);\n\t            break\n\n\t        case undefined:\n\t            throw invalidChar(read())\n\t        }\n\n\t        buffer += read();\n\t    },\n\n\t    start: function start () {\n\t        switch (c) {\n\t        case '{':\n\t        case '[':\n\t            return newToken('punctuator', read())\n\n\t        // This code is unreachable since the default lexState handles eof.\n\t        // case undefined:\n\t        //     return newToken('eof')\n\t        }\n\n\t        lexState = 'value';\n\t    },\n\n\t    beforePropertyName: function beforePropertyName () {\n\t        switch (c) {\n\t        case '$':\n\t        case '_':\n\t            buffer = read();\n\t            lexState = 'identifierName';\n\t            return\n\n\t        case '\\\\':\n\t            read();\n\t            lexState = 'identifierNameStartEscape';\n\t            return\n\n\t        case '}':\n\t            return newToken('punctuator', read())\n\n\t        case '\"':\n\t        case \"'\":\n\t            doubleQuote = (read() === '\"');\n\t            lexState = 'string';\n\t            return\n\t        }\n\n\t        if (util.isIdStartChar(c)) {\n\t            buffer += read();\n\t            lexState = 'identifierName';\n\t            return\n\t        }\n\n\t        throw invalidChar(read())\n\t    },\n\n\t    afterPropertyName: function afterPropertyName () {\n\t        if (c === ':') {\n\t            return newToken('punctuator', read())\n\t        }\n\n\t        throw invalidChar(read())\n\t    },\n\n\t    beforePropertyValue: function beforePropertyValue () {\n\t        lexState = 'value';\n\t    },\n\n\t    afterPropertyValue: function afterPropertyValue () {\n\t        switch (c) {\n\t        case ',':\n\t        case '}':\n\t            return newToken('punctuator', read())\n\t        }\n\n\t        throw invalidChar(read())\n\t    },\n\n\t    beforeArrayValue: function beforeArrayValue () {\n\t        if (c === ']') {\n\t            return newToken('punctuator', read())\n\t        }\n\n\t        lexState = 'value';\n\t    },\n\n\t    afterArrayValue: function afterArrayValue () {\n\t        switch (c) {\n\t        case ',':\n\t        case ']':\n\t            return newToken('punctuator', read())\n\t        }\n\n\t        throw invalidChar(read())\n\t    },\n\n\t    end: function end () {\n\t        // This code is unreachable since it's handled by the default lexState.\n\t        // if (c === undefined) {\n\t        //     read()\n\t        //     return newToken('eof')\n\t        // }\n\n\t        throw invalidChar(read())\n\t    },\n\t};\n\n\tfunction newToken (type, value) {\n\t    return {\n\t        type: type,\n\t        value: value,\n\t        line: line,\n\t        column: column,\n\t    }\n\t}\n\n\tfunction literal (s) {\n\t    for (var i = 0, list = s; i < list.length; i += 1) {\n\t        var c = list[i];\n\n\t        var p = peek();\n\n\t        if (p !== c) {\n\t            throw invalidChar(read())\n\t        }\n\n\t        read();\n\t    }\n\t}\n\n\tfunction escape () {\n\t    var c = peek();\n\t    switch (c) {\n\t    case 'b':\n\t        read();\n\t        return '\\b'\n\n\t    case 'f':\n\t        read();\n\t        return '\\f'\n\n\t    case 'n':\n\t        read();\n\t        return '\\n'\n\n\t    case 'r':\n\t        read();\n\t        return '\\r'\n\n\t    case 't':\n\t        read();\n\t        return '\\t'\n\n\t    case 'v':\n\t        read();\n\t        return '\\v'\n\n\t    case '0':\n\t        read();\n\t        if (util.isDigit(peek())) {\n\t            throw invalidChar(read())\n\t        }\n\n\t        return '\\0'\n\n\t    case 'x':\n\t        read();\n\t        return hexEscape()\n\n\t    case 'u':\n\t        read();\n\t        return unicodeEscape()\n\n\t    case '\\n':\n\t    case '\\u2028':\n\t    case '\\u2029':\n\t        read();\n\t        return ''\n\n\t    case '\\r':\n\t        read();\n\t        if (peek() === '\\n') {\n\t            read();\n\t        }\n\n\t        return ''\n\n\t    case '1':\n\t    case '2':\n\t    case '3':\n\t    case '4':\n\t    case '5':\n\t    case '6':\n\t    case '7':\n\t    case '8':\n\t    case '9':\n\t        throw invalidChar(read())\n\n\t    case undefined:\n\t        throw invalidChar(read())\n\t    }\n\n\t    return read()\n\t}\n\n\tfunction hexEscape () {\n\t    var buffer = '';\n\t    var c = peek();\n\n\t    if (!util.isHexDigit(c)) {\n\t        throw invalidChar(read())\n\t    }\n\n\t    buffer += read();\n\n\t    c = peek();\n\t    if (!util.isHexDigit(c)) {\n\t        throw invalidChar(read())\n\t    }\n\n\t    buffer += read();\n\n\t    return String.fromCodePoint(parseInt(buffer, 16))\n\t}\n\n\tfunction unicodeEscape () {\n\t    var buffer = '';\n\t    var count = 4;\n\n\t    while (count-- > 0) {\n\t        var c = peek();\n\t        if (!util.isHexDigit(c)) {\n\t            throw invalidChar(read())\n\t        }\n\n\t        buffer += read();\n\t    }\n\n\t    return String.fromCodePoint(parseInt(buffer, 16))\n\t}\n\n\tvar parseStates = {\n\t    start: function start () {\n\t        if (token.type === 'eof') {\n\t            throw invalidEOF()\n\t        }\n\n\t        push();\n\t    },\n\n\t    beforePropertyName: function beforePropertyName () {\n\t        switch (token.type) {\n\t        case 'identifier':\n\t        case 'string':\n\t            key = token.value;\n\t            parseState = 'afterPropertyName';\n\t            return\n\n\t        case 'punctuator':\n\t            // This code is unreachable since it's handled by the lexState.\n\t            // if (token.value !== '}') {\n\t            //     throw invalidToken()\n\t            // }\n\n\t            pop();\n\t            return\n\n\t        case 'eof':\n\t            throw invalidEOF()\n\t        }\n\n\t        // This code is unreachable since it's handled by the lexState.\n\t        // throw invalidToken()\n\t    },\n\n\t    afterPropertyName: function afterPropertyName () {\n\t        // This code is unreachable since it's handled by the lexState.\n\t        // if (token.type !== 'punctuator' || token.value !== ':') {\n\t        //     throw invalidToken()\n\t        // }\n\n\t        if (token.type === 'eof') {\n\t            throw invalidEOF()\n\t        }\n\n\t        parseState = 'beforePropertyValue';\n\t    },\n\n\t    beforePropertyValue: function beforePropertyValue () {\n\t        if (token.type === 'eof') {\n\t            throw invalidEOF()\n\t        }\n\n\t        push();\n\t    },\n\n\t    beforeArrayValue: function beforeArrayValue () {\n\t        if (token.type === 'eof') {\n\t            throw invalidEOF()\n\t        }\n\n\t        if (token.type === 'punctuator' && token.value === ']') {\n\t            pop();\n\t            return\n\t        }\n\n\t        push();\n\t    },\n\n\t    afterPropertyValue: function afterPropertyValue () {\n\t        // This code is unreachable since it's handled by the lexState.\n\t        // if (token.type !== 'punctuator') {\n\t        //     throw invalidToken()\n\t        // }\n\n\t        if (token.type === 'eof') {\n\t            throw invalidEOF()\n\t        }\n\n\t        switch (token.value) {\n\t        case ',':\n\t            parseState = 'beforePropertyName';\n\t            return\n\n\t        case '}':\n\t            pop();\n\t        }\n\n\t        // This code is unreachable since it's handled by the lexState.\n\t        // throw invalidToken()\n\t    },\n\n\t    afterArrayValue: function afterArrayValue () {\n\t        // This code is unreachable since it's handled by the lexState.\n\t        // if (token.type !== 'punctuator') {\n\t        //     throw invalidToken()\n\t        // }\n\n\t        if (token.type === 'eof') {\n\t            throw invalidEOF()\n\t        }\n\n\t        switch (token.value) {\n\t        case ',':\n\t            parseState = 'beforeArrayValue';\n\t            return\n\n\t        case ']':\n\t            pop();\n\t        }\n\n\t        // This code is unreachable since it's handled by the lexState.\n\t        // throw invalidToken()\n\t    },\n\n\t    end: function end () {\n\t        // This code is unreachable since it's handled by the lexState.\n\t        // if (token.type !== 'eof') {\n\t        //     throw invalidToken()\n\t        // }\n\t    },\n\t};\n\n\tfunction push () {\n\t    var value;\n\n\t    switch (token.type) {\n\t    case 'punctuator':\n\t        switch (token.value) {\n\t        case '{':\n\t            value = {};\n\t            break\n\n\t        case '[':\n\t            value = [];\n\t            break\n\t        }\n\n\t        break\n\n\t    case 'null':\n\t    case 'boolean':\n\t    case 'numeric':\n\t    case 'string':\n\t        value = token.value;\n\t        break\n\n\t    // This code is unreachable.\n\t    // default:\n\t    //     throw invalidToken()\n\t    }\n\n\t    if (root === undefined) {\n\t        root = value;\n\t    } else {\n\t        var parent = stack[stack.length - 1];\n\t        if (Array.isArray(parent)) {\n\t            parent.push(value);\n\t        } else {\n\t            parent[key] = value;\n\t        }\n\t    }\n\n\t    if (value !== null && typeof value === 'object') {\n\t        stack.push(value);\n\n\t        if (Array.isArray(value)) {\n\t            parseState = 'beforeArrayValue';\n\t        } else {\n\t            parseState = 'beforePropertyName';\n\t        }\n\t    } else {\n\t        var current = stack[stack.length - 1];\n\t        if (current == null) {\n\t            parseState = 'end';\n\t        } else if (Array.isArray(current)) {\n\t            parseState = 'afterArrayValue';\n\t        } else {\n\t            parseState = 'afterPropertyValue';\n\t        }\n\t    }\n\t}\n\n\tfunction pop () {\n\t    stack.pop();\n\n\t    var current = stack[stack.length - 1];\n\t    if (current == null) {\n\t        parseState = 'end';\n\t    } else if (Array.isArray(current)) {\n\t        parseState = 'afterArrayValue';\n\t    } else {\n\t        parseState = 'afterPropertyValue';\n\t    }\n\t}\n\n\t// This code is unreachable.\n\t// function invalidParseState () {\n\t//     return new Error(`JSON5: invalid parse state '${parseState}'`)\n\t// }\n\n\t// This code is unreachable.\n\t// function invalidLexState (state) {\n\t//     return new Error(`JSON5: invalid lex state '${state}'`)\n\t// }\n\n\tfunction invalidChar (c) {\n\t    if (c === undefined) {\n\t        return syntaxError((\"JSON5: invalid end of input at \" + line + \":\" + column))\n\t    }\n\n\t    return syntaxError((\"JSON5: invalid character '\" + (formatChar(c)) + \"' at \" + line + \":\" + column))\n\t}\n\n\tfunction invalidEOF () {\n\t    return syntaxError((\"JSON5: invalid end of input at \" + line + \":\" + column))\n\t}\n\n\t// This code is unreachable.\n\t// function invalidToken () {\n\t//     if (token.type === 'eof') {\n\t//         return syntaxError(`JSON5: invalid end of input at ${line}:${column}`)\n\t//     }\n\n\t//     const c = String.fromCodePoint(token.value.codePointAt(0))\n\t//     return syntaxError(`JSON5: invalid character '${formatChar(c)}' at ${line}:${column}`)\n\t// }\n\n\tfunction invalidIdentifier () {\n\t    column -= 5;\n\t    return syntaxError((\"JSON5: invalid identifier character at \" + line + \":\" + column))\n\t}\n\n\tfunction separatorChar (c) {\n\t    console.warn((\"JSON5: '\" + (formatChar(c)) + \"' in strings is not valid ECMAScript; consider escaping\"));\n\t}\n\n\tfunction formatChar (c) {\n\t    var replacements = {\n\t        \"'\": \"\\\\'\",\n\t        '\"': '\\\\\"',\n\t        '\\\\': '\\\\\\\\',\n\t        '\\b': '\\\\b',\n\t        '\\f': '\\\\f',\n\t        '\\n': '\\\\n',\n\t        '\\r': '\\\\r',\n\t        '\\t': '\\\\t',\n\t        '\\v': '\\\\v',\n\t        '\\0': '\\\\0',\n\t        '\\u2028': '\\\\u2028',\n\t        '\\u2029': '\\\\u2029',\n\t    };\n\n\t    if (replacements[c]) {\n\t        return replacements[c]\n\t    }\n\n\t    if (c < ' ') {\n\t        var hexString = c.charCodeAt(0).toString(16);\n\t        return '\\\\x' + ('00' + hexString).substring(hexString.length)\n\t    }\n\n\t    return c\n\t}\n\n\tfunction syntaxError (message) {\n\t    var err = new SyntaxError(message);\n\t    err.lineNumber = line;\n\t    err.columnNumber = column;\n\t    return err\n\t}\n\n\tvar stringify = function stringify (value, replacer, space) {\n\t    var stack = [];\n\t    var indent = '';\n\t    var propertyList;\n\t    var replacerFunc;\n\t    var gap = '';\n\t    var quote;\n\n\t    if (\n\t        replacer != null &&\n\t        typeof replacer === 'object' &&\n\t        !Array.isArray(replacer)\n\t    ) {\n\t        space = replacer.space;\n\t        quote = replacer.quote;\n\t        replacer = replacer.replacer;\n\t    }\n\n\t    if (typeof replacer === 'function') {\n\t        replacerFunc = replacer;\n\t    } else if (Array.isArray(replacer)) {\n\t        propertyList = [];\n\t        for (var i = 0, list = replacer; i < list.length; i += 1) {\n\t            var v = list[i];\n\n\t            var item = (void 0);\n\n\t            if (typeof v === 'string') {\n\t                item = v;\n\t            } else if (\n\t                typeof v === 'number' ||\n\t                v instanceof String ||\n\t                v instanceof Number\n\t            ) {\n\t                item = String(v);\n\t            }\n\n\t            if (item !== undefined && propertyList.indexOf(item) < 0) {\n\t                propertyList.push(item);\n\t            }\n\t        }\n\t    }\n\n\t    if (space instanceof Number) {\n\t        space = Number(space);\n\t    } else if (space instanceof String) {\n\t        space = String(space);\n\t    }\n\n\t    if (typeof space === 'number') {\n\t        if (space > 0) {\n\t            space = Math.min(10, Math.floor(space));\n\t            gap = '          '.substr(0, space);\n\t        }\n\t    } else if (typeof space === 'string') {\n\t        gap = space.substr(0, 10);\n\t    }\n\n\t    return serializeProperty('', {'': value})\n\n\t    function serializeProperty (key, holder) {\n\t        var value = holder[key];\n\t        if (value != null) {\n\t            if (typeof value.toJSON5 === 'function') {\n\t                value = value.toJSON5(key);\n\t            } else if (typeof value.toJSON === 'function') {\n\t                value = value.toJSON(key);\n\t            }\n\t        }\n\n\t        if (replacerFunc) {\n\t            value = replacerFunc.call(holder, key, value);\n\t        }\n\n\t        if (value instanceof Number) {\n\t            value = Number(value);\n\t        } else if (value instanceof String) {\n\t            value = String(value);\n\t        } else if (value instanceof Boolean) {\n\t            value = value.valueOf();\n\t        }\n\n\t        switch (value) {\n\t        case null: return 'null'\n\t        case true: return 'true'\n\t        case false: return 'false'\n\t        }\n\n\t        if (typeof value === 'string') {\n\t            return quoteString(value, false)\n\t        }\n\n\t        if (typeof value === 'number') {\n\t            return String(value)\n\t        }\n\n\t        if (typeof value === 'object') {\n\t            return Array.isArray(value) ? serializeArray(value) : serializeObject(value)\n\t        }\n\n\t        return undefined\n\t    }\n\n\t    function quoteString (value) {\n\t        var quotes = {\n\t            \"'\": 0.1,\n\t            '\"': 0.2,\n\t        };\n\n\t        var replacements = {\n\t            \"'\": \"\\\\'\",\n\t            '\"': '\\\\\"',\n\t            '\\\\': '\\\\\\\\',\n\t            '\\b': '\\\\b',\n\t            '\\f': '\\\\f',\n\t            '\\n': '\\\\n',\n\t            '\\r': '\\\\r',\n\t            '\\t': '\\\\t',\n\t            '\\v': '\\\\v',\n\t            '\\0': '\\\\0',\n\t            '\\u2028': '\\\\u2028',\n\t            '\\u2029': '\\\\u2029',\n\t        };\n\n\t        var product = '';\n\n\t        for (var i = 0; i < value.length; i++) {\n\t            var c = value[i];\n\t            switch (c) {\n\t            case \"'\":\n\t            case '\"':\n\t                quotes[c]++;\n\t                product += c;\n\t                continue\n\n\t            case '\\0':\n\t                if (util.isDigit(value[i + 1])) {\n\t                    product += '\\\\x00';\n\t                    continue\n\t                }\n\t            }\n\n\t            if (replacements[c]) {\n\t                product += replacements[c];\n\t                continue\n\t            }\n\n\t            if (c < ' ') {\n\t                var hexString = c.charCodeAt(0).toString(16);\n\t                product += '\\\\x' + ('00' + hexString).substring(hexString.length);\n\t                continue\n\t            }\n\n\t            product += c;\n\t        }\n\n\t        var quoteChar = quote || Object.keys(quotes).reduce(function (a, b) { return (quotes[a] < quotes[b]) ? a : b; });\n\n\t        product = product.replace(new RegExp(quoteChar, 'g'), replacements[quoteChar]);\n\n\t        return quoteChar + product + quoteChar\n\t    }\n\n\t    function serializeObject (value) {\n\t        if (stack.indexOf(value) >= 0) {\n\t            throw TypeError('Converting circular structure to JSON5')\n\t        }\n\n\t        stack.push(value);\n\n\t        var stepback = indent;\n\t        indent = indent + gap;\n\n\t        var keys = propertyList || Object.keys(value);\n\t        var partial = [];\n\t        for (var i = 0, list = keys; i < list.length; i += 1) {\n\t            var key = list[i];\n\n\t            var propertyString = serializeProperty(key, value);\n\t            if (propertyString !== undefined) {\n\t                var member = serializeKey(key) + ':';\n\t                if (gap !== '') {\n\t                    member += ' ';\n\t                }\n\t                member += propertyString;\n\t                partial.push(member);\n\t            }\n\t        }\n\n\t        var final;\n\t        if (partial.length === 0) {\n\t            final = '{}';\n\t        } else {\n\t            var properties;\n\t            if (gap === '') {\n\t                properties = partial.join(',');\n\t                final = '{' + properties + '}';\n\t            } else {\n\t                var separator = ',\\n' + indent;\n\t                properties = partial.join(separator);\n\t                final = '{\\n' + indent + properties + ',\\n' + stepback + '}';\n\t            }\n\t        }\n\n\t        stack.pop();\n\t        indent = stepback;\n\t        return final\n\t    }\n\n\t    function serializeKey (key) {\n\t        if (key.length === 0) {\n\t            return quoteString(key, true)\n\t        }\n\n\t        var firstChar = String.fromCodePoint(key.codePointAt(0));\n\t        if (!util.isIdStartChar(firstChar)) {\n\t            return quoteString(key, true)\n\t        }\n\n\t        for (var i = firstChar.length; i < key.length; i++) {\n\t            if (!util.isIdContinueChar(String.fromCodePoint(key.codePointAt(i)))) {\n\t                return quoteString(key, true)\n\t            }\n\t        }\n\n\t        return key\n\t    }\n\n\t    function serializeArray (value) {\n\t        if (stack.indexOf(value) >= 0) {\n\t            throw TypeError('Converting circular structure to JSON5')\n\t        }\n\n\t        stack.push(value);\n\n\t        var stepback = indent;\n\t        indent = indent + gap;\n\n\t        var partial = [];\n\t        for (var i = 0; i < value.length; i++) {\n\t            var propertyString = serializeProperty(String(i), value);\n\t            partial.push((propertyString !== undefined) ? propertyString : 'null');\n\t        }\n\n\t        var final;\n\t        if (partial.length === 0) {\n\t            final = '[]';\n\t        } else {\n\t            if (gap === '') {\n\t                var properties = partial.join(',');\n\t                final = '[' + properties + ']';\n\t            } else {\n\t                var separator = ',\\n' + indent;\n\t                var properties$1 = partial.join(separator);\n\t                final = '[\\n' + indent + properties$1 + ',\\n' + stepback + ']';\n\t            }\n\t        }\n\n\t        stack.pop();\n\t        indent = stepback;\n\t        return final\n\t    }\n\t};\n\n\tvar JSON5 = {\n\t    parse: parse,\n\t    stringify: stringify,\n\t};\n\n\tvar lib = JSON5;\n\n\tvar es5 = lib;\n\n\treturn es5;\n\n})));\n","import { sort } from 'fp-ts/lib/Array.js';\nimport { pipe } from 'fp-ts/lib/function.js';\nimport * as S from 'fp-ts/lib/string.js';\nimport * as N from 'fp-ts/lib/number.js';\nimport { reverse as reverseOrd, contramap } from 'fp-ts/lib/Ord.js';\nimport {minMaxAvg as arrayMinMaxAg} from './collections/Arrays.js';\n\n///  Sorting functions are unit tested\n\nexport type Primitive = string | number;\nexport type KeyValue = readonly [key: string, value: Primitive];\n\nconst byKey = (reverse:boolean = false) => pipe(\n  reverse ? reverseOrd(S.Ord) : S.Ord, \n  contramap((v:KeyValue) => v[0])\n);\n\nexport const byValueString = (reverse:boolean = false) => pipe(\n  reverse ? reverseOrd(S.Ord) : S.Ord, \n  contramap((v:KeyValue) => v[1] as string)\n);\n\nconst byValueNumber = (reverse:boolean = false) => pipe(\n  reverse ? reverseOrd(N.Ord) : N.Ord, \n  contramap((v:KeyValue) => v[1] as number)\n);\n\nexport const sortByKey = (reverse:boolean = false) => sort<KeyValue>(byKey(reverse));\nexport const sortByValueString = (reverse:boolean = false) => sort<KeyValue>(byValueString(reverse));\nexport const sortByValueNumber = (reverse:boolean = false) => sort<KeyValue>(byValueNumber(reverse));\n\n// eslint-disable-next-line functional/prefer-readonly-type\nexport type SortingFn = (data:KeyValue[]) => KeyValue[];\n\nexport const getSorter = (sortStyle:`value` | `valueReverse` | `key` | `keyReverse`) => {\n  switch (sortStyle) {\n  case `value`:\n    return sortByValueNumber(false);\n  case `valueReverse`:\n    return sortByValueNumber(true);\n  case `key`:\n    return sortByKey(false);\n  case `keyReverse`:\n    return sortByKey(true);\n  default:\n    throw new Error(`Unknown sorting value '${sortStyle}'. Expecting: value, valueReverse, key or keyReverse`);\n  }\n};\n\n\nexport const minMaxAvg = (entries:readonly KeyValue[], conversionFn?:(v:KeyValue) => number) => {\n  if (conversionFn === undefined) conversionFn = (v:KeyValue) => v[1] as number;\n  const values = entries.map<number>(conversionFn);\n  return arrayMinMaxAg(values);\n};","/**\n * Functions for working with primitive arrays, regardless of type\n * See Also: NumericArrays.ts\n */\n\nimport { integer as guardInteger } from '../Guards.js';\nimport { defaultRandom, RandomSource } from '../Random.js';\nimport { IsEqual, isEqualDefault, isEqualValueDefault, ToString } from '../Util.js';\n\nexport * from './NumericArrays.js';\n\n/**\n * Throws an error if `array` parameter is not a valid array\n * \n * ```js\n * import { guardArray } from 'https://unpkg.com/ixfx/dist/arrays.js';\n * guardArray(someVariable);\n * ```\n * @private\n * @param array \n * @param paramName \n */\nexport const guardArray = <V>(array:ArrayLike<V>, paramName:string = `?`) => {\n  if (array === undefined) throw new Error(`Param '${paramName}' is undefined. Expected array.`);\n  if (array === null) throw new Error(`Param '${paramName}' is null. Expected array.`);\n  if (!Array.isArray(array)) throw new Error(`Param '${paramName}' not an array as expected`);\n};\n\n/**\n * Throws if `index` is an invalid array index for `array`, and if\n * `array` itself is not a valid array.\n * @param array \n * @param index \n */\nexport const guardIndex = <V>(array:ReadonlyArray<V>, index:number, paramName:string = `index`) => {\n  guardArray(array);\n  guardInteger(index, `positive`, paramName);\n  if (index > array.length -1) throw new Error(`'${paramName}' ${index} beyond array max of ${array.length-1}`);\n};\n\n/**\n * Returns _true_ if all the contents of the array are identical.\n * \n * @example Uses default equality function:\n * ```js\n * import { areValuesIdentical } from 'https://unpkg.com/ixfx/dist/arrays.js';\n * \n * const a1 = [10, 10, 10];\n * areValuesIdentical(a1); // True\n * \n * const a2 = [ {name:`Jane`}, {name:`John} ];\n * areValuesIdentical(a2); // True, because JSON version captures value\n * ```\n * \n * If we want to compare by value for objects that aren't readily\n * converted to JSON, you need to provide a function:\n * \n * ```js\n * areValuesIdentical(someArray, (a, b) => {\n *  return (a.eventType === b.eventType);\n * });\n * ```\n * @param array Array\n * @param equality Equality checker. Uses string-conversion checking by default\n * @returns \n */\nexport const areValuesIdentical = <V>(array:ReadonlyArray<V>, equality?:IsEqual<V>):boolean => {\n  // Unit tested\n\n  if (!Array.isArray(array)) throw new Error(`Param 'array' is not an array.`);\n  if (array.length === 0) return true;\n  const eq = (equality === undefined) ? isEqualValueDefault : equality;\n  const a = array[0];\n  const r = array.some(v => !eq(a, v));\n  if (r) return false;\n  return true;\n};\n\n/**\n * Returns the _intersection_ of two arrays: the elements that are in common.\n * \n * ```js\n * intersection([1, 2, 3], [2, 4, 6]);\n// returns [2]\n * ```\n * @param a1 \n * @param a2 \n * @param equality \n * @returns \n */\nexport const intersection = <V>(a1:ReadonlyArray<V>, a2:ReadonlyArray<V>, equality:IsEqual<V> = isEqualDefault) => a1.filter(e1 => a2.some(e2 => equality(e1, e2)));\n\n/**\n * Returns a 'flattened' copy of array, un-nesting arrays one level\n * ```js\n * flatten([1, [2, 3], [[4]]] ]);\n * // Yields: [ 1, 2, 3, [4]];\n * ```\n * @param array \n * @returns \n */\nexport const flatten = <V>(array:ReadonlyArray<V|readonly V[]>):readonly V[] => Array.prototype.concat.apply([], [...array]);\n\n\n/**\n * Zip ombines the elements of two or more arrays based on their index.\n * \n * ```js\n * import { zip } from 'https://unpkg.com/ixfx/dist/arrays.js';\n * \n * const a = [1,2,3];\n * const b = [`red`, `blue`, `green`];\n * \n * const c = zip(a, b);\n * // Yields:\n * // [\n * //   [1, `red`],\n * //   [2, `blue`],\n * //   [3, `green`]\n * // ]\n * ```\n * \n * Typically the arrays you zip together are all about the same logical item. Eg, in the above example\n * perhaps `a` is size and `b` is colour. So thing #1 (at array index 0) is a red thing of size 1. Before\n * zipping we'd access it by `a[0]` and `b[0]`. After zipping, we'd have c[0], which is array of [1, `red`].\n * @param arrays \n * @returns Zipped together array\n */\n//eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport const zip = (...arrays:ReadonlyArray<any>):ReadonlyArray<any> => {\n  // Unit tested\n  if (arrays.some((a) => !Array.isArray(a))) throw new Error(`All parameters must be an array`);\n  const lengths = arrays.map(a => a.length);\n  if (!areValuesIdentical(lengths)) throw new Error(`Arrays must be of same length`);\n  const ret = [];\n  const len = lengths[0];\n  //eslint-disable-next-line functional/no-let\n  for (let i=0;i<len;i++) {\n    //eslint-disable-next-line functional/immutable-data\n    ret.push(arrays.map(a => a[i]));\n  }\n  return ret;\n};\n\n/**\n * Returns an interleaving of two or more arrays. All arrays must be the same length.\n * \n * ```js\n * import { interleave } from 'https://unpkg.com/ixfx/dist/arrays.js';\n * \n * const a = [`a`, `b`, `c`];\n * const b = [`1`, `2`, `3`];\n * const c = interleave(a, b);\n * // Yields:\n * // [`a`, `1`, `b`, `2`, `c`, `3`]\n * ```\n * @param arrays \n * @returns \n */\nexport const interleave = <V>(...arrays:ReadonlyArray<readonly V[]>):ReadonlyArray<V> => {\n  if (arrays.some((a) => !Array.isArray(a))) throw new Error(`All parameters must be an array`);\n  const lengths = arrays.map(a => a.length);\n  if (!areValuesIdentical(lengths)) throw new Error(`Arrays must be of same length`);\n\n  const ret = [];\n  const len = lengths[0];\n  //eslint-disable-next-line functional/no-let\n  for (let i=0;i<len;i++) {\n    //eslint-disable-next-line functional/no-let\n    for (let p=0;p<arrays.length;p++) {\n      //eslint-disable-next-line functional/immutable-data\n      ret.push(arrays[p][i]);\n    }\n  }\n  return ret;\n};\n\n/**\n * Returns an copy of `data` with specified length.\n * If the input array is too long, it is truncated.\n *  \n * If the input array is too short, it will be expanded based on the `expand` strategy:\n *  - 'undefined': fill with `undefined`\n *  - 'repeat': repeat array elements, starting from position 0\n *  - 'first': continually use first element\n *  - 'last': continually use last element\n * \n * ```js\n * import { ensureLength } from 'https://unpkg.com/ixfx/dist/arrays.js';\n * \n * ensureLength([1,2,3], 2); // [1,2]\n * ensureLength([1,2,3], 5, `undefined`); // [1,2,3,undefined,undefined]\n * ensureLength([1,2,3], 5, `repeat`);    // [1,2,3,1,2]\n * ensureLength([1,2,3], 5, `first`);     // [1,2,3,1,1]\n * ensureLength([1,2,3], 5, `last`);      // [1,2,3,3,3] \n * ```\n * @param data Input array to expand\n * @param length Desired length\n * @param expand Expand strategy\n * @typeParam V Type of array \n */\nexport const ensureLength = <V>(data:ReadonlyArray<V>, length:number, expand:`undefined`|`repeat`|`first`|`last` = `undefined`):ReadonlyArray<V> => {\n  // Unit tested\n  if (data === undefined) throw new Error(`Data undefined`);\n  if (!Array.isArray(data)) throw new Error(`data is not an array`);\n  if (data.length === length) return [...data];\n  if (data.length > length) {\n    return data.slice(0, length);\n  }\n  const d = [...data];\n  const add = length - d.length;\n  \n  //eslint-disable-next-line functional/no-let\n  for (let i=0;i<add;i++) {\n    //eslint-disable-next-line functional/immutable-data\n    if (expand === `undefined`) {\n      //eslint-disable-next-line functional/immutable-data\n      d.push(undefined);\n    } else if (expand === `repeat`) {\n      //eslint-disable-next-line functional/immutable-data\n      d.push(data[i%data.length]);\n    } else if (expand === `first`) {\n      //eslint-disable-next-line functional/immutable-data\n      d.push(data[0]);\n    } else if (expand === `last`) {\n      //eslint-disable-next-line functional/immutable-data\n      d.push(data[data.length-1]);\n    }\n  }\n  return d;\n};\n\n\n/**\n * Return elements from `array` that match a given `predicate`, and moreover are between\n * the given `startIndex` and `endIndex` (both inclusive).\n * \n * While this can be done with in the in-built `array.filter` function, it will\n * needlessly iterate through the whole array. It also avoids another alternative \n * of slicing the array before using `filter`.\n * \n * ```js\n * import { filterBetween } from 'https://unpkg.com/ixfx/dist/arrays.js';\n * \n * // Return 'registered' people between and including array indexes 5-10\n * const filtered = filterBetween(people, person => person.registered, 5, 10);\n * ```\n * @param array Array to filter \n * @param predicate Filter function\n * @param startIndex Start index (defaults to 0)\n * @param endIndex End index (defaults to last index)\n */\nexport const filterBetween = <V>(array:ReadonlyArray<V>, predicate:(value:V, index:number, array:ReadonlyArray<V>)=>boolean, startIndex?:number, endIndex?:number):readonly V[] => {\n  guardArray(array);\n  if (typeof startIndex === `undefined`) startIndex = 0;\n  if (typeof endIndex === `undefined`) endIndex = array.length-1;\n  guardIndex(array, startIndex, `startIndex`);\n  guardIndex(array, endIndex, `endIndex`);\n\n  const t:V[] = [];\n  \n  //eslint-disable-next-line functional/no-let\n  for (let i=startIndex;i<=endIndex;i++) {\n    //eslint-disable-next-line functional/immutable-data\n    if (predicate(array[i], i, array)) t.push(array[i]);\n  }\n  return t;\n};\n/**\n * Returns a random array index.\n * \n * ```js\n * import { randomIndex } from 'https://unpkg.com/ixfx/dist/arrays.js';\n * \n * const v = [`blue`, `red`, `orange`];\n * randomIndex(v); // Yields 0, 1 or 2\n * ```\n * \n * Use {@link randomElement} if you want a value from `array`, not index.\n * \n * @param array Array\n * @param rand Random generator. `Math.random` by default.\n * @returns \n */\nexport const randomIndex = <V>(array:ArrayLike<V>, rand:RandomSource = defaultRandom):number => Math.floor(rand() * array.length);\n\n/**\n * Returns random element.\n * \n * ```js\n * import { randomElement } from 'https://unpkg.com/ixfx/dist/arrays.js';\n * \n * const v = [`blue`, `red`, `orange`];\n * randomElement(v); // Yields `blue`, `red` or `orange`\n * ```\n * \n * Use {@link randomIndex} if you want a random index within `array`.\n * \n * @param array\n * @params rand Random generator. `Math.random` by default.\n * @returns \n */\nexport const randomElement = <V>(array:ArrayLike<V>, rand:RandomSource = defaultRandom):V => {\n  guardArray(array, `array`);\n  return array[Math.floor(rand() * array.length)];\n};\n\n/**\n * Removes a random item from an array, returning both the item and the new array as a result.\n * Does not modify the original array unless `mutate` parameter is true.\n * \n * @example Without changing source\n * ```js\n * import { randomPluck } from 'https://unpkg.com/ixfx/dist/arrays.js';\n * \n * const data = [100, 20, 40];\n * const {value, array} = randomPluck(data);\n * // value: 20, array: [100, 40], data: [100, 20, 40];\n * ```\n *\n * @example Mutating source\n * ```js\n * import { randomPluck } from 'https://unpkg.com/ixfx/dist/arrays.js';\n * \n * const data = [100, 20, 40];\n * const {value} = randomPluck(data, true);\n * // value: 20, data: [100, 40];\n * ```\n * \n * @template V Type of array\n * @param array Array to pluck item from\n * @param mutate If _true_, changes input array. _False_ by default.\n * @param random Random generatr. `Math.random` by default.\n * @return Returns an object `{value:V|undefined, array:V[]}`\n * \n */\n//eslint-disable-next-line functional/prefer-readonly-type\nexport const randomPluck = <V>(array:readonly V[], mutate = false, rand:RandomSource = defaultRandom):{readonly value:V|undefined, readonly array:Array<V> } => {\n  if (array === undefined) throw new Error(`array is undefined`);\n  if (!Array.isArray(array)) throw new Error(`'array' param is not an array`);\n  if (array.length === 0) return { value: undefined, array: [] };\n  const index = randomIndex(array, rand);\n  if (mutate) {\n    return {\n      value: array[index],\n      //eslint-disable-next-line functional/immutable-data\n      array: array.splice(index, 1)\n    };\n  } else {\n    // Copy array, remove item from that\n    const t = [...array];\n    //eslint-disable-next-line functional/immutable-data\n    t.splice(index, 1);\n    return {\n      value: array[index],\n      array: t\n    };\n  }\n};\n\n/**\n * Returns a shuffled copy of the input array.\n * @example\n * ```js\n * import { shuffle } from 'https://unpkg.com/ixfx/dist/arrays.js';\n * \n * const d = [1, 2, 3, 4];\n * const s = shuffle(d);\n * // d: [1, 2, 3, 4], s: [3, 1, 2, 4]\n * ```\n * @param dataToShuffle \n * @param rand Random generator. `Math.random` by default.\n * @returns Copy with items moved around randomly\n * @template V Type of array items\n */\nexport const shuffle = <V>(dataToShuffle:ReadonlyArray<V>, rand:RandomSource = defaultRandom):ReadonlyArray<V> => {\n  const array = [...dataToShuffle];\n  // eslint-disable-next-line  functional/no-let\n  for (let i = array.length - 1; i > 0; i--) {\n    const j = Math.floor(rand() * (i + 1));\n    [array[i], array[j]] = [array[j], array[i]];\n  }\n  return array;\n};\n\n/**\n * Sorts an array of objects by the given property name, assuming its a number.\n * \n * ```js`\n * const data = [ { size: 10, colour: `red` }, { size: 20, colour: `blue` }, { size: 5, colour: `pink` }];\n * const sorted = Arrays.sortByNumericProperty(data, `size`);\n * \n * Yields items ascending order:\n * [ { size: 5, colour: `pink` }, { size: 10, colour: `red` }, { size: 20, colour: `blue` } ]\n * ```\n * @param data \n * @param propertyName \n */\nexport const sortByNumericProperty = <V, K extends keyof V>(data:ReadonlyArray<V>, propertyName:K) => [...data].sort((a, b) => {\n  guardArray(data, `data`);\n  const av = a[propertyName];\n  const bv = b[propertyName];\n  if (av < bv) return -1;\n  if (av > bv) return 1;\n  return 0;\n});\n\n/**\n * Returns an array with a value omitted. If value is not found, result will be a copy of input.\n * Value checking is completed via the provided `comparer` function. \n * By default checking whether `a === b`. To compare based on value, use the `isEqualValueDefault` comparer.\n *\n * @example\n * ```js\n * import { without } from 'https://unpkg.com/ixfx/dist/arrays.js';\n * \n * const data = [100, 20, 40];\n * const filtered = without(data, 20); // [100, 40]\n * ```\n * \n * @example Using value-based comparison\n * ```js\n * import { without } from 'https://unpkg.com/ixfx/dist/arrays.js';\n * \n * const data = [{name: `Alice`}, {name:`Sam`}];\n * \n * // This wouldn't work as expected, because the default comparer uses instance,\n * // not value:\n * without(data, {name: `Alice`});\n * \n * // So instead we can use a value comparer:\n * without(data, {name:`Alice`}, isEqualValueDefault);\n * ```\n * \n * @example Use a function\n * ```js\n * import { without } from 'https://unpkg.com/ixfx/dist/arrays.js';\n * \n * const data = [{name: `Alice`}, {name:`Sam`}];\n * without(data, {name:`ALICE`}, (a, b) => {\n *  return (a.name.toLowerCase() === b.name.toLowerCase());\n * });\n * ```\n * \n * Consider {@link remove} to remove an item by index.\n * \n * @template V Type of array items\n * @param data Source array\n * @param value Value to remove\n * @param comparer Comparison function. If not provided `Util.isEqualDefault` is used, which compares using `===`\n * @return Copy of array without value.\n */\nexport const without = <V>(data:ReadonlyArray<V>, value:V, comparer:IsEqual<V> = isEqualDefault):ReadonlyArray<V> => data.filter(v => !comparer(v, value));\n\n/**\n * Returns all items in `data` for as long as `predicate` returns true\n * @param data \n * @param predicate \n * @returns \n */\nexport const until = <V, A>(data:ReadonlyArray<V>, predicate:(v:V, acc:A)=>readonly [stop:boolean, acc:A], initial:A):readonly V[] => {\n  const ret = [];\n  //eslint-disable-next-line functional/no-let\n  let total = initial;\n  //eslint-disable-next-line functional/no-let\n  for (let i=0;i<data.length;i++) {\n    const [stop, acc] = predicate(data[i], total);\n    if (stop) break;\n\n    total = acc;\n    \n    //eslint-disable-next-line functional/immutable-data\n    ret.push(data[i]);\n  }\n  return ret;\n};\n\n/**\n * Removes an element at `index` index from `data`, returning the resulting array without modifying the original.\n * \n * ```js\n * import { remove } from 'https://unpkg.com/ixfx/dist/arrays.js';\n * \n * const v = [ 100, 20, 50 ];\n * const vv = remove(2);\n * \n * Yields:\n *  v: [ 100, 20, 50 ]\n * vv: [ 100, 20 ] \n * ```\n * \n * Consider {@link without} if you want to remove an item by value.\n * \n * Throws an exception if `index` is outside the range of `data` array.\n * @param data Input array\n * @param index Index to remove\n * @typeParam V Type of array\n * @returns \n */\nexport const remove = <V>(data:ReadonlyArray<V>, index:number):ReadonlyArray<V> => {\n  //  Unit tested\n  if (!Array.isArray(data)) throw new Error(`'data' parameter should be an array`);\n  guardIndex(data, index, `index`);\n  return [...data.slice(0, index), ...data.slice(index+1)]; \n};\n\n/**\n * Groups data by a function `grouper`, returning data as a map with string\n * keys and array values. Multiple values can be assigned to the same group.\n * \n * `grouper` must yield a string designated group for a given item.\n * \n * @example\n * ```js\n * import { groupBy } from 'https://unpkg.com/ixfx/dist/arrays.js';\n * \n * const data = [\n *  { age: 39, city: `London` }\n *  { age: 14, city: `Copenhagen` }\n *  { age: 23, city: `Stockholm` }\n *  { age: 56, city: `London` }\n * ];\n * \n * // Whatever the function returns will be the designated group\n * // for an item\n * const map = groupBy(data, item => data.city); \n * ```\n * \n * This yields a Map with keys London, Stockholm and Copenhagen, and the corresponding values.\n * \n * ```\n * London: [{ age: 39, city: `London` }, { age: 56, city: `London` }]\n * Stockhom: [{ age: 23, city: `Stockholm` }]\n * Copenhagen: [{ age: 14, city: `Copenhagen` }]\n * ```\n * @param array Array to group\n * @param grouper Function that returns a key for a given item\n * @typeParam K Type of key to group by. Typically string.\n * @typeParam V Type of values\n * @returns Map \n */\nexport const groupBy = <K, V>(array:ReadonlyArray<V>, grouper:(item:V)=>K) => array.reduce((store, item) => {\n  const key = grouper(item);\n  const val = store.get(key);\n  if (val === undefined) {\n    store.set(key, [item]);\n  } else {\n    // eslint-disable-next-line functional/immutable-data\n    val.push(item);\n  }\n  return store;\n  /* eslint-disable-next-line functional/prefer-readonly-type */\n}, new Map<K, V[]>());\n\n/**\n * Samples array\n * \n * @example By percentage - get half of the items\n * ```\n * import { sample } from 'https://unpkg.com/ixfx/dist/arrays.js';\n * \n * const list = [1,2,3,4,5,6,7,8,9,10];\n * const sub = sample(list, 0.5);\n * // Yields: [2, 4, 6, 8, 10]\n * ```\n * \n * @example By steps - every third\n * ```\n * import { sample } from 'https://unpkg.com/ixfx/dist/arrays.js';\n * \n * const list = [1,2,3,4,5,6,7,8,9,10];\n * const sub = sample(list, 3);\n * // Yields:\n * // [3, 6, 9]\n * ```\n * @param array Array to sample\n * @param amount Amount, given as a percentage (0..1) or the number of interval (ie 3 for every third item)\n * @returns \n */\nexport const sample = <V>(array:ReadonlyArray<V>, amount:number):ReadonlyArray<V> => {\n  //eslint-disable-next-line functional/no-let\n  let subsampleSteps = 1;\n  if (amount <= 1) {\n    // Subsample based on a percentage\n    const numberOfItems = array.length*amount;\n    subsampleSteps = Math.round(array.length/numberOfItems);\n  } else {\n    subsampleSteps = amount;\n  }\n\n  guardInteger(subsampleSteps, `positive`, `amount`);\n  if (subsampleSteps > array.length -1) throw new Error(`Subsample steps exceeds array length`);\n  \n  const r:V[] = [];\n  \n  //eslint-disable-next-line functional/no-let\n  for (let i=subsampleSteps-1;i<array.length;i+=subsampleSteps) {\n    //eslint-disable-next-line functional/immutable-data\n    r.push(array[i]);\n  }\n  return r;\n};\n\n/**\n * Return `arr` broken up into chunks of `size`\n * \n * ```js\n * chunks([1,2,3,4,5,6,7,8,9,10], 3);\n * // Yields: [[1, 2, 3], [4, 5, 6], [7, 8, 9], [10]]\n * ```\n * @param arr \n * @param size \n * @returns \n */\n//eslint-disable-next-line func-style\nexport function chunks<V>(arr:ReadonlyArray<V>, size:number) {\n  // https://surma.github.io/underdash/\n  const output = [];\n  //eslint-disable-next-line  functional/no-let\n  for (let i = 0; i < arr.length; i += size) {\n    //eslint-disable-next-line functional/immutable-data\n    output.push(arr.slice(i, i + size));\n  }\n  return output;\n}\n\n/**\n * Returns a result of a merged into b.\n * B is always the 'newer' data that takes\n * precedence.\n */\nexport type MergeReconcile<V> = (a:V, b:V)=>V;\n\n/**\n * Merges arrays left to right, using the provided\n * `reconcile` function to choose a winner when keys overlap.\n * \n * There's also [Maps.mergeByKey](functions/Collections.Maps.mergeByKey.html) if the input data is in Map form.\n * \n * For example, if we have the array A:\n * [`A-1`, `A-2`, `A-3`]\n * \n * And array B:\n * [`B-1`, `B-2`, `B-4`]\n * \n * And with the key function:\n * ```js\n * // Make a key for value based on last char\n * const keyFn = (v) => v.substr(-1, 1);\n * ```\n * \n * If they are merged with the reconile function:\n * ```js\n * const reconcile = (a, b) => b.replace(`-`, `!`);\n * const output = mergeByKey(keyFn, reconcile, arrayA, arrayB);\n * ```\n * \n * The final result will be:\n * \n * [`B!1`, `B!2`, `A-3`, `B-4`]\n * \n * In this toy example, it's obvious how the reconciler transforms\n * data where the keys overlap. For the keys that do not overlap -\n * 3 and 4 in this example - they are copied unaltered.\n * \n * A practical use for `mergeByKey` has been in smoothing keypoints\n * from a TensorFlow pose. In this case, we want to smooth new keypoints\n * with older keypoints. But if a keypoint is not present, for it to be \n * passed through.\n * \n * @param keyFn Function to generate a unique key for data\n * @param reconcile Returns value to decide 'winner' when keys conflict.\n * @param arrays Arrays of data to merge \n */\nexport const mergeByKey = <V>(keyFn:ToString<V>, reconcile:MergeReconcile<V>, ...arrays:readonly ReadonlyArray<V>[]):ReadonlyArray<V> => {\n  const result = new Map<string, V>();\n  for (const m of arrays) {\n    for (const mv of m) {\n      if (mv === undefined) continue;\n      const mk = keyFn(mv);\n      //eslint-disable-next-line functional/no-let\n      let v = result.get(mk);\n      if (v) {\n        v = reconcile(v, mv);\n      } else {\n        v = mv;\n      }\n      result.set(mk, v);\n    }\n  }\n  return [...result.values()];\n};\n\n/**\n * Reduces in a pairwise fashion.\n * \n * Eg, if we have input array of [1, 2, 3, 4, 5], the\n * `reducer` fn will run with 1,2 as parameters, then 2,3, then 3,4 etc. \n * ```js\n * const values = [1, 2, 3, 4, 5]\n * reducePairwise(values, (acc, a, b) => {\n *  return acc + (b - a);\n * }, 0);\n * ```\n * \n * If input array has less than two elements, the initial value is returned.\n * \n * ```js\n * const reducer = (acc:string, a:string, b:string) => acc + `[${a}-${b}]`;\n * const result = reducePairwise(`a b c d e f g`.split(` `), reducer, `!`);\n * Yields: `![a-b][b-c][c-d][d-e][e-f][f-g]`\n * ```\n * @param arr \n * @param reducer \n * @param initial \n * @returns \n */\nexport const reducePairwise = <V, X>(arr:readonly V[], reducer:(acc:X, a:V, b:V)=>X, initial:X) => {\n  guardArray(arr, `arr`);\n  if (arr.length < 2) return initial;\n  //eslint-disable-next-line functional/no-let\n  for (let i=0;i<arr.length-1;i++) {\n    initial = reducer(initial, arr[i], arr[i+1]);\n  }\n  return initial;\n};\n\n/**\n * Assuming that `input` array is only unique values, this function\n * returns a new array with unique items from `values` added.\n * \n * If `comparer` function is not provided, values are compared by reference.\n * @param input \n * @param values \n */\nexport const pushUnique = <V>(input:readonly V[], values:readonly V[], comparer?:IsEqual<V>):readonly V[] => {\n  const c = comparer ?? isEqualDefault;\n  const ret = [...input];\n  for (const v of values) {\n    const found = ret.find(i => c(i, v));\n    if (found) continue;\n    //eslint-disable-next-line functional/immutable-data\n    ret.push(v);\n  }\n  return ret;\n};\n","import { randomIndex, randomElement } from \"./collections/Arrays.js\";\nimport { number as guardNumber } from './Guards.js';\nimport * as Easings from \"./modulation/Easing.js\";\nimport { clamp } from './data/Clamp.js';\n\nexport { randomIndex as arrayIndex };\nexport { randomElement as arrayElement };\nexport { randomHue as hue } from './visual/Colour.js';\n\n/**\n * Default random number generator: `Math.random`.\n */\nexport const defaultRandom = Math.random;\n\n\n/**\n * A random source.\n * \n * Predefined sources: {@link defaultRandom}, {@link gaussianSkewed}, {@link weightedSkewed}\n */\nexport type RandomSource = ()=>number;\n\n/***\n * Returns a random number, 0..1, weighted by a given easing function. \n * Default easing is `quadIn`, which skews towards zero.\n * \n * ```js\n * weighted();          // quadIn easing by default, which skews toward low values\n * weighted(`quadOut`); // quadOut favours high values\n * ```\n * \n * Use {@link weightedSkewed} for a curried version that can be used as a {@link RandomSource}:\n * \n * ```js\n * const w = weightedSkewed(`quadIn`);\n * w(); // Produce a random number\n * ```\n * @param easingName Easing name. `quadIn` by default.\n * @param rand Source random generator. `Math.random` by default.\n * @returns Random number (0-1)\n */\nexport const weighted = (easingName:Easings.EasingName = `quadIn`, rand:RandomSource = defaultRandom):number => {\n  const r = rand();\n  const easingFn = Easings.get(easingName as Easings.EasingName);\n  if (easingFn === undefined) throw new Error(`Easing function '${easingName}' not found.`);\n  return easingFn(r);\n};\n\n/**\n * Returns a curried version of {@link weighted}.\n * \n * ```js\n * const w = weightedSkewed(`quadIn`);   // Returns a function\n * w(); // Produce a random number\n * ```\n * @param easingName \n * @param rand \n * @returns \n */\nexport const weightedSkewed = (easingName:Easings.EasingName = `quadIn`, rand:RandomSource = defaultRandom):RandomSource => () => weighted(easingName, rand);\n\n/**\n * Random integer, weighted according to an easing function.\n * Number will be inclusive of `min` and below `max`.\n * \n * ```js\n * // If only one parameter is provided, it's assumed to be the max:\n * // Random number that might be 0 through to 99\n * const r = weightedInteger(100);\n * \n * // If two numbers are given, it's assumed to be min, max\n * // Random number that might be 20 through to 29\n * const r = weightedInteger(20,30);\n * \n * // One number and string. First param is assumed to be\n * // the max, second parameter the easing function\n * const r = weightedInteger(100, `quadIn`)\n * ```\n * \n * Useful for accessing a random array element:\n * ```js\n * const list = [`mango`, `kiwi`, `grape`];\n * // Yields random item from list\n * list[weightedInteger(list.length)];\n * ```\n * \n * Note: result from easing function will be clamped to\n * the min/max (by default 0-1);\n * \n * @param max Maximum (exclusive)\n * @param min Minimum number (inclusive), 0 by default\n * @param rand Source random generator. `Math.random` by default.\n * @param easing Easing to use, uses `quadIn` by default\n * @returns \n */\nexport const weightedInteger = (minOrMax:number, maxOrEasing?:number|Easings.EasingName, easing?:Easings.EasingName, rand:RandomSource = defaultRandom) => {\n  // Unit tested - for ranges and params types. Haven't tested easing distribution\n\n  guardNumber(minOrMax);\n  //eslint-disable-next-line functional/no-let\n  let min, max, easingName;\n  easingName = `quadIn`;\n  min = 0;\n\n  if (maxOrEasing === undefined) {\n    // No second parameter\n    max = minOrMax;\n  } else {\n    // There is a second parameter\n    if (typeof maxOrEasing === `number`) {\n      min = minOrMax;\n      max = maxOrEasing;\n      if (easing !== undefined) easingName = easing;\n    } else if (typeof maxOrEasing === `string`) {\n      max = minOrMax;\n      easingName = maxOrEasing;\n    } else {\n      throw new Error(`Unexpected value type for maxOrEasing: ${maxOrEasing}`);\n    }\n  }\n  \n  if (easing !== undefined) easingName = easing;\n\n  const easingFn = Easings.get(easingName as Easings.EasingName);\n  if (easingFn === undefined) throw new Error(`Easing '${easingName}' not found`);\n\n  guardNumber(min);\n  if (max <= min) throw new Error(`Max should be greater than min`);\n  const r = clamp(easingFn(rand()));\n  return Math.floor(r * (max-min)) + min;\n};\n\n/**\n * Returns a random number with gaussian (ie bell-curved) distribution\n * ```js\n * // Yields a random number between 0..1\n * // with a gaussian distribution\n * gaussian();\n * ```\n * \n * Distribution can also be skewed:\n * ```js\n * // Yields a skewed random value\n * gaussian(10);\n * ```\n * \n * Use the curried version in order to pass the random number generator elsewhere:\n * ```js\n * const g = gaussianSkewed(10);\n * // Now it can be called without parameters\n * g(); // Yields skewed random\n * \n * // Eg:\n * shuffle(gaussianSkewed(10));\n * ```\n * @param skew Skew factor. Defaults to 1, no skewing. Above 1 will skew to left, below 1 will skew to right\n * @returns \n */\nexport const gaussian = (skew = 1) => {\n  const min = 0;\n  const max = 1;\n  // Source: https://stackoverflow.com/questions/25582882/javascript-math-random-normal-distribution-gaussian-bell-curve\n  \n  //eslint-disable-next-line functional/no-let\n  let u = 0, v = 0;\n  while(u === 0) u = Math.random(); //Converting [0,1) to (0,1)\n  while(v === 0) v = Math.random();\n  //eslint-disable-next-line functional/no-let\n  let num = Math.sqrt(-2.0 * Math.log(u)) * Math.cos(2.0 * Math.PI * v);\n  \n  num = num / 10.0 + 0.5; // Translate to 0 -> 1\n  if (num > 1 || num < 0) {\n    num = gaussian(skew);// resample between 0 and 1 if out of range\n  } else{\n    num = Math.pow(num, skew); // Skew\n    num *= max - min; // Stretch to fill range\n    num += min; // offset to min\n  }\n  return num;\n};\n\n/**\n * Returns a function of skewed gaussian values.\n * \n * This 'curried' function is useful when passing to other functions\n * ```js\n * // Curry\n * const g = gaussianSkewed(10);\n * \n * // Now it can be called without parameters\n * g(); // Returns skewed value\n * \n * // Eg:\n * shuffle(gaussianSkewed(10));\n * ```\n * @param skew Skew factor. Defaults to 1, no skewing. Above 1 will skew to left, below 1 will skew to right\n * @returns \n */\nexport const gaussianSkewed = (skew:number = 1) => () => gaussian(skew);\n\n/**\n * Returns a random integer between `max` (exclusive) and `min` (inclusive)\n * If `min` is not specified, 0 is used.\n * \n * ```js\n * integer(10);    // Random number 0-9\n * integer(5, 10); // Random number 5-9\n * integer(-5);       // Random number from -4 to 0\n * integer(-5, -10); // Random number from -10 to -6\n * ```\n * @param max \n * @param min \n * @returns \n */\nexport const integer = (max:number, min?:number) => {\n  //eslint-disable-next-line functional/no-let\n  let reverse = false;\n  if (min === undefined) {\n    if (max < 0) {\n      max = Math.abs(max);\n      reverse = true;\n    }\n    min = 0;\n  }\n  const amt = max - min;\n  const r = Math.floor(Math.random() * amt) + min;\n  if (reverse) return -r;\n  return r;\n};\n\n/**\n * Random a random float between `max` (exclusive) and `min` (inclusive).\n * 1 and 0 are used as default max and min, respectively.\n * \n * ```js\n * // Random number between 0..1 (but not including 1)\n * // (this would be identical to Math.random())\n * const v = float();\n * // Random float between 0..100 (but not including 100)\n * const v = float(100);\n * // Random float between 20..40 (possibily including 20, but always lower than 40)\n * const v = float(20, 40);\n * ```\n * @param max \n * @param min \n * @returns \n */\nexport const float = (max:number = 1, min:number = 0) => Math.random() * (max - min) + min;\n\n/**\n * Returns a string of random letters and numbers of a given `length`.\n * \n * ```js\n * string(4); // eg. `4afd`\n * ```\n * @param length Length of random string\n * @returns Random string\n */\nexport const string = (length:number) => Math.random().toString(36).substring(2, length+2);\n\n/**\n * Generates a short roughly unique id\n * @returns \n */\nexport const shortGuid = () => {\n  // Via Stackoverflow...\n  const firstPart = (Math.random() * 46656) | 0;\n  const secondPart = (Math.random() * 46656) | 0;\n  const firstPartStr = `000${firstPart.toString(36)}`.slice(-3);\n  const secondPartStr = `000${secondPart.toString(36)}`.slice(-3);\n  return firstPartStr + secondPartStr;\n};\n","// Easings from https://easings.net/\nimport { interpolate } from '../data/Interpolate.js';\nimport { msElapsedTimer, HasCompletion, relativeTimer, ticksElapsedTimer, TimerSource } from '../flow/index.js';\n\nconst sqrt = Math.sqrt;\nconst pow = Math.pow;\nconst cos = Math.cos;\n//eslint-disable-next-line @typescript-eslint/naming-convention\nconst pi = Math.PI;\nconst sin = Math.sin;\n/*\ntype RelativeTimer = {\n  reset(): void\n  elapsed(): number\n  isDone(): boolean\n}\n\ntype TimerSource = (upperBound: number) => RelativeTimer;\n\nconst msRelativeTimer = function (upperBound: number): RelativeTimer {\n  let start = performance.now();\n  return {\n    reset: () => {\n      start = performance.now();\n    },\n    elapsed: () => clamp((performance.now() - start) / upperBound),\n    isDone: () => (performance.now() - start) >= upperBound,\n  };\n};\n\nconst tickRelativeTimer = function (upperBound: number): RelativeTimer {\n  let start = 0;\n  return {\n    reset: () => {\n      start = 0;\n    },\n    elapsed: () => clamp(start++ / upperBound),\n    isDone: () => start >= upperBound,\n  };\n};\n*/\n\nexport type EasingFn = (x:number)=>number;\n\n/**\n * Creates an easing based on clock time. Time\n * starts being counted when easing function is created.\n * @example Time based easing\n * ```\n * import { Easings } from \"https://unpkg.com/ixfx/dist/modulation.js\";\n * const t = Easings.time(`quintIn`, 5*1000); // Will take 5 seconds to complete\n * ...\n * t.compute(); // Get current value of easing\n * t.reset();   // Reset to 0\n * t.isDone;    // _True_ if finished\n * ```\n * @param nameOrFn Name of easing, or an easing function\n * @param durationMs Duration in milliseconds\n * @returns Easing\n */\nexport const time = function (nameOrFn:EasingName|EasingFn, durationMs:number):Easing {\n  return create(nameOrFn, durationMs, msElapsedTimer);\n};\n\n/**\n * Creates an easing based on ticks\n * \n * @example Tick-based easing\n * ```\n * import { Easings } from \"https://unpkg.com/ixfx/dist/modulation.js\";\n * const t = Easings.tick(`sineIn`, 1000);   // Will take 1000 ticks to complete\n * t.compute(); // Each call to `compute` progresses the tick count\n * t.reset();   // Reset to 0\n * t.isDone;    // _True_ if finished\n * ```\n * @param nameOrFn Name of easing, or an easing function\n * @param durationTicks Duration in ticks\n * @returns Easing\n */\nexport const tick = function (nameOrFn:EasingName|EasingFn, durationTicks:number):Easing {\n  return create(nameOrFn, durationTicks, ticksElapsedTimer);\n};\n\n/**\n * 'Ease' from `0` to `1` over a delicious curve. Commonly used for animation\n * and basic modelling of phyical motion. \n * \n * Create via {@link tick} or {@link time}, call `compute` to calculate the next\n * value in the progression, until you reach `1` or `isDone` returns true.\n * \n */\nexport type Easing = HasCompletion & {\n/**\n * Computes the current value of the easing\n *\n * @returns {number}\n */\n  compute():number\n\n/**\n * Reset the easing\n */\n  reset():void\n/**\n * Returns true if the easing is complete\n *\n * @returns {boolean}\n */\n  get isDone():boolean\n};\n\n/**\n * Creates a new easing by name\n * \n * ```js\n * import { Easings } from \"https://unpkg.com/ixfx/dist/modulation.js\";\n * const e = Easings.create(`circInOut`, 1000, msElapsedTimer);\n * ```\n * @param nameOrFn Name of easing, or an easing function\n * @param duration Duration (meaning depends on timer source)\n * @param timerSource Timer source. Eg {@link tickRelativeTimer}, {@link msRelativeTimer}\n * @returns\n */\nconst create = function (nameOrFn:EasingName|EasingFn, duration:number, timerSource:TimerSource):Easing {\n  //eslint-disable-next-line functional/no-let\n  let fn:EasingFn|undefined;\n  if (typeof nameOrFn === `function`) fn = nameOrFn;\n  else fn = get(nameOrFn);\n  if (fn === undefined) throw new Error(`Easing function not found: ${nameOrFn}`);\n\n  // Get a relative version of timer\n  const timer = relativeTimer(duration, timerSource(), true);\n\n  return {\n    get isDone() {\n      return timer.isDone;\n    },\n    compute: () => {\n      const relative = timer.elapsed;\n      //eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      return fn!(relative);\n    },\n    reset: () => {\n      timer.reset();\n    }\n  };\n};\n\n/**\n * Creates an easing function using a simple cubic bezier defined by two points.\n * \n * Eg: https://cubic-bezier.com/#0,1.33,1,-1.25\n *  a:0, b: 1.33, c: 1, d: -1.25\n * \n * ```js\n * import { Easings } from \"https://unpkg.com/ixfx/dist/modulation.js\";\n * // Time-based easing using bezier\n * const e = Easings.time(fromCubicBezier(1.33, -1.25), 1000);\n * e.compute();\n * ```\n * @param b\n * @param d \n * @param t \n * @returns Value\n */\nexport const fromCubicBezier = (b:number, d:number):EasingFn => (t:number) => {\n  const s = 1-t;\n  const s2 = s*s;\n  const t2 = t*t;\n  const t3 = t2*t;\n  return (3*b*s2*t) + (3*d*s*t2) + (t3);\n};\n\n\n/**\n * Returns a mix of two easing functions.\n * \n * ```js\n * import { Easings } from \"https://unpkg.com/ixfx/dist/modulation.js\";\n * // Get a 50/50 mix of two easing functions at t=0.25\n * Easings.mix(0.5, 0.25, Easings.functions.sineIn, Easings.functions.sineOut);\n * \n * // 10% of sineIn, 90% of sineOut\n * Easings.mix(0.90, 0.25, Easings.functions.sineIn, Easings.functions.sineOut);\n * ```\n * @param amt 'Progress' value passed to the easing functions\n * @param balance Mix between a and b\n * @param easingA \n * @param easingB \n * @returns Numeric value\n */\nexport const mix = (amt:number, balance:number, easingA:EasingFn, easingB:EasingFn) => interpolate(balance, easingA(amt), easingB(amt));\n\n/**\n * Returns a 'crossfade' of two easing functions, synchronised with the progress through the easing. That is:\n * * 0.0 will yield 100% of easingA at its `easing(0)` value.\n * * 0.2 will yield 80% of a, 20% of b, with both at their `easing(0.2)` values\n * * 0.5 will yield 50% of both functions both at their `easing(0.5)` values\n * * 0.8 will yield 20% of a, 80% of a, with both at their `easing(0.8)` values\n * * 1.0 will yield 100% of easingB at its `easing(1)` value.\n * \n * So easingB will only ever kick in at higher `amt` values and `easingA` will only be present in lower valus.\n * \n * ```js\n * import { Easings } from \"https://unpkg.com/ixfx/dist/modulation.js\";\n * Easings.crossFade(0.5, Easings.functions.sineIn, Easings.functions.sineOut);\n * ```\n * @param amt\n * @param easingA\n * @param easingB \n * @returns Numeric value\n */\nexport const crossfade = (amt:number, easingA:EasingFn, easingB:EasingFn) => mix(amt, amt, easingA, easingB);\n\n/**\n * @private\n */\nexport type EasingName = keyof typeof functions;\n\n/**\n * Returns an easing function by name, or _undefined_ if not found.\n * This is a manual way of working with easing functions. If you want to\n * ease over time or ticks, use `Flow.Timer.msElapsedTimer` or `Flow.Timer.ticksElapsedTimer`.\n * \n * ```js\n * const fn = Easings.get(`sineIn`);\n * // Returns 'eased' transformation of 0.5\n * fn(0.5); \n * ```\n * \n * This function is useful if trying to resolve an easing by string. If you\n * know in advance what easing to use, you could also access it via \n * `Easings.functions.NAME`, eg `Easings.functions.sineIn`.\n * @param easingName eg `sineIn`\n * @returns Easing function\n */\nexport const get = function (easingName:EasingName):EasingFn|undefined {\n  if (easingName === null) throw new Error(`easingName is null`);\n  if (easingName === undefined) throw new Error(`easingName is undefined`);\n  const name = easingName.toLocaleLowerCase();\n  const found = Object\n    .entries(functions)\n    .find(([k, _v]) => k.toLocaleLowerCase() === name);\n\n  if (found === undefined) return found;\n  return found[1];\n};\n\n/**\n * \n * @private\n * @returns Returns list of available easing names\n */\nexport const getEasings = function ():readonly string[] {\n  return Array.from(Object.keys(functions));\n};\n\n/**\n * Returns a roughly gaussian easing function\n * ```js\n * import { Easings } from \"https://unpkg.com/ixfx/dist/modulation.js\";\n * const fn = Easings.gaussian();\n * ```\n * \n * Try different positive and negative values for `stdDev` to pinch\n * or flatten the bell shape. \n * @param stdDev \n * @returns \n */\nexport const gaussian = (stdDev:number = 0.4):EasingFn => {\n  const a = 1/sqrt(2*pi);\n  const mean = 0.5;\n  \n  return (t:number) => {\n    const f = a / stdDev;\n    // p:-8 pinched\n    //eslint-disable-next-line functional/no-let\n    let p = -2.5;// -1/1.25;\n    //eslint-disable-next-line functional/no-let\n    let c = (t-mean)/stdDev;\n    c *= c;\n    p *= c;\n    const v = f * pow(Math.E, p);// * (2/pi);//0.62;\n    if (v > 1) return 1;\n    if (v < 0) return 0;\n\n    //if (v >1) console.log(v);\n    //if (v < 0) console.log(v);\n    return v;\n  };\n};\n\nconst bounceOut = function (x:number):number {\n  const n1 = 7.5625;\n  const d1 = 2.75;\n\n  if (x < 1 / d1) {\n    return n1 * x * x;\n  } else if (x < 2 / d1) {\n    return n1 * (x -= 1.5 / d1) * x + 0.75;\n  } else if (x < 2.5 / d1) {\n    return n1 * (x -= 2.25 / d1) * x + 0.9375;\n  } else {\n    return n1 * (x -= 2.625 / d1) * x + 0.984375;\n  }\n};\n\nconst quintIn = (x:number):number => x * x * x * x * x;\nconst quintOut = (x:number):number => 1 - pow(1 - x, 5);\nconst arch = (x:number):number => (x * (1-x) * 4);\n\nexport const functions = {\n  arch,\n  bell: gaussian(),\n  sineIn: (x:number):number => 1 - cos((x * pi) / 2),\n  sineOut: (x:number):number => sin((x * pi) / 2),\n  quadIn: (x:number):number => x * x,\n  quadOut: (x:number):number => 1 - (1 - x) * (1 - x),\n  sineInOut: (x:number):number => -(cos(pi * x) - 1) / 2,\n  quadInOut: (x:number):number => (x < 0.5 ? 2 * x * x : 1 - pow(-2 * x + 2, 2) / 2),\n  cubicIn: (x:number):number => x * x * x,\n  cubicOut: (x:number):number => 1 - pow(1 - x, 3),\n  quartIn: (x:number):number => x * x * x * x,\n  quartOut: (x:number):number => 1 - pow(1 - x, 4),\n  quintIn,\n  quintOut, //: (x: number): number => 1 - pow(1 - x, 5),\n  expoIn: (x:number):number => (x === 0 ? 0 : pow(2, 10 * x - 10)),\n  expoOut: (x:number):number => (x === 1 ? 1 : 1 - pow(2, -10 * x)),\n  quintInOut: (x:number):number => (x < 0.5 ? 16 * x * x * x * x * x : 1 - pow(-2 * x + 2, 5) / 2),\n  expoInOut: (x:number):number => (x === 0\n    ? 0\n    : x === 1\n      ? 1\n      : x < 0.5 ? pow(2, 20 * x - 10) / 2\n        : (2 - pow(2, -20 * x + 10)) / 2),\n  circIn: (x:number):number => 1 - sqrt(1 - pow(x, 2)),\n  circOut: (x:number):number => sqrt(1 - pow(x - 1, 2)),\n  backIn: (x:number):number => {\n    const c1 = 1.70158;\n    const c3 = c1 + 1;\n\n    return c3 * x * x * x - c1 * x * x;\n  },\n  backOut: (x:number):number => {\n    const c1 = 1.70158;\n    const c3 = c1 + 1;\n\n    return 1 + c3 * pow(x - 1, 3) + c1 * pow(x - 1, 2);\n  },\n  circInOut: (x:number):number => (x < 0.5\n    ? (1 - sqrt(1 - pow(2 * x, 2))) / 2\n    : (sqrt(1 - pow(-2 * x + 2, 2)) + 1) / 2),\n  backInOut: (x:number):number => {\n    const c1 = 1.70158;\n    const c2 = c1 * 1.525;\n\n    return x < 0.5\n      ? (pow(2 * x, 2) * ((c2 + 1) * 2 * x - c2)) / 2\n      : (pow(2 * x - 2, 2) * ((c2 + 1) * (x * 2 - 2) + c2) + 2) / 2;\n  },\n  elasticIn: (x:number):number => {\n    const c4 = (2 * pi) / 3;\n\n    return x === 0\n      ? 0\n      : x === 1\n        ? 1\n        : -pow(2, 10 * x - 10) * sin((x * 10 - 10.75) * c4);\n  },\n  elasticOut: (x:number):number => {\n    const c4 = (2 * pi) / 3;\n\n    return x === 0\n      ? 0\n      : x === 1\n        ? 1\n        : pow(2, -10 * x) * sin((x * 10 - 0.75) * c4) + 1;\n  },\n  bounceIn: (x:number):number => 1 - bounceOut(1 - x),\n  bounceOut: bounceOut,\n  elasticInOut: (x:number):number => {\n    const c5 = (2 * pi) / 4.5;\n\n    return x === 0\n      ? 0\n      : x === 1\n        ? 1\n        : x < 0.5\n          ? -(pow(2, 20 * x - 10) * sin((20 * x - 11.125) * c5)) / 2\n          : (pow(2, -20 * x + 10) * sin((20 * x - 11.125) * c5)) / 2 + 1;\n  },\n  bounceInOut: (x:number):number => (x < 0.5\n    ? (1 - bounceOut(1 - 2 * x)) / 2\n    : (1 + bounceOut(2 * x - 1)) / 2)\n};","export * as Normalise from './Normalise.js';\nexport * from './FrequencyMutable.js';\nexport * from './MovingAverage.js';\nexport * from './NumberTracker.js';\nexport * from './IntervalTracker.js';\nexport * from './PointTracker.js';\nexport * from './TrackedValue.js';\nexport * from './TrackerBase.js';\n\n\nexport * from './Clamp.js';\nexport * from './Scale.js';\nexport * from './Flip.js';\nexport * from './Interpolate.js';\nexport * from './Wrap.js';\nexport * as Correlate from './Correlate.js';\nexport * as Pool from './Pool.js';\n\nexport const piPi = Math.PI*2;\nexport type NumberFunction = ()=>number;","import {minMaxAvg} from \"../collections/NumericArrays.js\";\nimport {clamp} from \"./Clamp.js\";\nimport {scale} from \"./Scale.js\";\nimport { number as guardNumber } from \"../Guards.js\";\n/**\n * Normalises numbers, adjusting min/max as new values are processed.\n * Normalised return values will be in the range of 0-1 (inclusive).\n * \n * [Read more in the docs](https://clinth.github.io/ixfx-docs/data/normalising/)\n * \n * @example\n * ```js\n * import {Normalise} from 'https://unpkg.com/ixfx/dist/data.js'\n * const s = Normalise.stream();\n * s(2);    // 1 (because 2 is highest seen)\n * s(1);    // 0 (because 1 is the lowest so far)\n * s(1.5);  // 0.5 (50% of range 1-2)\n * s(0.5);  // 0 (because it's the new lowest)\n * ```\n * \n * Since normalisation is being adjusted as new min/max are encountered, it might\n * be that value normalised to 1 at one time is different to what normalises to 1\n * at a later time.\n * \n * If you already know what to expect of the number range, passingin `minDefault` \n * and `maxDefault` primes the normalisation.\n * ```js\n * const s = Normalise.stream();\n * s(5); // 1, because it's the highest seen\n * \n * // With priming:\n * const s = Normalise.stream(0, 10);\n * s(5); // 0.5, because we're expecting range 0-10\n * ```\n * \n * Note that if a value exceeds the default range, normalisation adjusts.\n * Errors are thrown if min/max defaults are NaN or if one attempts to\n * normalise NaN.\n * @returns \n */\nexport const stream = (minDefault?:number, maxDefault?:number) => {\n  //eslint-disable-next-line functional/no-let\n  let min = minDefault ?? Number.MAX_SAFE_INTEGER;\n  //eslint-disable-next-line functional/no-let\n  let max = maxDefault ?? Number.MIN_SAFE_INTEGER;\n\n  guardNumber(minDefault);\n  guardNumber(maxDefault);\n  \n  return (v:number):number => {\n    guardNumber(v);\n    min = Math.min(min, v);\n    max = Math.max(max, v);\n    return scale(v, min, max);\n  };\n};\n\n/**\n * Normalises an array. By default uses the actual min/max of the array\n * as the normalisation range. [Read more in the docs](https://clinth.github.io/ixfx-docs/data/normalising/)\n * \n * ```js\n * import {Normalise} from 'https://unpkg.com/ixfx/dist/data.js'\n * // Yields: [0.5, 0.1, 0.0, 0.9, 1]\n * Normalise.array([5,1,0,9,10]);\n * ```\n * \n * `minForced` and/or `maxForced` can\n * be provided to use an arbitrary range. \n * ```js\n * // Forced range 0-100\n * // Yields: [0.05, 0.01, 0.0, 0.09, 0.10]\n * Normalise.array([5,1,0,9,10], 0, 100);\n * ```\n * \n * Return values are clamped to always be 0-1, inclusive.\n * \n * @param values Values\n * @param minForced If provided, this will be min value used\n * @param maxForced If provided, this will be the max value used\n */\nexport const array = (values:readonly number[], minForced?:number, maxForced?:number) => {\n  if (!Array.isArray(values)) throw new Error(`values param should be an array`);\n  const mma = minMaxAvg(values);\n\n  const min = minForced ?? mma.min;\n  const max = maxForced ?? mma.max;\n\n  return values.map(v => clamp(scale(v, min, max)));\n};","import { zip, filterBetween } from './Arrays.js';\nimport * as Easings from \"../modulation/Easing.js\";\n\n/**\n * Applies a function `fn` to the elements of an array, weighting them based on their relative position.\n * \n * ```js\n * import { Arrays } from 'https://unpkg.com/ixfx/dist/collections.js';\n * \n * // Six items\n * Arrays.weight([1,1,1,1,1,1], Easings.gaussian());\n * \n * // Yields:\n * // [0.02, 0.244, 0.85, 0.85, 0.244, 0.02]\n * ```\n * \n * `fn` is expected to map (0..1) => (0..1), such as an {@link Modulation.Easings.EasingFn}. The input to the\n * `fn` is the relative position of an element. Thus the first element will be 0, the middle 0.5 and so on.\n * The output of `fn` is then multiplied by the original value.\n * \n * In the below example (which is also the default if `fn` is not specified), the relative position is\n * how values are weighted:\n * \n * ```js\n * Arrays.weight([1,1,1,1,1,1], (relativePos) => relativePos);\n * // Yields:\n * // [0, 0.2, 0.4, 0.6, 0.8, 1]\n * ```\n * \n * Non-numbers in `data` will be silently ignored (this filtering happens first, so relative index values are sane still).\n * \n * @param data Array of numbers\n * @param fn Returns a weighting based on the given relative position. If unspecified, `(x) => x` is used.\n */\nexport const weight = (data:readonly number[], fn?:(relativePos:number)=>number):readonly number[] => {\n  const f = (fn === undefined) ? (x:number) => x : fn;\n  return validNumbers(data).map((v:number, index:number) => v*f(index/(validNumbers.length-1)));\n};\n\n/**\n * Returns an array of all valid numbers from `data`\n * \n * @param data \n * @returns \n */\nexport const validNumbers = (data:readonly number[]) => data.filter(d => typeof d === `number` && !Number.isNaN(d));\n\n/**\n * Returns the dot product of two arbitrary-sized arrays. Assumed they are of the same length.\n * @param a \n * @param b \n * @returns \n */\nexport const dotProduct = (values:ReadonlyArray<readonly number[]>):number => {\n  //eslint-disable-next-line functional/no-let\n  let r = 0;\n  const len = values[0].length;\n\n  //eslint-disable-next-line functional/no-let\n  for (let i=0;i<len;i++) {\n    //eslint-disable-next-line functional/no-let\n    let t = 0;\n    //eslint-disable-next-line functional/no-let\n    for (let p=0;p<values.length;p++) {\n      if (p === 0) t = values[p][i];\n      else {\n        t *= values[p][i];\n      }\n    }\n    r += t;\n  }\n  return r;\n};\n\n/**\n * Calculates the average of all numbers in an array.\n * Array items which aren't a valid number are ignored and do not factor into averaging.\n *\n * Use {@link minMaxAvg} if you want min, max and total as well.\n * \n * @example\n * ```\n * import { Arrays } from 'https://unpkg.com/ixfx/dist/collections.js';\n * \n * // Average of a list\n * const avg = Arrays.average([1, 1.4, 0.9, 0.1]);\n * \n * // Average of a variable\n * let data = [100,200];\n * Arrays.average(data);\n * ```\n * \n * See also: [Numbers.average](Numbers.average.html) which takes a list of parameters\n * @param data Data to average.\n * @returns Average of array\n */\nexport const average = (data:readonly number[]):number => {\n  //  UNIT TESTED\n  if (data === undefined) throw new Error(`data parameter is undefined`);\n  const valid = validNumbers(data);\n  const total = valid.reduce((acc, v) => acc + v, 0);\n  return total / valid.length;\n};\n\n/**\n * Computes an average of an array with a set of weights applied.\n * \n * Weights can be provided as an array, expected to be on 0..1 scale, with indexes\n * matched up to input data. Ie. data at index 2 will be weighed by index 2 in the weightings array.\n * \n * ```js\n * import { Arrays } from 'https://unpkg.com/ixfx/dist/collections.js';\n * // All items weighted evenly\n * Arrays.averageWeighted([1,2,3], [1,1,1]); // 2\n * \n * // First item has full weight, second half, third quarter\n * Arrays.averageWeighted([1,2,3], [1, 0.5, 0.25]); // 1.57\n * \n * // With reversed weighting of [0.25,0.5,1] value is 2.42\n * ```\n * \n * A function can alternatively be provided to compute the weighting based on array index, via {@link weight}.\n * \n * ```js\n * Arrays.averageWeighted[1,2,3], Easings.gaussian()); // 2.0\n * ```\n * \n * This is the same as:\n * \n * ```js\n * import { Arrays } from 'https://unpkg.com/ixfx/dist/collections.js';\n * import { Easings } from 'https://unpkg.com/ixfx/dist/modulation.js';\n * \n * const data = [1,2,3];\n * const w = Arrays.weight(data, Easings.gaussian());\n * const avg = Arrays.averageWeighted(data, w); // 2.0\n * ```\n * @param data Data to average\n * @param weightings Array of weightings that match up to data array, or an easing function \n */\nexport const averageWeighted = (data:readonly number[], weightings:(readonly number[])|Easings.EasingFn):number => {\n  if (typeof weightings === `function`) weightings = weight(data, weightings);\n\n  const ww = zip(data, weightings);\n  const [totalV, totalW] = ww.reduce((acc, v:number[]) => [acc[0] + (v[0]*v[1]), acc[1] + v[1]], [0, 0]);\n  return totalV/totalW;\n};\n\n/**\n * Returns the minimum number out of `data`.\n * Undefined and non-numbers are silently ignored.\n * \n * ```js\n * import { Arrays } from 'https://unpkg.com/ixfx/dist/collections.js';\n * Arrays.min([10, 20, 0]); // Yields 0\n * ```\n * @param data\n * @returns Minimum number\n */\nexport const min = (data:readonly number[]):number => Math.min(...validNumbers(data));\n\n/**\n * Returns the index of the largest value.\n * ```js\n * import { Arrays } from 'https://unpkg.com/ixfx/dist/collections.js';\n * const v = [ 10, 40, 5 ];\n * Arrays.maxIndex(v); // Yields 1\n * ```\n * @param data Array of numbers \n * @returns Index of largest value\n */\nexport const maxIndex = (data:readonly number[]):number => data.reduce((bestIndex, value, index, arr) => (value > arr[bestIndex] ? index : bestIndex), 0);\n\n/**\n * Returns the index of the smallest value.\n * \n * ```js\n * import { Arrays } from 'https://unpkg.com/ixfx/dist/collections.js';\n * const v = [ 10, 40, 5 ];\n * Arrays.minIndex(v); // Yields 2\n * ```\n * @param data Array of numbers \n * @returns Index of smallest value\n */\nexport const minIndex = (...data:readonly number[]):number => data.reduce((bestIndex, value, index, arr) => (value < arr[bestIndex] ? index : bestIndex), 0);\n\n/**\n * Returns the maximum number out of `data`.\n * Undefined and non-numbers are silently ignored.\n * \n * ```js\n * import { Arrays } from 'https://unpkg.com/ixfx/dist/collections.js';\n * Arrays.max(100, 200, 50); // 200\n * ```\n * @param data List of numbers\n * @returns Maximum number\n */\nexport const max = (data:readonly number[]):number => Math.max(...validNumbers(data));\n\n/**\n * Returns the total of `data`.\n * Undefined and non-numbers are silently ignored.\n * \n * ```js\n * import { Arrays } from 'https://unpkg.com/ixfx/dist/collections.js';\n * Arrays.total([1, 2, 3]); // 6\n * ```\n * @param data Array of numbers\n * @returns Total\n */\nexport const total = (data:readonly number[]):number => data.reduce((prev, curr) => {\n  if (typeof curr !== `number`) return prev;\n  if (Number.isNaN(curr)) return prev;\n  if (Number.isFinite(curr)) return prev;\n  return prev + curr;\n}, 0);\n\n/**\n * Returns the maximum out of `data` without pre-filtering for speed.\n * \n * For most uses, {@link max} should suffice.\n * \n * ```js\n * import { Arrays } from 'https://unpkg.com/ixfx/dist/collections.js';\n * Arrays.maxFast([ 10, 0, 4 ]); // 10\n * ```\n * @param data \n * @returns Maximum\n */\nexport const maxFast = (data:readonly number[]|Float32Array):number => {\n  //eslint-disable-next-line functional/no-let\n  let m = Number.MIN_SAFE_INTEGER;\n  //eslint-disable-next-line functional/no-let\n  for (let i=0;i<data.length;i++) {\n    m = Math.max(m, data[i]);\n  }\n  return m;\n};\n\n/**\n * Returns the total of `data` without pre-filtering for speed.\n * \n * For most uses, {@link total} should suffice.\n * \n * ```js\n * import { Arrays } from 'https://unpkg.com/ixfx/dist/collections.js';\n * Arrays.totalFast([ 10, 0, 4 ]); // 14\n * ```\n * @param data \n * @returns Maximum\n */\nexport const totalFast = (data:readonly number[]|Float32Array):number => {\n  //eslint-disable-next-line functional/no-let\n  let m = 0;\n  //eslint-disable-next-line functional/no-let\n  for (let i=0;i<data.length;i++) {\n    m += data[i];\n  }\n  return m;\n};\n\n/**\n * Returns the maximum out of `data` without pre-filtering for speed.\n * \n * For most uses, {@link max} should suffice.\n * \n * ```js\n * import { Arrays } from 'https://unpkg.com/ixfx/dist/collections.js';\n * Arrays.minFast([ 10, 0, 100 ]); // 0\n * ```\n * @param data \n * @returns Maximum\n */\nexport const minFast = (data:readonly number[]|Float32Array):number => {\n  //eslint-disable-next-line functional/no-let\n  let m = Number.MIN_SAFE_INTEGER;\n  //eslint-disable-next-line functional/no-let\n  for (let i=0;i<data.length;i++) {\n    m = Math.min(m, data[i]);\n  }\n  return m;\n};\n\nexport type MinMaxAvgTotal = {\n  /**\n   * Smallest value in array\n   */\n  readonly min:number \n  /**\n   * Total of all items\n   */\n  readonly total:number \n  /**\n   * Largest value in array\n   */\n  readonly max:number\n  /**\n   * Average value in array\n   */\n  readonly avg:number\n};\n\n/**\n * Returns the min, max, avg and total of the array.\n * Any values that are invalid are silently skipped over.\n * \n * ```js\n * import { Arrays } from 'https://unpkg.com/ixfx/dist/collections.js';\n * \n * const v = [10, 2, 4.2, 99];\n * const mma = Arrays.minMaxAvg(v);\n * Yields: { min: 2, max: 99, total: 115.2, avg: 28.8 }\n * ```\n * \n * Use {@link average}, {@link max}, {@link min} or {@link total} if you only need one of these. \n * \n * A start and end range can be provided if the calculation should be restricted to a part\n * of the input array. By default the whole array is used.\n * \n * @param data\n * @param startIndex If provided, starting index to do calculations (defaults full range)\n * @param endIndex If provided, the end index to do calculations (defaults full range)\n * @returns `{min, max, avg, total}`\n */\nexport const minMaxAvg = (data:readonly number[], startIndex?:number, endIndex?:number):MinMaxAvgTotal  => {\n  if (data === undefined) throw new Error(`'data' is undefined`);\n  if (!Array.isArray(data)) throw new Error(`'data' parameter is not an array`);\n  \n  if (data.length === 0) {\n    return {\n      total: 0,\n      min: 0,\n      max: 0,\n      avg: 0\n    };\n  }\n  if (startIndex === undefined) startIndex = 0;\n  if (endIndex === undefined) endIndex = data.length - 1;\n\n  const validNumbers = filterBetween<number>(data, d => typeof d === `number` && !Number.isNaN(d), startIndex, endIndex);\n  const total = validNumbers.reduce((acc, v) => acc + v, 0);\n  return {\n    total: total,\n    max: Math.max(...validNumbers),\n    min: Math.min(...validNumbers),\n    avg: total / validNumbers.length\n  };\n};","import {clamp} from \"./Clamp.js\";\nimport { number as guardNumber} from \"../Guards.js\";\n\n/**\n * Scales `v` from an input range to an output range (aka `map`)\n * \n * For example, if a sensor's useful range is 100-500, scale it to a percentage:\n * \n * ```js\n * import { scale } from 'https://unpkg.com/ixfx/dist/data.js';\n * \n * scale(sensorReading, 100, 500, 0, 1);\n * ```\n * \n * `scale` defaults to a percentage-range output, so you can get away with:\n * ```js\n * scale(sensorReading, 100, 500);\n * ```\n * \n * If `v` is outside of the input range, it will likewise be outside of the output range.\n * Use {@link scaleClamped} to clip value to range.\n * \n * If inMin and inMax are equal, outMax will be returned.\n * \n * An easing function can be provided for non-linear scaling. In this case\n * the input value is 'pre scaled' using the function before it is applied to the\n * output range.\n * \n * ```js\n * scale(sensorReading, 100, 500, 0, 1, Easings.gaussian());\n * ```\n * @param v Value to scale\n * @param inMin Input minimum\n * @param inMax Input maximum\n * @param outMin Output minimum. If not specified, 0\n * @param outMax Output maximum. If not specified, 1\n * @param easing Easing function\n * @returns Scaled value\n */\nexport const scale = (\n  v:number, \n  inMin:number, inMax:number, \n  outMin?:number, outMax?:number,\n  easing?:(v:number)=>number\n):number => {\n  if (outMax === undefined) outMax = 1;\n  if (outMin === undefined) outMin = 0;\n  if (inMin === inMax) return outMax;\n\n  //eslint-disable-next-line functional/no-let\n  let a = (v - inMin) / (inMax - inMin);\n  if (easing !== undefined) a = easing(a);\n  return a * (outMax - outMin) + outMin;\n};\n\n/**\n * As {@link scale}, but result is clamped to be\n * within `outMin` and `outMax`.\n * @param v \n * @param inMin \n * @param inMax \n * @param outMin \n * @param outMax \n * @param easing \n * @returns \n */\nexport const scaleClamped = (\n  v:number, \n  inMin:number, inMax:number, \n  outMin?:number, outMax?:number,\n  easing?:(v:number)=>number\n):number => {\n\n  if (outMax === undefined) outMax = 1;\n  if (outMin === undefined) outMin = 0;\n  if (inMin === inMax) return outMax;\n  \n  const x = scale(v, inMin, inMax, outMin, outMax, easing);\n  return clamp(x, outMin, outMax);\n};\n\n/**\n * Scales an input percentage to a new percentage range.\n * \n * If you have an input percentage (0-1), `scalePercentageOutput` maps it to an\n * _output_ percentage of `outMin`-`outMax`.\n * \n * ```js\n * import { scalePercentages } from 'https://unpkg.com/ixfx/dist/data.js';\n * \n * // Scales 50% to a range of 0-10%\n * scalePercentages(0.5, 0, 0.10); // 0.05 - 5%\n * ```\n * \n * An error is thrown if any parameter is outside of percentage range. This added\n * safety is useful for catching bugs. Otherwise, you could just as well call\n * `scale(percentage, 0, 1, outMin, outMax)`.\n * \n * If you want to scale some input range to percentage output range, just use `scale`:\n * ```js\n * import { scale } from 'https://unpkg.com/ixfx/dist/data.js';\n * \n * // Yields 0.5\n * scale(2.5, 0, 5);\n * ```\n * @param percentage Input value, within percentage range\n * @param outMin Output minimum, between 0-1\n * @param outMax Output maximum, between 0-1\n * @returns Scaled value between outMin-outMax.\n */\nexport const scalePercentages = (percentage:number, outMin:number, outMax:number = 1):number => {\n  guardNumber(percentage, `percentage`, `v`);\n  guardNumber(outMin, `percentage`, `outMin`);\n  guardNumber(outMax, `percentage`, `outMax`);\n  return scale(percentage, 0, 1, outMin, outMax);\n};\n\n\n/**\n * Scales an input percentage value to an output range\n * If you have an input percentage (0-1), `scalePercent` maps it to an output range of `outMin`-`outMax`.\n * ```js\n * import { scalePercent } from 'https://unpkg.com/ixfx/dist/data.js';\n * scalePercent(0.5, 10, 20); // 15\n * ```\n * \n * @param v Value to scale\n * @param outMin Minimum for output\n * @param outMax Maximum for output\n * @returns \n */\nexport const scalePercent = (v:number, outMin:number, outMax:number):number => {\n  guardNumber(v, `percentage`, `v`);\n  return scale(v, 0, 1, outMin, outMax);\n};\n","import * as Arcs from './Arc.js';\nimport * as Beziers from './Bezier.js';\nimport * as Circles from './Circle.js';\nimport * as Compound from './CompoundPath.js';\nimport * as Grids from './Grid.js';\nimport * as Lines from './Line.js';\nimport * as Paths from './Path.js';\nimport * as Points from './Point.js';\nimport * as Rects from './Rect.js';\nimport * as Ellipses from './Ellipse.js';\nimport * as Shapes from './Shape.js';\nimport * as Vectors from './Vector.js';\nimport * as Waypoints from './Waypoint.js';\nimport * as Spheres from './Sphere.js';\nimport * as Polar from './Polar.js';\n\nexport { Circles, Lines, Rects, Points, Paths, Grids, Beziers, Compound, Ellipses,  Waypoints, Spheres };\n\nexport * as Scaler from './Scaler.js';\n\n/**\n * Work with arcs. Arcs are a angle-limited circle, describing a wedge.\n * \n * {@link ArcPositioned} has a origin x,y.\n * \n * Conversions:\n * - {@link fromDegrees}\n * - {@link toLine}: A line from start/end position of arc\n * - {@link toSvg}: Returns an SVG representation of arc\n * \n * Calculations:\n * - {@link bbox}: Bounding box\n * - {@link interpolate}: Interplate two arcs\n * - {@link point}: Find a point on the arc, given an angle\n * - {@link length}: Circumference of arc\n * \n * Comparisons:\n * - {@link isArc}: Returns true if object is Arc-ish\n * - {@link isEqual}: Returns true if two objects have identical arc properties\n */\nexport { Arcs };\n\n/**\n * Generate a few basic geometric shapes\n * Overview:\n * * {@link arrow}\n * * {@link starburst}\n */\nexport { Shapes };\n\n/**\n * Helper functions for working with vectors, which can either be a {@link Points.Point} or Polar {@link Polar.Coord}.\n * While most of the functionality is provided in either of those modules, the Vector module lets you cleanly\n * interoperate between these two coordinates.\n */\nexport { Vectors };\n\n/**\n * Work with Polar coordinates.\n * A Polar {@link Coord} is just `{ angleRadians:number, distance: number }`.\n * \n * Conversion: {@link toCartesian}, {@link fromCartesian}, {@link toString}\n * \n * Math: {@link divide}, {@link invert}, {@link multiply}, {@link dotProduct}\n * \n * Geometric manipulations: {@link rotate}, {@link rotateDegrees}\n * \n * Cleaning: {@link clampMagnitude}, {@link normalise}\n * \n * Debugging: {@link toString}\n * \n * Comparisons: {@link isAntiParallel}, {@link isOpposite}, {@link isParallel}, {@link isCoord}\n */\nexport { Polar };\n\n/**\n * Functions for producing points within a shape.\n * Useful for creating patterns.\n * \n * Overview:\n * * {@link sphereFibonacci}: Generate points on a sphere\n * * {@link vogelSpiral}: Generate a sunflower-esque pattern of points in a circle \n */\nexport * as SurfacePoints from './SurfacePoints.js';\n\n/**\n * Triangle processing.\n * \n * Helpers for creating:\n * - {@link Triangles.fromFlatArray}: Create from `[ x1, y1, x2, y2, x3, y3 ]`\n * - {@link Triangles.fromPoints}: Create from three `{ x, y }` sets\n * - {@link Triangles.fromRadius}: Equilateral triangle of a given radius and center\n * \n * There are sub-modules for dealing with particular triangles:\n * - {@link Triangles.Equilateral}: Equilateral triangls\n * - {@link Triangles.Right}: Right-angled triangles\n * - {@link Triangles.Isosceles}: Iscosceles triangles\n * \n * Calculations\n * - {@link angles}: Internal angles in radians. {@link anglesDegrees} for degrees. \n * - {@link area}: Area of triangle\n * - {@link bbox}: Bounding box\n * - {@link centroid}: Centroid of triangle\n * - {@link perimeter}: Calculate perimeter\n * - {@link lengths}: Return array lengths of triangle's edges\n * - {@link rotate}, {@link rotateByVertex}\n * \n * Conversions\n * - {@link edges}: Edges of triangle as {@link Lines.Line}\n * - {@link corners}: Corner positions\n * - {@link innerCircle}: Largest circle to fit within triangle\n * - {@link outerCircle}: Largest circle to enclose triangle\n * - {@link toFlatArray}\n * \n * Comparisons\n * - {@link intersectsPoint}: Whether a point intersects triangle\n * - {@link isEqual}: Check whether two triangles have equal values\n * - {@link isAcute}, {@link isEquilateral}, {@link isIsosceles}, {@link isRightAngle}\n * - {@link isTriangle}: Returns true if object has expected properties of a triangle\n */\nexport * as Triangles from './Triangle.js';\n\n/**\n * Convert angle in degrees to angle in radians.\n * @param angleInDegrees \n * @returns \n */\nexport function degreeToRadian(angleInDegrees:number):number;\n\n/**\n * Convert angles in degrees to angles in radians\n * @param angleInDegrees \n */\nexport function degreeToRadian(angleInDegrees:readonly number[]):readonly number[];\n\n//eslint-disable-next-line func-style\nexport function degreeToRadian(angleInDegrees:number|readonly number[]):number|readonly number[] {\n  if (Array.isArray(angleInDegrees)) {\n    return angleInDegrees.map(v => v * (Math.PI / 180.0));\n  } else {\n    return (angleInDegrees as number) * (Math.PI / 180.0);\n  }\n}\n\n/**\n * Convert angle in radians to angle in degrees\n * @param angleInRadians\n * @returns \n */\nexport function radianToDegree(angleInRadians:number):number;\n\n/**\n * Convert angles in radians to angles in degrees\n * @param angleInRadians \n */\nexport function radianToDegree(angleInRadians:readonly number[]):readonly number[];\n\n//eslint-disable-next-line func-style\nexport function radianToDegree(angleInRadians:number|readonly number[]):number| readonly number[] {\n  if (Array.isArray(angleInRadians)) {\n    return angleInRadians.map(v => v * 180 / Math.PI);\n  } else {\n    return (angleInRadians as number) * 180 / Math.PI;\n  }\n}\n\n/**\n * Angle from x-axis to point (ie. `Math.atan2`)\n * @param point \n * @returns \n */\nexport const radiansFromAxisX = (point:Points.Point):number => Math.atan2(point.x, point.y);\n\ntry {\n  if (typeof window !== `undefined`) {\n    //eslint-disable-next-line functional/immutable-data,@typescript-eslint/no-explicit-any\n    (window as any).ixfx = { ...(window as any).ixfx, Geometry: { Circles, Arcs, Lines, Rects, Points, Paths, Grids, Beziers, Compound, Ellipses, Polar, Shapes, radiansFromAxisX, radianToDegree, degreeToRadian } };\n  }\n} catch { /* no-op */ }","import { degreeToRadian, Polar } from './index.js';\nimport { guard as guardPoint, isPoint } from './Point.js';\nimport { Path } from './Path.js';\nimport { Lines, Points, Rects } from './index.js';\n\n/**\n * Returns true if parameter is an arc\n * @param p Arc or number\n * @returns \n */\nexport const isArc = (p:Arc|number|unknown):p is Arc => (p as Arc).startRadian !== undefined && (p as Arc).endRadian !== undefined;\n\n/**\n * Returns true if parameter has a positioned (x,y) \n * @param p Point, Arc or ArcPositiond\n * @returns \n */\nexport const isPositioned = (p:Points.Point | Arc| ArcPositioned):p is Points.Point => (p as Points.Point).x !== undefined && (p as Points.Point).y !== undefined;\n\n/**\n * Arc, defined by radius, start and end point in radians, and whether it is counter-clockwise.\n */\nexport type Arc = {\n/**\n * Radius of arc\n */\n  readonly radius:number\n/**\n * Start radian\n */\n  readonly startRadian:number\n/**\n * End radian\n */\n  readonly endRadian:number\n/**\n * If true, arc is counter-clockwise\n */\n  readonly counterClockwise?:boolean\n}\n\n/**\n * An {@link Geometry.Arcs.Arc} that also has a position, given in x, y\n */\nexport type ArcPositioned = Points.Point & Arc;\n\nconst piPi = Math.PI *2;\n\n/**\n * Returns an arc from degrees, rather than radians\n * @param radius Radius of arc\n * @param startDegrees Start angle in degrees\n * @param endDegrees End angle in degrees\n * @param origin Optional center of arc\n * @returns Arc\n */\nexport function fromDegrees(radius:number, startDegrees:number, endDegrees:number):Arc;\nexport function fromDegrees(radius:number, startDegrees:number, endDegrees:number, origin:Points.Point):ArcPositioned\n\n//eslint-disable-next-line func-style\nexport function fromDegrees(radius:number, startDegrees:number, endDegrees:number, origin?:Points.Point):Arc|ArcPositioned  {\n  const a:Arc = {\n    radius,\n    startRadian:degreeToRadian(startDegrees),\n    endRadian:degreeToRadian(endDegrees)\n  };\n  if (isPoint(origin)) {\n    guardPoint(origin);\n    const ap:ArcPositioned = {\n      ...a,\n      x: origin.x,\n      y: origin.y\n    };\n    return Object.freeze(ap);\n  } else {\n    return Object.freeze(a);\n  }\n}\n\n/**\n * Returns a {@link Geometry.Lines.Line} linking the start and end points of an {@link ArcPositioned}.\n *\n * @param arc\n * @returns Line from start to end of arc\n */\nexport const toLine = (arc:ArcPositioned):Lines.Line => Lines.fromPoints(\n  point(arc, arc.startRadian),\n  point(arc, arc.endRadian)\n);\n\n/**\n * Calculates a coordinate on an arc, based on an angle\n * @param arc Arc\n * @param angleRadian Angle of desired coordinate \n * @param origin Origin of arc (0,0 used by default)\n * @returns Coordinate\n */\nexport const point = (arc:Arc|ArcPositioned, angleRadian:number, origin?:Points.Point):Points.Point => {\n  if (angleRadian > arc.endRadian) throw new Error(`angleRadian beyond end angle of arc`);\n  if (angleRadian < arc.startRadian) throw new Error(`angleRadian beyond start angle of arc`);\n\n  if (origin === undefined) {\n    if (isPositioned(arc)) {\n      origin = arc;\n    } else {\n      origin = { x:0, y:0 };\n    }\n  }\n  return {\n    x: (Math.cos(angleRadian) * arc.radius) + origin.x,\n    y: (Math.sin(angleRadian) * arc.radius) + origin.y\n  };\n};\n\n/**\n * Throws an error if arc instance is invalid\n * @param arc \n */\nexport const guard = (arc:Arc|ArcPositioned) => {\n  if (arc === undefined) throw new Error(`Arc is undefined`);\n  if (isPositioned(arc)) {\n    guardPoint(arc, `arc`);\n  }\n  if (arc.radius === undefined) throw new Error(`Arc radius is undefined (${JSON.stringify(arc)})`);\n  if (typeof arc.radius !== `number`) throw new Error(`Radius must be a number`);\n  if (Number.isNaN(arc.radius)) throw new Error(`Radius is NaN`);\n  if (arc.radius <= 0) throw new Error(`Radius must be greater than zero`);\n\n  if (arc.startRadian === undefined) throw new Error(`Arc is missing 'startRadian' field`);\n  if (arc.endRadian === undefined) throw new Error(`Arc is missing 'startRadian' field`);\n  if (Number.isNaN(arc.endRadian)) throw new Error(`Arc endRadian is NaN`);\n  if (Number.isNaN(arc.startRadian)) throw new Error(`Arc endRadian is NaN`);\n\n  if (arc.startRadian >= arc.endRadian) throw new Error(`startRadian is expected to be les than endRadian`);  \n};\n\n\ntype Interpolate = {\n  (amount:number, arc:Arc, origin:Points.Point):Points.Point;\n  (amount:number, arc:ArcPositioned):Points.Point;\n};\n\n/**\n * Compute relative position on arc\n * @param arc Arc\n * @param amount Relative position 0-1\n * @param origin If arc is not positioned, pass in an origin\n * @returns \n */\nexport const interpolate:Interpolate = (amount:number, arc:ArcPositioned|Arc, origin?:Points.Point):Points.Point => {\n  guard(arc);\n  return point(arc, arc.startRadian + ((arc.endRadian-arc.startRadian)*amount), origin);\n};\n\n/**\n * Creates a {@link Geometry.Paths.Path} instance from the arc. This wraps up some functions for convienence.\n * @param arc \n * @returns Path\n */\nexport const toPath = (arc:ArcPositioned):Path => {\n  guard(arc);\n\n  return Object.freeze({\n    ...arc,\n    nearest:(point:Points.Point) => { throw new Error(`not implemented`); },\n    interpolate:(amount:number) => interpolate(amount, arc),\n    bbox:() => bbox(arc) as Rects.RectPositioned,\n    length: () => length(arc),\n    toSvgString:() => toSvg(arc),\n    kind: `arc`\n  });\n};\n\n/**\n * Calculates the length of the arc\n * @param arc \n * @returns Length\n */\nexport const length = (arc:Arc):number =>  piPi*arc.radius*((arc.startRadian-arc.endRadian)/piPi);\n\n/**\n * Calculates a {@link Geometry.Rects.Rect | Rect} bounding box for arc.\n * @param arc \n * @returns Rectangle encompassing arc.\n */\nexport const bbox = (arc:ArcPositioned|Arc):Rects.RectPositioned|Rects.Rect => {\n  if (isPositioned(arc)) {\n    const middle = interpolate(0.5, arc);\n    const asLine = toLine(arc);\n    return Points.bbox(middle, asLine.a, asLine.b);\n  } else {\n    return {\n      width: arc.radius*2,\n      height: arc.radius*2\n    };\n  }\n};\n\n\ntype ToSvg = {\n  /**\n   * SVG path for arc description\n   * @param origin Origin of arc\n   * @param radius Radius\n   * @param startRadian Start\n   * @param endRadian End\n   */\n  (origin:Points.Point, radius:number, startRadian:number, endRadian:number, opts?:SvgOpts):readonly string[];\n  /**\n   * SVG path for non-positioned arc\n   */\n  (arc:Arc, origin:Points.Point, opts?:SvgOpts):readonly string[];\n/**\n * SVG path for positioned arc\n */\n  (arc:ArcPositioned, opts?:SvgOpts):readonly string[];\n};\n\n\n/**\n * Creates an SV path snippet for arc\n * @returns \n */\nexport const toSvg:ToSvg = (a:Points.Point|Arc|ArcPositioned, b?:number|Points.Point|SvgOpts, c?:number|SvgOpts, d?:number, e?:SvgOpts) => {\n  if (isArc(a)) {\n    if (isPositioned(a)) {\n      return toSvgFull(a, a.radius, a.startRadian, a.endRadian, b as SvgOpts);\n    } else {\n      if (isPoint(b)) {\n        return toSvgFull(b, a.radius, a.startRadian, a.endRadian, c as SvgOpts);\n      } else {\n        return toSvgFull({ x: 0, y: 0 }, a.radius, a.startRadian, a.endRadian);\n      }\n    }\n  } else {\n    if (c === undefined) throw new Error(`startAngle undefined`);\n    if (d === undefined) throw new Error(`endAngle undefined`);\n   \n    if (isPoint(a)) {\n      if (typeof b === `number` && typeof c ===  `number` && typeof d === `number`) {\n        return toSvgFull(a, b, c, d, e);\n      } else {\n        throw new Error(`Expected (point, number, number, number). Missing a number param.`);\n      }\n    } else {\n      throw new Error(`Expected (point, number, number, number). Missing first point.`);\n    }\n  } \n};\n\nexport type SvgOpts = {\n  \n  /**\n   * \"If the arc should be greater or less than 180 degrees\"\n   * ie. tries to maximise arc length\n   */\n  readonly largeArc?:boolean\n  \n  /**\n   * \"If the arc should begin moving at positive angles\"\n   * ie. the kind of bend it makes to reach end point\n   */\n  readonly sweep?:boolean\n}\n\nconst toSvgFull = (origin:Points.Point, radius:number, startRadian:number, endRadian:number, opts?:SvgOpts):readonly string[] => {\n  // https://developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths\n  // A rx ry x-axis-rotation large-arc-flag sweep-flag x y\n  // a rx ry x-axis-rotation large-arc-flag sweep-flag dx dy\n\n  if (opts === undefined || typeof opts !== `object`) opts = {};\n\n  const isFullCircle = endRadian - startRadian === 360;\n  const start = Polar.toCartesian(radius, endRadian - 0.01, origin);\n  const end = Polar.toCartesian(radius, startRadian, origin);\n  \n  const { largeArc = false, sweep = false } = opts;\n\n  const d = [`\n    M ${start.x} ${start.y}\n    A ${radius} ${radius} 0 ${largeArc ? `1` : `0`} ${sweep ? `1` : `0`} ${end.x} ${end.y},\n  `];\n\n  //eslint-disable-next-line functional/immutable-data\n  if (isFullCircle) d.push(`z`);\n\n  return d;\n};\n\n/**\n * Calculates the distance between the centers of two arcs\n * @param a\n * @param b \n * @returns Distance \n */\nexport const distanceCenter = (a:ArcPositioned, b:ArcPositioned):number => Points.distance(a, b);\n\n/**\n * Returns true if the two arcs have the same values\n *\n * ```js\n * const arcA = { radius: 5, endRadian: 0, startRadian: 1 };\n * const arcA = { radius: 5, endRadian: 0, startRadian: 1 };\n * arcA === arcB; // false, because object identities are different\n * Arcs.isEqual(arcA, arcB); // true, because values are identical\n * ```\n * @param a\n * @param b\n * @returns {boolean}\n */\nexport const isEqual = (a:Arc|ArcPositioned, b:Arc|ArcPositioned):boolean => {\n  if (a.radius !== b.radius) return false;\n\n  if (isPositioned(a) && isPositioned(b)) {\n    if (a.x !== b.x) return false;\n    if (a.y !== b.y) return false;\n    if (a.z !== b.z) return false;\n    return true;\n  } else if (!isPositioned(a) && !isPositioned(b)) {\n    // no-op\n  } else return false; // one is positioned one not\n\n  if (a.endRadian !== b.endRadian) return false;\n  if (a.startRadian !== b.startRadian) return false;\n  return true;\n};","import { Circles, Lines, Points, Polar, Rects } from \"./index.js\";\nimport { interpolate as lineInterpolate } from './Line.js';\nimport { number as guardNumber } from '../Guards.js';\nimport { clamp as clampNumber, wrap as wrapNumber } from '../data/index.js';\nimport { Arrays } from \"../collections/index.js\";\nimport { RandomSource, defaultRandom } from \"../Random.js\";\nimport { quantiseEvery as quantiseEveryNumber } from \"../Numbers.js\";\n/**\n * A point, consisting of x, y and maybe z fields.\n */\nexport type Point = {\n  readonly x:number\n  readonly y:number\n  readonly z?:number\n};\n\nexport type Point3d = Point & {\n  readonly z:number\n};\n\n/**\n * Returns a Point form of either a point, x,y params or x,y,z params.\n * If parameters are undefined, an empty point is returned (0, 0)\n * @ignore\n * @param a \n * @param b \n * @returns \n */\nexport function getPointParam(a?:Point|number, b?:number|boolean, c?:number):Point|Point3d {\n  if (a === undefined) return { x:0, y:0 };\n\n  if (Points.isPoint(a)) {\n    return a;\n  } else if (typeof a !== `number` || typeof b !== `number`) {\n    throw new Error(`Expected point or x,y as parameters. Got: a: ${JSON.stringify(a)} b: ${JSON.stringify(b)}`);\n  }\n  \n  // x,y,z\n  if (typeof c === `number`) {\n    return Object.freeze({ x: a, y: b, z:c });\n  } \n  // x,y\n  return Object.freeze({ x: a, y: b });\n}\n\nexport const dotProduct = (...pts:readonly Point[]):number => {\n  const a = pts.map(p => Points.toArray(p));\n  return Arrays.dotProduct(a);\n};\n\n/**\n * An empty point of `{ x:0, y:0 }`.\n * \n * Use `isEmpty` to check if a point is empty.\n */\n//eslint-disable-next-line @typescript-eslint/naming-convention\nexport const Empty = Object.freeze({ x:0, y: 0 });\n\n/**\n * Placeholder point, where x and y is `NaN`.\n * Use `isPlaceholder` to check if a point is a placeholder.\n */\n//eslint-disable-next-line @typescript-eslint/naming-convention\nexport const Placeholder = Object.freeze({ x:NaN, y:NaN });\n\n/**\n * Returns true if both x and y is 0.\n * Use `Points.Empty` to return an empty point.\n * @param p \n * @returns \n */\nexport const isEmpty = (p:Point) => p.x === 0 && p.y === 0;\n\n/**\n * Returns true if point is a placeholder, where both x and y\n * are `NaN`.\n * \n * Use Points.Placeholder to return a placeholder point.\n * @param p \n * @returns \n */\nexport const isPlaceholder = (p:Point) => Number.isNaN(p.x) && Number.isNaN(p.y);\n\n/**\n * Returns true if p.x and p.y === null\n * @param p \n * @returns \n */\nexport const isNull = (p:Point) => p.x === null && p.y === null;\n\n/***\n * Returns true if p.x or p.y isNaN\n */\nexport const isNaN = (p:Point) => Number.isNaN(p.x) || Number.isNaN(p.y);\n/**\n * Returns the 'minimum' point from an array of points, using a comparison function.\n * \n * @example Find point closest to a coordinate\n * ```js\n * const points = [...];\n * const center = {x: 100, y: 100};\n * \n * const closestToCenter = findMinimum((a, b) => {\n *  const aDist = distance(a, center);\n *  const bDist = distance(b, center);\n *  if (aDistance < bDistance) return a;\n *  return b;\n * }, points);\n * ```\n * @param compareFn Compare function returns the smallest of `a` or `b`\n * @param points \n * @returns \n */\nexport const findMinimum = (compareFn:(a:Point, b:Point)=>Point, ...points:readonly Point[]):Point => {\n  if (points.length === 0) throw new Error(`No points provided`);\n  //eslint-disable-next-line functional/no-let\n  let min = points[0];\n  points.forEach(p => {\n    min = compareFn(min, p);\n  });\n  return min;\n};\n\n/**\n * Returns the left-most of the provided points.\n * \n * Same as: \n * ```js\n * findMinimum((a, b) => {\n *  if (a.x <= b.x) return a;\n *  return b;\n *}, ...points)\n * ```\n * \n * @param points \n * @returns \n */\nexport const leftmost = (...points:readonly Point[]):Point => findMinimum((a, b) => ((a.x <= b.x)  ?  a :  b), ...points);\n\n/**\n * Returns the right-most of the provided points.\n * \n * Same as: \n * ```js\n * findMinimum((a, b) => {\n *  if (a.x >= b.x) return a;\n *  return b;\n *}, ...points)\n * ```\n * \n * @param points \n * @returns \n */\nexport const rightmost = (...points:readonly Point[]):Point => findMinimum((a, b) => ((a.x >= b.x) ? a : b), ...points);\n\n\nexport function distance(a:Point, b:Point):number;\nexport function distance(a:Point, x:number, y:number):number;\nexport function distance(a:Point):number;\n\n/**\n * Calculate distance between two points.\n * \n * ```js`\n * // Distance between two points\n * const ptA = { x: 0.5, y:0.8 };\n * const ptB = { x: 1, y: 0.4 };\n * distance(ptA, ptB);\n * // Or, provide x,y as parameters\n * distance(ptA, 0.4, 0.9);\n * \n * // Distance from ptA to x: 0.5, y:0.8, z: 0.1\n * const ptC = { x: 0.5, y:0.5, z: 0.3 };\n * // With x,y,z as parameters:\n * distance(ptC, 0.5, 0.8, 0.1);\n * ``\n * @param a First point\n * @param xOrB Second point, or x coord\n * @param y y coord, if x coord is given\n * @param z Optional z coord, if x and y are given.\n * @returns \n */\n//eslint-disable-next-line func-style\nexport function distance(a:Point|Point3d, xOrB?:Point|Point3d|number, y?:number, z?:number):number {\n  const pt = getPointParam(xOrB, y, z);\n  guard(pt);\n  \n  if (isPoint3d(pt) && isPoint3d(a)) {\n    return Math.hypot(pt.x-a.x, pt.y-a.y, pt.z-a.z);\n  }else {\n    return Math.hypot(pt.x-a.x, pt.y-a.y);\n  }\n}\n\n/**\n * Returns the distance from point `a` to the exterior of `shape`.\n * \n * @example Distance from point to rectangle\n * ```\n * const distance = distanceToExterior(\n *  {x: 50, y: 50},\n *  {x: 100, y: 100, width: 20, height: 20}\n * );\n * ```\n * \n * @example Find closest shape to point\n * ```\n * import {minIndex} from '../collections/arrays.js';\n * const shapes = [ some shapes... ]; // Shapes to compare against\n * const pt = { x: 10, y: 10 };       // Comparison point\n * const distances = shapes.map(v => distanceToExterior(pt, v));\n * const closest = shapes[minIndex(...distances)];\n * ```\n * @param a Point\n * @param shape Point, or a positioned Rect or Circle.\n * @returns \n */\nexport const distanceToExterior = (a:Point, shape:PointCalculableShape):number => {\n  if (Rects.isRectPositioned(shape)) {\n    return Rects.distanceFromExterior(shape, a);\n  }\n  if (Circles.isCirclePositioned(shape)) {\n    return Circles.distanceFromExterior(shape, a);\n  }\n  if (isPoint(shape)) return distance(a, shape);\n  throw new Error(`Unknown shape`);\n};\n\n/**\n * Returns the distance from point `a` to the center of `shape`.\n * @param a Point\n * @param shape Point, or a positioned Rect or Circle.\n * @returns \n */\nexport const distanceToCenter = (a:Point, shape:PointCalculableShape):number => {\n  if (Rects.isRectPositioned(shape)) {\n    return Rects.distanceFromExterior(shape, a);\n  }\n  if (Circles.isCirclePositioned(shape)) {\n    return Circles.distanceFromExterior(shape, a);\n  }\n  if (isPoint(shape)) return distance(a, shape);\n  throw new Error(`Unknown shape`);\n};\n\nexport type PointCalculableShape =  Lines.PolyLine | Lines.Line | Rects.RectPositioned | Point | Circles.CirclePositioned\n\n/**\n * Throws an error if point is invalid\n * @param p \n * @param name \n */\nexport function guard(p:Point, name = `Point`) {\n  if (p === undefined) throw new Error(`'${name}' is undefined. Expected {x,y} got ${JSON.stringify(p)}`);\n  if (p === null) throw new Error(`'${name}' is null. Expected {x,y} got ${JSON.stringify(p)}`);\n  if (p.x === undefined) throw new Error(`'${name}.x' is undefined. Expected {x,y} got ${JSON.stringify(p)}`);\n  if (p.y === undefined) throw new Error(`'${name}.y' is undefined. Expected {x,y} got ${JSON.stringify(p)}`);\n  if (typeof p.x !== `number`) throw new Error(`'${name}.x' must be a number. Got ${p.x}`);\n  if (typeof p.y !== `number`) throw new Error(`'${name}.y' must be a number. Got ${p.y}`);\n \n  if (p.x === null) throw new Error(`'${name}.x' is null`);\n  if (p.y === null) throw new Error(`'${name}.y' is null`);\n  \n  if (Number.isNaN(p.x)) throw new Error(`'${name}.x' is NaN`);\n  if (Number.isNaN(p.y)) throw new Error(`'${name}.y' is NaN`);\n}\n\n/**\n * Throws if parameter is not a valid point, or either x or y is 0\n * @param pt\n * @returns \n */\nexport const guardNonZeroPoint = (pt:Point, name = `pt`) => {\n  guard(pt, name);\n  guardNumber(pt.x, `nonZero`, `${name}.x`);\n  guardNumber(pt.y, `nonZero`, `${name}.y`);\n  return true;\n};\n\n/**\n * Returns a point with Math.abs applied to x and y.\n * ```js\n * Points.abs({ x:1,  y:1  }); // { x: 1, y: 1 }\n * Points.abs({ x:-1, y:1  }); // { x: 1, y: 1 }\n * Points.abs({ x:-1, y:-1 }); // { x: 1, y: 1 }\n * ```\n * @param pt \n * @returns \n */\nexport const abs = (pt:Point) => ({\n  ...pt,\n  x: Math.abs(pt.x),\n  y: Math.abs(pt.y)\n});\n\n/**\n * Returns the angle in radians between `a` and `b`.\n * \n * Eg if `a` is the origin, and `b` is another point,\n * in degrees one would get 0 to -180 when `b` was above `a`.\n *  -180 would be `b` in line with `a`.\n * Same for under `a`.\n * \n * Providing a third point `c` gives the interior angle, where `b` is the middle point.\n * @param a \n * @param b \n * @param c\n * @returns \n */\nexport const angle = (a:Point, b?:Point, c?:Point) => {\n  if (b === undefined) {\n    return Math.atan2(a.y, a.x);\n  } else if (c !== undefined) {\n    return Math.atan2(b.y - a.y, b.x - a.x) - Math.atan2(c.y - a.y, c.x - a.x);\n  }\n  return Math.atan2(b.y - a.y, b.x - a.x);\n};\n\n/**\n * Calculates the [centroid](https://en.wikipedia.org/wiki/Centroid#Of_a_finite_set_of_points) of a set of points\n * Undefined values are skipped over.\n * \n * ```js\n * // Find centroid of a list of points\n * const c1 = centroid(p1, p2, p3, ...);\n * \n * // Find centroid of an array of points\n * const c2 = centroid(...pointsArray);\n * ```\n * @param points \n * @returns A single point\n */\nexport const centroid = (...points:readonly (Point|undefined)[]):Point => {\n  if (!Array.isArray(points)) throw new Error(`Expected list of points`); \n  const sum = points.reduce((prev, p) => {\n    if (p === undefined) return prev; // Ignore undefined\n    if (Array.isArray(p)) throw new Error(`'points' list contains an array. Did you mean: centroid(...myPoints)?`);\n    if (!isPoint(p)) throw new Error(`'points' contains something which is not a point: ${JSON.stringify(p)}`);\n    return {\n      x: prev.x + p.x,\n      y: prev.y + p.y\n    };\n  }, { x:0, y:0 });\n\n  return Object.freeze({\n    x: sum.x / points.length,\n    y: sum.y / points.length\n  });\n};\n\n/**\n * Returns the minimum rectangle that can enclose all provided points\n * @param points\n * @returns \n */\nexport const bbox = (...points:readonly Point[]):Rects.RectPositioned => {\n  const leftMost = findMinimum((a, b) => {\n    if (a.x < b.x) return a;\n    else return b;\n  }, ...points);\n  const rightMost = findMinimum((a, b) => {\n    if (a.x > b.x) return a;\n    else return b;\n  }, ...points);\n  const topMost = findMinimum((a, b) => {\n    if (a.y < b.y) return a;\n    else return b;\n  }, ...points);\n  const bottomMost = findMinimum((a, b) => {\n    if (a.y > b.y) return a;\n    else return b;\n  }, ...points);\n\n  const topLeft = { x:leftMost.x, y:topMost.y };\n  const topRight = { x:rightMost.x, y:topMost.y };\n  const bottomRight = { x:rightMost.x, y:bottomMost.y };\n  const bottomLeft = { x:leftMost.x, y:bottomMost.y };\n  return Rects.maxFromCorners(topLeft, topRight, bottomRight, bottomLeft);\n};\n\n/**\n * Returns _true_ if the parameter has x and y fields\n * @param p \n * @returns \n */\nexport function isPoint(p:number|unknown):p is Point {\n  if (p === undefined) return false;\n  if (p === null) return false;\n  if ((p as Point).x === undefined) return false;\n  if ((p as Point).y === undefined) return false;\n  return true;\n}\n\nexport const isPoint3d = (p:Point|unknown):p is Point3d => {\n  if (p === undefined) return false;\n  if (p === null) return false;\n  if ((p as Point3d).x === undefined) return false;\n  if ((p as Point3d).y === undefined) return false;\n  if ((p as Point3d).z === undefined) return false;\n  return true;\n};\n\n/**\n * Returns point as an array in the form [x,y]. This can be useful for some libraries\n * that expect points in array form.\n * \n * ```\n * const p = {x: 10, y:5};\n * const p2 = toArray(p); // yields [10,5]\n * ```\n * @param p\n * @returns\n */\nexport const toArray = (p:Point):readonly number[] => ([p.x, p.y]);\n\n/**\n * Returns a human-friendly string representation `(x, y)`.\n * If `precision` is supplied, this will be the number of significant digits.\n * @param p\n * @returns \n */\nexport function toString(p:Point, digits?:number):string  {\n  if (p === undefined) return `(undefined)`;\n  if (p === null) return `(null)`;\n\n  const x = digits ? p.x.toFixed(digits) : p.x;\n  const y = digits ? p.y.toFixed(digits) : p.y;\n\n  if (p.z !== undefined) {\n    const z = digits ? p.z.toFixed(digits) : p.z;\n    return `(${x},${y},${z})`;\n  } else {\n    return `(${x},${y})`;\n  }\n}\n\n/**\n * Returns _true_ if the points have identical values\n * \n * ```js\n * const a = {x: 10, y: 10};\n * const b = {x: 10, y: 10;};\n * a === b        // False, because a and be are different objects\n * isEqual(a, b)   // True, because a and b are same value\n * ```\n * @param a\n * @param b\n * @returns _True_ if points are equal\n */\nexport const isEqual = (...p:readonly Point[]):boolean => {\n  if (p === undefined) throw new Error(`parameter 'p' is undefined`);\n  if (p.length < 2) return true;\n\n  //eslint-disable-next-line functional/no-let\n  for (let i=1;i<p.length;i++) {\n    if (p[i].x !== p[0].x) return false;\n    if (p[i].y !== p[0].y) return false;\n  }\n  return true;\n};\n\n/**\n * Returns true if two points are within a specified range.\n * Provide a point for the range to set different x/y range, or pass a number\n * to use the same range for both axis.\n * \n * Note this simply compares x,y values it does not calcuate distance.\n *\n * @example\n * ```js\n * withinRange({x:100,y:100}, {x:101, y:101}, 1); // True\n * withinRange({x:100,y:100}, {x:105, y:101}, {x:5, y:1}); // True \n * withinRange({x:100,y:100}, {x:105, y:105}, {x:5, y:1}); // False - y axis too far \n * ```\n * @param a\n * @param b\n * @param maxRange\n * @returns \n */\nexport const withinRange = (a:Point, b:Point, maxRange:Point|number):boolean =>  {\n  if (typeof maxRange === `number`) {\n    maxRange = { x:maxRange, y:maxRange };\n  }\n  const x = Math.abs(b.x - a.x);\n  const y = Math.abs(b.y - a.y);\n  return (x <= maxRange.x && y<= maxRange.y);\n};\n\n/**\n * Returns a relative point between two points\n * ```js\n * interpolate(0.5, a, b); // Halfway point between a and b\n * ```\n * \n * Alias for Lines.interpolate(amount, a, b);\n * \n * @param amount Relative amount, 0-1\n * @param a \n * @param b \n * @param allowOverflow If true, length of line can be exceeded for `amount` of below 0 and above `1`.\n * @returns {@link Point}\n */\nexport const interpolate = (amount:number, a:Point, b:Point, allowOverflow = false):Point => lineInterpolate(amount, a, b, allowOverflow); //({x: (1-amt) * a.x + amt * b.x, y:(1-amt) * a.y + amt * b.y });\n\n/**\n * Returns a point from two coordinates or an array of [x,y]\n * @example\n * ```js\n * let p = from([10, 5]); // yields {x:10, y:5}\n * let p = from(10, 5);   // yields {x:10, y:5}\n * let p = from(10);      // yields {x:10, y:0} 0 is used for default y\n * let p = from();        // yields {x:0, y:0}  0 used for default x & y\n * ```\n * @param xOrArray\n * @param [y]\n * @returns Point\n */\nexport const from = (xOrArray?:number | readonly number[], y?:number):Point => {\n  if (Array.isArray(xOrArray)) {\n    if (xOrArray.length !== 2) throw new Error(`Expected array of length two, got ` + xOrArray.length);\n    return Object.freeze({\n      x: xOrArray[0],\n      y: xOrArray[1]\n    });\n  } else {\n    if (xOrArray === undefined) xOrArray = 0;\n    else if (Number.isNaN(xOrArray)) throw new Error(`x is NaN`);\n    if (y === undefined) y = 0;\n    else if (Number.isNaN(y)) throw new  Error(`y is NaN`);\n    return Object.freeze({ x: xOrArray as number, y: y });\n  }\n};\n\n/**\n * Returns an array of points from an array of numbers. \n * \n * Array can be a continuous series of x, y values:\n * ```\n * [1,2,3,4] would yield: [{x:1, y:2}, {x:3, y:4}]\n * ```\n * \n * Or it can be an array of arrays:\n * ```\n * [[1,2], [3,4]] would yield: [{x:1, y:2}, {x:3, y:4}]\n * ```\n * @param coords \n * @returns \n */\nexport const fromNumbers = (...coords:readonly ReadonlyArray<number>[]|readonly number[]):readonly Point[] => {\n  const pts:Point[] = [];\n\n  if (Array.isArray(coords[0])) {\n    // [[x,y],[x,y]...]\n    (coords as number[][]).forEach(coord => {\n      if (!(coord.length % 2 === 0)) throw new Error(`coords array should be even-numbered`);\n      //eslint-disable-next-line  functional/immutable-data\n      pts.push(Object.freeze({ x: coord[0], y: coord[1] }));    \n    });\n  } else {\n    // [x,y,x,y,x,y]\n    if (coords.length % 2 !== 0) throw new Error(`Expected even number of elements: [x,y,x,y...]`);\n    //eslint-disable-next-line functional/no-let\n    for (let i=0;i<coords.length;i+=2) {\n      //eslint-disable-next-line  functional/immutable-data\n      pts.push(Object.freeze({ x: coords[i] as number, y: coords[i+1] as number }));\n    }\n  }\n  return pts;\n};\n\n/**\n * Returns `a` minus `b`\n * \n * ie.\n * ```js\n * return {\n *   x: a.x - b.x,\n *   y: a.y - b.y\n * };\n * ```\n * @param a Point a\n * @param b Point b\n * @returns Point\n */\nexport function subtract(a:Point, b:Point):Point;\n\n/**\n * Returns `a` minus the given coordinates.\n * \n * ie:\n * ```js\n * return {\n *  x: a.x - x,\n *  y: a.y - y\n * }\n * ```\n * @param a Point\n * @param x X coordinate\n * @param y Y coordinate (if omitted, x is used as well)\n */\nexport function subtract (a:Point, x:number, y?:number):Point;\n\n/**\n * Subtracts two sets of x,y pairs.\n * \n * If first parameter is a Point, any additional properties of it \n * are included in returned Point.\n * @param x1 \n * @param y1 \n * @param x2 \n * @param y2 \n */\nexport function subtract (x1:number, y1:number, x2:number, y2:number):Point;\n\n//eslint-disable-next-line func-style\nexport function subtract(a:Point|number, b:Point|number, c?:number, d?:number):Point {\n  if (isPoint(a)) {\n    guard(a, `a`);\n    if (isPoint(b)) {\n      guard(b, `b`);\n      return Object.freeze({\n        ...a,\n        x: a.x - b.x,\n        y: a.y - b.y\n      });\n    } else {\n      if (c === undefined) c = b;\n      return Object.freeze({\n        ...a,\n        x: a.x - b,\n        y: a.y - c\n      });\n    }\n  } else {\n    guardNumber(a, ``, `a`);\n    if (typeof b !== `number`) throw new Error(`Second parameter is expected to by y value`);\n    guardNumber(b, ``, `b`);\n\n    if (Number.isNaN(c)) throw new Error(`Third parameter is NaN`);\n    if (Number.isNaN(d)) throw new Error(`Fourth parameter is NaN`);\n\n    if (c === undefined) c = 0;\n    if (d === undefined) d = 0;\n    return Object.freeze({\n      x: a - c,\n      y: b - d\n    });\n  }\n}\n\n/**\n * Applies `fn` on `x` and `y` fields, returning all other fields as well\n * ```js\n * const p = {x:1.234, y:4.9};\n * const p2 = Points.apply(p, Math.round);\n * // Yields: {x:1, y:5}\n * ```\n * \n * The name of the field is provided as well. Here we only round the `x` field:\n * \n * ```js\n * const p = {x:1.234, y:4.9};\n * const p2 = Points.apply(p, (v, field) => {\n *  if (field === `x`) return Math.round(v);\n *  return v;\n * });\n * ```\n * @param pt \n * @param fn \n * @returns \n */\nexport const apply = (pt:Point, fn:(v:number, field?:string)=>number):Point => (Object.freeze<Point>({\n  ...pt,\n  x: fn(pt.x, `x`),\n  y: fn(pt.y, `y`)\n}));\n\n\n/**\n * Runs a sequential series of functions on `pt`. The output from one feeding into the next.\n * ```js\n * const p = Points.pipelineApply(somePoint, Points.normalise, Points.invert);\n * ```\n * \n * If you want to make a reusable pipeline of functions, consider {@link pipeline} instead.\n * @param pt \n * @param pipeline \n * @returns \n */\nexport const pipelineApply = (pt:Point, ...pipelineFns:readonly ((pt:Point)=>Point)[]):Point => pipeline(...pipelineFns)(pt); // pipeline.reduce((prev, curr) => curr(prev), pt);\n\n/**\n * Returns a pipeline function that takes a point to be transformed through a series of functions\n * ```js\n * // Create pipeline\n * const p = Points.pipeline(Points.normalise, Points.invert);\n * \n * // Now run it on `somePoint`.\n * // First we normalised, and then invert\n * const changedPoint = p(somePoint);\n * ```\n * \n * If you don't want to create a pipeline, use {@link pipelineApply}.\n * @param pipeline Pipeline of functions\n * @returns\n */\nexport const pipeline = (...pipeline:readonly ((pt:Point)=>Point)[]) => (pt:Point) => pipeline.reduce((prev, curr) => curr(prev), pt);\n\n/**\n * Reduces over points, treating _x_ and _y_ separately.\n * \n * ```\n * // Sum x and y values\n * const total = Points.reduce(points, (p, acc) => {\n *  return {x: p.x + acc.x, y: p.y + acc.y}\n * });\n * ```\n * @param pts Points to reduce\n * @param fn Reducer\n * @param initial Initial value, uses `{ x:0, y:0 }` by default\n * @returns \n */\nexport const reduce = (pts:readonly Point[], fn:(p:Point, accumulated:Point)=>Point, initial:Point = { x:0, y:0 }):Point => {\n  //eslint-disable-next-line functional/no-let\n  let acc = initial;\n  pts.forEach(p => {\n    acc = fn(p, acc);\n  });\n  return acc;\n};\n\ntype Sum = {\n  /**\n   * Adds two sets of coordinates. If y is omitted, the parameter for x is added to both x and y\n   */\n  (aX:number, aY:number, bX:number, bY:number):Point;\n  /**\n   * Add x,y to a\n   */\n  (a:Point, x:number, y?:number):Point;\n  /**\n   * Add two points\n   */\n  (a:Point, b?:Point):Point;\n};\n\n/**\n * Returns a Point of `a` plus `b`. ie:\n * \n * ```js\n * return {\n *   x: a.x + b.x,\n *   y: a.y + b.y\n * };\n * ```\n * \n * Usage:\n * \n * ```js\n * sum(ptA, ptB);\n * sum(x1, y1, x2, y2);\n * sum(ptA, x2, y2);\n * sum(ptA, xAndY);\n * ```\n */\nexport const sum:Sum = function (a:Point|number, b:Point|number|undefined, c?:number, d?:number):Point {\n  //  Unit tested\n  if (a === undefined) throw new Error(`a missing. a: ${a}`);\n  \n  //eslint-disable-next-line functional/no-let\n  let ptA:Point|undefined;\n  //eslint-disable-next-line functional/no-let\n  let ptB:Point|undefined;\n  if (isPoint(a)) {\n    ptA = a;\n    if (b === undefined) b = Empty;\n    if (isPoint(b)) {\n      ptB = b;\n    } else {\n      if (b === undefined) throw new Error(`Expects x coordinate`);\n      ptB = { x: b, y: (c === undefined ? b : c) };    \n    }\n  } else if (!isPoint(b)) {\n    // Neither of first two params are points\n    if (b === undefined) throw new Error(`Expected number as second param`);\n    ptA = { x: a, y: b };\n    if (c === undefined) throw new Error(`Expects x coordiante`);\n    ptB = { x: c, y: (d === undefined ? 0 : d) };    \n  }\n\n  if (ptA === undefined) throw new Error(`ptA missing. a: ${a}`);\n  if (ptB === undefined) throw new Error(`ptB missing. b: ${b}`);\n  guard(ptA, `a`);\n  guard(ptB, `b`);\n  return Object.freeze({\n    x: ptA.x + ptB.x,\n    y: ptA.y + ptB.y\n  });\n};\n\n/**\n * Returns `a` multiplied by `b`\n * \n * ie.\n * ```js\n * return {\n *  x: a.x * b.x,\n*   y: a.y * b.y\n * }\n * ```\n * @param a\n * @param b\n * @returns\n */\nexport function multiply(a:Point, b:Point):Point;\n\n/**\n * Multiply by a width,height:\n * ```\n * return { \n *  x: a.x * rect.width,\n *  y: a.y * rect.height\n * };\n * ```\n * @param a \n * @param rect \n */\nexport function multiply(a:Point, rect:Rects.Rect):Point;\n\n/**\n * Returns `a` multipled by some x and/or y scaling factor\n * \n * ie.\n * ```js\n * return {\n *  x: a.x * x\n*   y: a.y * y\n * }\n * ```\n * \n * Usage:\n * ```js\n * multiply(pt, 10, 100); // Scale pt by x:10, y:100\n * multiply(pt, Math.min(window.innerWidth, window.innerHeight)); // Scale both x,y by viewport with or height, whichever is smaller\n * ```\n * @export\n * @parama Point to scale\n * @param x Scale factor for x axis\n * @param [y] Scale factor for y axis (if not specified, the x value is used)\n * @returns Scaled point\n */\nexport function multiply(a:Point, x:number, y?:number):Point;\n\n/**\n * Returns `a` multiplied by `b` point, or given x and y.\n * ie.\n * ```js\n * return {\n *   x: a.x * b.x,\n *   y: a.y * b.y\n * };\n * ```\n * @param a \n * @param bOrX \n * @param y \n * @returns \n */\n/* eslint-disable func-style */\nexport function multiply(a:Point, bOrX:Rects.Rect| Point | number, y?:number):Point {\n  //  Unit tested\n\n  guard(a, `a`);\n  if (typeof bOrX === `number`) {\n    if (typeof y === `undefined`) y = bOrX;\n    guardNumber(y, ``, `y`);\n    guardNumber(bOrX, ``, `x`);\n    return Object.freeze({ x: a.x * bOrX, y: a.y * y });\n  } else if (isPoint(bOrX)) {\n    guard(bOrX, `b`);\n    return Object.freeze({\n      x: a.x * bOrX.x,\n      y: a.y * bOrX.y\n    });\n  } else if (Rects.isRect(bOrX)) {\n    Rects.guard(bOrX, `rect`);\n    return Object.freeze({\n      x: a.x * bOrX.width,\n      y: a.y * bOrX.height\n    });\n  } else throw new Error(`Invalid arguments. a: ${JSON.stringify(a)} b: ${JSON.stringify(bOrX)}`);\n}\n\n/**\n * Multiplies all components by `v`.\n * Existing properties of `pt` are maintained.\n * \n * ```js\n * multiplyScalar({ x:2, y:4 }, 2);\n * // Yields: { x:4, y:8 }\n * ```\n * @param pt Point\n * @param v Value to multiply by\n * @returns \n */\nexport const multiplyScalar = (pt:Point|Point3d, v:number):Point|Point3d => {\n  if (isPoint3d(pt)) {\n    return Object.freeze({\n      ...pt,\n      x: pt.x * v,\n      y: pt.y * v,\n      z: pt.z * v\n    });\n  } else {\n    return Object.freeze({\n      ...pt,\n      x: pt.x * v,\n      y: pt.y * v\n    });\n  }\n};\n/**\n * Divides a / b:\n * ```js\n * return {\n *  x: a.x / b.x,\n *  y: a.y / b.y\n * }\n * ```\n * @param a \n * @param b \n */\nexport function divide(a:Point, b:Point):Point;\n\n/**\n * Divides point a by rectangle:\n * ```js\n * return {\n *  x: a.x / rect.width,\n *  y: a.y / rect.hight\n * };\n * ```\n * @param a \n * @param Rect \n */\nexport function divide(a:Point, rect:Rects.Rect):Point;\n\n/**\n * Divides a point by x,y.\n * ```js\n * return {\n *  x: a.x / x,\n *  y: b.y / y\n * };\n * ```\n * @param a Point\n * @param x X divisor\n * @param y Y divisor. If unspecified, x divisor is used.\n */\nexport function divide(a:Point, x:number, y?:number):Point;\n\n/**\n * Divides two sets of points:\n * ```js\n * return {\n *  x: x1 / x2,\n *  y: y1 / y2\n * };\n * ```\n * @param x1 \n * @param y1 \n * @param x2 \n * @param y2 \n */\nexport function divide(x1:number, y1:number, x2?:number, y2?:number):Point;\n\n/**\n * Devides a from b. If a contains a zero, that axis will be returned as zero\n * @param a\n * @param b\n * @param c \n * @param d \n * @returns \n */\nexport function divide(a:Point|number, b:Rects.Rect|Point | number, c?:number, d?:number):Point {\n  //  Unit tested\n\n  if (isPoint(a)) {\n    guard(a, `a`);\n    if (isPoint(b)) {\n      guardNonZeroPoint(b);\n      return Object.freeze({\n        x: a.x / b.x,\n        y: a.y / b.y\n      });\n    } else if (Rects.isRect(b)) {\n      Rects.guard(b, `rect`);\n      return Object.freeze({\n        x: a.x / b.width,\n        y: a.y / b.height\n      });\n    }else {\n      if (c === undefined) c = b;\n      guard(a);\n      guardNumber(b, `nonZero`, `x`);\n      guardNumber(c, `nonZero`, `y`);\n      return Object.freeze({\n        x: a.x / b,\n        y: a.y / c\n      });\n    }\n  } else {\n    if (typeof b !== `number`) throw new Error(`expected second parameter to be y1 coord`);\n    guardNumber(a, `positive`, `x1`);\n    guardNumber(b, `positive`, `y1`);\n    if (c === undefined) c = 1;\n    if (d === undefined) d = c;\n    guardNumber(c, `nonZero`, `x2`);\n    guardNumber(d, `nonZero`, `y2`);\n\n    return Object.freeze({\n      x: a / c,\n      y: b / d\n    });\n  }\n}\n\nexport const quantiseEvery = (pt:Point, snap:Point, middleRoundsUp = true) => Object.freeze({\n  x: quantiseEveryNumber(pt.x, snap.x, middleRoundsUp),\n  y: quantiseEveryNumber(pt.y, snap.y, middleRoundsUp)\n});\n/**\n * Simple convex hull impementation. Returns a set of points which\n * enclose `pts`.\n * \n * For more power, see something like [Hull.js](https://github.com/AndriiHeonia/hull)\n * @param pts \n * @returns \n */\nexport const convexHull = (...pts:readonly Point[]):readonly Point[] => {\n  const sorted = [...pts].sort(compareByX);\n  if (sorted.length === 1) return sorted;\n\n  const x = (points:Point[]) => {\n    const v:Point[] = [];\n    points.forEach(p => {\n      while (v.length >= 2) {\n        const q = v[v.length-1];\n        const r = v[v.length-2];\n        if ((q.x - r.x) * (p.y - r.y) >= (q.y - r.y) * (p.x - r.x)) {\n          //eslint-disable-next-line functional/immutable-data\n          v.pop();\n        } else break;\n      }\n      //eslint-disable-next-line functional/immutable-data\n      v.push(p);\n    });\n    //eslint-disable-next-line functional/immutable-data\n    v.pop();\n    return v;\n  };\n\n  const upper = x(sorted);\n  //eslint-disable-next-line functional/immutable-data\n  const lower = x(sorted.reverse());\n\n  if (upper.length === 1 && lower.length === 1 && isEqual(lower[0], upper[0])) return upper;\n  return upper.concat(lower);\n};\n\n\n/**\n * Returns -2 if both x & y of a is less than b\n * Returns -1 if either x/y of a is less than b\n * \n * Returns 2 if both x & y of a is greater than b\n * Returns 1 if either x/y of a is greater than b's x/y\n * \n * Returns 0 if x/y of a and b are equal\n * @param a \n * @param b \n * @returns \n */\nexport const compare = (a:Point, b:Point):number => {\n  if (a.x < b.x && a.y < b.y) return -2;\n  if (a.x > b.x && a.y > b.y) return 2;\n  if (a.x < b.x || a.y < b.y) return -1;\n  if (a.x > b.x || a.y > b.y) return 1;\n  if (a.x === b.x && a.x === b.y) return 0;\n  return NaN;\n};\n\n/**\n * Compares points based on x value.\n * Returns above 0 if a.x > b.x (to the right)\n * Returns 0 if a.x === b.x\n * Returns below 0 if a.x < b.x (to the left)\n * \n * @example Sorting by x\n * ```js\n * arrayOfPoints.sort(Points.compareByX);\n * ```\n * @param a \n * @param b \n * @returns \n */\nexport const compareByX = (a:Point, b:Point):number =>  a.x - b.x || a.y - b.y;\n\n/**\n * Project `origin` by `distance` and `angle` (radians).\n * \n * To figure out rotation, imagine a horizontal line running through `origin`.\n * * Rotation = 0 deg puts the point on the right of origin, on same y-axis\n * * Rotation = 90 deg/3:00 puts the point below origin, on the same x-axis\n * * Rotation = 180 deg/6:00 puts the point on the left of origin on the same y-axis\n * * Rotation = 270 deg/12:00 puts the point above the origin, on the same x-axis\n * \n * ```js\n * // Yields a point 100 units away from 10,20 with 10 degrees rotation (ie slightly down) \n * const a = Points.project({x:10, y:20}, 100, degreeToRadian(10));\n * ```\n * @param origin \n * @param distance \n * @param angle \n * @returns \n */\nexport const project = (origin:Point, distance:number, angle:number) => {\n  const x = (Math.cos(angle) * distance) + origin.x;\n  const y =  (Math.sin(angle) * distance) + origin.y;\n  return { x, y };\n};\n\n/**\n * Rotate a single point by a given amount in radians\n * @param pt \n * @param amountRadian \n * @param origin \n */\nexport function rotate(pt:Point, amountRadian:number, origin?:Point):Point;\n\n/**\n * Rotate several points by a given amount in radians\n * @param pt Points\n * @param amountRadian Amount to rotate in radians. If 0 is given, a copy of the input array is returned\n * @param origin Origin to rotate around. Defaults to 0,0\n */\nexport function rotate(pt:ReadonlyArray<Point>, amountRadian:number, origin?:Point):ReadonlyArray<Point>;\n\nexport function rotate(pt:Point|ReadonlyArray<Point>, amountRadian:number, origin?:Point):Point|ReadonlyArray<Point> {\n  if (origin === undefined) origin = { x:0, y:0 };\n  guard(origin, `origin`);\n  guardNumber(amountRadian, ``, `amountRadian`);\n  const arrayInput = Array.isArray(pt);\n\n  // no-op\n  if (amountRadian === 0)  return pt;\n    \n  if (!arrayInput) {\n    pt = [pt as Point];\n  }\n\n  const ptAr = pt as ReadonlyArray<Point>;\n  ptAr.forEach((p, index) => guard(p, `pt[${index}]`));\n  \n  //eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n  const asPolar = ptAr.map(p => Polar.fromCartesian(p, origin!));\n  const rotated = asPolar.map(p => Polar.rotate(p, amountRadian));\n  const asCartesisan = rotated.map(p => Polar.toCartesian(p, origin));\n  if (arrayInput) return asCartesisan;\n  else return asCartesisan[0];\n\n  //const p = Polar.fromCartesian(pt, origin);\n  //const pp = Polar.rotate(p, amountRadian);\n  //return Polar.toCartesian(pp, origin);\n}\n\n//eslint-disable-next-line functional/prefer-readonly-type\nexport const rotatePointArray = (v:ReadonlyArray<readonly number[]>, amountRadian:number):number[][] => {\n  const mat = [[Math.cos(amountRadian), -Math.sin(amountRadian)], [Math.sin(amountRadian), Math.cos(amountRadian)]];\n  const result = [];\n  //eslint-disable-next-line functional/no-let\n  for (let i=0; i < v.length; ++i) {\n    //eslint-disable-next-line functional/immutable-data\n    result[i] = [mat[0][0]*v[i][0] + mat[0][1]*v[i][1], mat[1][0]*v[i][0] + mat[1][1]*v[i][1]];\n  }\n  return result;\n};\n\nconst length = (ptOrX:Point|number, y?:number):number => {\n  if (isPoint(ptOrX)) {\n    y = ptOrX.y;\n    ptOrX = ptOrX.x;\n  }\n  if (y === undefined) throw new Error(`Expected y`);\n  return Math.sqrt(ptOrX*ptOrX + y*y);\n};\n\n/**\n * Normalise point as a unit vector.\n * \n * ```js\n * normalise({x:10, y:20});\n * normalise(10, 20);\n * ```\n * @param ptOrX Point, or x value\n * @param y y value if first param is x\n * @returns \n */\nexport const normalise = (ptOrX:Point|number, y?:number):Point => {\n  const pt = getPointParam(ptOrX, y);\n  const l = length(pt);\n  if (l === 0) return Points.Empty;\n  return Object.freeze({\n    x: pt.x / l,\n    y: pt.y / l\n  });\n};\n\n/**\n * Normalises a point by a given width and height\n * @param pt Point\n * @param width Width\n * @param height Height\n */\nexport function normaliseByRect(pt:Point, width:number, height:number):Point;\n\nexport function normaliseByRect(pt:Point, rect:Rects.Rect):Point;\n\n/**\n * Normalises x,y by width and height so it is on a 0..1 scale\n * @param x \n * @param y \n * @param width \n * @param height \n */\nexport function normaliseByRect(x:number, y:number, width:number, height:number):Point;\n\n/**\n * Normalises a point so it is on a 0..1 scale\n * @param a Point, or x\n * @param b y coord or width\n * @param c height or width\n * @param d height\n * @returns Point\n */\nexport function normaliseByRect(a:Point|number, b:number|Rects.Rect, c?:number, d?:number):Point {\n  //  Unit tested\n  if (isPoint(a)) {\n    if (typeof b === `number` && c !== undefined) {\n      guardNumber(b, `positive`, `width`);\n      guardNumber(c, `positive`, `height`);\n    } else {\n      if (!Rects.isRect(b)) throw new Error(`Expected second parameter to be a rect`);\n      c = b.height;\n      b = b.width;\n    }\n    return Object.freeze({\n      x: a.x / b,\n      y: a.y / c\n    });\n  } else {\n    guardNumber(a, `positive`, `x`);\n    if (typeof b !== `number`) throw new Error(`Expecting second parameter to be a number (width)`);\n    if (typeof c !== `number`) throw new Error(`Expecting third parameter to be a number (height)`);\n\n    guardNumber(b, `positive`, `y`);\n    guardNumber(c, `positive`, `width`);\n    if (d === undefined) throw new Error(`Expected height parameter`);\n    guardNumber(d, `positive`, `height`);\n    return Object.freeze({\n      x: a / c,\n      y: b / d\n    });\n  }\n}\n\n/**\n * Returns a random point on a 0..1 scale.\n * ```js\n * import { Points } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * const pt = Points.random(); // eg {x: 0.2549012, y:0.859301}\n * ```\n * \n * A custom source of randomness can be provided:\n * ```js\n * import { Points } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * import { weightedSkewed } from \"https://unpkg.com/ixfx/dist/random.js\"\n * const pt = Points.random(weightedSkewed(`quadIn`));\n * ```\n * @param rando \n * @returns \n */\nexport const random = (rando?:RandomSource):Point => {\n  if (rando === undefined) rando = defaultRandom;\n\n  return Object.freeze({\n    x: rando(),\n    y: rando()\n  });\n};\n\n/**\n * Wraps a point to be within `ptMin` and `ptMax`.\n * Note that max values are _exclusive_, meaning the return value will always be one less.\n * \n * Eg, if a view port is 100x100 pixels, wrapping the point 150,100 yields 50,99.\n * \n * ```js\n * // Wraps 150,100 to on 0,0 -100,100 range\n * wrap({x:150,y:100}, {x:100,y:100});\n * ```\n * \n * Wrap normalised point:\n * ```js\n * wrap({x:1.2, y:1.5}); // Yields: {x:0.2, y:0.5}\n * ```\n * @param pt Point to wrap\n * @param ptMax Maximum value, or `{ x:1, y:1 }` by default\n * @param ptMin Minimum value, or `{ x:0, y:0 }` by default\n * @returns Wrapped point\n */\nexport const wrap = (pt:Point, ptMax:Point = { x:1, y:1 }, ptMin:Point = { x:0, y:0 }):Point => {\n  //  Unit tested\n  guard(pt, `pt`);\n  guard(ptMax, `ptMax`);\n  guard(ptMin, `ptMin`);\n  \n  return Object.freeze({\n    x: wrapNumber(pt.x, ptMin.x, ptMax.x),\n    y: wrapNumber(pt.y, ptMin.y, ptMax.y)\n  });\n};\n\n/**\n * Inverts one or more axis of a point\n * ```js\n * invert({x:10, y:10}); // Yields: {x:-10, y:-10}\n * invert({x:10, y:10}, `x`); // Yields: {x:-10, y:10}\n * ``` \n * @param pt Point to invert\n * @param what Which axis. If unspecified, both axies are inverted\n * @returns \n */\nexport const invert = (pt:Point|Point3d, what:`both`|`x`|`y`|`z` = `both`):Point => {\n  switch (what) {\n  case `both`:\n    if (isPoint3d(pt)) {\n      return Object.freeze({\n        ...pt,\n        x: pt.x * -1,\n        y: pt.y * -1,\n        z: pt.z * -1\n      });\n    } else {\n      return Object.freeze({\n        ...pt,\n        x: pt.x * -1,\n        y: pt.y * -1,\n      });\n    }\n  case `x`:\n    return Object.freeze({\n      ...pt,\n      x: pt.x * -1\n    });\n  case `y`:\n    return Object.freeze({\n      ...pt,\n      y: pt.y * -1\n    });\n  case `z`:\n    if (isPoint3d(pt)) {\n      return Object.freeze({\n        ...pt,\n        z: pt.z * -1\n      });\n    } else throw new Error(`pt parameter is missing z`);\n  default:\n    throw new Error(`Unknown what parameter. Expecting 'both', 'x' or 'y'`);\n  }\n};\n\n/**\n * Returns a point with rounded x,y coordinates. By default uses `Math.round` to round.\n * ```js\n * toIntegerValues({x:1.234, y:5.567}); // Yields: {x:1, y:6}\n * ```\n * \n * ```js\n * toIntegerValues(pt, Math.ceil); // Use Math.ceil to round x,y of `pt`.\n * ```\n * @param pt Point to round\n * @param rounder Rounding function, or Math.round by default\n * @returns \n */\nexport const toIntegerValues = (pt:Point, rounder:(x:number)=>number = Math.round):Point => {\n  guard(pt, `pt`);\n  return Object.freeze({\n    x: rounder(pt.x),\n    y: rounder(pt.y)\n  });\n};\n\n/**\n * Clamps the magnitude of a point.\n * This is useful when using a Point as a vector, to limit forces.\n * @param pt \n * @param max Maximum magnitude (1 by default)\n * @param min Minimum magnitude (0 by default)\n * @returns \n */\nexport const clampMagnitude = (pt:Point, max = 1, min = 0):Point => {\n  const length = distance(pt);\n  //eslint-disable-next-line functional/no-let\n  let ratio = 1;\n  if (length > max) {\n    ratio =  max / length;\n  } else if (length < min) {\n    ratio = min / length;\n  }\n  return ratio === 1 ? pt : multiply(pt, ratio, ratio);\n};\n\n\n/**\n * Clamps a point to be between `min` and `max` (0 & 1 by default)\n * @param pt Point\n * @param min Minimum value (0 by default)\n * @param max Maximum value (1 by default)\n */\nexport function clamp(pt:Point, min?:number, max?:number):Point;\n\n/**\n * Clamps an x,y pair to be between `min` and `max` (0 & 1 by default)\n * @param x X coordinate\n * @param y Y coordinate\n * @param min Minimum value (0 by default)\n * @param max Maximum value (1 by default)\n */\nexport function clamp(x:number, y:number, min?:number, max?:number):Point;\nexport function clamp(a:Point|number, b?:number, c?:number, d?:number):Point {\n  //  Unit tested\n\n  if (isPoint(a)) {\n    if (b === undefined) b = 0;\n    if (c === undefined) c = 1;\n    guardNumber(b, ``, `min`);\n    guardNumber(c, ``, `max`);\n    return Object.freeze({\n      x: clampNumber(a.x, b, c),\n      y: clampNumber(a.y, b, c)\n    });\n  } else {\n    if (b === undefined) throw new Error(`Expected y coordinate`);\n    if (c === undefined) c = 0;\n    if (d === undefined) d = 1;\n    guardNumber(a, ``, `x`);\n    guardNumber(b, ``, `y`);\n    guardNumber(c, ``, `min`);\n    guardNumber(d, ``, `max`);\n\n    return Object.freeze({\n      x: clampNumber(a, c, d),\n      y: clampNumber(b, c, d)\n    });\n  }\n}\n\nexport type PointRelation = (a:Point|number, b?:number)=>PointRelationResult;\n\nexport type PointRelationResult = {\n  /**\n   * Angle from start\n   */\n  readonly angle:number\n  /**\n  * Distance from start\n  */\n  readonly distanceFromStart:number\n  /**\n  * Distance from last compared point\n  */\n   readonly distanceFromLast:number\n  \n  /**\n  * Center point from start\n  */\n  readonly centroid:Point\n  /**\n  * Average of all points seen\n  * This is calculated by summing x,y and dividing by total points\n  */\n  readonly average:Point\n\n  /**\n   * Speed. Distance/millisecond from one sample to the next.\n   */\n  readonly speed:number\n};\n\n/**\n * Tracks the relation between two points\n * \n * ```js\n * import { Points } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * \n * // Start point: 50,50\n * const t = Points.relation({x:50,y:50});\n * \n * // Compare to 0,0\n * const { angle, distanceFromStart, distanceFromLast, average, centroid, speed } = t({x:0,y:0});\n * ```\n * \n * X,y coordinates can also be used as parameters:\n * ```js\n * const t = Points.relation(50, 50);\n * const result = t(0, 0);\n * // result.speed, result.angle ...\n * ```\n * \n * Note that all the intermediate values are not stored. It keeps the initial\n * point, and the previous point. If you want to compute something over a set\n * of prior points, you may want to use [Data.pointsTracker](./Data.pointsTracker.html)\n * @param start \n * @returns \n */\nexport const relation = (a:Point|number, b?:number):PointRelation => {\n  const start = getPointParam(a, b);\n  //eslint-disable-next-line functional/no-let\n  let totalX = 0;\n  //eslint-disable-next-line functional/no-let\n  let totalY = 0;\n  //eslint-disable-next-line functional/no-let\n  let count = 0;\n  //eslint-disable-next-line functional/no-let\n  let lastUpdate = performance.now();\n  //eslint-disable-next-line functional/no-let\n  let lastPoint = start;\n  const update = (aa:Point|number, bb?:number) => {\n    const p = getPointParam(aa, bb);\n    totalX += p.x;\n    totalY += p.y;\n    count++;\n    \n    const distanceFromStart = distance(p, start);\n    const distanceFromLast = distance(p, lastPoint);\n    \n    // Track speed\n    const now = performance.now();\n    const speed = distanceFromLast / ((now - lastUpdate));\n    lastUpdate = now;\n   \n    lastPoint = p;\n\n    return Object.freeze({\n      angle: angle(p, start),\n      distanceFromStart,\n      distanceFromLast,\n      speed,\n      centroid: centroid(p, start),\n      average: {\n        x: totalX/count,\n        y: totalY/count\n      }\n    });\n  };\n\n  return update;\n};\n\nexport const progressBetween = (currentPos:Points.Point|Points.Point3d, from:Points.Point|Points.Point3d, to:Points.Point|Points.Point3d) => {\n  // Via: https://www.habrador.com/tutorials/math/2-passed-waypoint/?s=09\n  // from -> current\n  const a = Points.subtract(currentPos, from);\n  \n  // from -> to\n  const b = Points.subtract(to, from);\n\n  if (Points.isPoint3d(a) && Points.isPoint3d(b)) {\n    return (a.x*b.x + a.y*b.y + a.z * b.z) / (b.x * b.x + b.y * b.y + b.z*b.z);\n  } else {\n    return (a.x*b.x + a.y*b.y) / (b.x * b.x + b.y * b.y);\n  }\n};\n// const p = { x: 100, y: 100 };\n// console.log(`distance: ` + distance(p));\n// const pp = clampMagnitude(p, 10);\n// console.log(`c1: ${toString(pp)} distance: ${distance(pp)}`);\n\n// const p = { x: 42, y: 1337};\n// const pNorm = normalise(p);\n// console.log(`normalised: ${toString(pNorm)}`);","import { Arrays } from '../collections/index.js';\nimport { minFast } from '../collections/NumericArrays.js';\nimport { number as guardNumber, percent as guardPercent } from '../Guards.js';\nimport { Points, Rects } from './index.js';\nimport { Path } from './Path.js';\nimport { guard as guardPoint, Point } from './Point.js';\n\n/**\n * A line, which consists of an `a` and `b` {@link Points.Point}.\n */\nexport type Line = {\n  readonly a:Points.Point\n  readonly b:Points.Point\n}\n\n//eslint-disable-next-line @typescript-eslint/naming-convention\nexport const Empty = Object.freeze({\n  a: Object.freeze({ x:0, y:0 }),\n  b: Object.freeze({ x:0, y:0 })\n});\n\n//eslint-disable-next-line @typescript-eslint/naming-convention\nexport const Placeholder = Object.freeze({\n  a: Object.freeze({ x:NaN, y:NaN }),\n  b: Object.freeze({ x:NaN, y:NaN })\n});\n\n/**\n * Returns true if `l` is the same as Line.Empty, that is\n * the `a` and `b` points are Points.Empty.\n * @param l \n * @returns \n */\nexport const isEmpty = (l:Line):boolean => Points.isEmpty(l.a) && Points.isEmpty(l.b);\n\nexport const isPlaceholder = (l:Line):boolean => Points.isPlaceholder(l.a) && Points.isPlaceholder(l.b);\n\n/**\n * A PolyLine, consisting of more than one line.\n */\nexport type PolyLine = ReadonlyArray<Line>;\n\n/**\n * Returns true if `p` is a valid line, containing `a` and `b` Points.\n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * Lines.isLine(l);\n * ```\n * @param p Value to check\n * @returns True if a valid line.\n */\nexport const isLine = (p:Path | Line | Points.Point):p is Line => {\n  if (p === undefined) return false;\n  if ((p as Line).a === undefined) return false;\n  if ((p as Line).b === undefined) return false;\n  if (!Points.isPoint((p as Line).a)) return false;\n  if (!Points.isPoint((p as Line).b)) return false;\n  return true;\n};\n\n/**\n * Returns true if `p` is a {@link PolyLine}, ie. an array of {@link Line}s.\n * Validates all items in array.\n * @param p \n * @returns\n */\n//eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport const isPolyLine = (p:any):p is PolyLine => {\n  if (!Array.isArray(p)) return false;\n\n  const valid = !p.some(v => !isLine(v));\n  return valid;\n};\n\n/**\n * Returns true if the lines have the same value. Note that only\n * the line start and end points are compared. So the lines might\n * be different in other properties, and `isEqual` will still return\n * true.\n * \n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * const a = { a: {x:0,  y: 10 }, b: { x: 20, y: 20 }};\n * const b = { a: {x:0,  y: 10 }, b: { x: 20, y: 20 }};\n * a === b; // false, because they are different objects\n * Lines.isEqual(a, b); // true, because they have the same value\n * ```\n * @param {Line} a\n * @param {Line} b\n * @returns {boolean}\n */\nexport const isEqual = (a:Line, b:Line):boolean => Points.isEqual(a.a, b.a) && Points.isEqual(a.b, b.b);\n\n/**\n * Applies `fn` to both start and end points.\n * \n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * // Line 10,10 -> 20,20\n * const line = Lines.fromNumbers(10,10, 20,20);\n * \n * // Applies randomisation to both x and y.\n * const rand = (p) => ({\n *  x: p.x * Math.random(),\n *  y: p.y * Math.random()\n * });\n * \n * // Applies our randomisation function\n * const line2 = apply(line, rand);\n * ```\n * @param line Line\n * @param fn Function that takes a point and returns a point\n * @returns \n */\nexport const apply = (line:Line, fn:(p:Points.Point)=>Points.Point) => Object.freeze<Line>(\n  {\n    ...line,\n    a: fn(line.a),\n    b: fn(line.b)\n  }\n);\n\n\n/**\n * Throws an exception if:\n * * line is undefined\n * * a or b parameters are missing\n * \n * Does not validate points\n * @param line \n * @param paramName \n */\nexport const guard = (line:Line, paramName:string = `line`) => {\n  if (line === undefined) throw new Error(`${paramName} undefined`);\n  if (line.a === undefined) throw new Error(`${paramName}.a undefined. Expected {a:Point, b:Point}. Got: ${JSON.stringify(line)}`);\n  if (line.b === undefined) throw new Error(`${paramName}.b undefined. Expected {a:Point, b:Point} Got: ${JSON.stringify(line)}`);\n};\n\n/**\n * Returns the angle in radians of a line, or two points\n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * Lines.angleRadian(line);\n * Lines.angleRadian(ptA, ptB);\n * ```\n * @param lineOrPoint \n * @param b \n * @returns \n */\nexport const angleRadian = (lineOrPoint:Line|Points.Point, b?:Points.Point):number => {\n  //eslint-disable-next-line functional/no-let\n  let a:Points.Point;\n  if (isLine(lineOrPoint)) {\n    a = lineOrPoint.a;\n    b = lineOrPoint.b;\n  } else {\n    a = lineOrPoint;\n    if (b === undefined) throw new Error(`b point must be provided`);\n  }\n  return Math.atan2(b.y - a.y, b.x - a.x);\n};\n\n/**\n * Multiplies start and end of line by point.x, point.y.\n * \n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * \n * // Line 1,1 -> 10,10\n * const l = Lines.fromNumbers(1, 1, 10, 10);\n * const ll = Lines.multiply(l, {x:2, y:3});\n * // Yields: 2,20 -> 3,30\n * ```\n * @param line \n * @param point \n * @returns \n */\nexport const multiply = (line:Line, point:Points.Point):Line => (Object.freeze({\n  ...line,\n  a: Points.multiply(line.a, point),\n  b: Points.multiply(line.b, point)\n}));\n\n/**\n * Divides both start and end points by given x,y\n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * \n * // Line 1,1 -> 10,10\n * const l = Lines.fromNumbers(1,1,10,10);\n * const ll = Lines.divide(l, {x:2, y:4});\n * // Yields: 0.5,0.25 -> 5,2.5\n * ```\n * @param line \n * @param point \n * @returns \n */\nexport const divide = (line:Line, point:Points.Point):Line => Object.freeze({\n  ...line,\n  a: Points.divide(line.a, point),\n  b: Points.divide(line.b, point)\n});\n\n/**\n * Adds both start and end points by given x,y\n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * // Line 1,1 -> 10,10\n * const l = Lines.fromNumbers(1,1,10,10);\n * const ll = Lines.sum(l, {x:2, y:4});\n * // Yields: 3,5 -> 12,14\n * ```\n * @param line \n * @param point \n * @returns \n */\nexport const sum = (line:Line, point:Points.Point):Line => Object.freeze({\n  ...line,\n  a: Points.sum(line.a, point),\n  b: Points.sum(line.b, point)\n});\n\n/**\n * Subtracts both start and end points by given x,y\n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * \n * // Line 1,1 -> 10,10\n * const l = Lines.fromNumbers(1,1,10,10);\n * const ll = Lines.subtract(l, {x:2, y:4});\n * // Yields: -1,-3 -> 8,6\n * ```\n * @param line \n * @param point \n * @returns \n */\nexport const subtract = (line:Line, point:Points.Point):Line => Object.freeze({\n  ...line,\n  a: Points.subtract(line.a, point),\n  b: Points.subtract(line.b, point)\n});\n\n/**\n * Normalises start and end points by given width and height. Useful\n * for converting an absolutely-defined line to a relative one.\n * \n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * \n * // Line 1,1 -> 10,10\n * const l = Lines.fromNumbers(1,1,10,10);\n * const ll = Lines.normaliseByRect(l, 10, 10);\n * // Yields: 0.1,0.1 -> 1,1\n * ```\n * @param line \n * @param width\n * @param height \n * @returns \n */\nexport const normaliseByRect = (line:Line, width:number, height:number):Line => Object.freeze({\n  ...line,\n  a: Points.normaliseByRect(line.a, width, height),\n  b: Points.normaliseByRect(line.b, width, height)\n});\n\n\n/**\n * Returns true if `point` is within `maxRange` of `line`.\n * \n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * const line = Lines.fromNumbers(0,20,20,20);\n * Lines.withinRange(line, {x:0,y:21}, 1); // True\n * ```\n * @param line\n * @param point\n * @param maxRange \n * @returns True if point is within range\n */\nexport const withinRange = (line:Line, point:Points.Point, maxRange:number):boolean =>  {\n  const dist = distance(line, point);\n  return dist <= maxRange;\n};\n\n/**\n * Returns the length between two points\n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * Lines.length(ptA, ptB);\n * ```\n * @param a First point\n * @param b Second point\n * @returns \n */\nexport function length(a:Points.Point, b:Points.Point):number;\n\n/**\n * Returns length of line. If a polyline (array of lines) is provided,\n * it is the sum total that is returned.\n * \n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * Lines.length(a: {x:0, y:0}, b: {x: 100, y:100});\n * Lines.length(lines);\n * ```\n * @param line Line\n */\nexport function length(line:Line|PolyLine):number;\n\n/**\n * Returns length of line, polyline or between two points\n * \n * @param aOrLine Point A, line or polyline (array of lines)\n * @param pointB Point B, if first parameter is a point\n * @returns Length (total accumulated length for arrays)\n */\n//eslint-disable-next-line func-style\nexport function length(aOrLine:Points.Point|Line|PolyLine, pointB?:Points.Point):number  {\n  if (isPolyLine(aOrLine)) {\n    const sum = aOrLine.reduce((acc, v) => length(v) + acc, 0);\n    return sum;\n  }\n\n  const [a, b] = getPointsParam(aOrLine, pointB);\n  const x = b.x - a.x;\n  const y = b.y - a.y;\n  if (a.z !== undefined && b.z !== undefined) {\n    const z = b.z - a.z;\n    return Math.hypot(x, y, z);\n  } else {\n    return Math.hypot(x, y);\n  }\n}\n\n/**\n * Returns the mid-point of a line (same as `interpolate` with an amount of 0.5)\n * \n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * Lines.midpoint(line); // Returns {x, y}\n * ```\n * @param aOrLine \n * @param pointB \n * @returns \n */\nexport const midpoint =(aOrLine:Points.Point|Line, pointB?:Points.Point):Points.Point => {\n  const [a, b] = getPointsParam(aOrLine, pointB);\n  return interpolate(0.5, a, b);\n};\n\n/**\n * Returns [a,b] points from either a line parameter, or two points.\n * It additionally applies the guardPoint function to ensure validity.\n * This supports function overloading.\n * @ignore\n * @param aOrLine \n * @param b \n * @returns \n */\nexport const getPointsParam = (aOrLine:Points.Point|Line, b?:Points.Point):readonly [Points.Point, Points.Point] => {\n  //eslint-disable-next-line functional/no-let\n  let a;\n  if (isLine(aOrLine)) {\n    b = aOrLine.b;\n    a = aOrLine.a;\n  } else {\n    a = aOrLine;\n    if (b === undefined) throw new Error(`Since first parameter is not a line, two points are expected. Got a: ${JSON.stringify(a)} b: ${JSON.stringify(b)}`);\n  }\n  guardPoint(a, `a`);\n  guardPoint(a, `b`);\n\n  return [a, b];\n};\n\n/**\n * Returns the nearest point on `line` closest to `point`.\n * \n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * const pt = Lines.nearest(line, {x:10,y:10});\n * ```\n * \n * If an array of lines is provided, it will be the closest point amongst all the lines\n * @param line Line or array of lines\n * @param point\n * @returns Point `{ x, y }`\n */\nexport const nearest = (line:Line|readonly Line[], point:Points.Point):Points.Point => {\n  \n  const n = (line:Line):Points.Point => {\n    const { a, b } = line;\n    const atob = { x: b.x - a.x, y: b.y - a.y };\n    const atop = { x: point.x - a.x, y: point.y - a.y };\n    const len = atob.x * atob.x + atob.y * atob.y;\n\n    //eslint-disable-next-line functional/no-let\n    let dot = atop.x * atob.x + atop.y * atob.y;\n    const t = Math.min(1, Math.max(0, dot / len));\n    dot = (b.x - a.x) * (point.y - a.y) - (b.y - a.y) * (point.x - a.x);\n    return { x: a.x + atob.x * t, y: a.y + atob.y * t };\n  };\n\n  if (Array.isArray(line)) {\n    const pts = line.map(l => n(l));\n    const dists = pts.map(p => Points.distance(p, point));\n    return Object.freeze<Points.Point>(pts[Arrays.minIndex(...dists)]);\n  } else {\n    return Object.freeze<Points.Point>(n(line as Line));\n  }\n};\n\n/**\n * Calculates [slope](https://en.wikipedia.org/wiki/Slope) of line.\n * \n * @example\n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * Lines.slope(line);\n * Lines.slope(ptA, ptB)\n * ```\n * @param lineOrPoint Line or point. If point is provided, second point must be given too\n * @param b Second point if needed\n * @returns \n */\nexport const slope = (lineOrPoint:Line|Points.Point, b?:Points.Point):number => {\n  //eslint-disable-next-line functional/no-let\n  let a:Points.Point;\n  if (isLine(lineOrPoint)) {\n    //eslint-disable-next-line functional/no-let\n    a = lineOrPoint.a;\n    b = lineOrPoint.b;\n  } else {\n    a = lineOrPoint;\n    if (b === undefined) throw new Error(`b parameter required`);\n  }\n  if (b !== undefined) {\n    return (b.y - a.y) / (b.x - a.x);\n  } else throw Error(`Second point missing`);\n};\n\nconst directionVector = (line:Line):Points.Point => ({\n  x: line.b.x-line.a.x,\n  y: line.b.y-line.a.y\n});\n\nconst directionVectorNormalised = (line:Line):Points.Point => {\n  const l = length(line);\n  const v = directionVector(line);\n  return {\n    x: v.x / l,\n    y: v.y / l\n  };\n};\n\n/**\n * Returns a point perpendicular to `line` at a specified `distance`. Use negative\n * distances for the other side of line.\n * ```\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * // Project a point 100 units away from line, at its midpoint.\n * const pt = Lines.perpendicularPoint(line, 100, 0.5);\n * ```\n * @param line Line\n * @param distance Distance from line. Use negatives to flip side\n * @param amount Relative place on line to project point from. 0 projects from A, 0.5 from the middle, 1 from B.\n */\nexport const perpendicularPoint = (line:Line, distance:number, amount:number = 0) => {\n  const origin = interpolate(amount, line);\n  const dvn = directionVectorNormalised(line);\n  return {\n    x: origin.x  - dvn.y * distance,\n    y: origin.y  + dvn.x * distance\n  };\n};\n\n/**\n * Returns a parallel line to `line` at `distance`.\n * \n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * const l = Lines.parallel(line, 10);\n * ```\n * @param line\n * @param distance \n */\nexport const parallel = (line:Line, distance:number):Line => {\n  const dv = directionVector(line);\n  const dvn = directionVectorNormalised(line);\n  const a = {\n    x: line.a.x - dvn.y * distance,\n    y: line.a.y + dvn.x * distance\n  };\n  return {\n    a,\n    b: {\n      x: a.x + dv.x,\n      y: a.y + dv.y \n    }\n  };\n};\n\n/**\n * Scales a line from its midpoint\n * \n * @example Shorten by 50%, anchored at the midpoint\n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * const l = {\n *  a: {x:50, y:50}, b: {x: 100, y: 90}\n * }\n * const l2 = Lines.scaleFromMidpoint(l, 0.5);\n * ```\n * @param line\n * @param factor \n */\nexport const scaleFromMidpoint = (line:Line, factor:number):Line => {\n  const a = interpolate(factor/2, line);\n  const b = interpolate(0.5 + factor/2, line);\n  return { a, b };\n};\n\n/**\n * Calculates `y` where `line` intersects `x`.\n * @param line Line to extend\n * @param x Intersection of x-axis.\n */\nexport const pointAtX = (line:Line, x:number):Points.Point => {\n  const y = line.a.y + (x - line.a.x) * slope(line);\n  return Object.freeze({ x: x, y });\n};\n\n/**\n * Returns a line extended from its `a` point by a specified distance\n *\n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * const line = {a: {x: 0, y:0}, b: {x:10, y:10} }\n * const extended = Lines.extendFromA(line, 2);\n * ```\n * @param line\n * @param distance\n * @return Newly extended line\n */\nexport const extendFromA = (line:Line, distance:number):Line => {\n  const len = length(line);\n  return Object.freeze({\n    ...line,\n    a: line.a,\n    b: Object.freeze({\n      x: line.b.x + (line.b.x - line.a.x) / len * distance,\n      y: line.b.y + (line.b.y - line.a.y) / len * distance,\n    })\n  })\n  ;\n};\n\n/**\n * Yields every integer point along `line`. \n * \n * @example Basic usage\n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * const l = { a: {x: 0, y: 0}, b: {x: 100, y: 100} };\n * for (const p of Lines.pointsOf(l)) {\n *  // Do something with point `p`...\n * }\n * ```\n * \n * Some precision is lost as start and end\n * point is also returned as an integer.\n * \n * Uses [Bresenham's line algorithm](https://en.wikipedia.org/wiki/Bresenham%27s_line_algorithm)\n * @param line Line\n */\n//eslint-disable-next-line func-style\nexport function* pointsOf(line:Line):Generator<Points.Point>  {\n  // Via https://play.ertdfgcvb.xyz/#/src/demos/dyna\n  const { a, b } = line;\n  //eslint-disable-next-line functional/no-let\n  let x0 = Math.floor(a.x);\n  //eslint-disable-next-line functional/no-let\n  let y0 = Math.floor(a.y);\n  const x1 = Math.floor(b.x);\n  const y1 = Math.floor(b.y);\n  const dx = Math.abs(x1 - x0);\n  const dy = -Math.abs(y1 - y0);\n  const sx = x0 < x1 ? 1 : -1;\n  const sy = y0 < y1 ? 1 : -1;\n  //eslint-disable-next-line functional/no-let\n  let err = dx + dy;\n\n  while (true) {\n    yield { x:x0, y:y0 };\n    if (x0 === x1 && y0 === y1) break;\n    const e2 = 2 * err;\n    if (e2 >= dy) {\n      err += dy;\n      x0 += sx;\n    }\n    if (e2 <= dx) {\n      err += dx;\n      y0 += sy;\n    }\n  }\n}\n\n/**\n * Returns the distance of `point` to the \n * nearest point on `line`.\n * \n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * const d = Lines.distance(line, {x:10,y:10});\n * ```\n * \n * If an array of lines is provided, the shortest distance is returned.\n * @param line Line (or array of lines)\n * @param point Point to check against\n * @returns Distance\n */\nexport const distance = (line:Line|ReadonlyArray<Line>, point:Points.Point):number => {\n  if (Array.isArray(line)) {\n    const distances = line.map(l => distanceSingleLine(l, point));\n    return minFast(distances);\n  } else {\n    return distanceSingleLine(line as Line, point);\n  }\n};\n\n/**\n * Returns the distance of `point` to the nearest point on `line`\n * \n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * const distance = Lines.distanceSingleLine(line, pt);\n * ```\n * @param line Line\n * @param point Target point\n * @returns \n */\nconst distanceSingleLine = (line:Line, point:Points.Point):number => {\n  guard(line, `line`);\n  guardPoint(point, `point`);\n\n  if (length(line) === 0) {\n    // Line is really a point\n    return length(line.a, point);\n  }\n\n  const near = nearest(line, point);\n  return length(near, point);\n};\n\n/**\n * Calculates a point in-between `a` and `b`.\n * \n * If an interpolation amount below 0 or above 1 is given, _and_\n * `allowOverflow_ is true, a point will be returned that is extended\n * past `line`. This is useful for easing functions which might\n * briefly go past the limits.\n * \n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * \n * // Get {x,y} at 50% along line\n * Lines.interpolate(0.5, line);\n * \n * // Get {x,y} at 80% between point A and B\n * Lines.interpolate(0.8, ptA, ptB);\n * ```\n * @param amount Relative position, 0 being at a, 0.5 being halfway, 1 being at b\n * @param a Start\n * @param b End\n * @returns Point between a and b\n */\nexport function interpolate(amount:number, a:Points.Point, pointB:Points.Point, allowOverflow?:boolean):Points.Point;\n\n/**\n * Calculates a point in-between `line`'s start and end points.\n * \n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * \n * // Get {x, y } at 50% along line\n * Lines.interpolate(0.5, line);\n * ```\n * \n * Any additional properties from `b`  are returned on the result as well.\n * @param amount 0..1 \n * @param line Line\n * @param allowOverflow If true, interpolation amount is permitted to exceed 0..1, extending the line\n */\nexport function interpolate(amount:number, line:Line, allowOverflow?:boolean):Points.Point;\n\n/**\n * Calculates a point in-between a line's start and end points.\n * \n * @param amount Interpolation amount\n * @param aOrLine Line, or first point\n * @param pointBOrAllowOverflow Second point (if needed) or allowOverflow.\n * @param allowOverflow If true, interpolation amount is permitted to exceed 0..1, extending the line.\n * @returns \n */\n//eslint-disable-next-line func-style\nexport function interpolate(amount:number, aOrLine:Points.Point|Line, pointBOrAllowOverflow?:Points.Point|boolean, allowOverflow?:boolean):Points.Point {\n  \n  if (typeof pointBOrAllowOverflow === `boolean`) {\n    allowOverflow = pointBOrAllowOverflow;\n    pointBOrAllowOverflow = undefined;\n  }\n  \n  if (!allowOverflow) guardPercent(amount, `amount`);\n  else guardNumber(amount, ``, `amount`);\n\n  const [a, b] = getPointsParam(aOrLine, pointBOrAllowOverflow);\n\n  const d = length(a, b);\n  const d2 = d * (1 - amount);\n\n  // Points are identical, return a copy of b\n  if (d === 0 && d2 === 0) return Object.freeze({ ...b });\n\n  const x = b.x - (d2 * (b.x - a.x) / d);\n  const y = b.y - (d2 * (b.y - a.y) / d);\n\n  return Object.freeze({\n    ...b,\n    x: x, \n    y: y\n  });\n}\n\n/**\n * Returns a string representation of two points\n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * console.log(Lines.toString(a, b)));\n * ```\n * @param a \n * @param b \n * @returns \n */\nexport function toString (a:Points.Point, b:Points.Point):string;\n\n/**\n * Returns a string representation of a line \n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * Lines.toString(line);\n * ```\n * @param line \n */\nexport function toString(line:Line):string;\n\n/**\n * Returns a string representation of a line or two points.\n * @param a\n * @param b \n * @returns \n */\n//eslint-disable-next-line func-style\nexport function toString(a:Points.Point|Line, b?:Points.Point):string {\n  if (isLine(a)) {\n    guard(a, `a`);\n    b = a.b;\n    a = a.a;\n  } else if (b === undefined) throw new Error(`Expect second point if first is a point`);\n  return Points.toString(a) + `-` + Points.toString(b);\n}\n\n/**\n * Returns a line from a basis of coordinates (x1, y1, x2, y2)\n * \n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * // Line from 0,1 -> 10,15\n * Lines.fromNumbers(0, 1, 10, 15);\n * ```\n * @param x1 \n * @param y1 \n * @param x2 \n * @param y2 \n * @returns \n */\nexport const fromNumbers = (x1:number, y1:number, x2:number, y2:number):Line => {\n  if (Number.isNaN(x1)) throw new Error(`x1 is NaN`);\n  if (Number.isNaN(x2)) throw new Error(`x2 is NaN`);\n  if (Number.isNaN(y1)) throw new Error(`y1 is NaN`);\n  if (Number.isNaN(y2)) throw new Error(`y2 is NaN`);\n\n  const a = { x: x1, y: y1 };\n  const b = { x: x2, y: y2 };\n  return fromPoints(a, b);\n};\n\n/**\n * Returns an array representation of line: [a.x, a.y, b.x, b.y]\n * \n * See {@link fromFlatArray} to create a line _from_ this representation.\n *\n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * Lines.toFlatArray(line);\n * Lines.toFlatArray(pointA, pointB);\n * ```\n * @export\n * @param {Point} a\n * @param {Point} b\n * @returns {number[]}\n */\nexport const toFlatArray = (a:Points.Point|Line, b:Points.Point):readonly number[] =>  {\n  if (isLine(a)) {\n    return [a.a.x, a.a.y, a.b.x, a.b.y];\n  } else if (Points.isPoint(a) && Points.isPoint(b)) {\n    return [a.x, a.y, b.x, b.y];\n  } else {\n    throw new Error(`Expected single line parameter, or a and b points`);\n  }\n};\n\n/**\n * Yields all the points of all the lines.\n * \n * ```js\n * const lines = [ ..some array of lines.. ];\n * for (const pt of Lines.asPoints(lines)) {\n *  // Yields a and then b of each point sequentially\n * }\n * ```\n * @param lines \n */\n//eslint-disable-next-line func-style\nexport function* asPoints(lines:Iterable<Line>) {\n  for (const l of lines) {\n    yield l.a;\n    yield l.b;\n  }\n}\n\n/**\n * Returns an SVG description of line\n * ```\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js';\n * Lines.toSvgString(ptA, ptB);\n * ```\n * @param a \n * @param b \n * @returns \n */\nexport const toSvgString = (a:Points.Point, b:Points.Point):readonly string[] => [`M${a.x} ${a.y} L ${b.x} ${b.y}`];\n\n/**\n * Returns a line from four numbers [x1,y1,x2,y2].\n * \n * See {@link toFlatArray} to create an array from a line.\n * \n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * const line = Lines.fromFlatArray(...[0, 0, 100, 100]);\n * // line is {a: { x:0, y:0 }, b: { x: 100, y: 100 } }\n * ```\n * @param arr Array in the form [x1,y1,x2,y2]\n * @returns Line\n */\nexport const fromFlatArray = (arr:readonly number[]):Line => {\n  if (!Array.isArray(arr)) throw new Error(`arr parameter is not an array`);\n  if (arr.length !== 4) throw new Error(`array is expected to have length four`);\n  return fromNumbers(arr[0], arr[1], arr[2], arr[3]);\n};\n\n/**\n * Returns a line from two points\n * \n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * // Line from 0,1 to 10,15\n * const line = Lines.fromPoints( { x:0, y:1 }, { x:10, y:15 });\n * // line is: { a: { x: 0, y: 1}, b: { x: 10, y: 15 } };\n * ```\n * @param a Start point\n * @param b End point\n * @returns \n */\nexport const fromPoints = (a:Points.Point, b:Points.Point):Line => {\n  guardPoint(a, `a`);\n  guardPoint(b, `b`);\n  a = Object.freeze({ ...a });\n  b = Object.freeze({ ...b });\n  return Object.freeze({\n    a: a,\n    b: b\n  });\n};\n\n/**\n * Returns an array of lines that connects provided points. Note that line is not closed.\n * \n * Eg, if points a,b,c are provided, two lines are provided: a->b and b->c.\n * \n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * const lines = Lines.joinPointsToLines(ptA, ptB, ptC);\n * // lines is an array of, well, lines\n * ```\n * @param points \n * @returns \n */\nexport const joinPointsToLines = (...points:readonly Points.Point[]):PolyLine => {\n  const lines = [];\n  //eslint-disable-next-line functional/no-let\n  let start = points[0];\n  //eslint-disable-next-line functional/no-let\n  for (let i=1;i<points.length;i++) {\n    //eslint-disable-next-line functional/immutable-data\n    lines.push(fromPoints(start, points[i]));\n    start = points[i];\n  }\n  return lines;\n};\n\n/**\n * Returns a {@link LinePath} from two points\n * \n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * const path = Lines.fromPointsToPath(ptA, ptB);\n * ```\n * @param a \n * @param b \n * @returns \n */\nexport const fromPointsToPath = (a:Points.Point, b:Points.Point):LinePath => toPath(fromPoints(a, b));\n\n/**\n * Returns a rectangle that encompasses dimension of line\n * \n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js';\n * const rect = Lines.bbox(line);\n * ```\n */\nexport const bbox = (line:Line):Rects.RectPositioned =>  Points.bbox(line.a, line.b);\n\n/**\n * Returns a path wrapper around a line instance. This is useful if there are a series\n * of operations you want to do with the same line because you don't have to pass it\n * in as an argument to each function.\n * \n * Note that the line is immutable, so a function like `sum` returns a new LinePath,\n * wrapping the result of `sum`.\n * \n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * // Create a path\n * const l = Lines.toPath(fromNumbers(0,0,10,10));\n * \n * // Now we can use it...\n * l.length();\n * \n * // Mutate functions return a new path\n * const ll = l.sum({x:10,y:10});\n * ll.length();\n * ```\n * @param line \n * @returns \n */\nexport const toPath = (line:Line):LinePath => {\n  const { a, b } = line;\n  return Object.freeze({\n    ...line,\n    length: () => length(a, b),\n    interpolate: (amount:number) => interpolate(amount, a, b),\n    bbox: () => bbox(line),\n    toString: () => toString(a, b),\n    toFlatArray: () => toFlatArray(a, b),\n    toSvgString: () => toSvgString(a, b),\n    toPoints: () => [a, b],\n    rotate: (amountRadian:number, origin:Points.Point) => toPath(rotate(line, amountRadian, origin)),\n    nearest:(point:Point) => nearest(line, point),\n    sum:(point:Points.Point) => toPath(sum(line, point)),\n    divide:(point:Points.Point) => toPath(divide(line, point)),\n    multiply:(point:Point) => toPath(multiply(line, point)),\n    subtract:(point:Point) => toPath(subtract(line, point)),\n    midpoint: () => midpoint(a, b),\n    distance: (point:Point) => distanceSingleLine(line, point),\n    parallel: (distance:number) => parallel(line, distance),\n    perpendicularPoint: (distance:number, amount?:number) => perpendicularPoint(line, distance, amount),\n    slope: () => slope(line),\n    withinRange: (point:Point, maxRange:number) => withinRange(line, point, maxRange),\n    isEqual: (otherLine:Line) => isEqual(line, otherLine),\n    apply:(fn:(point:Points.Point)=>Points.Point) => toPath(apply(line, fn)),\n    kind: `line`\n  });\n};\n\nexport type LinePath = Line & Path & {\n  toFlatArray():readonly number[]\n  toPoints():readonly Points.Point[]\n  rotate(amountRadian:number, origin:Points.Point):LinePath\n  sum(point:Points.Point):LinePath\n  divide(point:Points.Point):LinePath\n  multiply(point:Points.Point):LinePath\n  subtract(point:Points.Point):LinePath\n  apply(fn:(point:Points.Point)=>Points.Point):LinePath\n  midpoint():Point\n  distance(point:Point):number\n  parallel(distance:number):Line\n  perpendicularPoint(distance:number, amount?:number):Point\n  slope():number\n  withinRange(point:Point, maxRange:number):boolean\n  isEqual(otherLine:Line):boolean\n}\n\n/**\n * Returns a line that is rotated by `angleRad`. By default it rotates\n * around its center, but an arbitrary `origin` point can be provided.\n * If `origin` is a number, it's presumed to be a 0..1 percentage of the line.\n * \n * ```js\n * import { Lines } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * \n * // Rotates line by 0.1 radians around point 10,10\n * const r = Lines.rotate(line, 0.1, {x:10,y:10});\n * \n * // Rotate line by 5 degrees around its center\n * const r = Lines.rotate(line, degreeToRadian(5));\n * \n * // Rotate line by 5 degres around its end point\n * const r = Lines.rotate(line, degreeToRadian(5), line.b);\n * \n * // Rotate by 90 degrees at the 80% position\n * const r = Lines.rotated = rotate(line, Math.PI / 2, 0.8);\n * ```\n * @param line Line to rotate\n * @param amountRadian Angle in radians to rotate by\n * @param origin Point to rotate around. If undefined, middle of line will be used\n * @returns \n */\nexport const rotate = (line:Line, amountRadian?:number, origin?:Points.Point|number):Line => {\n  if (amountRadian === undefined || amountRadian === 0) return line;\n  if (origin === undefined) origin = 0.5;\n  if (typeof origin === `number`) {\n    origin = interpolate(origin, line.a, line.b);\n  }\n  return Object.freeze({\n    ...line,\n    a: Points.rotate(line.a, amountRadian, origin),\n    b: Points.rotate(line.b, amountRadian, origin)\n  });\n};","export * from  './Interfaces.js';\n\nexport { mapSet, mapCircularMutable, mapArray } from './MapMultiMutable.js';\nexport { circularArray } from './CircularArray.js';\nexport { simpleMapArrayMutable } from './SimpleMapArray.js';\nexport { setMutable } from './Set.js';\nexport { stack, stackMutable } from './Stack.js';\nexport { queue, queueMutable } from './Queue.js';\nexport { map } from './MapImmutable.js';\nexport { mapMutable } from './MapMutable.js';\nexport { MapOfMutableImpl } from './MapMultiMutable.js';\n\n/**\n * Stacks store items in order. \n * \n * Stacks and queues can be helpful when it's necessary to process data in order, but each one has slightly different behaviour.\n * \n * Like a stack of plates, the newest item (on top) is removed\n * before the oldest items (at the bottom). {@link Queues} operate differently, with\n * the oldest items (at the front of the queue) removed before the newest items (at the end of the queue).\n * \n * Create stacks with {@link stack} or {@link stackMutable}. These return a {@link Stack} or {@link StackMutable} respectively.\n * \n * The ixfx implementation allow you to set a capacity limit with three {@link DiscardPolicy |policies} for\n * how items are evicted.\n * \n */\nexport * as Stacks from './Stack.js';\n\n/** \n * Arrays are a list of data. ixfx provides a number of functions for working with arrays in an immutable manner.\n * This means that the input array is not changed.\n * \n * For arrays of numbers:\n * * {@link average}, {@link max}, {@link min}, {@link total}: Calculate average/max/min/total\n * * {@link averageWeighted}: Calculate average, but applies a weighting function, eg to favour items at beginning of array\n * * {@link minMaxAvg}: Find smallest, largest and average\n * * {@link maxIndex}, {@link minIndex}: Return index of largest/smallest value\n * * {@link dotProduct}: Returns the dot-product between two arrays\n * * {@link weight}: Applies a weighting function to all values based on their index\n * \n * Randomisation\n * * {@link randomIndex}: Return a random array index\n * * {@link randomElement}: Return a random value\n * * {@link randomPluck}: Remove a random element from an array, returning it and the new array\n * * {@link shuffle}: Returns a randomly-sorted copy of arra\n * \n * Finding/accessing\n * * {@link filterBetween}: Same as `Array.filter` but only looks within a specified index range\n * * {@link sample}: Returns a new array with a random sampling of input\n * * {@link areValuesIdentical}: Returns true if all the values in the array are identical\n * \n * Changing the shape\n * * {@link ensureLength}: Returns a copy of array with designated length, either padding it out or truncating as necessary\n * * {@link groupBy}: Groups data into a new Map\n * * {@link interleave}: Flattens several arrays into one, interleaving their values.\n * * {@link remove}: Remove an item by index\n * * {@link without}: Returns an array with specified value omitted\n * * {@link zip}: Groups together elements from several arrays based on their index\n */\nexport * as Arrays from './Arrays.js';\n\n/**\n * Sets store unique items. \n * \n * ixfx's {@link SetImmutable} (or {@link SetMutable}) compares items by value rather than reference, unlike the default JS implementation.\n * \n * Create using {@link Sets.set} or {@link Sets.setMutable}\n */\nexport * as Sets from './Set.js';\n\n/**\n * Queues store items in the order in which they are added.\n * \n * Stacks and queues can be helpful when it's necessary to process data in order, but each one has slightly different behaviour.\n * \n * Like lining up at a bakery, the oldest items (at the front of the queue) are removed \n * before the newest items (at the end of the queue). This is different to {@link Stacks},\n * where the newest item (on top) is removed before the oldest items (at the bottom).\n * \n * The ixfx implementations allow you to set a capacity limit with three {@link DiscardPolicy |policies} for\n * how items are evicted.\n * \n * Create queues with {@link queue} or {@link queueMutable}. These return a {@link Queue} or {@link QueueMutable} respectively.\n */\nexport * as Queues from './Queue.js';\n\n\n/**\n * Maps associate keys with values. Several helper functions are provided\n * for working with the standard JS Map class.\n * \n * ixfx also includes {@link MapMutable}, {@link MapImmutable}\n * \n * Overview:\n * * {@link getOrGenerate}: Solves a common scenario of wanting a value by a particular key, or generating it if it doesn't exist\n * * {@link filter}: Yields values in map that match a predicate\n * * {@link find}: Finds the first value that matches a predicate, or _undefined_ if nothing found\n * * {@link hasAnyValue}: Searches through all keys, returning true if any occurence of _value_ was found\n * \n * Transformations:\n * * {@link toArray}: Returns the values of the map as an array\n * * {@link mapToArray}: Applies a function to convert a map's values to an array\n * * {@link toObject}: Coverts a Map to a plain object, useful for JSON serialising.\n * * {@link mapToObjTransform}: Converts a map to a plain object, but applying a function to values\n * * {@link transformMap}: Like `Array.map`, but for Maps. Useful for generating a map as a transform of an input map.\n * * {@link zipKeyValue}: Given an array of keys and values, combines them together into a map\n */\nexport * as Maps from './Map.js';\n","import { number as guardNumber } from \"./Guards.js\";\nimport { untilMatch } from \"./Text.js\";\n\nexport * as IterableAsync from './IterableAsync.js';\nexport * as Debug from './Debug.js';\n\n//export { KeyValue } from './KeyValue.js';\n\n/**\n * Returns `fallback` if `v` is NaN, otherwise returns `v`\n * @param v\n * @param fallback \n * @returns \n */\nexport const ifNaN = (v:number, fallback:number):number => {\n  if (Number.isNaN(v)) return fallback;\n  return v;\n};\n\n\n/**\n * Maps the properties of an object through a map function.\n * In terms of typesafety, the mapped properties are assumed to have the\n * same type.\n * \n * ```js\n * const o = {\n *  x: 10,\n *  y: 20,\n *  width: 200,\n *  height: 200\n * }\n * \n * // Make each property use an averager instead\n * const oAvg = mapObject(o, (value, key) => {\n *  return movingAverage(10);\n * });\n * \n * // Add a value to the averager\n * oAvg.x.add(20);\n * ```\n */\n//eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport const mapObject = <X extends Record<string, unknown>, V>(object:X, mapFn:(value:any, key?:readonly [keyof X], index?:number)=>V):RemapObjectPropertyType<X, V> => {\n  const mapped = Object.entries(object).map(([key, value], i) => [key, mapFn(value, (key as unknown) as ([keyof X]), i)]);\n  return Object.fromEntries(mapped);\n};\n\n\nexport type RemapObjectPropertyType <OriginalType, PropType> = { readonly\n  [Property in keyof OriginalType]:PropType\n}\n\n/**\n * Returns true if `x` is a power of two\n * @param x \n * @returns True if `x` is a power of two\n */\nexport const isPowerOfTwo = (x:number) => Math.log2(x) % 1 === 0;\n\n/**\n * Returns the relative difference from the `initial` value\n * ```js\n * const rel = relativeDifference(100);\n * rel(100); // 1\n * rel(150); // 1.5\n * rel(50);  // 0.5\n * ```\n * \n * The code for this is simple:\n * ```js\n * const relativeDifference = (initial) => (v) => v/initial\n * ```\n * @param {number} initial \n * @returns \n */\nexport const relativeDifference = (initial:number) => (v:number) => v/initial;\n\n// try {\n//   if (typeof window !== `undefined`) {\n//     //eslint-disable-next-line functional/immutable-data,@typescript-eslint/no-explicit-any\n//     (window as any).ixfx = {...(window as any).ixfx, clamp, clampIndex, flip, interpolate, interpolateAngle, proportion, relativeDifference, scale, scalePercent, wrap, wrapInteger, wrapRange};\n//   }\n// } catch { /* no-op */ }\n\n/**\n * Returns a field on object `o` by a dotted path.\n * ```\n * const d = {\n *  accel: {x: 1, y: 2, z: 3},\n *  gyro:  {x: 4, y: 5, z: 6}\n * };\n * getFieldByPath(d, `accel.x`); // 1\n * getFieldByPath(d, `gyro.z`);  // 6\n * getFieldByPath(d, `gyro`);    // {x:4, y:5, z:6}\n * getFieldByPath(d, ``);        // Returns original object\n * ```\n * \n * If a field does not exist, `undefined` is returned.\n * Use {@link getFieldPaths} to get a list of paths.\n * @param o \n * @param path \n * @returns \n */\n//eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport const getFieldByPath = (o:any, path:string = ``):any|undefined => {\n  if (path.length === 0) return o;\n  if (path in o) {\n    return o[path];\n  } else {\n    const start = untilMatch(path, `.`);\n    if (start in o) {\n      return getFieldByPath(o[start], path.substring(start.length+1));\n    } else {\n      return undefined;\n    }\n  }\n};\n\n/**\n * Returns a list of paths for all the fields on `o`\n * ```\n * const d = {\n *  accel: {x: 1, y: 2, z: 3},\n *  gyro:  {x: 4, y: 5, z: 6}\n * };\n * const paths = getFieldPaths(d); \n * // Yields [ `accel.x`, `accel.y`,`accel.z`,`gyro.x`,`gyro.y`,`gyro.z` ]\n * ```\n * \n * Use {@link getFieldByPath} to fetch data by this 'path' string.\n * @param o \n * @returns \n */\n//eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport const getFieldPaths = (o:any):readonly string[] => {\n  const paths:string[] = [];\n  //eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const probe = (o:any, prefix = ``) => {\n    if (typeof o === `object`) {\n      const keys = Object.keys(o);\n      if (prefix.length > 0) prefix += `.`;\n      keys.forEach(k => probe(o[k], prefix + k));\n    } else {\n      //eslint-disable-next-line functional/immutable-data\n      paths.push(prefix);\n    }\n  };\n  probe(o);\n  return paths;\n};\n\n/**\n * Rounds `v` up to the nearest multiple of `multiple`\n * ```\n * roundMultiple(19, 20); // 20\n * roundMultiple(21, 20); // 40\n * ```\n * @param v \n * @param multiple \n * @returns \n */\nexport const roundUpToMultiple = (v:number, multiple:number):number => {\n  guardNumber(v, `nonZero`, `v`);\n  guardNumber(multiple, `nonZero`, `muliple`);\n  return Math.ceil(v/multiple)*multiple;\n};\n\nexport type ToString<V> = (itemToMakeStringFor:V)=>string;\n\n/**\n * Function that returns true if `a` and `b` are considered equal\n */\nexport type IsEqual<V> = (a:V, b:V)=>boolean;\n\n/**\n * Default comparer function is equiv to checking `a === b`\n */\nexport const isEqualDefault = <V>(a:V, b:V):boolean => a === b;\n\n/**\n * Comparer returns true if string representation of `a` and `b` are equal.\n * Uses `toStringDefault` to generate a string representation (`JSON.stringify`)\n * @returns True if the contents of `a` and `b` are equal\n */\nexport const isEqualValueDefault = <V>(a:V, b:V):boolean => {\n  //  UNIT TESTED\n  if (a === b) return true; // Object references are the same, or string values are the same\n  return toStringDefault(a) === toStringDefault(b); // String representations are the same\n};\n\n/**\n * A default converter to string that uses JSON.stringify if its an object, or the thing itself if it's a string\n */\nexport const toStringDefault = <V>(itemToMakeStringFor:V):string => ((typeof itemToMakeStringFor === `string`) ? itemToMakeStringFor : JSON.stringify(itemToMakeStringFor));\n\nexport const runningiOS = () => [\n  `iPad Simulator`,\n  `iPhone Simulator`,\n  `iPod Simulator`,\n  `iPad`,\n  `iPhone`,\n  `iPod`\n].includes(navigator.platform)\n  // iPad on iOS 13 detection\n  || (navigator.userAgent.includes(`Mac`) && `ontouchend` in document);\n\n/**\n * Default sort comparer, following same sematics as Array.sort\n * @param x \n * @param y \n * @returns \n */\n//eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport const defaultComparer = (x:any, y:any) => {\n  // Via https://stackoverflow.com/questions/47334234/how-to-implement-array-prototype-sort-default-compare-function\n  if (x === undefined && y === undefined) return 0;\n  if (x === undefined) return 1;\n  if (y === undefined) return -1;\n\n  const xString = defaultToString(x);\n  const yString = defaultToString(y);\n\n  if (xString < yString) return -1;\n  if(xString > yString) return 1;\n  return 0;\n};\n\n//eslint-disable-next-line @typescript-eslint/no-explicit-any\nconst defaultToString = (obj:any) => {\n  //ECMA specification: http://www.ecma-international.org/ecma-262/6.0/#sec-tostring\n  if (obj === null) return `null`;\n  if (typeof obj === `boolean` ||  typeof obj === `number`) return (obj).toString();\n\n  if (typeof obj === `string`) return obj;\n  if (typeof obj === `symbol`) throw new TypeError();\n  return (obj).toString();\n};\n\ntry {\n  if (typeof window !== `undefined`) {\n    //eslint-disable-next-line functional/immutable-data,@typescript-eslint/no-explicit-any\n    (window as any).ixfx = { ...(window as any).ixfx,  getFieldByPath, getFieldPaths };\n  }\n} catch { /* no-op */ }","import { string as random } from './Random.js';\n\nexport { random };\n\n/**\n * Returns source text that is between `start` and `end` match strings. Returns _undefined_ if start/end is not found.\n * \n * ```js\n * // Yields ` orange `;\n * between(`apple orange melon`, `apple`, `melon`);\n * ```\n * @param source Source text \n * @param start Start match\n * @param end If undefined, `start` will be used instead\n * @param lastEndMatch If true, looks for the last match of `end` (default). If false, looks for the first match.\n * @returns \n */\nexport const between = (source:string, start:string, end?:string, lastEndMatch = true):string | undefined => {\n  const startPos = source.indexOf(start);\n  if (startPos < 0) return;\n\n  if (end === undefined) end = start;\n\n  const endPos = lastEndMatch ? source.lastIndexOf(end) : source.indexOf(end, startPos+1);\n  if (endPos < 0) return;\n\n  return source.substring(startPos+1, endPos);\n};\n\n\n/**\n * Returns first position of the given character code, or -1 if not found.\n * @param source Source string\n * @param code Code to seek\n * @param start Start index, 0 by default\n * @param end End index (inclusive), source.length-1 by default\n * @returns Found position, or -1 if not found\n */\nexport const indexOfCharCode = (source:string, code:number, start = 0, end = source.length-1):number => {\n  //eslint-disable-next-line functional/no-let\n  for (let i=start;i<=end;i++) {\n    if (source.charCodeAt(i) === code) return i;\n  }\n  return -1;\n};\n\n/**\n * Returns `source` with chars removed at `removeStart` position\n * ```js\n * omitChars(`hello there`, 1, 3);\n * // Yields: `ho there`\n * ```\n * @param source \n * @param removeStart Start point to remove\n * @param removeLength Number of characters to remove \n * @returns \n */\nexport const omitChars = (source:string, removeStart:number, removeLength:number) =>  source.substring(0, removeStart) + source.substring(removeStart+removeLength);\n\n/**\n * Splits a string into `length`-size chunks.\n * \n * If `length` is greater than the length of `source`, a single element array is returned with source.\n * The final array element may be smaller if we ran out of characters.\n * \n * ```js\n * splitByLength(`hello there`, 2);\n * // Yields:\n * // [`he`, `ll`, `o `, `th`, `er`, `e`]\n * ```\n * @param source Source string\n * @param length Length of each chunk\n * @returns \n */\nexport const splitByLength = (source:string, length:number):readonly string[] => {\n  const chunks = Math.ceil(source.length/length);\n  const ret:string[] = [];\n  //eslint-disable-next-line functional/no-let\n  let start = 0;\n\n  //eslint-disable-next-line functional/no-let  \n  for (let c=0;c<chunks;c++) {\n    //eslint-disable-next-line functional/immutable-data\n    ret.push(source.substring(start, start+length));\n    start += length;\n  }\n  return ret;\n};\n\n/**\n * Returns the `source` string up until (and excluding) `match`. If match is not\n * found, all of `source` is returned.\n * \n * ```js\n * // Yields `apple `\n * untilMarch(`apple orange melon`, `orange`);\n * ```\n * @param source \n * @param match \n * @param startPos If provided, gives the starting offset. Default 0\n */\nexport const untilMatch = (source:string, match:string, startPos = 0):string => {\n  if (startPos > source.length) throw new Error(`startPos should be less than length`);\n  const m = source.indexOf(match, startPos);\n  \n  if (m < 0) return source;\n  return source.substring(startPos, m);\n};\n\n/**\n * 'Unwraps' a string, removing one or more 'wrapper' strings that it starts and ends with.\n * ```js\n * unwrap(\"'hello'\", \"'\");        // hello\n * unwrap(\"apple\", \"a\");          // apple\n * unwrap(\"wow\", \"w\");            // o\n * unwrap(`\"'blah'\"`, '\"', \"'\");  // blah\n * ```\n * @param source \n * @param wrappers \n * @returns \n */\nexport const unwrap = (source:string, ...wrappers:readonly string[]):string => {\n  //eslint-disable-next-line functional/no-let\n  let matched = false;\n  do {\n    matched = false;\n    for (const w of wrappers) {\n      if (source.startsWith(w) && source.endsWith(w)) {\n        source = source.substring(w.length, source.length - (w.length * 2) + 1);\n        matched = true;\n      }\n    }\n  } while (matched);\n\n  return source;\n};\n\n/**\n * A range\n */\nexport type Range = {\n  /**\n   * Text of range\n   */\n  readonly text:string\n  /**\n   * Start position, with respect to source text\n   */\n   readonly start:number\n  /**\n   * End position, with respect to source text\n   */\n   readonly end:number\n  /**\n   * Index of range. First range is 0\n   */\n   readonly index:number\n}\n\nexport type LineSpan = {\n  readonly start:number\n  readonly end:number\n  readonly length:number\n}\n\n/**\n * Calculates the span, defined in {@link Range} indexes, that includes `start` through to `end` character positions.\n * \n * After using {@link splitRanges} to split text, `lineSpan` is used to associate some text coordinates with ranges.\n * \n * @param ranges Ranges\n * @param start Start character position, in source text reference\n * @param end End character position, in source text reference\n * @returns Span\n */\nexport const lineSpan = (ranges:readonly Range[], start:number, end:number):LineSpan => {\n  //eslint-disable-next-line functional/no-let\n  let s = -1;\n  //eslint-disable-next-line functional/no-let\n  let e = -1;\n  //eslint-disable-next-line functional/no-let\n  for (let i = 0; i < ranges.length; i++) {\n    const r = ranges[i];\n    s = i;\n    if (r.text.length === 0) continue;\n    if (start < r.end) {\n      break;\n    }\n  }\n\n  //eslint-disable-next-line functional/no-let\n  for (let i = s; i < ranges.length; i++) {\n    const r = ranges[i];\n    e = i;\n    if (end === r.end) {\n      e = i + 1;\n      break;\n    }\n    if (end < r.end) {\n      break;\n    }\n  }\n  return { length: e - s, start: s, end: e };\n};\n\n/**\n * Splits a source string into ranges:\n * ```js\n * const ranges = splitRanges(\"hello;there;fella\", \";\");\n * ```\n * \n * Each range consists of:\n * ```js\n * { \n *  text: string  - the text of range\n *  start: number - start pos of range, wrt to source\n *  end: number   - end pos of range, wrt to source\n *  index: number - index of range (starting at 0)\n * }\n * ```\n * @param source \n * @param split \n * @returns \n */\nexport const splitRanges = (source:string, split:string):readonly Range[] => {\n  //eslint-disable-next-line functional/no-let\n  let start = 0;\n  //eslint-disable-next-line functional/no-let\n  let text = ``;\n  const ranges:Range[] = [];\n  //eslint-disable-next-line functional/no-let\n  let index = 0;\n  //eslint-disable-next-line functional/no-let\n  for (let i = 0; i < source.length; i++) {\n    if (source.indexOf(split, i) === i) {\n      //eslint-disable-next-line functional/no-let\n      const end = i;\n      //eslint-disable-next-line functional/immutable-data\n      ranges.push({\n        text, start, end, index\n      });\n      start = end + 1;\n      text = ``;\n      index++;\n    } else {\n      text += source.charAt(i);\n    }\n  }\n  if (start < source.length) {\n    //eslint-disable-next-line functional/immutable-data\n    ranges.push({ text, start, index, end: source.length });\n  }\n  return ranges;\n};\n\n/**\n * Counts the number of times one of `chars` appears at the front of\n * a string, contiguously.\n * \n * ```js\n * countCharsFromStart(`  hi`, ` `); // 2\n * countCharsFromStart(`hi  `, ` `); // 0\n * countCharsFromStart(`  hi  `, ` `); // 2\n * ```\n * @param source \n * @param chars \n * @returns \n */\nexport const countCharsFromStart = (source:string, ...chars:readonly string[]):number => {\n  //eslint-disable-next-line functional/no-let\n  let counted = 0;\n  //eslint-disable-next-line functional/no-let\n  for (let i = 0; i < source.length; i++) {\n    if (chars.includes(source.charAt(i))) {\n      counted++;\n    } else {\n      break;\n    }\n  }\n  return counted;\n};\n\n/**\n * Returns _true_ if `source` starts and ends with `start` and `end`. Case-sensitive.\n * If _end_ is omitted, the the `start` value will be used.\n * \n * ```js\n * startsEnds(`This is a string`, `This`, `string`); // True\n * startsEnds(`This is a string`, `is`, `a`); // False\n * starsEnds(`test`, `t`); // True, starts and ends with 't'\n * ```\n * @param source String to search within \n * @param start Start\n * @param end End (if omitted, start will be looked for at end as well)\n * @returns True if source starts and ends with provided values.\n */\nexport const startsEnds = (source:string, start:string, end:string = start):boolean => source.startsWith(start) && source.endsWith(end);\n\n//eslint-disable-next-line no-useless-escape\nexport const htmlEntities = (source:string):string => source.replace(/[\\u00A0-\\u9999<>\\&]/g, i => `&#${i.charCodeAt(0)};`);","import { getOrGenerateSync } from \"./collections/Map\";\nimport { goldenAngleColour } from \"./visual/Colour\";\n\n//eslint-disable-next-line functional/no-let\nlet logColourCount = 0;\nconst logColours = getOrGenerateSync(new Map<string, string>(), () => goldenAngleColour(++logColourCount));\n\n\n/**\n * Returns a bundled collection of {@link logger}s\n * \n * ```\n * const con = logSet(`a`);\n * con.log(`Hello`);  // console.log(`a Hello`);\n * con.warn(`Uh-oh`); // console.warn(`a Uh-oh`);\n * con.error(`Eek!`); // console.error(`a Eek!`);\n * ```\n * @param prefix \n * @returns \n */\nexport const logSet = (prefix:string, verbose = true) => {\n  if (verbose) {\n    return {\n      log: logger(prefix, `log`),\n      warn: logger(prefix, `warn`),\n      error: logger(prefix, `error`)\n    };\n  } else {\n    return {\n      //eslint-disable-next-line @typescript-eslint/no-explicit-any\n      log: (_:any) => { /** no-op */ },\n      warn: logger(prefix, `warn`),\n      error: logger(prefix, `error`)\n    };\n  }\n\n};\n\n//eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport type Logger = (m:any)=>void;\nexport type LogSet = {\n  readonly log:Logger,\n  readonly warn:Logger,\n  readonly error:Logger\n};\n\n/**\n * Returns a console logging function which prefixes messages. This is\n * useful for tracing messages from different components. Each prefix\n * is assigned a colour, further helping to distinguish messages.\n * \n * Use {@link logSet} to get a bundled set.\n * \n * ```\n * // Initialise once\n * const log = logger(`a`);\n * const error = logger(`a`, `error`);\n * const warn = logger(`a`, `warn);\n * \n * // And then use\n * log(`Hello`);    // console.log(`a Hello`);\n * error(`Uh-oh`);  // console.error(`a Uh-oh`);\n * warn(`Eek!`);    // console.warn(`a Eeek!`);\n * ```\n * @param prefix \n * @param kind \n * @returns \n */\n//eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport const logger = (prefix:string, kind:`log` | `warn` | `error` = `log`):Logger => (m:any) => {\n  if (m === undefined) {\n    m = `(undefined)`;\n  } else if (typeof m === `object`) {\n    m = JSON.stringify(m);\n  }\n\n  switch (kind) {\n  case `log`:\n    console.log(`%c${prefix} ${m}`, `color: ${logColours(prefix)}`);\n    break;\n  case `warn`:\n    console.warn(prefix, m);\n    break;\n  case `error`:\n    console.error(prefix, m);\n    break;\n  }\n};","import { defaultComparer, IsEqual, isEqualDefault, ToString } from \"../Util.js\";\nexport { create as expiringMap, ExpiringMap, ExpiringMapEvent, ExpiringMapEvents, Opts as ExpiringMapOpts } from './ExpiringMap.js';\n\n\n//  UNIT TESTED!\n\n/**\n * Returns true if map contains `value` under `key`, using `comparer` function. Use {@link hasAnyValue} if you don't care\n * what key value might be under.\n * \n * Having a comparer function is useful to check by value rather than object reference.\n * \n * @example Find key value based on string equality\n * ```js\n * hasKeyValue(map,`hello`, `samantha`, (a, b) => a === b);\n * ```\n * @param map Map to search\n * @param key Key to search\n * @param value Value to search\n * @param comparer Function to determine match\n * @returns True if key is found\n */\nexport const hasKeyValue = <K, V>(map:ReadonlyMap<K, V>, key:K, value:V, comparer:IsEqual<V>):boolean => {\n  if (!map.has(key)) return false;\n  const values = Array.from(map.values());\n  return values.some(v => comparer(v, value));\n};\n\n/**\n * Deletes all key/values from map where value matches `value`,\n * with optional comparer. Mutates map.\n * \n * ```js\n * import { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\"\n * \n * // Compare fruits based on their colour property\n * const colourComparer = (a, b) => a.colour === b.colour;\n * \n * // Deletes all values where .colour = `red`\n * Maps.deleteByValue(map, { colour: `red` }, colourComparer);\n * ```\n * @param map \n * @param value \n * @param comparer \n */\nexport const deleteByValue = <K, V>(map:ReadonlyMap<K, V>, value:V, comparer:IsEqual<V> = isEqualDefault) => {\n  for (const e of Object.entries(map)) {\n    if (comparer(e[1], value)) {\n      // @ts-ignore\n      map.delete(e[0]);\n    }\n  }\n};\n\nexport type GetOrGenerate<K, V, Z> = (key:K, args?:Z)=>Promise<V>;\n\nexport interface Mappish<K, V> {\n  get(key:K):V|undefined;\n  set(key:K, value:V):void;\n}\n\n/**\n * Returns a function that fetches a value from a map, or generates and sets it if not present.\n * Undefined is never returned, because if `fn` yields that, an error is thrown.\n * \n * See {@link getOrGenerateSync} for a synchronous version.\n * \n * ```\n * const m = getOrGenerate(new Map(), (key) => {\n *  return key.toUppercase();\n * });\n * \n * // Not contained in map, so it will run the uppercase function,\n * // setting the value to the key 'hello'.\n * const v = await m(`hello`);  // Yields 'HELLO'\n * const v1 = await m(`hello`); // Value exists, so it is returned ('HELLO')\n * ```\n * \n */\n//eslint-disable-next-line functional/prefer-readonly-type\nexport const getOrGenerate = <K, V, Z>(map:Mappish<K, V>, fn:(key:K, args?:Z)=>Promise<V>|V):GetOrGenerate<K, V, Z> => async (key:K, args?:Z):Promise<V> => {\n  //eslint-disable-next-line functional/no-let\n  let value = map.get(key);\n  if (value !== undefined) return Promise.resolve(value);\n  value = await fn(key, args);\n  if (value === undefined) throw new Error(`fn returned undefined`);\n  map.set(key, value);\n  return value;\n};\n\n/**\n * @inheritDoc getOrGenerate\n * @param map \n * @param fn \n * @returns \n */\n//eslint-disable-next-line functional/prefer-readonly-type\nexport const getOrGenerateSync = <K, V, Z>(map:Mappish<K, V>, fn:(key:K, args?:Z)=>V) => (key:K, args?:Z):V => {\n  //eslint-disable-next-line functional/no-let\n  let value = map.get(key);\n  if (value !== undefined) return value;\n  value = fn(key, args);\n  map.set(key, value);\n  return value;\n};\n\n/**\n * Adds items to a map only if their key doesn't already exist \n * \n * Uses provided {@link Util.ToString} function to create keys for items. Item is only added if it doesn't already exist.\n * Thus the older item wins out, versus normal `Map.set` where the newest wins.\n * \n * \n * @example\n * ```js\n * import { Maps } from \"https://unpkg.com/ixfx/dist/collections.js\";\n * const map = new Map();\n * const peopleArray = [ _some people objects..._];\n * Maps.addKeepingExisting(map, p => p.name, ...peopleArray);\n * ```\n * @param set \n * @param hashFunc \n * @param values \n * @returns \n */\nexport const addKeepingExisting = <V>(set:ReadonlyMap<string, V>|undefined, hashFunc:ToString<V>, ...values:readonly V[]) => {\n  const s = set === undefined ? new Map() : new Map(set);\n  values.forEach(v => {\n    const vStr = hashFunc(v);\n    if (s.has(vStr)) return;\n    s.set(vStr, v);\n  });\n  return s;\n};\n\n/**\n * Returns a array of entries from a map, sorted by value.\n * \n * ```js\n * const m = new Map();\n * m.set(`4491`, { name: `Bob` });\n * m.set(`2319`, { name: `Alice` });\n * \n * // Compare by name\n * const comparer = (a, b) => defaultComparer(a.name, b.name);\n * \n * // Get sorted values\n * const sorted = Maps.sortByValue(m, comparer);\n * ```\n * \n * `sortByValue` takes a comparison function that should return -1, 0 or 1 to indicate order of `a` to `b`. If not provided, {@link Util.defaultComparer} is used.\n * @param map \n * @param compareFn \n * @returns \n */\nexport const sortByValue = <K, V>(map:ReadonlyMap<K, V>, compareFn?:(a:V, b:V)=>number) => {\n  const f = compareFn ?? defaultComparer;\n  [...map.entries()].sort((a, b) => f(a[1], b[1]));\n};\n\n/**\n * Returns an array of entries from a map, sorted by a property of the value\n * \n * ```js\n * cosnt m = new Map();\n * m.set(`4491`, { name: `Bob` });\n * m.set(`2319`, { name: `Alice` });\n * const sorted = Maps.sortByValue(m, `name`);\n * ```\n * @param map Map to sort\n * @param prop Property of value\n * @param compareFn Comparer. If unspecified, uses a default.\n */\nexport const sortByValueProperty = <K, V, Z>(map:ReadonlyMap<K, V>, prop:string, compareFn?:(a:Z, b:Z)=>number) => {\n  const cfn = (typeof compareFn === `undefined`) ? defaultComparer : compareFn;\n  return [...map.entries()].sort((aE, bE) => {\n    const a = aE[1];\n    const b = bE[1];\n    // @ts-ignore\n    return cfn(a[prop], b[prop]);\n  });\n};\n/**\n * Returns true if _any_ key contains `value`, based on the provided `comparer` function. Use {@link hasKeyValue}\n * if you only want to find a value under a certain key.\n * \n * Having a comparer function is useful to check by value rather than object reference.\n * @example Finds value where name is 'samantha', regardless of other properties\n * ```js\n * hasAnyValue(map, {name:`samantha`}, (a, b) => a.name === b.name);\n * ```\n * \n * Works by comparing `value` against all values contained in `map` for equality using the provided `comparer`.\n * \n * @param map Map to search\n * @param value Value to find\n * @param comparer Function that determines matching. Should return true if `a` and `b` are considered equal.\n * @returns True if value is found\n */\nexport const hasAnyValue = <K, V>(map:ReadonlyMap<K, V>, value:V, comparer:IsEqual<V>):boolean => {\n  const entries = Array.from(map.entries());\n  return entries.some(kv => comparer(kv[1], value));\n};\n\n/**\n * Returns values where `predicate` returns true.\n * \n * If you just want the first match, use `find`\n * \n * @example All people over thirty\n * ```js\n * // for-of loop\n * for (const v of filter(people, person => person.age > 30)) {\n * \n * }\n * // If you want an array\n * const overThirty = Array.from(filter(people, person => person.age > 30));\n * ```\n * @param map Map\n * @param predicate Filtering predicate \n * @returns Values that match predicate\n */\n//eslint-disable-next-line func-style\nexport function * filter<V>(map:ReadonlyMap<string, V>, predicate:(v:V)=>boolean) {\n  for (const v of map.values()) {\n    if (predicate(v)) yield v;\n  }\n}\n\n//export const filter = <V>(map:ReadonlyMap<string, V>, predicate:(v:V) => boolean):ReadonlyArray<V> => Array.from(map.values()).filter(predicate);\n\n/**\n * Copies data to an array\n * @param map \n * @returns \n */\nexport const toArray = <V>(map:ReadonlyMap<string, V>):ReadonlyArray<V> => Array.from(map.values());\n\n/**\n * Returns a Map from an iterable\n * \n * ```js\n * const data = [ \n *  { fruit: `granny-smith`, family: `apple`, colour: `green` }\n *  { fruit: `mango`, family: `stone-fruit`, colour: `orange` }\n * ];\n * const map = Maps.fromIterable(data, v => v.fruit);\n * ```\n * @param data Input data\n * @param keyFn Function which returns a string id\n * @param allowOverwrites If true, items with same id will silently overwrite each other, with last write wins\n * @returns \n */\nexport const fromIterable = <V>(data:Iterable<V>, keyFn:(v:V)=>string, allowOverwrites = false):ReadonlyMap<string, V> => {\n  const m = new Map<string, V>();\n  for (const d of data) {\n    const id = keyFn(d);\n    if (m.has(id) && !allowOverwrites) throw new Error(`id ${id} is already used and new data will overwrite it. `);\n    m.set(id, d);\n  }\n  return m;\n};\n\n/**\n * Returns a Map from an object, or array of objects.\n * Assumes the top-level properties of the object is the key.\n * \n * ```js\n * const data = {\n *  Sally: { name: `Sally`, colour: `red` },\n *  Bob: { name: `Bob`, colour: `pink` }\n * };\n * const map = Maps.fromObject(data);\n * map.get(`Sally`); // { name: `Sally`, colour: `red` }\n * ```\n * \n * To add an object to an existing map, use {@link addObject}.\n * @param data \n * @returns \n */\n//eslint-disable-next-line @typescript-eslint/no-explicit-any,functional/prefer-readonly-type\nexport const fromObject = <V>(data:any):ReadonlyMap<string, V> => {\n  //eslint-disable-next-line @typescript-eslint/no-explicit-any,functional/prefer-readonly-type\n  const map = new Map<string, V>();\n  if (Array.isArray(data)) {\n    data.forEach(d => addObject<V>(map, d));\n  } else {\n    addObject<V>(map, data);\n  }\n  return map;\n};\n\n/**\n * Adds an object to an existing map. It assumes a structure where\n * each top-level property is a key:\n * \n * ```js\n * const data = {\n *  Sally: { name: `Sally`, colour: `red` },\n *  Bob: { name: `Bob`, colour: `pink` }\n * };\n * const map = new Map();\n * Maps.addObject(map, data);\n * \n * map.get(`Sally`); // { name: `Sally`, colour: `red` }\n * ```\n * \n * To create a new map from an object, use {@link fromObject} instead.\n * @param map \n * @param data \n */\n//eslint-disable-next-line @typescript-eslint/no-explicit-any,functional/prefer-readonly-type\nexport const addObject = <V>(map:Map<string, V>, data:any) => {\n  const entries = Object.entries(data);\n  for (const [key, value] of entries) {\n    map.set(key, value as V);\n  }\n};\n/**\n * Returns the first found item that matches `predicate` or _undefined_.\n * \n * If you want all matches, use {@link filter}.\n * \n * @example First person over thirty\n * ```js\n * const overThirty = find(people, person => person.age > 30);\n * ```\n * @param map Map to search\n * @param predicate Function that returns true for a matching item\n * @returns Found item or _undefined_\n */\nexport const find = <V>(map:ReadonlyMap<string, V>, predicate:(v:V)=>boolean):V|undefined =>  Array.from(map.values()).find(vv => predicate(vv));\n\n/**\n * Converts a map to a simple object, transforming from type `T` to `K` as it does so. If no transforms are needed, use {@link toObject}.\n * \n * ```js\n * const map = new Map();\n * map.set(`name`, `Alice`);\n * map.set(`pet`, `dog`);\n * \n * const o = mapToObjTransform(map, v => {\n *  ...v,\n *  registered: true\n * });\n * \n * // Yields: { name: `Alice`, pet: `dog`, registered: true }\n * ```\n * \n * If the goal is to create a new map with transformed values, use {@link transformMap}.\n * @param m\n * @param valueTransform \n * @typeParam T Value type of input map\n * @typeParam K Value type of destination map\n * @returns \n */\n//eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport const mapToObjTransform = <T, K>(m:ReadonlyMap<string, T>, valueTransform:(value:T)=>K):{readonly [key:string]:K} => Array.from(m).reduce((obj:any, [key, value]) => {\n  const t = valueTransform(value);\n  /* eslint-disable-next-line functional/immutable-data */\n  obj[key] = t;\n  return obj;\n}, {});\n\n/**\n * Zips together an array of keys and values into an object. Requires that \n * `keys` and `values` are the same length.\n * \n * @example\n * ```js\n * const o = zipKeyValue([`a`, `b`, `c`], [0, 1, 2])\n * Yields: { a: 0, b: 1, c: 2}\n *```\n  * @param keys String keys\n  * @param values Values\n  * @typeParam V Type of values\n  * @return Object with keys and values\n  */\nexport const zipKeyValue = <V>(keys:ReadonlyArray<string>, values:ArrayLike<V|undefined>) => {\n  if (keys.length !== values.length) throw new Error(`Keys and values arrays should be same length`);\n  return Object.fromEntries(keys.map((k, i) => [k, values[i]]));\n};\n\n\n//#region Functions by Kees C. Bakker\n// Functions by Kees C. Bakker\n// https://keestalkstech.com/2021/10/having-fun-grouping-arrays-into-maps-with-typescript/\n\n/**\n * Like `Array.map`, but for a Map. Transforms from Map<K,V> to Map<K,R>, returning as a new Map.\n * \n * @example\n * ```js\n * const mapOfStrings = new Map();\n * mapOfStrings.set(`a`, `10`);\n * mapOfStrings.get(`a`); // Yields `10` (a string)\n * \n * // Convert a map of string->string to string->number\n * const mapOfInts = transformMap(mapOfStrings, (value, key) => parseInt(value));\n * \n * mapOfInts.get(`a`); // Yields 10 (a proper number)\n * ```\n * \n * If you want to combine values into a single object, consider instead  {@link mapToObjTransform}.\n * @param source \n * @param transformer \n * @typeParam K Type of keys (generally a string)\n * @typeParam V Type of input map values\n * @typeParam R Type of output map values\n * @returns \n */\nexport const transformMap = <K, V, R>(\n  source:ReadonlyMap<K, V>,\n  transformer:(value:V, key:K)=>R\n) => new Map(\n    Array.from(source, v => [v[0], transformer(v[1], v[0])])\n  );\n\n\n/**\n * Converts a `Map` to a plain object, useful for serializing to JSON.\n * To convert back to a map use {@link fromObject}.\n * \n * @example\n * ```js\n * const map = new Map();\n * map.set(`Sally`, { name: `Sally`, colour: `red` });\n * map.set(`Bob`, { name: `Bob`, colour: `pink });\n * \n * const objects = Maps.toObject(map);\n * // Yields: {\n* //  Sally: { name: `Sally`, colour: `red` },\n* //  Bob: { name: `Bob`, colour: `pink` }\n* // }\n * ```\n * @param m \n * @returns \n */\n/* eslint-disable-next-line @typescript-eslint/no-explicit-any */\nexport const toObject = <T>(m:ReadonlyMap<string, T>):{ readonly [key:string]:T} => Array.from(m).reduce((obj:any, [key, value]) => {\n  /* eslint-disable-next-line functional/immutable-data */\n  obj[key] = value;\n  return obj;\n}, {});\n\n/**\n * Converts Map to Array with a provided `transformer` function. Useful for plucking out certain properties\n * from contained values and for creating a new map based on transformed values from an input map.\n * \n * @example Get an array of ages from a map of Person objects\n * ```js\n * let person = { age: 29, name: `John`};\n * map.add(person.name, person);\n * \n * const ages = mapToArray(map, (key, person) => person.age);\n * // [29, ...]\n * ```\n * \n * In the above example, the `transformer` function returns a number, but it could\n * just as well return a transformed version of the input:\n * \n * ```js\n * // Return with random heights and uppercased name\n * mapToArray(map, (key, person) => ({\n *  ...person,\n *  height: Math.random(),\n *  name: person.name.toUpperCase();\n * }))\n * // Yields:\n * // [{height: 0.12, age: 29, name: \"JOHN\"}, ...]\n * ```\n * @param m \n * @param transformer A function that takes a key and item, returning a new item.\n * @returns \n */\nexport const mapToArray = <K, V, R>(\n  m:ReadonlyMap<K, V>,\n  transformer:(key:K, item:V)=>R\n):readonly R[] => Array.from(m.entries()).map(x => transformer(x[0], x[1]));\n// End Functions by Kees C. Bakker\n//#endregion\n\n/**\n * Returns a result of a merged into b.\n * B is always the 'newer' data that takes\n * precedence.\n */\nexport type MergeReconcile<V> = (a:V, b:V)=>V;\n\n/**\n * Merges maps left to right, using the provided\n * `reconcile` function to choose a winner when keys overlap.\n * \n * There's also [Arrays.mergeByKey](functions/Collections.Arrays.mergeByKey.html) if you don't already have a map.\n * \n * For example, if we have the map A:\n * 1 => `A-1`, 2 => `A-2`, 3 => `A-3`\n * \n * And map B:\n * 2 => `B-1`, 2 => `B-2`, 4 => `B-4`\n * \n * If they are merged with the reconile function:\n * ```js\n * const reconcile = (a, b) => b.replace(`-`, `!`);\n * const output = mergeByKey(reconcile, mapA, mapB);\n * ```\n * \n * The final result will be:\n * \n * 1 => `B!1`, 2 => `B!2`, 3 => `A-3`, 4 => `B-4`\n * \n * In this toy example, it's obvious how the reconciler transforms\n * data where the keys overlap. For the keys that do not overlap -\n * 3 and 4 in this example - they are copied unaltered.\n * \n * A practical use for `mergeByKey` has been in smoothing keypoints\n * from a TensorFlow pose. In this case, we want to smooth new keypoints\n * with older keypoints. But if a keypoint is not present, for it to be \n * passed through.\n * \n * @param reconcile \n * @param maps \n */\nexport const mergeByKey = <K, V>(reconcile:MergeReconcile<V>, ...maps:readonly ReadonlyMap<K, V>[]):ReadonlyMap<K, V> => {\n  const result = new Map<K, V>();\n  for (const m of maps) {\n    for (const [mk, mv] of m) {\n      //eslint-disable-next-line functional/no-let\n      let v = result.get(mk);\n      if (v) {\n        v = reconcile(v, mv);\n      } else {\n        v = mv;\n      }\n      result.set(mk, v);\n    }\n  }\n  return result;\n};","import { SimpleEventEmitter } from \"../Events.js\";\nimport { sortByValueProperty } from \"./Map.js\";\nimport { integer as guardInteger } from '../Guards.js';\n\n/**\n * Expiring map options\n */\nexport type Opts = {\n  /**\n   * Capacity limit\n   */\n  readonly capacity?:number\n  /**\n   * Policy for evicting items if capacity is reached\n   */\n  readonly evictPolicy?:`none`|`oldestGet`|`oldestSet`\n  /**\n   * Automatic deletion policy.\n   * none: no automatic deletion (default)\n   * get/set: interval based on last get/set\n   * either: if either interval has elapsed\n   */\n  readonly autoDeletePolicy?:`none`|`get`|`set`|`either`\n  /**\n   * Automatic deletion interval\n   */\n  readonly autoDeleteElapsedMs?:number;\n}\n\ntype Item<V> = {\n  readonly value:V\n  readonly lastSet:number\n  readonly lastGet:number\n}\n\n/**\n * Event from the ExpiringMap\n */\nexport type ExpiringMapEvent<K, V> = {\n  readonly key:K\n  readonly value:V\n}\n\nexport type ExpiringMapEvents<K, V> = {\n  /**\n   * Fires when an item is removed due to eviction\n   * or automatic expiry\n   */\n  readonly expired:ExpiringMapEvent<K, V>\n  /**\n   * Fires when a item with a new key is added\n   */\n  readonly newKey:ExpiringMapEvent<K, V>\n\n  /**\n   * Fires when an item is manually removed,\n   * removed due to eviction or automatic expiry\n   */\n  readonly removed:ExpiringMapEvent<K, V>\n}\n\n/**\n * Create a ExpiringMap instance\n * @param opts \n * @returns \n */\nexport const create = <K, V>(opts:Opts = {}):ExpiringMap<K, V> => new ExpiringMap(opts);\n/***\n * A map that can have a capacity limit. The elapsed time for each get/set\n * operation is maintained allowing for items to be automatically removed.\n * `has()` does not affect the last access time.\n * \n * By default, it uses the `none` eviction policy, meaning that when full\n * an error will be thrown if attempting to add new keys.\n * \n * Eviction policies:\n * `oldestGet` removes the item that hasn't been accessed the longest,\n * `oldestSet` removes the item that hasn't been updated the longest.\n * \n * ```js\n * const map = new ExpiringMap();\n * map.set(`fruit`, `apple`);\n * \n * // Remove all entries that were set more than 100ms ago\n * map.deleteWithElapsed(100, `set`);\n * // Remove all entries that were last accessed more than 100ms ago\n * map.deleteWithElapsed(100, `get`);\n * // Returns the elapsed time since `fruit` was last accessed\n * map.elapsedGet(`fruit`); \n * // Returns the elapsed time since `fruit` was last set\n * map.elapsedSet(`fruit`);\n * ```\n * \n * Last set/get time for a key can be manually reset using `touch(key)`.\n * \n * \n * Events:\n * * `expired`: when an item is automatically removed.\n * * `removed`: when an item is manually or automatically removed.\n * * `newKey`: when a new key is added\n * \n * ```js\n * map.addEventListener(`expired`, evt => {\n *  const { key, value } = evt;\n * });\n * ```\n * The map can automatically remove items based on elapsed intervals.\n * \n * @example Automatically delete items that haven't been accessed for one second\n * ```js\n * const map = new ExpiringMap({\n *  autoDeleteElapsed: 1000,\n *  autoDeletePolicy: `get`\n * });\n * ```\n * \n * @example Automatically delete the oldest item if we reach a capacity limit\n * ```\n * const map = new ExpiringMap({\n *  capacity: 5,\n *  evictPolicy: `oldestSet`\n * });\n * ```\n */\nexport class ExpiringMap<K, V> extends SimpleEventEmitter<ExpiringMapEvents<K, V>> {\n  private capacity:number;\n  private store:Map<K, Item<V>>;\n  private keyCount:number;\n  private evictPolicy;\n  \n  private autoDeleteElapsedMs:number;\n  private autoDeletePolicy;\n\n  constructor(opts:Opts = {}) {\n    super();\n    this.capacity = opts.capacity ?? -1;\n\n    guardInteger(this.capacity, `nonZero`, `capacity`);\n    this.store = new Map();\n    this.keyCount = 0;\n\n    if (opts.evictPolicy && this.capacity <= 0) throw new Error(`evictPolicy is set, but no capacity limit is set`);\n\n    this.evictPolicy = opts.evictPolicy ?? `none`;\n    this.autoDeleteElapsedMs = opts.autoDeleteElapsedMs ?? -1;\n    this.autoDeletePolicy = opts.autoDeletePolicy ?? `none`;\n\n    if (this.autoDeleteElapsedMs > 0) {\n      setInterval(() => this.#maintain(), Math.max(1000, this.autoDeleteElapsedMs * 2));\n    }\n  }\n\n  /**\n   * Returns the number of keys being stored.\n   */\n  get keyLength() {\n    return this.keyCount;\n  }\n\n  *entries():IterableIterator<[k:K, v:V]> {\n    for (const entry of this.store.entries()) {\n      yield [entry[0], entry[1].value];\n    }\n  }\n\n  *values():IterableIterator<V> {\n    for (const v of this.store.values()) {\n      yield v.value;\n    }\n  }\n\n  *keys():IterableIterator<K> {\n    yield* this.store.keys();\n  }\n\n  /**\n   * Returns the elapsed time since `key`\n   * was set. Returns _undefined_ if `key`\n   * does not exist\n   */\n  elapsedSet(key:K):number|undefined {\n    const v = this.store.get(key);\n    if (!v) return v;\n    return Date.now() - v.lastSet;\n  }\n \n  /**\n   * Returns the elapsed time since `key`\n   * was accessed. Returns _undefined_ if `key`\n   * does not exist\n   */\n  elapsedGet(key:K):number|undefined {\n    const v = this.store.get(key);\n    if (!v) return v;\n    return Date.now() - v.lastGet;\n  }\n  \n  /**\n   * Returns true if `key` is stored.\n   * Does not affect the key's last access time.\n   * @param key \n   * @returns \n   */\n  has(key:K):boolean {\n    return this.store.has(key);\n  }\n\n  /**\n   * Gets an item from the map by key, returning\n   * undefined if not present\n   * @param key Key\n   * @returns Value, or undefined\n   */\n  get(key:K):V|undefined {\n    const v = this.store.get(key);\n    if (v) {\n      return v.value;\n    }\n  }\n\n  /**\n   * Deletes the value under `key`, if present.\n   * \n   * Returns _true_ if something was removed.\n   * @param key \n   * @returns \n   */\n  delete(key:K):boolean {\n    const val = this.store.get(key);\n    if (!val) return false;\n    const d = this.store.delete(key);\n    this.keyCount = this.keyCount - 1;\n    this.fireEvent(`removed`, {\n      key,\n      value: val.value\n    });\n    return d;\n  }\n\n  /**\n   * Updates the lastSet/lastGet time for a value\n   * under `k`.\n   * \n   * Returns false if key was not found\n   * @param key \n   * @returns \n   */\n  touch(key:K):boolean {\n    const v = this.store.get(key);\n    if (!v) return false;\n    this.store.set(key, {\n      ...v,\n      lastSet: Date.now(),\n      lastGet: Date.now()\n    });\n    return true;\n  }\n\n  private findEvicteeKey() {\n    if (this.evictPolicy === `none`) return null;\n    //eslint-disable-next-line functional/no-let\n    let sortBy = ``;\n    if (this.evictPolicy === `oldestGet`) sortBy = `lastGet`;\n    else if (this.evictPolicy === `oldestSet`) sortBy = `lastSet`;\n    else throw Error(`Unknown eviction policy ${this.evictPolicy}`);\n    const sorted = sortByValueProperty(this.store, sortBy);\n    return sorted[0][0];\n  }\n\n  #maintain() {\n    if (this.autoDeletePolicy === `none`) return;\n    this.deleteWithElapsed(this.autoDeleteElapsedMs, this.autoDeletePolicy);\n  }\n\n  /**\n   * Deletes all values where elapsed time has past\n   * for get/set or either.\n   * \n   * Remove items are returned\n   * @param time \n   * @param prop get/set/either\n   */\n  deleteWithElapsed(time:number, prop:`get`|`set`|`either`):[k:K, v:V][] {\n    const entries = [...this.store.entries()];\n    const prune:[k:K, v:V][] = [];\n    const now = Date.now();\n    for (const e of entries) {\n      const elapsedGet = now - e[1].lastGet;\n      const elapsedSet = now - e[1].lastSet;\n      const elapsed = prop === `get` ? elapsedGet :\n        prop === `set` ? elapsedSet : Math.max(elapsedGet, elapsedSet);\n      if (elapsed >= time) {\n        prune.push([e[0], e[1].value]);\n      }\n    }\n\n    for (const e of prune) {\n      this.store.delete(e[0]);\n      this.keyCount = this.keyCount - 1;\n      const eventArgs = {\n        key: e[0],\n        value: e[1]\n      };\n      this.fireEvent(`expired`, eventArgs);\n      this.fireEvent(`removed`, eventArgs);\n    }\n    return prune;\n  }\n\n  /**\n   * Sets the `key` to be `value`.\n   * \n   * If the key already exists, it is updated.\n   * \n   * If the map is full, according to its capacity,\n   * another value is selected for removal.\n   * @param key \n   * @param value \n   * @returns \n   */\n  set(key:K, value:V) {\n    const existing = this.store.get(key);\n\n    if (existing) {\n      // Update set time\n      this.store.set(key, {\n        ...existing,\n        lastSet: performance.now()\n      });\n      return;\n    }\n    \n    // New key\n    if (this.keyCount === this.capacity && this.capacity > 0) {\n      // Evict first\n      const key = this.findEvicteeKey();\n      if (!key) throw new Error(`ExpiringMap full (capacity: ${this.capacity})`);\n      const existing = this.store.get(key);\n      this.store.delete(key);\n      this.keyCount = this.keyCount - 1;\n      if (existing) {\n        const eventArgs = { key, value:existing.value }; \n        this.fireEvent(`expired`, eventArgs);\n        this.fireEvent(`removed`, eventArgs);\n      }\n      \n    }\n\n    this.keyCount++;\n    this.store.set(key, {\n      lastGet: 0,\n      lastSet: Date.now(),\n      value: value\n    });\n\n    this.fireEvent(`newKey`, { key, value });\n  }\n\n}","/* eslint-disable */\nimport * as d3Colour from 'd3-color';\nimport * as d3Interpolate from 'd3-interpolate';\nimport {defaultRandom, RandomSource} from '../Random.js';\nimport {number as guardNumber} from '../Guards.js'\n\nexport type Hsl = {h:number, s:number, l:number, opacity?:number};\nexport type Rgb = {r:number, g:number, b:number, opacity?:number}\nexport type Spaces = `hsl` | `rgb` | `lab` | `hcl` | `cubehelix`;\n/**\n * @private\n */\nexport type Colour = d3Colour.RGBColor | d3Colour.HSLColor;\n\n/**\n * A representation of colour. Eg: `blue`, `rgb(255,0,0)`, `hsl(20,100%,50%)`\n */\nexport type Colourish = string|d3Colour.ColorCommonInstance;\n\n/**\n * Options for interpolation\n */\nexport type InterpolationOpts = {\n  /**\n   * Gamma correction. Eg 4 brightens values. Only applies to rgb and cubehelix\n   * [Read more](https://github.com/d3/d3-interpolate#interpolate_gamma)\n   */\n  gamma?:number\n  /**\n   * Colour space\n   */\n  space?:Spaces\n  /**\n   * If true, interpolation happens the longer distance. Only applies to hsl, hcl and cubehelix\n   */\n  long?:boolean\n}\n\n/**\n * Parses colour to `{ h, s, l }`. `opacity` field is added if it exists on source.\n * @param colour \n * @returns \n */\nexport const toHsl = (colour:Colourish):Hsl => {\n  const rgb = toRgb(colour);\n  const hsl = rgbToHsl(rgb.r, rgb.b, rgb.g);\n  if (rgb.opacity) return {...hsl, opacity: rgb.opacity};\n  else return hsl;\n}\n\n\n/**\n * Returns a full HSL colour string (eg `hsl(20,50%,75%)`) based on a index.\n * It's useful for generating perceptually different shades as the index increments.\n * \n * ```\n * el.style.backgroundColor = goldenAgeColour(10);\n * ```\n * \n * Saturation and lightness can be specified, as numeric ranges of 0-1.\n * \n * @param saturation Saturation (0-1), defaults to 0.5\n * @param lightness Lightness (0-1), defaults to 0.75\n * @param alpha Opacity (0-1), defaults to 1.0\n * @returns HSL colour string eg `hsl(20,50%,75%)`\n */\nexport const goldenAngleColour = (index: number, saturation = 0.5, lightness = 0.75, alpha = 1.0) => {\n  guardNumber(index, `positive`, `index`);\n  guardNumber(saturation, `percentage`, `saturation`);\n  guardNumber(lightness, `percentage`, `lightness`);\n  guardNumber(alpha, `percentage`, `alpha`);\n\n  // Via Stackoverflow\n  const hue = index * 137.508; // use golden angle approximation\n  if (alpha === 1) return `hsl(${hue},${saturation*100}%,${lightness*100}%)`;\n  else  `hsl(${hue},${saturation*100}%,${lightness*100}%,${alpha*100}%)`\n}\n\n/**\n * Returns a random hue component\n * ```\n * // Generate hue\n * const h =randomHue(); // 0-359\n * \n * // Generate hue and assign as part of a HSL string\n * el.style.backgroundColor = `hsl(${randomHue(), 50%, 75%})`;\n * ```\n * @param rand \n * @returns \n */\nexport const randomHue = (rand:RandomSource = defaultRandom): number => {\n  const r = rand();\n  return r * 360;\n};\n\n/**\n * Parses colour to `{ r, g, b }`. `opacity` field is added if it exists on source.\n * [Named colours](https://html-color-codes.info/color-names/)\n * @param colour \n * @returns \n */\nexport const toRgb = (colour:Colourish):Rgb => {\n  const c = resolveColour(colour);\n  const rgb = c.rgb();\n  if (c.opacity < 1) return {r:rgb.r, g:rgb.g, b:rgb.b, opacity: c.opacity};\n  else return {r:rgb.r, g:rgb.g, b:rgb.b}\n}\n\nconst resolveColour = (c:Colourish):Colour => {\n  if (typeof c === `string`) {\n    const css = d3Colour.color(c);\n    if (css !== null) return css;\n  } else {\n    if (isHsl(c)) return d3Colour.hsl(c.h, c.s, c.l);\n    if (isRgb(c)) return d3Colour.rgb(c.r, c.g, c.b); \n  }\n  throw new Error(`Could not resolve colour ${JSON.stringify(c)}`);\n}\n\n/**\n * Returns a colour in hex format `#000000`\n * @param colour\n * @returns Hex format, including #\n */\nexport const toHex = (colour:Colourish):string => {\n  const c = resolveColour(colour);\n  return c.formatHex();\n}\n\n/**\n * Returns a variation of colour with its opacity multiplied by `amt`.\n * \n * ```js\n * // Return a colour string for blue that is 50% opaque\n * opacity(`blue`, 0.5);\n * // eg: `rgba(0,0,255,0.5)`\n * \n * // Returns a colour string that is 50% more opaque\n * opacity(`hsla(200,100%,50%,50%`, 0.5);\n * // eg: `hsla(200,100%,50%,25%)` \n * ```\n * \n * [Named colours](https://html-color-codes.info/color-names/)\n * @param colour A valid CSS colour\n * @param amt Amount to multiply opacity by\n * @returns String representation of colour\n */\nexport const opacity = (colour:Colourish, amt:number):string => {\n  const c = resolveColour(colour);\n  c.opacity *= amt;\n  return c.toString(); \n}\n\n/**\n * Gets a CSS variable.\n * @example Fetch --accent variable, or use `yellow` if not found.\n * ```\n * getCssVariable(`accent`, `yellow`);\n * ```\n * @param name Name of variable. Omit the `--`\n * @param fallbackColour Fallback colour if not found\n * @param root  Element to search variable from\n * @returns Colour or fallback.\n */\n export const getCssVariable = (name:string, fallbackColour:string = `black`, root?:HTMLElement):string => {\n  if (root === undefined) root = document.body;\n  const fromCss = getComputedStyle(root).getPropertyValue(`--${name}`).trim();\n  if (fromCss === undefined || fromCss.length === 0) return fallbackColour;\n  return fromCss;\n};\n\n/**\n * Interpolates between two colours, returning a string in the form `rgb(r,g,b)`\n * \n * @example\n * ```js\n * // Get 50% between blue and red\n * interpolate(0.5, `blue`, `red`); \n * \n * // Get midway point, with specified colour space\n * interpolate(0.5, `hsl(200, 100%, 50%)`, `pink`, {space: `hcl`});\n * ```\n * \n * [Named colours](https://html-color-codes.info/color-names/)\n * @param amount Amount (0 = from, 0.5 halfway, 1= to)\n * @param from Starting colour\n * @param to Final colour\n * @param optsOrSpace Options for interpolation, or string name for colour space, eg `hsl`.\n * @returns String representation of colour, eg. `rgb(r,g,b)`\n */\nexport const interpolate = (amount:number, from:Colourish, to:Colourish, optsOrSpace?:string|InterpolationOpts):string => {\n  guardNumber(amount, `percentage`, `amount`);\n  if (typeof from !== `string`) throw new Error(`Expected string for 'from' param`);\n  if (typeof to !== `string`) throw new Error(`Expected string for 'to' param`);\n\n  let opts:InterpolationOpts;\n  if (typeof optsOrSpace === `undefined`) opts = {};\n  else if (typeof optsOrSpace === `string`) opts = { space: optsOrSpace as Spaces};\n  else opts = optsOrSpace as InterpolationOpts;\n\n\n  const inter = getInterpolator(opts, [from, to]);\n  if (inter === undefined) throw new Error(`Could not handle colour/space`);\n  return inter(amount);\n}\n\nconst getInterpolator = (optsOrSpace:InterpolationOpts|string, colours:Colourish[]): ((t: number) => string) | undefined => {\n  if (!Array.isArray(colours)) throw new Error(`Expected one or more colours as parameters`);\n  \n  let opts:InterpolationOpts;\n  if (typeof optsOrSpace === `undefined`) opts = {};\n  else if (typeof optsOrSpace === `string`) opts = { space: optsOrSpace as Spaces};\n  else opts = optsOrSpace as InterpolationOpts;\n\n  if (!Array.isArray(colours)) throw new Error(`Expected array for colours parameter`);\n  if (colours.length < 2) throw new Error(`Interpolation expects at least two colours`);\n  const {space = `rgb`, long = false} = opts;\n  let inter;\n\n  switch (space) {\n  case `lab`:\n    inter = d3Interpolate.interpolateLab;\n    break;\n  case `hsl`:\n    inter = long ? d3Interpolate.interpolateHslLong : d3Interpolate.interpolateHsl;\n    break;\n  case `hcl`:\n    inter = long ? d3Interpolate.interpolateHclLong : d3Interpolate.interpolateHcl;\n    break;\n  case `cubehelix`:\n    inter = long ? d3Interpolate.interpolateCubehelixLong : d3Interpolate.interpolateCubehelix;\n    break;\n  case `rgb`:\n    inter = d3Interpolate.interpolateRgb;\n  default:\n    inter = d3Interpolate.interpolateRgb;\n  }\n\n  if (opts.gamma) {\n    if (space === `rgb` || space === `cubehelix`) {\n      inter = (inter as d3Interpolate.ColorGammaInterpolationFactory).gamma(opts.gamma);      \n    }\n  }\n\n  if (colours.length > 2) {\n    return d3Interpolate.piecewise(inter, colours);\n  } else return inter(colours[0], colours[1]);\n}\n\n/**\n * Produces a scale of colours as a string array\n * \n * @example\n * ```js\n * // Yields array of 5 colour strings\n * const s = scale(5, {space:`hcl`}, `blue`, `red`);\n * // Produces scale between three colours\n * const s = scale(5, {space:`hcl`}, `blue`, `yellow`, `red`);\n * ```\n * @param steps Number of colours\n * @param opts Options for interpolation, or string colour space eg `hsl`\n * @param colours From/end colours (or more)\n * @returns \n */\nexport const scale = (steps:number, opts:InterpolationOpts|string, ...colours:Colourish[]):string[] => {\n  guardNumber(steps, `aboveZero`, `steps`);\n  if (!Array.isArray(colours)) throw new Error(`Expected one or more colours as parameters`);\n  const inter = getInterpolator(opts, colours);\n  if (inter === undefined) throw new Error(`Could not handle colour/space`);\n\n  const perStep = 1/(steps-1);\n  const r = [];\n  //eslint-disable-next-line functional/no-let\n  let amt = 0;\n  //eslint-disable-next-line functional/no-let\n  for (let i=0; i<steps; i++) {\n    //eslint-disable-next-line functional/immutable-data\n    r.push(inter(amt));\n    amt += perStep;\n    if (amt > 1) amt = 1;\n  }\n  return r;\n}\n\nconst isHsl = (p: Colour|d3Colour.ColorCommonInstance|Hsl): p is Hsl => {\n  if ((p as Hsl).h === undefined) return false;\n  if ((p as Hsl).s === undefined) return false;\n  if ((p as Hsl).l === undefined) return false;\n  return true;\n};\n\nconst isRgb = (p: Colour|d3Colour.ColorCommonInstance|Rgb): p is Rgb => {\n  if ((p as Rgb).r === undefined) return false;\n  if ((p as Rgb).g === undefined) return false;\n  if ((p as Rgb).b === undefined) return false;\n  return true;\n};\n\nconst rgbToHsl = (r:number, g:number, b:number):Hsl => {\n  r /= 255;\n  g /= 255;\n  b /= 255;\n\n  var min = Math.min(r, g, b),\n    max = Math.max(r, g, b),\n    delta = max - min,\n    h, s, l;\n\n  h = 0;\n  if (max === min) {\n    h = 0;\n  }\n  else if (r === max) {\n    h = (g - b) / delta;\n  }\n  else if (g === max) {\n    h = 2 + (b - r) / delta;\n  }\n  else if (b === max) {\n    h = 4 + (r - g) / delta;\n  }\n\n  h = Math.min(h * 60, 360);\n\n  if (h < 0) {\n    h += 360;\n  }\n\n  l = (min + max) / 2;\n\n  if (max === min) {\n    s = 0;\n  }\n  else if (l <= 0.5) {\n    s = delta / (max + min);\n  }\n  else {\n    s = delta / (2 - max - min);\n  }\n\n  return {h, s, l};\n};\n","export default function(constructor, factory, prototype) {\n  constructor.prototype = factory.prototype = prototype;\n  prototype.constructor = constructor;\n}\n\nexport function extend(parent, definition) {\n  var prototype = Object.create(parent.prototype);\n  for (var key in definition) prototype[key] = definition[key];\n  return prototype;\n}\n","import define, {extend} from \"./define.js\";\n\nexport function Color() {}\n\nexport var darker = 0.7;\nexport var brighter = 1 / darker;\n\nvar reI = \"\\\\s*([+-]?\\\\d+)\\\\s*\",\n    reN = \"\\\\s*([+-]?(?:\\\\d*\\\\.)?\\\\d+(?:[eE][+-]?\\\\d+)?)\\\\s*\",\n    reP = \"\\\\s*([+-]?(?:\\\\d*\\\\.)?\\\\d+(?:[eE][+-]?\\\\d+)?)%\\\\s*\",\n    reHex = /^#([0-9a-f]{3,8})$/,\n    reRgbInteger = new RegExp(`^rgb\\\\(${reI},${reI},${reI}\\\\)$`),\n    reRgbPercent = new RegExp(`^rgb\\\\(${reP},${reP},${reP}\\\\)$`),\n    reRgbaInteger = new RegExp(`^rgba\\\\(${reI},${reI},${reI},${reN}\\\\)$`),\n    reRgbaPercent = new RegExp(`^rgba\\\\(${reP},${reP},${reP},${reN}\\\\)$`),\n    reHslPercent = new RegExp(`^hsl\\\\(${reN},${reP},${reP}\\\\)$`),\n    reHslaPercent = new RegExp(`^hsla\\\\(${reN},${reP},${reP},${reN}\\\\)$`);\n\nvar named = {\n  aliceblue: 0xf0f8ff,\n  antiquewhite: 0xfaebd7,\n  aqua: 0x00ffff,\n  aquamarine: 0x7fffd4,\n  azure: 0xf0ffff,\n  beige: 0xf5f5dc,\n  bisque: 0xffe4c4,\n  black: 0x000000,\n  blanchedalmond: 0xffebcd,\n  blue: 0x0000ff,\n  blueviolet: 0x8a2be2,\n  brown: 0xa52a2a,\n  burlywood: 0xdeb887,\n  cadetblue: 0x5f9ea0,\n  chartreuse: 0x7fff00,\n  chocolate: 0xd2691e,\n  coral: 0xff7f50,\n  cornflowerblue: 0x6495ed,\n  cornsilk: 0xfff8dc,\n  crimson: 0xdc143c,\n  cyan: 0x00ffff,\n  darkblue: 0x00008b,\n  darkcyan: 0x008b8b,\n  darkgoldenrod: 0xb8860b,\n  darkgray: 0xa9a9a9,\n  darkgreen: 0x006400,\n  darkgrey: 0xa9a9a9,\n  darkkhaki: 0xbdb76b,\n  darkmagenta: 0x8b008b,\n  darkolivegreen: 0x556b2f,\n  darkorange: 0xff8c00,\n  darkorchid: 0x9932cc,\n  darkred: 0x8b0000,\n  darksalmon: 0xe9967a,\n  darkseagreen: 0x8fbc8f,\n  darkslateblue: 0x483d8b,\n  darkslategray: 0x2f4f4f,\n  darkslategrey: 0x2f4f4f,\n  darkturquoise: 0x00ced1,\n  darkviolet: 0x9400d3,\n  deeppink: 0xff1493,\n  deepskyblue: 0x00bfff,\n  dimgray: 0x696969,\n  dimgrey: 0x696969,\n  dodgerblue: 0x1e90ff,\n  firebrick: 0xb22222,\n  floralwhite: 0xfffaf0,\n  forestgreen: 0x228b22,\n  fuchsia: 0xff00ff,\n  gainsboro: 0xdcdcdc,\n  ghostwhite: 0xf8f8ff,\n  gold: 0xffd700,\n  goldenrod: 0xdaa520,\n  gray: 0x808080,\n  green: 0x008000,\n  greenyellow: 0xadff2f,\n  grey: 0x808080,\n  honeydew: 0xf0fff0,\n  hotpink: 0xff69b4,\n  indianred: 0xcd5c5c,\n  indigo: 0x4b0082,\n  ivory: 0xfffff0,\n  khaki: 0xf0e68c,\n  lavender: 0xe6e6fa,\n  lavenderblush: 0xfff0f5,\n  lawngreen: 0x7cfc00,\n  lemonchiffon: 0xfffacd,\n  lightblue: 0xadd8e6,\n  lightcoral: 0xf08080,\n  lightcyan: 0xe0ffff,\n  lightgoldenrodyellow: 0xfafad2,\n  lightgray: 0xd3d3d3,\n  lightgreen: 0x90ee90,\n  lightgrey: 0xd3d3d3,\n  lightpink: 0xffb6c1,\n  lightsalmon: 0xffa07a,\n  lightseagreen: 0x20b2aa,\n  lightskyblue: 0x87cefa,\n  lightslategray: 0x778899,\n  lightslategrey: 0x778899,\n  lightsteelblue: 0xb0c4de,\n  lightyellow: 0xffffe0,\n  lime: 0x00ff00,\n  limegreen: 0x32cd32,\n  linen: 0xfaf0e6,\n  magenta: 0xff00ff,\n  maroon: 0x800000,\n  mediumaquamarine: 0x66cdaa,\n  mediumblue: 0x0000cd,\n  mediumorchid: 0xba55d3,\n  mediumpurple: 0x9370db,\n  mediumseagreen: 0x3cb371,\n  mediumslateblue: 0x7b68ee,\n  mediumspringgreen: 0x00fa9a,\n  mediumturquoise: 0x48d1cc,\n  mediumvioletred: 0xc71585,\n  midnightblue: 0x191970,\n  mintcream: 0xf5fffa,\n  mistyrose: 0xffe4e1,\n  moccasin: 0xffe4b5,\n  navajowhite: 0xffdead,\n  navy: 0x000080,\n  oldlace: 0xfdf5e6,\n  olive: 0x808000,\n  olivedrab: 0x6b8e23,\n  orange: 0xffa500,\n  orangered: 0xff4500,\n  orchid: 0xda70d6,\n  palegoldenrod: 0xeee8aa,\n  palegreen: 0x98fb98,\n  paleturquoise: 0xafeeee,\n  palevioletred: 0xdb7093,\n  papayawhip: 0xffefd5,\n  peachpuff: 0xffdab9,\n  peru: 0xcd853f,\n  pink: 0xffc0cb,\n  plum: 0xdda0dd,\n  powderblue: 0xb0e0e6,\n  purple: 0x800080,\n  rebeccapurple: 0x663399,\n  red: 0xff0000,\n  rosybrown: 0xbc8f8f,\n  royalblue: 0x4169e1,\n  saddlebrown: 0x8b4513,\n  salmon: 0xfa8072,\n  sandybrown: 0xf4a460,\n  seagreen: 0x2e8b57,\n  seashell: 0xfff5ee,\n  sienna: 0xa0522d,\n  silver: 0xc0c0c0,\n  skyblue: 0x87ceeb,\n  slateblue: 0x6a5acd,\n  slategray: 0x708090,\n  slategrey: 0x708090,\n  snow: 0xfffafa,\n  springgreen: 0x00ff7f,\n  steelblue: 0x4682b4,\n  tan: 0xd2b48c,\n  teal: 0x008080,\n  thistle: 0xd8bfd8,\n  tomato: 0xff6347,\n  turquoise: 0x40e0d0,\n  violet: 0xee82ee,\n  wheat: 0xf5deb3,\n  white: 0xffffff,\n  whitesmoke: 0xf5f5f5,\n  yellow: 0xffff00,\n  yellowgreen: 0x9acd32\n};\n\ndefine(Color, color, {\n  copy(channels) {\n    return Object.assign(new this.constructor, this, channels);\n  },\n  displayable() {\n    return this.rgb().displayable();\n  },\n  hex: color_formatHex, // Deprecated! Use color.formatHex.\n  formatHex: color_formatHex,\n  formatHex8: color_formatHex8,\n  formatHsl: color_formatHsl,\n  formatRgb: color_formatRgb,\n  toString: color_formatRgb\n});\n\nfunction color_formatHex() {\n  return this.rgb().formatHex();\n}\n\nfunction color_formatHex8() {\n  return this.rgb().formatHex8();\n}\n\nfunction color_formatHsl() {\n  return hslConvert(this).formatHsl();\n}\n\nfunction color_formatRgb() {\n  return this.rgb().formatRgb();\n}\n\nexport default function color(format) {\n  var m, l;\n  format = (format + \"\").trim().toLowerCase();\n  return (m = reHex.exec(format)) ? (l = m[1].length, m = parseInt(m[1], 16), l === 6 ? rgbn(m) // #ff0000\n      : l === 3 ? new Rgb((m >> 8 & 0xf) | (m >> 4 & 0xf0), (m >> 4 & 0xf) | (m & 0xf0), ((m & 0xf) << 4) | (m & 0xf), 1) // #f00\n      : l === 8 ? rgba(m >> 24 & 0xff, m >> 16 & 0xff, m >> 8 & 0xff, (m & 0xff) / 0xff) // #ff000000\n      : l === 4 ? rgba((m >> 12 & 0xf) | (m >> 8 & 0xf0), (m >> 8 & 0xf) | (m >> 4 & 0xf0), (m >> 4 & 0xf) | (m & 0xf0), (((m & 0xf) << 4) | (m & 0xf)) / 0xff) // #f000\n      : null) // invalid hex\n      : (m = reRgbInteger.exec(format)) ? new Rgb(m[1], m[2], m[3], 1) // rgb(255, 0, 0)\n      : (m = reRgbPercent.exec(format)) ? new Rgb(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, 1) // rgb(100%, 0%, 0%)\n      : (m = reRgbaInteger.exec(format)) ? rgba(m[1], m[2], m[3], m[4]) // rgba(255, 0, 0, 1)\n      : (m = reRgbaPercent.exec(format)) ? rgba(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, m[4]) // rgb(100%, 0%, 0%, 1)\n      : (m = reHslPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, 1) // hsl(120, 50%, 50%)\n      : (m = reHslaPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, m[4]) // hsla(120, 50%, 50%, 1)\n      : named.hasOwnProperty(format) ? rgbn(named[format]) // eslint-disable-line no-prototype-builtins\n      : format === \"transparent\" ? new Rgb(NaN, NaN, NaN, 0)\n      : null;\n}\n\nfunction rgbn(n) {\n  return new Rgb(n >> 16 & 0xff, n >> 8 & 0xff, n & 0xff, 1);\n}\n\nfunction rgba(r, g, b, a) {\n  if (a <= 0) r = g = b = NaN;\n  return new Rgb(r, g, b, a);\n}\n\nexport function rgbConvert(o) {\n  if (!(o instanceof Color)) o = color(o);\n  if (!o) return new Rgb;\n  o = o.rgb();\n  return new Rgb(o.r, o.g, o.b, o.opacity);\n}\n\nexport function rgb(r, g, b, opacity) {\n  return arguments.length === 1 ? rgbConvert(r) : new Rgb(r, g, b, opacity == null ? 1 : opacity);\n}\n\nexport function Rgb(r, g, b, opacity) {\n  this.r = +r;\n  this.g = +g;\n  this.b = +b;\n  this.opacity = +opacity;\n}\n\ndefine(Rgb, rgb, extend(Color, {\n  brighter(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);\n  },\n  darker(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);\n  },\n  rgb() {\n    return this;\n  },\n  clamp() {\n    return new Rgb(clampi(this.r), clampi(this.g), clampi(this.b), clampa(this.opacity));\n  },\n  displayable() {\n    return (-0.5 <= this.r && this.r < 255.5)\n        && (-0.5 <= this.g && this.g < 255.5)\n        && (-0.5 <= this.b && this.b < 255.5)\n        && (0 <= this.opacity && this.opacity <= 1);\n  },\n  hex: rgb_formatHex, // Deprecated! Use color.formatHex.\n  formatHex: rgb_formatHex,\n  formatHex8: rgb_formatHex8,\n  formatRgb: rgb_formatRgb,\n  toString: rgb_formatRgb\n}));\n\nfunction rgb_formatHex() {\n  return `#${hex(this.r)}${hex(this.g)}${hex(this.b)}`;\n}\n\nfunction rgb_formatHex8() {\n  return `#${hex(this.r)}${hex(this.g)}${hex(this.b)}${hex((isNaN(this.opacity) ? 1 : this.opacity) * 255)}`;\n}\n\nfunction rgb_formatRgb() {\n  const a = clampa(this.opacity);\n  return `${a === 1 ? \"rgb(\" : \"rgba(\"}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${a === 1 ? \")\" : `, ${a})`}`;\n}\n\nfunction clampa(opacity) {\n  return isNaN(opacity) ? 1 : Math.max(0, Math.min(1, opacity));\n}\n\nfunction clampi(value) {\n  return Math.max(0, Math.min(255, Math.round(value) || 0));\n}\n\nfunction hex(value) {\n  value = clampi(value);\n  return (value < 16 ? \"0\" : \"\") + value.toString(16);\n}\n\nfunction hsla(h, s, l, a) {\n  if (a <= 0) h = s = l = NaN;\n  else if (l <= 0 || l >= 1) h = s = NaN;\n  else if (s <= 0) h = NaN;\n  return new Hsl(h, s, l, a);\n}\n\nexport function hslConvert(o) {\n  if (o instanceof Hsl) return new Hsl(o.h, o.s, o.l, o.opacity);\n  if (!(o instanceof Color)) o = color(o);\n  if (!o) return new Hsl;\n  if (o instanceof Hsl) return o;\n  o = o.rgb();\n  var r = o.r / 255,\n      g = o.g / 255,\n      b = o.b / 255,\n      min = Math.min(r, g, b),\n      max = Math.max(r, g, b),\n      h = NaN,\n      s = max - min,\n      l = (max + min) / 2;\n  if (s) {\n    if (r === max) h = (g - b) / s + (g < b) * 6;\n    else if (g === max) h = (b - r) / s + 2;\n    else h = (r - g) / s + 4;\n    s /= l < 0.5 ? max + min : 2 - max - min;\n    h *= 60;\n  } else {\n    s = l > 0 && l < 1 ? 0 : h;\n  }\n  return new Hsl(h, s, l, o.opacity);\n}\n\nexport function hsl(h, s, l, opacity) {\n  return arguments.length === 1 ? hslConvert(h) : new Hsl(h, s, l, opacity == null ? 1 : opacity);\n}\n\nfunction Hsl(h, s, l, opacity) {\n  this.h = +h;\n  this.s = +s;\n  this.l = +l;\n  this.opacity = +opacity;\n}\n\ndefine(Hsl, hsl, extend(Color, {\n  brighter(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Hsl(this.h, this.s, this.l * k, this.opacity);\n  },\n  darker(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Hsl(this.h, this.s, this.l * k, this.opacity);\n  },\n  rgb() {\n    var h = this.h % 360 + (this.h < 0) * 360,\n        s = isNaN(h) || isNaN(this.s) ? 0 : this.s,\n        l = this.l,\n        m2 = l + (l < 0.5 ? l : 1 - l) * s,\n        m1 = 2 * l - m2;\n    return new Rgb(\n      hsl2rgb(h >= 240 ? h - 240 : h + 120, m1, m2),\n      hsl2rgb(h, m1, m2),\n      hsl2rgb(h < 120 ? h + 240 : h - 120, m1, m2),\n      this.opacity\n    );\n  },\n  clamp() {\n    return new Hsl(clamph(this.h), clampt(this.s), clampt(this.l), clampa(this.opacity));\n  },\n  displayable() {\n    return (0 <= this.s && this.s <= 1 || isNaN(this.s))\n        && (0 <= this.l && this.l <= 1)\n        && (0 <= this.opacity && this.opacity <= 1);\n  },\n  formatHsl() {\n    const a = clampa(this.opacity);\n    return `${a === 1 ? \"hsl(\" : \"hsla(\"}${clamph(this.h)}, ${clampt(this.s) * 100}%, ${clampt(this.l) * 100}%${a === 1 ? \")\" : `, ${a})`}`;\n  }\n}));\n\nfunction clamph(value) {\n  value = (value || 0) % 360;\n  return value < 0 ? value + 360 : value;\n}\n\nfunction clampt(value) {\n  return Math.max(0, Math.min(1, value || 0));\n}\n\n/* From FvD 13.37, CSS Color Module Level 3 */\nfunction hsl2rgb(h, m1, m2) {\n  return (h < 60 ? m1 + (m2 - m1) * h / 60\n      : h < 180 ? m2\n      : h < 240 ? m1 + (m2 - m1) * (240 - h) / 60\n      : m1) * 255;\n}\n","export const radians = Math.PI / 180;\nexport const degrees = 180 / Math.PI;\n","import define, {extend} from \"./define.js\";\nimport {Color, rgbConvert, Rgb} from \"./color.js\";\nimport {degrees, radians} from \"./math.js\";\n\n// https://observablehq.com/@mbostock/lab-and-rgb\nconst K = 18,\n    Xn = 0.96422,\n    Yn = 1,\n    Zn = 0.82521,\n    t0 = 4 / 29,\n    t1 = 6 / 29,\n    t2 = 3 * t1 * t1,\n    t3 = t1 * t1 * t1;\n\nfunction labConvert(o) {\n  if (o instanceof Lab) return new Lab(o.l, o.a, o.b, o.opacity);\n  if (o instanceof Hcl) return hcl2lab(o);\n  if (!(o instanceof Rgb)) o = rgbConvert(o);\n  var r = rgb2lrgb(o.r),\n      g = rgb2lrgb(o.g),\n      b = rgb2lrgb(o.b),\n      y = xyz2lab((0.2225045 * r + 0.7168786 * g + 0.0606169 * b) / Yn), x, z;\n  if (r === g && g === b) x = z = y; else {\n    x = xyz2lab((0.4360747 * r + 0.3850649 * g + 0.1430804 * b) / Xn);\n    z = xyz2lab((0.0139322 * r + 0.0971045 * g + 0.7141733 * b) / Zn);\n  }\n  return new Lab(116 * y - 16, 500 * (x - y), 200 * (y - z), o.opacity);\n}\n\nexport function gray(l, opacity) {\n  return new Lab(l, 0, 0, opacity == null ? 1 : opacity);\n}\n\nexport default function lab(l, a, b, opacity) {\n  return arguments.length === 1 ? labConvert(l) : new Lab(l, a, b, opacity == null ? 1 : opacity);\n}\n\nexport function Lab(l, a, b, opacity) {\n  this.l = +l;\n  this.a = +a;\n  this.b = +b;\n  this.opacity = +opacity;\n}\n\ndefine(Lab, lab, extend(Color, {\n  brighter(k) {\n    return new Lab(this.l + K * (k == null ? 1 : k), this.a, this.b, this.opacity);\n  },\n  darker(k) {\n    return new Lab(this.l - K * (k == null ? 1 : k), this.a, this.b, this.opacity);\n  },\n  rgb() {\n    var y = (this.l + 16) / 116,\n        x = isNaN(this.a) ? y : y + this.a / 500,\n        z = isNaN(this.b) ? y : y - this.b / 200;\n    x = Xn * lab2xyz(x);\n    y = Yn * lab2xyz(y);\n    z = Zn * lab2xyz(z);\n    return new Rgb(\n      lrgb2rgb( 3.1338561 * x - 1.6168667 * y - 0.4906146 * z),\n      lrgb2rgb(-0.9787684 * x + 1.9161415 * y + 0.0334540 * z),\n      lrgb2rgb( 0.0719453 * x - 0.2289914 * y + 1.4052427 * z),\n      this.opacity\n    );\n  }\n}));\n\nfunction xyz2lab(t) {\n  return t > t3 ? Math.pow(t, 1 / 3) : t / t2 + t0;\n}\n\nfunction lab2xyz(t) {\n  return t > t1 ? t * t * t : t2 * (t - t0);\n}\n\nfunction lrgb2rgb(x) {\n  return 255 * (x <= 0.0031308 ? 12.92 * x : 1.055 * Math.pow(x, 1 / 2.4) - 0.055);\n}\n\nfunction rgb2lrgb(x) {\n  return (x /= 255) <= 0.04045 ? x / 12.92 : Math.pow((x + 0.055) / 1.055, 2.4);\n}\n\nfunction hclConvert(o) {\n  if (o instanceof Hcl) return new Hcl(o.h, o.c, o.l, o.opacity);\n  if (!(o instanceof Lab)) o = labConvert(o);\n  if (o.a === 0 && o.b === 0) return new Hcl(NaN, 0 < o.l && o.l < 100 ? 0 : NaN, o.l, o.opacity);\n  var h = Math.atan2(o.b, o.a) * degrees;\n  return new Hcl(h < 0 ? h + 360 : h, Math.sqrt(o.a * o.a + o.b * o.b), o.l, o.opacity);\n}\n\nexport function lch(l, c, h, opacity) {\n  return arguments.length === 1 ? hclConvert(l) : new Hcl(h, c, l, opacity == null ? 1 : opacity);\n}\n\nexport function hcl(h, c, l, opacity) {\n  return arguments.length === 1 ? hclConvert(h) : new Hcl(h, c, l, opacity == null ? 1 : opacity);\n}\n\nexport function Hcl(h, c, l, opacity) {\n  this.h = +h;\n  this.c = +c;\n  this.l = +l;\n  this.opacity = +opacity;\n}\n\nfunction hcl2lab(o) {\n  if (isNaN(o.h)) return new Lab(o.l, 0, 0, o.opacity);\n  var h = o.h * radians;\n  return new Lab(o.l, Math.cos(h) * o.c, Math.sin(h) * o.c, o.opacity);\n}\n\ndefine(Hcl, hcl, extend(Color, {\n  brighter(k) {\n    return new Hcl(this.h, this.c, this.l + K * (k == null ? 1 : k), this.opacity);\n  },\n  darker(k) {\n    return new Hcl(this.h, this.c, this.l - K * (k == null ? 1 : k), this.opacity);\n  },\n  rgb() {\n    return hcl2lab(this).rgb();\n  }\n}));\n","import define, {extend} from \"./define.js\";\nimport {Color, rgbConvert, Rgb, darker, brighter} from \"./color.js\";\nimport {degrees, radians} from \"./math.js\";\n\nvar A = -0.14861,\n    B = +1.78277,\n    C = -0.29227,\n    D = -0.90649,\n    E = +1.97294,\n    ED = E * D,\n    EB = E * B,\n    BC_DA = B * C - D * A;\n\nfunction cubehelixConvert(o) {\n  if (o instanceof Cubehelix) return new Cubehelix(o.h, o.s, o.l, o.opacity);\n  if (!(o instanceof Rgb)) o = rgbConvert(o);\n  var r = o.r / 255,\n      g = o.g / 255,\n      b = o.b / 255,\n      l = (BC_DA * b + ED * r - EB * g) / (BC_DA + ED - EB),\n      bl = b - l,\n      k = (E * (g - l) - C * bl) / D,\n      s = Math.sqrt(k * k + bl * bl) / (E * l * (1 - l)), // NaN if l=0 or l=1\n      h = s ? Math.atan2(k, bl) * degrees - 120 : NaN;\n  return new Cubehelix(h < 0 ? h + 360 : h, s, l, o.opacity);\n}\n\nexport default function cubehelix(h, s, l, opacity) {\n  return arguments.length === 1 ? cubehelixConvert(h) : new Cubehelix(h, s, l, opacity == null ? 1 : opacity);\n}\n\nexport function Cubehelix(h, s, l, opacity) {\n  this.h = +h;\n  this.s = +s;\n  this.l = +l;\n  this.opacity = +opacity;\n}\n\ndefine(Cubehelix, cubehelix, extend(Color, {\n  brighter(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Cubehelix(this.h, this.s, this.l * k, this.opacity);\n  },\n  darker(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Cubehelix(this.h, this.s, this.l * k, this.opacity);\n  },\n  rgb() {\n    var h = isNaN(this.h) ? 0 : (this.h + 120) * radians,\n        l = +this.l,\n        a = isNaN(this.s) ? 0 : this.s * l * (1 - l),\n        cosh = Math.cos(h),\n        sinh = Math.sin(h);\n    return new Rgb(\n      255 * (l + a * (A * cosh + B * sinh)),\n      255 * (l + a * (C * cosh + D * sinh)),\n      255 * (l + a * (E * cosh)),\n      this.opacity\n    );\n  }\n}));\n","export function basis(t1, v0, v1, v2, v3) {\n  var t2 = t1 * t1, t3 = t2 * t1;\n  return ((1 - 3 * t1 + 3 * t2 - t3) * v0\n      + (4 - 6 * t2 + 3 * t3) * v1\n      + (1 + 3 * t1 + 3 * t2 - 3 * t3) * v2\n      + t3 * v3) / 6;\n}\n\nexport default function(values) {\n  var n = values.length - 1;\n  return function(t) {\n    var i = t <= 0 ? (t = 0) : t >= 1 ? (t = 1, n - 1) : Math.floor(t * n),\n        v1 = values[i],\n        v2 = values[i + 1],\n        v0 = i > 0 ? values[i - 1] : 2 * v1 - v2,\n        v3 = i < n - 1 ? values[i + 2] : 2 * v2 - v1;\n    return basis((t - i / n) * n, v0, v1, v2, v3);\n  };\n}\n","import {basis} from \"./basis.js\";\n\nexport default function(values) {\n  var n = values.length;\n  return function(t) {\n    var i = Math.floor(((t %= 1) < 0 ? ++t : t) * n),\n        v0 = values[(i + n - 1) % n],\n        v1 = values[i % n],\n        v2 = values[(i + 1) % n],\n        v3 = values[(i + 2) % n];\n    return basis((t - i / n) * n, v0, v1, v2, v3);\n  };\n}\n","export default x => () => x;\n","import constant from \"./constant.js\";\n\nfunction linear(a, d) {\n  return function(t) {\n    return a + t * d;\n  };\n}\n\nfunction exponential(a, b, y) {\n  return a = Math.pow(a, y), b = Math.pow(b, y) - a, y = 1 / y, function(t) {\n    return Math.pow(a + t * b, y);\n  };\n}\n\nexport function hue(a, b) {\n  var d = b - a;\n  return d ? linear(a, d > 180 || d < -180 ? d - 360 * Math.round(d / 360) : d) : constant(isNaN(a) ? b : a);\n}\n\nexport function gamma(y) {\n  return (y = +y) === 1 ? nogamma : function(a, b) {\n    return b - a ? exponential(a, b, y) : constant(isNaN(a) ? b : a);\n  };\n}\n\nexport default function nogamma(a, b) {\n  var d = b - a;\n  return d ? linear(a, d) : constant(isNaN(a) ? b : a);\n}\n","import {rgb as colorRgb} from \"d3-color\";\nimport basis from \"./basis.js\";\nimport basisClosed from \"./basisClosed.js\";\nimport nogamma, {gamma} from \"./color.js\";\n\nexport default (function rgbGamma(y) {\n  var color = gamma(y);\n\n  function rgb(start, end) {\n    var r = color((start = colorRgb(start)).r, (end = colorRgb(end)).r),\n        g = color(start.g, end.g),\n        b = color(start.b, end.b),\n        opacity = nogamma(start.opacity, end.opacity);\n    return function(t) {\n      start.r = r(t);\n      start.g = g(t);\n      start.b = b(t);\n      start.opacity = opacity(t);\n      return start + \"\";\n    };\n  }\n\n  rgb.gamma = rgbGamma;\n\n  return rgb;\n})(1);\n\nfunction rgbSpline(spline) {\n  return function(colors) {\n    var n = colors.length,\n        r = new Array(n),\n        g = new Array(n),\n        b = new Array(n),\n        i, color;\n    for (i = 0; i < n; ++i) {\n      color = colorRgb(colors[i]);\n      r[i] = color.r || 0;\n      g[i] = color.g || 0;\n      b[i] = color.b || 0;\n    }\n    r = spline(r);\n    g = spline(g);\n    b = spline(b);\n    color.opacity = 1;\n    return function(t) {\n      color.r = r(t);\n      color.g = g(t);\n      color.b = b(t);\n      return color + \"\";\n    };\n  };\n}\n\nexport var rgbBasis = rgbSpline(basis);\nexport var rgbBasisClosed = rgbSpline(basisClosed);\n","export default function(a, b) {\n  if (!b) b = [];\n  var n = a ? Math.min(b.length, a.length) : 0,\n      c = b.slice(),\n      i;\n  return function(t) {\n    for (i = 0; i < n; ++i) c[i] = a[i] * (1 - t) + b[i] * t;\n    return c;\n  };\n}\n\nexport function isNumberArray(x) {\n  return ArrayBuffer.isView(x) && !(x instanceof DataView);\n}\n","import value from \"./value.js\";\nimport numberArray, {isNumberArray} from \"./numberArray.js\";\n\nexport default function(a, b) {\n  return (isNumberArray(b) ? numberArray : genericArray)(a, b);\n}\n\nexport function genericArray(a, b) {\n  var nb = b ? b.length : 0,\n      na = a ? Math.min(nb, a.length) : 0,\n      x = new Array(na),\n      c = new Array(nb),\n      i;\n\n  for (i = 0; i < na; ++i) x[i] = value(a[i], b[i]);\n  for (; i < nb; ++i) c[i] = b[i];\n\n  return function(t) {\n    for (i = 0; i < na; ++i) c[i] = x[i](t);\n    return c;\n  };\n}\n","export default function(a, b) {\n  var d = new Date;\n  return a = +a, b = +b, function(t) {\n    return d.setTime(a * (1 - t) + b * t), d;\n  };\n}\n","export default function(a, b) {\n  return a = +a, b = +b, function(t) {\n    return a * (1 - t) + b * t;\n  };\n}\n","import value from \"./value.js\";\n\nexport default function(a, b) {\n  var i = {},\n      c = {},\n      k;\n\n  if (a === null || typeof a !== \"object\") a = {};\n  if (b === null || typeof b !== \"object\") b = {};\n\n  for (k in b) {\n    if (k in a) {\n      i[k] = value(a[k], b[k]);\n    } else {\n      c[k] = b[k];\n    }\n  }\n\n  return function(t) {\n    for (k in i) c[k] = i[k](t);\n    return c;\n  };\n}\n","import number from \"./number.js\";\n\nvar reA = /[-+]?(?:\\d+\\.?\\d*|\\.?\\d+)(?:[eE][-+]?\\d+)?/g,\n    reB = new RegExp(reA.source, \"g\");\n\nfunction zero(b) {\n  return function() {\n    return b;\n  };\n}\n\nfunction one(b) {\n  return function(t) {\n    return b(t) + \"\";\n  };\n}\n\nexport default function(a, b) {\n  var bi = reA.lastIndex = reB.lastIndex = 0, // scan index for next number in b\n      am, // current match in a\n      bm, // current match in b\n      bs, // string preceding current number in b, if any\n      i = -1, // index in s\n      s = [], // string constants and placeholders\n      q = []; // number interpolators\n\n  // Coerce inputs to strings.\n  a = a + \"\", b = b + \"\";\n\n  // Interpolate pairs of numbers in a & b.\n  while ((am = reA.exec(a))\n      && (bm = reB.exec(b))) {\n    if ((bs = bm.index) > bi) { // a string precedes the next number in b\n      bs = b.slice(bi, bs);\n      if (s[i]) s[i] += bs; // coalesce with previous string\n      else s[++i] = bs;\n    }\n    if ((am = am[0]) === (bm = bm[0])) { // numbers in a & b match\n      if (s[i]) s[i] += bm; // coalesce with previous string\n      else s[++i] = bm;\n    } else { // interpolate non-matching numbers\n      s[++i] = null;\n      q.push({i: i, x: number(am, bm)});\n    }\n    bi = reB.lastIndex;\n  }\n\n  // Add remains of b.\n  if (bi < b.length) {\n    bs = b.slice(bi);\n    if (s[i]) s[i] += bs; // coalesce with previous string\n    else s[++i] = bs;\n  }\n\n  // Special optimization for only a single match.\n  // Otherwise, interpolate each of the numbers and rejoin the string.\n  return s.length < 2 ? (q[0]\n      ? one(q[0].x)\n      : zero(b))\n      : (b = q.length, function(t) {\n          for (var i = 0, o; i < b; ++i) s[(o = q[i]).i] = o.x(t);\n          return s.join(\"\");\n        });\n}\n","import {color} from \"d3-color\";\nimport rgb from \"./rgb.js\";\nimport {genericArray} from \"./array.js\";\nimport date from \"./date.js\";\nimport number from \"./number.js\";\nimport object from \"./object.js\";\nimport string from \"./string.js\";\nimport constant from \"./constant.js\";\nimport numberArray, {isNumberArray} from \"./numberArray.js\";\n\nexport default function(a, b) {\n  var t = typeof b, c;\n  return b == null || t === \"boolean\" ? constant(b)\n      : (t === \"number\" ? number\n      : t === \"string\" ? ((c = color(b)) ? (b = c, rgb) : string)\n      : b instanceof color ? rgb\n      : b instanceof Date ? date\n      : isNumberArray(b) ? numberArray\n      : Array.isArray(b) ? genericArray\n      : typeof b.valueOf !== \"function\" && typeof b.toString !== \"function\" || isNaN(b) ? object\n      : number)(a, b);\n}\n","import {hsl as colorHsl} from \"d3-color\";\nimport color, {hue} from \"./color.js\";\n\nfunction hsl(hue) {\n  return function(start, end) {\n    var h = hue((start = colorHsl(start)).h, (end = colorHsl(end)).h),\n        s = color(start.s, end.s),\n        l = color(start.l, end.l),\n        opacity = color(start.opacity, end.opacity);\n    return function(t) {\n      start.h = h(t);\n      start.s = s(t);\n      start.l = l(t);\n      start.opacity = opacity(t);\n      return start + \"\";\n    };\n  }\n}\n\nexport default hsl(hue);\nexport var hslLong = hsl(color);\n","import {lab as colorLab} from \"d3-color\";\nimport color from \"./color.js\";\n\nexport default function lab(start, end) {\n  var l = color((start = colorLab(start)).l, (end = colorLab(end)).l),\n      a = color(start.a, end.a),\n      b = color(start.b, end.b),\n      opacity = color(start.opacity, end.opacity);\n  return function(t) {\n    start.l = l(t);\n    start.a = a(t);\n    start.b = b(t);\n    start.opacity = opacity(t);\n    return start + \"\";\n  };\n}\n","import {hcl as colorHcl} from \"d3-color\";\nimport color, {hue} from \"./color.js\";\n\nfunction hcl(hue) {\n  return function(start, end) {\n    var h = hue((start = colorHcl(start)).h, (end = colorHcl(end)).h),\n        c = color(start.c, end.c),\n        l = color(start.l, end.l),\n        opacity = color(start.opacity, end.opacity);\n    return function(t) {\n      start.h = h(t);\n      start.c = c(t);\n      start.l = l(t);\n      start.opacity = opacity(t);\n      return start + \"\";\n    };\n  }\n}\n\nexport default hcl(hue);\nexport var hclLong = hcl(color);\n","import {cubehelix as colorCubehelix} from \"d3-color\";\nimport color, {hue} from \"./color.js\";\n\nfunction cubehelix(hue) {\n  return (function cubehelixGamma(y) {\n    y = +y;\n\n    function cubehelix(start, end) {\n      var h = hue((start = colorCubehelix(start)).h, (end = colorCubehelix(end)).h),\n          s = color(start.s, end.s),\n          l = color(start.l, end.l),\n          opacity = color(start.opacity, end.opacity);\n      return function(t) {\n        start.h = h(t);\n        start.s = s(t);\n        start.l = l(Math.pow(t, y));\n        start.opacity = opacity(t);\n        return start + \"\";\n      };\n    }\n\n    cubehelix.gamma = cubehelixGamma;\n\n    return cubehelix;\n  })(1);\n}\n\nexport default cubehelix(hue);\nexport var cubehelixLong = cubehelix(color);\n","import {default as value} from \"./value.js\";\n\nexport default function piecewise(interpolate, values) {\n  if (values === undefined) values = interpolate, interpolate = value;\n  var i = 0, n = values.length - 1, v = values[0], I = new Array(n < 0 ? 0 : n);\n  while (i < n) I[i] = interpolate(v, v = values[++i]);\n  return function(t) {\n    var i = Math.max(0, Math.min(n - 1, Math.floor(t *= n)));\n    return I[i](t - i);\n  };\n}\n","import {CircularArray} from \"./Interfaces.js\";\r\nimport { integer as guardInteger } from \"../Guards.js\";\r\n\r\nclass CircularArrayImpl<V> extends Array {\r\n  //  Class is unit tested!\r\n  /* eslint-disable-next-line functional/prefer-readonly-type */\r\n  #capacity: number;\r\n  /* eslint-disable-next-line functional/prefer-readonly-type */\r\n  #pointer: number;\r\n\r\n  constructor(capacity: number = 0) {\r\n    super();\r\n    // Allowed to create with capacity zero\r\n    guardInteger(capacity, `positive`, `capacity`);\r\n\r\n    // Can't throw because .filter won't use ctor proprly\r\n    this.#capacity = capacity;\r\n    this.#pointer = 0;\r\n  }\r\n\r\n  add(thing: V): CircularArrayImpl<V> {\r\n    const ca = CircularArrayImpl.from(this) as CircularArrayImpl<V>;\r\n    /* eslint-disable-next-line functional/immutable-data */\r\n    ca[this.#pointer] = thing;\r\n    /* eslint-disable-next-line functional/immutable-data */\r\n    ca.#capacity = this.#capacity;\r\n    if (this.#capacity > 0) {\r\n      /* eslint-disable-next-line functional/immutable-data */\r\n      ca.#pointer = this.#pointer + 1 === this.#capacity ? 0 : this.#pointer + 1;\r\n    } else {\r\n      /* eslint-disable-next-line functional/immutable-data */\r\n      ca.#pointer = this.#pointer + 1;\r\n    }\r\n    return ca;\r\n  }\r\n\r\n  get pointer(): number {\r\n    return this.#pointer;\r\n  }\r\n\r\n  get isFull(): boolean {\r\n    if (this.#capacity === 0) return false;\r\n    return this.length === this.#capacity;\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * Returns a new circular array. Immutable. A circular array only keeps up to `capacity` items.\r\n * Old items are overridden with new items.\r\n * \r\n * `CircularArray` extends the regular JS array. Only use `add` to change the array if you want\r\n * to keep the `CircularArray` behaviour.\r\n * \r\n * @example Basic functions\r\n * ```js\r\n * let a = circularArray(10);\r\n * a = a.add(`hello`);  // Because it's immutable, capture the return result of `add`\r\n * a.isFull;            // True if circular array is full\r\n * a.pointer;           // The current position in array it will write to\r\n * ```\r\n * \r\n * Since it extends the regular JS array, you can access items as usual:\r\n * @example Accessing\r\n * ```js\r\n * let a = circularArray(10);\r\n * ... add some stuff ..\r\n * a.forEach(item => console.log(item)); \r\n * ```\r\n * @param capacity Maximum capacity before recycling array entries\r\n * @return Circular array\r\n */\r\nexport const circularArray = <V>(capacity:number): CircularArray<V> => new CircularArrayImpl<V>(capacity);\r\n","//  UNIT TESTED\nimport { SimpleEventEmitter } from \"../Events.js\";\nimport { ToString, toStringDefault, isEqualDefault } from \"../Util.js\";\nimport { hasAnyValue as mapHasAnyValue,  toArray as mapToArray, find as mapFind, filter as mapFilter, addKeepingExisting } from './Map.js';\nimport { without } from './Arrays.js';\nimport { circularArray } from './CircularArray.js';\nimport { CircularArray, MapArrayEvents, MapArrayOpts, MapCircularOpts, MapMultiOpts,  MapOfMutable, MapSetOpts, MultiValue } from \"./Interfaces.js\";\n\n/**\n * @internal\n */\nexport class MapOfMutableImpl<V, M> extends SimpleEventEmitter<MapArrayEvents<V>> {\n  /* eslint-disable-next-line functional/prefer-readonly-type */\n  readonly #map:Map<string, M> = new Map();\n  readonly groupBy:ToString<V>;\n  readonly type:MultiValue<V, M>;\n\n  constructor(type:MultiValue<V, M>, opts:MapMultiOpts<V> = {}) {\n    super();\n    this.type = type;\n    this.groupBy = opts.groupBy ?? toStringDefault;\n  }\n\n  /**\n   * Returns the type name. For in-built implementations, it will be one of: array, set or circular\n   */\n  get typeName() {\n    return this.type.name;\n  }\n\n  /**\n   * Returns the length of the longest child list\n   */\n  get lengthMax() {\n    //eslint-disable-next-line functional/no-let\n    let m = 0;\n    for (const v of this.#map.values()) {\n      m = Math.max(m, this.type.count(v));\n    }\n    return m;\n  }\n\n  debugString():string {\n    const keys = Array.from(this.#map.keys());\n    // eslint-disable-next-line functional/no-let\n    let r = `Keys: ${keys.join(`, `)}\\r\\n`;\n    keys.forEach(k => {\n      const v = this.#map.get(k);\n      if (v !== undefined) {\n        const asArray = this.type.toArray(v);\n        if (asArray !== undefined) {\n          r += ` - ${k} (${this.type.count(v)}) = ${JSON.stringify(asArray)}\\r\\n`;\n        }\n      } else r += ` - ${k} (undefined)\\r\\n`;\n    });\n    return r;\n  }\n\n  get isEmpty():boolean {\n    return (this.#map.size === 0);\n  }\n\n  clear() {\n    this.#map.clear();\n    super.fireEvent(`clear`, true);\n  }\n\n  addKeyedValues(key:string, ...values:ReadonlyArray<V>) {\n    const set = this.#map.get(key);\n    //console.log(`addKeyedValues: key: ${key} values: ${JSON.stringify(values)}`);\n    if (set === undefined) {\n      this.#map.set(key, this.type.add(undefined, values));\n      super.fireEvent(`addedKey`, { key:key });\n      super.fireEvent(`addedValues`, { values: values });\n    } else {\n      // eslint-disable-next-line functional/immutable-data\n      this.#map.set(key, this.type.add(set, values));\n      super.fireEvent(`addedValues`, { values: values });\n    }\n  }\n\n  addValue(...values:ReadonlyArray<V>) {\n    values.forEach(v => this.addKeyedValues(this.groupBy(v), v));\n  }\n\n  hasKeyValue(key:string, value:V):boolean {    \n    const m = this.#map.get(key);\n    if (m === undefined) return false;    \n    return this.type.has(m, value);\n  }\n\n  has(key:string):boolean {\n    return this.#map.has(key);\n  }\n\n  deleteKeyValue(key:string, value:V):boolean {\n    const a = this.#map.get(key);\n    if (a === undefined) return false;\n    const preCount = this.type.count(a);\n\n    const filtered = this.type.without(a, value);// this.type.filter(a, v => !this.valueComparer(v, value));\n    const postCount = filtered.length;\n    this.#map.set(key, this.type.add(undefined, filtered));\n    return preCount > postCount;\n  }\n\n  delete(key:string):boolean {\n    const a = this.#map.get(key);\n    if (a === undefined) return false;\n    this.#map.delete(key);\n    this.fireEvent(`deleteKey`, { key: key });\n    return true;\n  }\n\n  findKeyForValue(value:V):string | undefined {\n    const keys = Array.from(this.#map.keys());\n    const found = keys.find(key => {\n      const a = this.#map.get(key);\n      if (a === undefined) throw Error(`Bug: map could not be accessed`);\n      if (this.type.has(a, value)) return true;\n      return false;\n    });\n    return found;\n  }\n\n  count(key:string):number {\n    const e = this.#map.get(key);\n    if (e === undefined) return 0;\n    return this.type.count(e);\n  }\n\n  /**\n   * Returns the array of values stored under `key`\n   * or undefined if key does not exist\n   */\n  get(key:string):readonly V[] | undefined {\n    const m = this.#map.get(key);\n    if (m === undefined) return undefined;\n    return this.type.toArray(m);\n  }\n\n  getSource(key:string):M|undefined {\n    return this.#map.get(key);\n  }\n\n  /* eslint-disable-next-line functional/prefer-readonly-type */\n  keys():string[] {\n    return Array.from(this.#map.keys());\n  }\n\n  /* eslint-disable-next-line functional/prefer-readonly-type */\n  keysAndCounts():Array<[string, number]> {\n    const keys = this.keys();\n    /* eslint-disable-next-line functional/prefer-readonly-type */\n    const r = keys.map(k => [k, this.count(k)]) as Array<[string, number]>;\n    return r;\n  }\n\n  merge(other:MapOfMutable<V, M>) {\n    const keys = other.keys();\n    keys.forEach(key => {\n      const data = other.get(key);\n      if (data !== undefined) this.addKeyedValues(key, ...data);\n    });\n  }\n}\n\n//  UNIT TESTED\n/**\n * Returns a {@link MapOfMutable} to allow storing multiple values under a key, unlike a regular Map.\n * @example\n * ```js\n * const map = mapArray();\n * map.add(`hello`, [1,2,3,4]); // Adds series of numbers under key `hello`\n * \n * const hello = map.get(`hello`); // Get back values\n * ```\n * \n * Takes options:\n * * `comparer`: {@link Util.IsEqual}\n * * `toString`: {@link Util.ToString}\n * \n * A custom {@link Util.ToString} function can be provided which is used when checking value equality (`has`, `without`)\n * ```js\n * const map = mapArray({toString:(v) => v.name}); // Compare values based on their `name` field;\n * ``` \n * \n * Alternatively, a {@link Util.IsEqual} function can be used:\n * ```js\n * const map = mapArray({comparer: (a, b) => a.name === b.name });\n * ```\n * @param opts \n * @template V Data type of items \n * @returns {@link MapOfMutable}\n */\nexport const mapArray = <V>(opts:MapArrayOpts<V> = {}):MapOfMutable<V, ReadonlyArray<V>> => {\n  const comparer = opts.comparer === undefined ?\n    opts.toString === undefined ? (a:V, b:V) => opts.toString(a) === opts.toString(b) :\n      isEqualDefault\n    : opts.comparer;\n    \n  const t:MultiValue<V, ReadonlyArray<V>> = {\n    get name()  {\n      return `array`;\n    },\n    add:(dest, values) => {\n      if (dest === undefined) return [...values];\n      return [...dest, ...values];\n    },\n    count: (source) => source.length,\n    find: (source, predicate) => source.find(predicate),\n    filter: (source, predicate) => source.filter(predicate),\n    toArray: (source) => source,\n    has: (source, value) => source.find(v => comparer(v, value)) !== undefined,\n    without: (source, value) => source.filter(v => !comparer(v, value))\n  };\n  const m = new MapOfMutableImpl<V, ReadonlyArray<V>>(t, opts);\n  return m;\n};\n\n/**\n * Returns a {@link MapOfMutable} that uses a set to hold values.\n * This means that only unique values are stored under each key. By default it\n * uses the JSON representation to compare items. \n * \n * Options: `{ hash: toStringFn } }`\n * \n * `hash` is a {@link Util.ToString} function: `(object) => string`. By default it uses\n * `JSON.stringify`.\n * \n * @example Only storing the newest three items per key\n * ```js\n * const map = mapSetMutable();\n * map.add(`hello`, [1, 2, 3, 1, 2, 3]);\n * const hello = map.get(`hello`); // [1, 2, 3]\n * ```\n * \n * @example\n * ```js\n * const hash = (v) => v.name; // Use name as the key\n * const map = mapSetMutable(hash);\n * map.add(`hello`, {age:40, name: `Mary`});\n * map.add(`hello`, {age:29, name: `Mary`}); // Value ignored as same name exists\n * ```\n * @param opts \n * @returns\n */\nexport const mapSet = <V>(opts?:MapSetOpts<V>):MapOfMutable<V, ReadonlyMap<string, V>> => {\n  const hash = opts?.hash ?? toStringDefault;\n  const comparer = (a:V, b:V) => hash(a) === hash(b);\n\n  const t:MultiValue<V, ReadonlyMap<string, V>> = {\n    get name()  {\n      return `set`;\n    },\n    add:(dest, values) => addKeepingExisting(dest, hash, ...values),\n    count: (source) => source.size,\n    find: (source, predicate) => mapFind(source, predicate),\n    filter: (source, predicate) => mapFilter(source, predicate),\n    toArray: (source) => mapToArray(source),\n    has: (source, value) => mapHasAnyValue(source, value, comparer),\n    without: (source, value) => without(mapToArray(source), value, comparer)\n  };\n  const m = new MapOfMutableImpl<V, ReadonlyMap<string, V>>(t, opts);\n  return m;\n};\n\n/**\n * Returns a {@link MapOfMutable} that uses a {@link CircularArray} to hold values. Mutable.\n * This means that the number of values stored under each key will be limited to the defined\n * capacity.\n * \n * Required option:\n * * `capacity`: how many items to hold\n * \n * @example Only store the most recent three items per key\n * ```js\n * const map = mapCircularMutable({capacity: 3});\n * map.add(`hello`, [1, 2, 3, 4, 5]);\n * const hello = map.get(`hello`); // [3, 4, 5]\n * ```\n * \n * \n * @param opts \n * @returns\n */\nexport const mapCircularMutable = <V>(opts:MapCircularOpts<V>):MapOfMutable<V, CircularArray<V>> => {\n  const comparer = isEqualDefault;\n  \n  const t:MultiValue<V, CircularArray<V>> = {\n    get name()  {\n      return `circular`;\n    },\n    add:(dest, values) => {\n      if (dest === undefined) dest = circularArray<V>(opts.capacity);\n      values.forEach(v => dest = dest?.add(v));\n      return dest;\n    },\n    count: (source) => source.length,\n    find: (source, predicate) => source.find(predicate),\n    filter: (source, predicate) => source.filter(predicate),\n    toArray: (source) => source,\n    has: (source, value) => source.find(v => comparer(v, value)) !== undefined,\n    without: (source, value) => source.filter(v => !comparer(v, value))\n  };\n  return new MapOfMutableImpl<V, CircularArray<V>>(t, opts);\n};\n","//  Unit tested!\r\nimport {DiscardPolicy, Stack} from \"./Interfaces.js\";\r\nimport {StackMutable} from './Interfaces.js';\r\n\r\nexport type StackOpts = {\r\n  readonly debug?:boolean\r\n  readonly capacity?: number\r\n  readonly discardPolicy?: DiscardPolicy\r\n}\r\n\r\nconst trimStack = <V>(opts: StackOpts, stack: ReadonlyArray<V>, toAdd: ReadonlyArray<V>): ReadonlyArray<V> => {\r\n  const potentialLength = stack.length + toAdd.length;\r\n  const policy = opts.discardPolicy ?? `additions`;\r\n  const capacity = opts.capacity ?? potentialLength;\r\n  const toRemove = potentialLength - capacity;\r\n  if (opts.debug) console.log(`Stack.push: stackLen: ${stack.length} potentialLen: ${potentialLength} toRemove: ${toRemove} policy: ${policy}`);\r\n\r\n  switch (policy) {\r\n  case `additions`:\r\n    if (opts.debug) console.log(`Stack.push:DiscardAdditions: stackLen: ${stack.length} slice: ${potentialLength-capacity} toAddLen: ${toAdd.length}`);\r\n    if (stack.length === opts.capacity) {\r\n      return stack; // Completely full\r\n    } else {\r\n      // Only add some from the new array\r\n      return [...stack, ...toAdd.slice(0, toAdd.length-toRemove)];\r\n    }\r\n  case `newer`:\r\n    if (toRemove >= stack.length) {\r\n      // New items will completely flush out old\r\n      return toAdd.slice(Math.max(0, toAdd.length-capacity), Math.min(toAdd.length, capacity)+1);\r\n    } else {\r\n      // Keep some of the old (from 0)\r\n      //if (opts.debug) console.log(` orig: ${JSON.stringify(stack)}`);\r\n      if (opts.debug) console.log(` from orig: ${stack.slice(0, stack.length-toRemove)}`);\r\n      return [...stack.slice(0, stack.length-toRemove), ...toAdd.slice(0, Math.min(toAdd.length, capacity-toRemove+1))];    \r\n    }\r\n  case `older`:\r\n    // Oldest item in stack is position 0\r\n    return [...stack, ...toAdd].slice(toRemove);\r\n  default:\r\n    throw new Error(`Unknown discard policy ${policy}`);\r\n  }\r\n};\r\n\r\n// Add to top (last index)\r\nconst push = <V>(opts: StackOpts, stack: ReadonlyArray<V>, ...toAdd: ReadonlyArray<V>): ReadonlyArray<V> => {\r\n  // If stack is A, B and toAdd is C, D this yields A, B, C, D\r\n  //const mutated = [...stack, ...toAdd];\r\n  const potentialLength = stack.length + toAdd.length;\r\n\r\n  const overSize = (opts.capacity && potentialLength > opts.capacity);\r\n  const toReturn  = overSize ? trimStack(opts, stack, toAdd) : [...stack, ...toAdd];\r\n  return toReturn;\r\n};\r\n\r\n// Remove from top (last index)\r\nconst pop = <V>(opts: StackOpts, stack: ReadonlyArray<V>): ReadonlyArray<V> => {\r\n  if (stack.length === 0) throw new Error(`Stack is empty`);\r\n  return stack.slice(0, stack.length - 1);\r\n};\r\n\r\n/**\r\n * Peek at the top of the stack (end of array)\r\n *\r\n * @template V\r\n * @param {StackOpts} opts\r\n * @param {V[]} stack\r\n * @returns {(V | undefined)}\r\n */\r\nconst peek = <V>(opts: StackOpts, stack: ReadonlyArray<V>): V | undefined => stack[stack.length - 1];\r\n\r\nconst isEmpty = <V>(opts: StackOpts, stack: ReadonlyArray<V>): boolean => stack.length === 0;\r\n\r\nconst isFull = <V>(opts: StackOpts, stack: ReadonlyArray<V>): boolean => {\r\n  if (opts.capacity) {\r\n    return stack.length >= opts.capacity;\r\n  }\r\n  return false;\r\n};\r\n\r\n// -------------------------\r\n// Immutable\r\n// -------------------------\r\nclass StackImpl<V> {\r\n  readonly opts: StackOpts;\r\n  /* eslint-disable-next-line functional/prefer-readonly-type */\r\n  readonly data: ReadonlyArray<V>;\r\n\r\n  constructor(opts: StackOpts, data: ReadonlyArray<V>) {\r\n    this.opts = opts;\r\n    this.data = data;\r\n  }\r\n\r\n  push(...toAdd: ReadonlyArray<V>): Stack<V> {\r\n    return new StackImpl<V>(this.opts, push(this.opts, this.data, ...toAdd));\r\n  }\r\n\r\n  pop(): Stack<V> {\r\n    return new StackImpl<V>(this.opts, pop(this.opts, this.data));\r\n  }\r\n\r\n  forEach(fn:(v:V) => void): void {\r\n    this.data.forEach(fn);\r\n  }\r\n\r\n  forEachFromTop(fn:(v:V) => void): void {\r\n    [...this.data].reverse().forEach(fn);\r\n  }\r\n\r\n  get isEmpty(): boolean {\r\n    return isEmpty(this.opts, this.data);\r\n  }\r\n\r\n  get isFull(): boolean {\r\n    return isFull(this.opts, this.data);\r\n  }\r\n\r\n  get peek(): V | undefined {\r\n    return peek(this.opts, this.data);\r\n  }\r\n\r\n  get length():number {\r\n    return this.data.length;\r\n  }\r\n}\r\n\r\n// -------------------------\r\n// Mutable\r\n// -------------------------\r\nclass StackMutableImpl<V> {\r\n  readonly opts: StackOpts;\r\n  /* eslint-disable-next-line functional/prefer-readonly-type */\r\n  data: ReadonlyArray<V>;\r\n\r\n  constructor(opts: StackOpts, data: ReadonlyArray<V>) {\r\n    this.opts = opts;\r\n    this.data = data;\r\n  }\r\n\r\n  push(...toAdd: ReadonlyArray<V>): number {\r\n    /* eslint-disable-next-line functional/immutable-data */\r\n    this.data = push(this.opts, this.data, ...toAdd);\r\n    return this.data.length;\r\n  }\r\n\r\n  forEach(fn:(v:V) => void): void {\r\n    this.data.forEach(fn);\r\n  }\r\n\r\n  forEachFromTop(fn:(v:V) => void): void {\r\n    [...this.data].reverse().forEach(fn);\r\n  }\r\n\r\n  pop(): V|undefined {\r\n    const v = peek(this.opts, this.data);\r\n    pop(this.opts, this.data);\r\n    return v;\r\n  }\r\n\r\n  get isEmpty(): boolean {\r\n    return isEmpty(this.opts, this.data);\r\n  }\r\n\r\n  get isFull(): boolean {\r\n    return isFull(this.opts, this.data);\r\n  }\r\n\r\n  get peek(): V | undefined {\r\n    return peek(this.opts, this.data);\r\n  }\r\n\r\n  get length():number {\r\n    return this.data.length;\r\n  }\r\n}\r\n\r\n/**\r\n * Returns a stack. Immutable. Use {@link stackMutable} for a mutable alternative.\r\n * \r\n * The basic usage is `push`/`pop` to add/remove, returning the modified stack. Use the\r\n * property `peek` to see what's on top.\r\n * \r\n * @example Basic usage\r\n * ```js\r\n * // Create\r\n * let s = stack();\r\n * // Add one or more items\r\n * s = s.push(1, 2, 3, 4);\r\n * // See what's at the top of the stack\r\n * s.peek;      // 4\r\n * \r\n * // Remove from the top of the stack, returning\r\n * // a new stack without item\r\n * s = s.pop();\r\n * s.peek;        // 3\r\n * ```\r\n * @param opts Options\r\n * @param startingItems List of items to add to stack. Items will be pushed 'left to right', ie array index 0 will be bottom of the stack.\r\n */\r\nexport const stack = <V>(opts: StackOpts = {}, ...startingItems: ReadonlyArray<V>): Stack<V> => new StackImpl({...opts}, [...startingItems]);\r\n\r\n/**\r\n * Creates a stack. Mutable. Use {@link stack} for an immutable alternative.\r\n * \r\n * @example Basic usage\r\n * ```js\r\n * // Create\r\n * const s = stackMutable();\r\n * // Add one or more items\r\n * s.push(1, 2, 3, 4);\r\n * \r\n * // See what's on top\r\n * s.peek;  // 4\r\n * \r\n * // Remove the top-most, and return it\r\n * s.pop();   // 4\r\n * \r\n * // Now there's a new top-most element\r\n * s.peek;  // 3\r\n * ```\r\n */\r\nexport const stackMutable = <V>(opts: StackOpts = {}, ...startingItems: ReadonlyArray<V>):StackMutable<V> =>  new StackMutableImpl({...opts}, [...startingItems]);","//  UNIT TESTED\n\nimport {QueueMutable, Queue, DiscardPolicy} from \"./Interfaces.js\";\n\n/**\n * Queue options.\n * \n * @example Cap size to 5 items, throwing away newest items already in queue.\n * ```js\n * const q = queue({capacity: 5, discardPolicy: `newer`});\n * ```\n */\nexport type QueueOpts =  {\n  /**\n   * @private\n   */\n  readonly debug?:boolean\n  /**\n   * Capcity limit\n   */\n  readonly capacity?: number\n  /**\n   * Default is `additions`, meaning new items are discarded.\n   * \n   * `older`: Removes items front of the queue (ie older items are discarded)\n   * \n   * `newer`: Remove from rear of queue to make space for new items (ie newer items are discarded)\n   * \n   * `additions`: Only adds new items that there are room for (ie. brand new items are discarded)\n   *\n   */\n  readonly discardPolicy?: DiscardPolicy\n}\n\nconst debug = (opts: QueueOpts, msg:string):void => {\n  /* eslint-disable-next-line functional/no-expression-statement */\n  opts.debug ? console.log(`queue:${msg}`) : null;\n};\n\nconst trimQueue = <V>(opts: QueueOpts, queue: ReadonlyArray<V>, toAdd: ReadonlyArray<V>): ReadonlyArray<V> => {\n  const potentialLength = queue.length + toAdd.length;\n  const capacity = opts.capacity ?? potentialLength;\n  const toRemove = potentialLength - capacity;\n  const policy = opts.discardPolicy ?? `additions`;\n  debug(opts, `queueLen: ${queue.length} potentialLen: ${potentialLength} toRemove: ${toRemove} policy: ${policy}`);\n \n  switch (policy) {\n  // Only add what we can from toAdd\n  case `additions`:\n    debug(opts, `trimQueue:DiscardAdditions: queueLen: ${queue.length} slice: ${potentialLength-capacity} toAddLen: ${toAdd.length}`);\n    if (queue.length === opts.capacity) {\n      return queue; // Completely full\n    } else {\n      // Only add some from the new array (from the front)  \n      return [...queue, ...toAdd.slice(0, toRemove-1)];\n    }\n  // Remove from rear of queue (last index) before adding new things\n  case `newer`:\n    if (toRemove >= queue.length) {\n      // New items will completely flush out old\n      return toAdd.slice(Math.max(0, toAdd.length-capacity), Math.min(toAdd.length, capacity)+1);\n    } else {\n      // Keep some of the old\n      const toAddFinal = toAdd.slice(0, Math.min(toAdd.length, capacity-toRemove+1));\n      const toKeep =  queue.slice(0, queue.length-toRemove);\n      debug(opts, `trimQueue: toRemove: ${toRemove} keeping: ${JSON.stringify(toKeep)} from orig: ${JSON.stringify(queue)} toAddFinal: ${JSON.stringify(toAddFinal)}`);\n      const t=  [...toKeep, ...toAddFinal];    \n      debug(opts, `final: ${JSON.stringify(t)}`);\n      return t;\n    }\n  // Remove from the front of the queue (0 index). ie. older items are discarded\n  case `older`:\n    // If queue is A, B and toAdd is C, D this yields A, B, C, D\n    return [...queue, ...toAdd].slice(toRemove);\n  default:\n    throw new Error(`Unknown overflow policy ${policy}`);\n  }\n};\n\n/**\n * Adds to the back of the queue (last array index)\n * Last item of `toAdd` will potentially be the new end of the queue (depending on capacity limit and overflow policy)\n * @template V\n * @param {QueueOpts} opts\n * @param {V[]} queue\n * @param {...V[]} toAdd\n * @returns {V[]}\n */\nconst enqueue = <V>(opts: QueueOpts, queue: ReadonlyArray<V>, ...toAdd: ReadonlyArray<V>): ReadonlyArray<V> => {\n  if (opts === undefined) throw new Error(`opts parameter undefined`);\n\n  const potentialLength = queue.length + toAdd.length;\n  const overSize = opts.capacity && potentialLength > opts.capacity;\n\n  const toReturn = overSize ? trimQueue(opts, queue, toAdd) : [...queue, ...toAdd];\n  if (opts.capacity && toReturn.length !== opts.capacity && overSize) throw new Error(`Bug! Expected return to be at capacity. Return len: ${toReturn.length} capacity: ${opts.capacity} opts: ${JSON.stringify(opts)}`);\n  if (!opts.capacity && toReturn.length !== potentialLength) throw new Error(`Bug! Return length not expected. Return len: ${toReturn.length} expected: ${potentialLength} opts: ${JSON.stringify(opts)}`);\n  \n  return toReturn;\n};\n\n// Remove from front of queue (0 index)\nconst dequeue = <V>(opts: QueueOpts, queue: ReadonlyArray<V>): ReadonlyArray<V> => {\n  if (queue.length === 0) throw new Error(`Queue is empty`);\n  return queue.slice(1);\n};\n\n/**\n * Returns front of queue (oldest item), or undefined if queue is empty\n *\n * @template V\n * @param {QueueOpts} opts\n * @param {V[]} queue\n * @returns {(V | undefined)}\n */\nconst peek = <V>(opts: QueueOpts, queue: ReadonlyArray<V>): V | undefined => queue[0];\n\nconst isEmpty = <V>(opts: QueueOpts, queue: ReadonlyArray<V>): boolean => queue.length === 0;\n\nconst isFull = <V>(opts: QueueOpts, queue: ReadonlyArray<V>): boolean => {\n  if (opts.capacity) {\n    return queue.length >= opts.capacity;\n  }\n  return false;\n};\n\n// -------------------------------\n// Immutable\n// -------------------------------\nclass QueueImpl<V> {\n  readonly opts: QueueOpts;\n  readonly data: ReadonlyArray<V>;\n\n  /**\n   * Creates an instance of Queue.\n   * @param {QueueOpts} opts Options foor queue\n   * @param {V[]} data Initial data. Index 0 is front of queue\n   * @memberof Queue\n   */\n  constructor(opts: QueueOpts, data: ReadonlyArray<V>) {\n    if (opts === undefined) throw new Error(`opts parameter undefined`);\n\n    this.opts = opts;\n    this.data = data;\n  }\n\n  forEach(fn:(v:V) => void) {\n    //eslint-disable-next-line functional/no-let\n    for (let i=this.data.length-1; i>=0; i--) {\n      fn(this.data[i]);\n    }  \n  }\n\n  forEachFromFront(fn:(v:V) => void) {\n    // From front of queue\n    this.data.forEach(vv => fn(vv));\n  }\n\n  enqueue(...toAdd: ReadonlyArray<V>): QueueImpl<V> {\n    return new QueueImpl<V>(this.opts, enqueue(this.opts, this.data, ...toAdd));\n  }\n\n  dequeue(): QueueImpl<V> {\n    return new QueueImpl<V>(this.opts, dequeue(this.opts, this.data));\n  }\n\n  get isEmpty(): boolean {\n    return isEmpty(this.opts, this.data);\n  }\n\n  get isFull(): boolean {\n    return isFull(this.opts, this.data);\n  }\n\n  get length():number {\n    return this.data.length;\n  }\n\n  get peek(): V | undefined {\n    return peek(this.opts, this.data);\n  }\n}\n\n// -------------------------------\n// Mutable\n// -------------------------------\nclass QueueMutableImpl<V> implements QueueMutable<V> {\n  readonly opts: QueueOpts;\n  // eslint-disable-next-line functional/prefer-readonly-type\n  data: ReadonlyArray<V>;\n\n  constructor(opts:QueueOpts, data:ReadonlyArray<V>) {\n    if (opts === undefined) throw new Error(`opts parameter undefined`);\n    this.opts = opts;\n    this.data = data;\n  }\n\n  enqueue(...toAdd: ReadonlyArray<V>): number {\n    /* eslint-disable-next-line functional/immutable-data */\n    this.data = enqueue(this.opts, this.data, ...toAdd);\n    return this.data.length;\n  }\n\n  dequeue(): V|undefined {\n    const v = peek(this.opts, this.data);\n    /* eslint-disable-next-line functional/immutable-data */\n    this.data = dequeue(this.opts, this.data);\n    return v;\n  }\n\n  get isEmpty(): boolean {\n    return isEmpty(this.opts, this.data);\n  }\n\n  get isFull(): boolean {\n    return isFull(this.opts, this.data);\n  }\n\n  get length():number {\n    return this.data.length;\n  }\n\n  get peek(): V | undefined {\n    return peek(this.opts, this.data);\n  }\n}\n\n/**\n * Returns an immutable queue. Queues are useful if you want to treat 'older' or 'newer'\n * items differently. _Enqueing_ adds items at the back of the queue, while\n * _dequeing_ removes items from the front (ie. the oldest).\n *\n * ```js\n * let q = queue();           // Create\n * q = q.enqueue(`a`, `b`);   // Add two strings\n * const front = q.peek();    // `a` is at the front of queue (oldest)\n * q = q.dequeue();           // q now just consists of `b`  \n * ```\n * @example Cap size to 5 items, throwing away newest items already in queue.\n * ```js\n * const q = queue({capacity: 5, discardPolicy: `newer`});\n * ```\n * \n * @template V Data type of items\n * @param opts\n * @param startingItems Index 0 is the front of the queue\n * @returns A new queue\n */\nexport const queue = <V>(opts: QueueOpts = {}, ...startingItems: ReadonlyArray<V>): Queue<V> => {\n  opts = {...opts}; // Make a copy of options\n  return new QueueImpl(opts, [...startingItems]); // Make a copy of array so it can't be modified\n};\n\n/**\n * Returns a mutable queue. Queues are useful if you want to treat 'older' or 'newer'\n * items differently. _Enqueing_ adds items at the back of the queue, while\n * _dequeing_ removes items from the front (ie. the oldest).\n * \n * ```js\n * const q = queue();       // Create\n * q.enqueue(`a`, `b`);     // Add two strings\n * const front = q.dequeue();  // `a` is at the front of queue (oldest)\n * ```\n *\n * @example Cap size to 5 items, throwing away newest items already in queue.\n * ```js\n * const q = queue({capacity: 5, discardPolicy: `newer`});\n * ```\n * \n * @template V Data type of items\n * @param opts\n * @param startingItems Items are added in array order. So first item will be at the front of the queue.\n */\nexport const queueMutable = <V>(opts: QueueOpts = {}, ...startingItems: ReadonlyArray<V>): QueueMutable<V> => new QueueMutableImpl({...opts}, [...startingItems]);","\nimport { ArrayKeys, EitherKey, ObjKeys, MapImmutable } from \"./Interfaces\";\n\n/**\n * Adds an array o [k,v] to the map, returning a new instance\n * @param map Initial data\n * @param data Data to add\n * @returns New map with data added\n */\nconst addArray = <K, V>(map:ReadonlyMap<K, V>, data:ArrayKeys<K, V>):ReadonlyMap<K, V> => {\n  const x = new Map<K, V>(map.entries());\n  data.forEach(d => {\n    if (d[0] === undefined) throw new Error(`key cannot be undefined`);\n    if (d[1] === undefined) throw new Error(`value cannot be undefined`);\n    x.set(d[0], d[1]);\n  });\n  return x;\n};\n\n/**\n * Adds objects to the map, returning a new instance\n * @param map Initial data\n * @param data Data to add\n * @returns A new map with data added\n */\nconst addObjects = <K, V>(map:ReadonlyMap<K, V>, data:ObjKeys<K, V>):ReadonlyMap<K, V> => {\n  const x = new Map<K, V>(map.entries());\n  data.forEach(d => {\n    if (d.key === undefined) throw new Error(`key cannot be undefined`);\n    if (d.value === undefined) throw new Error(`value cannot be undefined`);\n\n    x.set(d.key, d.value);\n  });\n  return x;\n};\n\n/**\n * Returns true if map contains key\n * \n * @example\n * ```js\n * if (has(map, `London`)) ...\n * ```\n * @param map Map to search\n * @param key Key to find\n * @returns True if map contains key\n */\nexport const has = <K, V>(map:ReadonlyMap<K, V>, key:K):boolean => map.has(key);\n\n/**\n * Adds data to a map, returning the new map.\n * \n * Can add items in the form of [key,value] or {key, value}.\n * @example These all produce the same result\n * ```js\n * map.set(`hello`, `samantha`);\n * map.add([`hello`, `samantha`]);\n * map.add({key: `hello`, value: `samantha`})\n * ```\n * @param map Initial data\n * @param data One or more data to add in the form of [key,value] or {key, value} \n * @returns New map with data added\n */\nexport const add = <K, V>(map:ReadonlyMap<K, V>, ...data:EitherKey<K, V>):ReadonlyMap<K, V> => {\n  if (map === undefined) throw new Error(`map parameter is undefined`);\n  if (data === undefined) throw new Error(`data parameter i.s undefined`);\n  if (data.length === 0) return map;\n\n  const firstRecord = data[0];\n  const isObj = typeof (firstRecord as {readonly key:K, readonly value:V}).key !== `undefined` && typeof (firstRecord as {readonly key:K, readonly value:V}).value !== `undefined`;  //(typeof (data[0] as {readonly key:K}).key !== undefined && typeof (data[0] as {readonly value:V}).value !== undefined);\n  return isObj ? addObjects(map, data as ObjKeys<K, V>) : addArray(map, data as ArrayKeys<K, V>);\n};\n\n/**\n * Sets data in a copy of the initial map\n * @param map Initial map\n * @param key Key\n * @param value Value to  set\n * @returns New map with data set\n */\nexport const set = <K, V>(map:ReadonlyMap<K, V>, key:K, value:V) => {\n  const x = new Map<K, V>(map.entries());\n  x.set(key, value);\n  return x;\n};\n\n/**\n * Delete a key from the map, returning a new map\n * @param map Initial data\n * @param key \n * @returns New map with data deleted\n */\nexport const del = <K, V>(map:ReadonlyMap<K, V>, key:K):ReadonlyMap<K, V> => {\n  const x = new Map<K, V>(map.entries());\n  x.delete(key);\n  return x;\n};\n\n/**\n * Returns an {@link MapImmutable}.\n * Use {@link mapMutable} as a mutable alternatve.\n * \n * @example Basic usage\n * ```js\n * // Creating\n * let m = map();\n * // Add\n * m = m.add([\"name\", \"sally\"]);\n * // Recall\n * m.get(\"name\");\n * ```\n * \n * @example Enumerating\n * ```js\n * for (const [key, value] of map.entries()) {\n *  console.log(`${key} = ${value}`);\n * }\n * ```\n * \n * @example Overview\n * ```js\n * // Create\n * let m = map();\n * // Add\n * m = m.add([\"name\" , \"sally\"]);\n * m.get(\"name\");   // \"sally\";\n * m.has(\"age\");    // false\n * m.has(\"name\");   // true\n * m.isEmpty;       // false\n * m = m.delete(\"name\");\n * m.entries();     // Iterator of key value pairs\n * ```\n * \n * Since it is immutable, `add()`, `delete()` and `clear()` return a new version with change.\n * \n * @param dataOrMap Optional initial data in the form of an array of `{ key: value }` or `[ key, value ]`\n */\nexport const map = <K, V>(dataOrMap?:ReadonlyMap<K, V>|EitherKey<K, V>):MapImmutable<K, V> => {\n  if (dataOrMap === undefined) return map([]);\n  if (Array.isArray(dataOrMap)) return map(add(new Map(), ...dataOrMap));\n  const data = dataOrMap as ReadonlyMap<K, V>;\n  return {\n    add: (...itemsToAdd:EitherKey<K, V>) => {\n      const s = add(data, ...itemsToAdd);\n      return map(s);\n    },\n    get: (key:K) => data.get(key),\n    delete: (key:K) => map(del(data, key)),\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    clear: () => map(),\n    has: (key:K) => data.has(key),\n    entries: () => data.entries(),\n    isEmpty: () => data.size === 0\n  };\n};","import {add, del, set, has} from './MapImmutable.js';\r\nimport { EitherKey, MapMutable } from \"./Interfaces\";\r\n\r\n/**\r\n * Returns a {@link MapMutable} (which just wraps the in-built Map)\r\n * Use {@link map} for the immutable alternative.\r\n * \r\n * @example Basic usage\r\n * ```js\r\n * const m = mapMutable();\r\n * // Add one or more entries\r\n * m.add([\"name\", \"sally\"]);\r\n * // Alternatively:\r\n * m.set(\"name\", \"sally\");\r\n * // Recall\r\n * m.get(\"name\");           // \"sally\"\r\n * m.delete(\"name\");\r\n * m.isEmpty; // True\r\n * m.clear();\r\n * ```\r\n * @param data Optional initial data in the form of an array of `{ key: value }` or `[ key, value ]`\r\n */\r\nexport const mapMutable = <K, V>(...data: EitherKey<K, V>): MapMutable<K, V> => {\r\n  // eslint-disable-next-line functional/no-let\r\n  let m = add(new Map<K, V>(), ...data);\r\n  return {\r\n    add: (...data: EitherKey<K, V>) => {\r\n      m = add(m, ...data);\r\n    },\r\n    delete: (key: K) => {\r\n      m = del(m, key);\r\n    },\r\n    clear: () => {\r\n      m = add(new Map<K, V>());\r\n    },\r\n    set: (key: K, value: V): void => {\r\n      m = set(m, key, value);\r\n    },\r\n    get: (key: K): V | undefined => m.get(key),\r\n    entries: () => m.entries(),\r\n    isEmpty: () => m.size === 0,\r\n    has: (key: K) => has(m, key)\r\n  };\r\n};","import * as NumericArrays from './collections/NumericArrays.js';\nimport { numberTracker } from './data/NumberTracker.js';\nimport { TrackedValueOpts } from './data/TrackedValue.js';\nimport { Easings } from './modulation/index.js';\nimport { number as guard, integer as guardInteger } from './Guards.js';\n\n/**\n * Calculates the average of all numbers in an array.\n * Array items which aren't a valid number are ignored and do not factor into averaging.\n\n * @example\n * ```\n * import * as Numbers from 'https://unpkg.com/ixfx/dist/numbers.js';\n * \n * // Average of a list\n * const avg = Numbers.average(1, 1.4, 0.9, 0.1);\n * \n * // Average of a variable\n * let data = [100,200];\n * Numbers.average(...data);\n * ```\n * \n * See also: [Arrays.average](Collections.Arrays.average.html) which takes an array.\n * @param data Data to average.\n * @returns Average of array\n */\nexport const average = (...numbers:readonly number[]) => NumericArrays.average(numbers);\n\n/**\n * See [Arrays.averageWeighted](Collections.Arrays.averageWeighted.html)\n * @param weightings \n * @param numbers \n * @returns \n */\nexport const averageWeighted = (weightings:(readonly number[])|Easings.EasingFn, ...numbers:readonly number[]):number => NumericArrays.averageWeighted(numbers, weightings);\n\n/**\n * Returns the minimum number out of `data`.\n * Undefined and non-numbers are silently ignored.\n * \n * ```js\n * import * as Numbers from 'https://unpkg.com/ixfx/dist/numbers.js';\n * Numbers.min(10, 20, 0); // Yields 0\n * ```\n * @param data\n * @returns Minimum number\n */\nexport const min = (...data:readonly number[]):number => NumericArrays.min(data);\n\n\n/**\n * Returns the maximum number out of `data`.\n * Undefined and non-numbers are silently ignored.\n * \n * ```js\n * import * as Numbers from 'https://unpkg.com/ixfx/dist/numbers.js';\n * Numbers.max(10, 20, 0); // Yields 20\n * ```\n * @param data\n * @returns Maximum number\n */\nexport const max = (...data:readonly number[]):number => NumericArrays.max(data);\n\n\n/**\n * Returns the total of `data`.\n * Undefined and non-numbers are silently ignored.\n * \n * ```js\n * import * as Numbers from 'https://unpkg.com/ixfx/dist/numbers.js';\n * Numbers.total(10, 20, 0); // Yields 30\n * ```\n * @param data\n * @returns Total\n */\nexport const total = (...data:readonly number[]):number => NumericArrays.total(data);\n\n/**\n * Returns true if `possibleNumber` is a number and not NaN\n * @param possibleNumber \n * @returns \n */\nexport const isValid = (possibleNumber:number|unknown) => {\n  if (typeof possibleNumber !== `number`) return false;\n  if (Number.isNaN(possibleNumber)) return false;\n  return true;\n}; \n\n/**\n * Alias for [Data.numberTracker](Data.numberTracker.html) \n */\nexport const tracker = (opts?:TrackedValueOpts) => numberTracker(opts);\n\n/**\n * Filters an iterator of values, only yielding\n * those that are valid numbers\n * \n * ```js\n * import * as Numbers from 'https://unpkg.com/ixfx/dist/numbers.js';\n * \n * const data = [true, 10, '5', { x: 5 }];\n * for (const n of Numbers.filter(data)) {\n *  // 5\n * }\n * ```\n * @param it \n */\n//eslint-disable-next-line func-style\nexport function* filter(it:Iterable<unknown>) {\n  for (const v of it) {\n    if (isValid(v)) yield v;\n  }\n}\n\n/**\n * Rounds `v` by `every`. Middle values are rounded up by default.\n * \n * ```js\n * quantiseEvery(11, 10);  // 10\n * quantiseEvery(25, 10);  // 30\n * quantiseEvery(0, 10);   // 0\n * quantiseEvery(4, 10);   // 0\n * quantiseEvery(100, 10); // 100\n * ```\n * \n * @param v \n * @param every \n * @param middleRoundsUp \n * @returns \n */\nexport const quantiseEvery = (v:number, every:number, middleRoundsUp = true) => {\n  // Unit tested!\n  guard(v, ``, `v`);\n  guardInteger(every, ``, `every`);\n\n  //eslint-disable-next-line functional/no-let\n  let div = v / every;\n  const divMod = div % 1;\n  div = Math.floor(div);\n  if (divMod === 0.5 && middleRoundsUp || divMod > 0.5) div++;\n  return every * div;\n};\n\n/**\n * Generates a `step`-length series of values between `start` and `end` (inclusive).\n * Each value will be equally spaced.\n * \n * ```js\n * for (const v of linearSpace(1, 5, 6)) {\n *  // Yields: 1, 2, 3, 4, 5, 6\n * }\n * ```\n * \n * Numbers can be produced from large to small as well\n * ```js\n * const values = [...linearSpace(10, 5, 3)];\n * // Yields: [10, 7.5, 5]\n * ```\n * @param start Start number (inclusive)\n * @param end  End number (inclusive)\n * @param steps How many steps to make from start -> end\n * @param precision Number of decimal points to round to \n */\nexport function* linearSpace(start:number, end:number, steps:number, precision?:number):IterableIterator<number> {\n  guard(start, ``, `start`);\n  guard(end, ``, `end`);\n\n  guard(steps, ``, `steps`);\n\n  const r = precision ? rounder(precision) : (v:number) => v;\n  const step = (end-start) / (steps -1);\n\n  guard(step, ``, `step`);\n  if (!Number.isFinite(step)) throw new Error(`Calculated step value is infinite`);\n\n  //eslint-disable-next-line functional/no-let\n  for (let i=0;i<steps;i++) {\n    const v = (start + (step * i));\n    yield r(v);\n  }\n}\n\n/**\n * Rounds a number to given number of decimal places.\n * \n * If you are reusing the same rounding, consider {@link rounder}.\n * ```js\n * round(10.12345, 2); // 10.12\n * round(10.12345, 1); // 10.1\n * round(10.12345);    // 10         \n * ```\n * @param v \n * @param decimalPlaces \n */\nexport const round = (v:number, decimalPlaces:number = 0) => {\n  guard(v, ``, `v`);\n  return rounder(decimalPlaces)(v);\n};\n\n/**\n * Returns a number rounding function\n * ```js\n * const r = rounder(2);\n * r(10.12355); // 10.12\n * ```\n * @param decimalPlaces\n * @returns \n */\nexport const rounder = (decimalPlaces:number = 0) => {\n  guardInteger(decimalPlaces, `positive`, `decimalPlaces`);\n\n  if (decimalPlaces === 0) return Math.round;\n  const p = Math.pow(10, decimalPlaces);\n\n  return (v:number) => Math.floor(v*p) / p;\n};","import { TrackedValueOpts } from \"./TrackedValue.js\";\n\n/**\n * Base tracker class\n */\nexport abstract class TrackerBase<V> {\n  /**\n   * @ignore\n   */\n  seenCount:number;\n\n  /**\n  * @ignore\n  */\n  protected storeIntermediate:boolean;\n  \n  /**\n  * @ignore\n  */\n  protected resetAfterSamples:number;\n\n  /**\n   * @ignore\n   */\n  protected sampleLimit:number;\n\n  public readonly id:string;\n\n  constructor(opts:TrackedValueOpts = {}) {\n    this.id = opts.id ?? `tracker`;\n    this.sampleLimit = opts.sampleLimit ?? -1;\n    this.resetAfterSamples = opts.resetAfterSamples ?? -1;\n\n    this.storeIntermediate = opts.storeIntermediate ?? (this.sampleLimit>-1 || this.resetAfterSamples > -1);\n    this.seenCount = 0;\n  }\n\n  /**\n   * Reset tracker\n   */\n  reset() {\n    this.seenCount = 0;\n    this.onReset();\n  }\n\n  seen(...p:V[]) {    \n    if (this.resetAfterSamples > 0 && this.seenCount > this.resetAfterSamples) {\n      this.reset();\n    } else if (this.sampleLimit > 0 && this.seenCount > this.sampleLimit * 2) {\n      this.seenCount = this.trimStore(this.sampleLimit);\n      this.onTrimmed();\n    }\n\n    this.seenCount += p.length;\n    const t = this.seenImpl(p);\n    this.onSeen(t);\n  }\n\n  /**\n   * @ignore\n   * @param p \n   */\n  abstract seenImpl(p:V[]):V[];\n\n  abstract get last():V|undefined;\n\n  /**\n   * Returns the initial value, or undefined\n   */\n  abstract get initial():V|undefined;\n\n  /**\n   * Returns the elapsed milliseconds since the initial value\n   */\n  abstract get elapsed():number;\n\n  /**\n   * @ignore\n   */\n  //eslint-disable-next-line @typescript-eslint/no-empty-function\n  onSeen(_p:V[]) {\n  }\n\n  /**\n   * @ignore\n   */\n  abstract onReset():void;\n\n  abstract onTrimmed():void;\n  abstract trimStore(limit:number):number;\n} \n","import { repeat } from \"../flow/index.js\";\nimport { TrackedValueOpts, Timestamped } from \"./TrackedValue.js\";\nimport { TrackerBase } from \"./TrackerBase.js\";\n\nexport class PrimitiveTracker<V extends number|string> extends TrackerBase<V> {\n  values:V[];\n  timestamps:number[];\n\n  constructor(opts?:TrackedValueOpts) {\n    super(opts);\n    this.values = [];\n    this.timestamps = [];\n  }\n\n  /**\n   * Reduces size of value store to `limit`. Returns\n   * number of remaining items\n   * @param limit \n   */\n  trimStore(limit:number):number {\n    if (limit >= this.values.length) return this.values.length;\n    this.values = this.values.slice(-limit);\n    this.timestamps = this.timestamps.slice(-limit);\n    return this.values.length;\n  }\n\n  onTrimmed() {\n    // no-op\n  }\n  \n    \n  get last():V|undefined {\n    return this.values.at(-1);\n  }\n\n  get initial():V|undefined {\n    return this.values.at(0);\n  }\n\n  /**\n * Returns number of recorded values (this can include the initial value)\n */\n  get size() {\n    return this.values.length;\n  }\n  \n  /**\n   * Returns the elapsed time, in milliseconds since the instance was created\n   */\n  get elapsed():number {\n    if (this.values.length < 0) throw new Error(`No values seen yet`);\n    return Date.now() - this.timestamps[0];\n  }\n\n  onReset() {\n    this.values = [];\n    this.timestamps = [];\n  }\n\n  /**\n   * Tracks a value\n   */\n  //eslint-disable-next-line @typescript-eslint/no-explicit-any\n  seenImpl(p:V[]):V[] {\n    const last = p.at(-1) as Timestamped<V>;\n    const now = Date.now();\n    if (this.storeIntermediate) {\n      this.values.push(...p);\n      this.timestamps.push(...repeat(p.length, () => now));\n    } else if (this.values.length === 0) {\n      // Add as initial value\n      this.values.push(last);\n      this.timestamps.push(now);\n    }\n    else if (this.values.length === 2) {\n      // Replace last value\n      this.values[1] = last;\n      this.timestamps[1] = now;\n    } else if (this.values.length === 1) {\n      // Add last value\n      this.values.push(last);\n      this.timestamps.push(now);\n    }\n\n    return p;\n  }\n\n}\n","import { PrimitiveTracker } from \"./PrimitiveTracker.js\";\nimport { TrackedValueOpts as TrackOpts, Timestamped } from \"./TrackedValue.js\";\nimport { minFast, maxFast, totalFast } from \"../collections/NumericArrays.js\";\n\nexport class NumberTracker extends PrimitiveTracker<number> {\n  total = 0;\n  min = Number.MAX_SAFE_INTEGER;\n  max = Number.MIN_SAFE_INTEGER;\n\n  get avg() { \n    return this.total / this.seenCount;\n  }\n\n  /**\n   * Difference between last value and initial.\n   * Eg. if last value was 10 and initial value was 5, 5 is returned (10 - 5)\n   * If either of those is missing, undefined is returned\n   */\n  difference():number|undefined {\n    if (this.last === undefined) return;\n    if (this.initial === undefined) return;\n    return this.last - this.initial;\n  }\n\n  /**\n   * Relative difference between last value and initial.\n   * Eg if last value was 10 and initial value was 5, 2 is returned (200%)\n   */\n  relativeDifference():number|undefined {\n    if (this.last === undefined) return;\n    if (this.initial === undefined) return;\n    return this.last / this.initial;\n  }\n\n  onReset() {\n    this.min = Number.MAX_SAFE_INTEGER;\n    this.max = Number.MIN_SAFE_INTEGER;\n    this.total = 0;\n    super.onReset();\n  }\n\n  onTrimmed() {\n    this.min = minFast(this.values);\n    this.max = maxFast(this.values);\n    this.total = totalFast(this.values);\n  }\n\n  onSeen(values:Timestamped<number>[]) {\n    if (values.some(v => Number.isNaN(v))) throw Error(`Cannot add NaN`);\n    this.total = values.reduce((acc, v) => acc+v, this.total);\n    this.min = Math.min(...values, this.min);\n    this.max = Math.max(...values, this.max);\n  }\n\n  getMinMaxAvg() {\n    return {\n      min: this.min,\n      max: this.max,\n      avg: this.avg,\n    };\n  }\n}\n\n/**\n * Keeps track of the total, min, max and avg in a stream of values. By default values\n * are not stored.\n * \n * Usage:\n * \n * ```js\n * import { numberTracker } from 'https://unpkg.com/ixfx/dist/data.js';\n * \n * const t = numberTracker(); \n * t.seen(10);\n * \n * t.avg / t.min/ t.max\n * t.initial; // initial value\n * t.size;    // number of seen values\n * t.elapsed; // milliseconds since intialisation\n * t.last;    // last value\n * ```\n * \n * To get `{ avg, min, max, total }`\n * ```\n * t.getMinMax()\n * ```\n * \n * Use `t.reset()` to clear everything.\n * \n * Trackers can automatically reset after a given number of samples\n * ```\n * // reset after 100 samples\n * const t = numberTracker({ resetAfterSamples: 100 });\n * ```\n * \n * To store values, use the `storeIntermediate` option:\n * \n * ```js\n * const t = numberTracker({ storeIntermediate: true });\n * ```\n * \n * Difference between last value and initial value:\n * ```js\n * t.relativeDifference();\n * ```\n * \n * Get raw data (if it is being stored):\n * ```js\n * t.values; // array of numbers\n * t.timestampes; // array of millisecond times, indexes correspond to t.values\n * ```\n * @class NumberTracker\n */\nexport const numberTracker = (opts:TrackOpts = {}) => new NumberTracker(opts);\n\n","import { Bezier as BezierLib } from 'bezier-js';\nimport { Paths, Points, Rects, Lines } from './index.js';\n\nexport type QuadraticBezier = {\n  readonly a:Points.Point,\n  readonly b:Points.Point,\n  readonly quadratic:Points.Point\n}\n\nexport type QuadraticBezierPath = Paths.Path & QuadraticBezier;\nexport type CubicBezier = {\n  readonly a:Points.Point,\n  readonly b:Points.Point,\n  readonly cubic1:Points.Point,\n  readonly cubic2:Points.Point,\n}\n\nexport type CubicBezierPath = Paths.Path & CubicBezier;\n\nexport const isQuadraticBezier = (path:Paths.Path | QuadraticBezier | CubicBezier):path is QuadraticBezier => (path as QuadraticBezier).quadratic !== undefined;\nexport const isCubicBezier = (path:Paths.Path | CubicBezier | QuadraticBezier):path is CubicBezier => (path as CubicBezier).cubic1 !== undefined && (path as CubicBezier).cubic2 !== undefined;\n\n/**\n * Returns a new quadratic bezier with specified bend amount\n *\n * @param {QuadraticBezier} b Curve\n * @param {number} [bend=0] Bend amount, from -1 to 1\n * @returns {QuadraticBezier}\n */\nexport const quadraticBend = (a:Points.Point, b:Points.Point, bend = 0):QuadraticBezier => quadraticSimple(a, b, bend);\n\n/**\n * Creates a simple quadratic bezier with a specified amount of 'bend'.\n * Bend of -1 will pull curve down, 1 will pull curve up. 0 is no curve\n * @param {Points.Point} start Start of curve\n * @param {Points.Point} end End of curve\n * @param {number} [bend=0] Bend amount, -1 to 1\n * @returns {QuadraticBezier}\n */\nexport const quadraticSimple = (start:Points.Point, end:Points.Point, bend = 0):QuadraticBezier => {\n  if (isNaN(bend)) throw Error(`bend is NaN`);\n  if (bend < -1 || bend > 1) throw Error(`Expects bend range of -1 to 1`);\n\n  const middle = Lines.interpolate(0.5, start, end);\n  // eslint-disable-next-line functional/no-let\n  let target = middle;\n  if (end.y < start.y) {\n    // Upward slope\n    target = bend > 0 ? { x: Math.min(start.x, end.x), y: Math.min(start.y, end.y) } :\n      { x: Math.max(start.x, end.x), y: Math.max(start.y, end.y) };\n  } else {\n    // Downward slope\n    target = bend > 0 ? { x: Math.max(start.x, end.x), y: Math.min(start.y, end.y) } :\n      { x: Math.min(start.x, end.x), y: Math.max(start.y, end.y) };\n  }\n\n  const handle = Lines.interpolate(Math.abs(bend), middle, target,);\n  return quadratic(start, end, handle);\n};\n\n/**\n * Returns a relative point on a simple quadratic \n * @param start Start\n * @param end  End\n * @param bend Bend (-1 to 1)\n * @param amt Amount\n * @returns Point\n */\nexport const computeQuadraticSimple = (start:Points.Point, end:Points.Point, bend:number, amt:number):Points.Point => {\n  const q = quadraticSimple(start, end, bend);\n  const bzr = new BezierLib(q.a, q.quadratic, q.b);\n  return bzr.compute(amt);\n};\n\n//https://developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Paths\nexport const quadraticToSvgString = (start:Points.Point, end:Points.Point, handle:Points.Point):readonly string[] => [`M ${start.x} ${start.y} Q ${handle.x} ${handle.y} ${end.x} ${end.y}`];\n\nexport const toPath = (cubicOrQuadratic:CubicBezier|QuadraticBezier):CubicBezierPath|QuadraticBezierPath => {\n  if (isCubicBezier(cubicOrQuadratic)) {\n    return cubicToPath(cubicOrQuadratic);\n  } else if (isQuadraticBezier(cubicOrQuadratic)) {\n    return quadratictoPath(cubicOrQuadratic);\n  } else {\n    throw new Error(`Unknown bezier type`);\n  }\n};\n\nexport const cubic = (start:Points.Point, end:Points.Point, cubic1:Points.Point, cubic2:Points.Point):CubicBezier => (\n  {\n    a: Object.freeze(start),\n    b: Object.freeze(end),\n    cubic1: Object.freeze(cubic1),\n    cubic2: Object.freeze(cubic2) \n  });\n\nconst cubicToPath = (cubic:CubicBezier):CubicBezierPath => {\n  const { a, cubic1, cubic2, b } = cubic;\n\n  const bzr = new BezierLib(a, cubic1, cubic2, b);\n  return Object.freeze({\n    ...cubic,\n    length: () => bzr.length(),\n    interpolate: (t:number) => bzr.compute(t),\n    nearest: (_:Points.Point) => { throw new Error(`not implemented`); },\n    bbox: () => {\n      const { x, y } = bzr.bbox();\n      const xSize = x.size;\n      const ySize = y.size;\n      if (xSize === undefined) throw new Error(`x.size not present on calculated bbox`);\n      if (ySize === undefined) throw new Error(`x.size not present on calculated bbox`);\n\n      return Rects.fromTopLeft({ x: x.min, y: y.min }, xSize, ySize);\n    },\n    toString: () => bzr.toString(),\n    toSvgString: () => [`brrup`],\n    kind: `bezier/cubic`\n  });\n};\n\nexport const quadratic = (start:Points.Point, end:Points.Point, handle:Points.Point):QuadraticBezier => ({\n  a: Object.freeze(start),\n  b: Object.freeze(end),\n  quadratic: Object.freeze(handle)\n});\n\n\nconst quadratictoPath = (quadraticBezier:QuadraticBezier):QuadraticBezierPath => {\n  const { a, b, quadratic } = quadraticBezier;\n  const bzr = new BezierLib(a, quadratic, b);\n  return Object.freeze({\n    ...quadraticBezier,\n    length: () => bzr.length(),\n    interpolate: (t:number) => bzr.compute(t),\n    nearest: (_:Points.Point) => { throw new Error(`not implemented`); },\n    bbox: () => {\n      const { x, y } = bzr.bbox();\n      const xSize = x.size;\n      const ySize = y.size;\n      if (xSize === undefined) throw new Error(`x.size not present on calculated bbox`);\n      if (ySize === undefined) throw new Error(`x.size not present on calculated bbox`);\n      return Rects.fromTopLeft({ x: x.min, y: y.min }, xSize, ySize);\n    },\n    toString: () => bzr.toString(),\n    toSvgString: () => quadraticToSvgString(a, b, quadratic),\n    kind: `bezier/quadratic`\n  });\n};\n\n","import { Bezier } from \"./bezier.js\";\n\n// math-inlining.\nconst { abs, cos, sin, acos, atan2, sqrt, pow } = Math;\n\n// cube root function yielding real roots\nfunction crt(v) {\n  return v < 0 ? -pow(-v, 1 / 3) : pow(v, 1 / 3);\n}\n\n// trig constants\nconst pi = Math.PI,\n  tau = 2 * pi,\n  quart = pi / 2,\n  // float precision significant decimal\n  epsilon = 0.000001,\n  // extremas used in bbox calculation and similar algorithms\n  nMax = Number.MAX_SAFE_INTEGER || 9007199254740991,\n  nMin = Number.MIN_SAFE_INTEGER || -9007199254740991,\n  // a zero coordinate, which is surprisingly useful\n  ZERO = { x: 0, y: 0, z: 0 };\n\n// Bezier utility functions\nconst utils = {\n  // Legendre-Gauss abscissae with n=24 (x_i values, defined at i=n as the roots of the nth order Legendre polynomial Pn(x))\n  Tvalues: [\n    -0.0640568928626056260850430826247450385909,\n    0.0640568928626056260850430826247450385909,\n    -0.1911188674736163091586398207570696318404,\n    0.1911188674736163091586398207570696318404,\n    -0.3150426796961633743867932913198102407864,\n    0.3150426796961633743867932913198102407864,\n    -0.4337935076260451384870842319133497124524,\n    0.4337935076260451384870842319133497124524,\n    -0.5454214713888395356583756172183723700107,\n    0.5454214713888395356583756172183723700107,\n    -0.6480936519369755692524957869107476266696,\n    0.6480936519369755692524957869107476266696,\n    -0.7401241915785543642438281030999784255232,\n    0.7401241915785543642438281030999784255232,\n    -0.8200019859739029219539498726697452080761,\n    0.8200019859739029219539498726697452080761,\n    -0.8864155270044010342131543419821967550873,\n    0.8864155270044010342131543419821967550873,\n    -0.9382745520027327585236490017087214496548,\n    0.9382745520027327585236490017087214496548,\n    -0.9747285559713094981983919930081690617411,\n    0.9747285559713094981983919930081690617411,\n    -0.9951872199970213601799974097007368118745,\n    0.9951872199970213601799974097007368118745,\n  ],\n\n  // Legendre-Gauss weights with n=24 (w_i values, defined by a function linked to in the Bezier primer article)\n  Cvalues: [\n    0.1279381953467521569740561652246953718517,\n    0.1279381953467521569740561652246953718517,\n    0.1258374563468282961213753825111836887264,\n    0.1258374563468282961213753825111836887264,\n    0.121670472927803391204463153476262425607,\n    0.121670472927803391204463153476262425607,\n    0.1155056680537256013533444839067835598622,\n    0.1155056680537256013533444839067835598622,\n    0.1074442701159656347825773424466062227946,\n    0.1074442701159656347825773424466062227946,\n    0.0976186521041138882698806644642471544279,\n    0.0976186521041138882698806644642471544279,\n    0.086190161531953275917185202983742667185,\n    0.086190161531953275917185202983742667185,\n    0.0733464814110803057340336152531165181193,\n    0.0733464814110803057340336152531165181193,\n    0.0592985849154367807463677585001085845412,\n    0.0592985849154367807463677585001085845412,\n    0.0442774388174198061686027482113382288593,\n    0.0442774388174198061686027482113382288593,\n    0.0285313886289336631813078159518782864491,\n    0.0285313886289336631813078159518782864491,\n    0.0123412297999871995468056670700372915759,\n    0.0123412297999871995468056670700372915759,\n  ],\n\n  arcfn: function (t, derivativeFn) {\n    const d = derivativeFn(t);\n    let l = d.x * d.x + d.y * d.y;\n    if (typeof d.z !== \"undefined\") {\n      l += d.z * d.z;\n    }\n    return sqrt(l);\n  },\n\n  compute: function (t, points, _3d) {\n    // shortcuts\n    if (t === 0) {\n      points[0].t = 0;\n      return points[0];\n    }\n\n    const order = points.length - 1;\n\n    if (t === 1) {\n      points[order].t = 1;\n      return points[order];\n    }\n\n    const mt = 1 - t;\n    let p = points;\n\n    // constant?\n    if (order === 0) {\n      points[0].t = t;\n      return points[0];\n    }\n\n    // linear?\n    if (order === 1) {\n      const ret = {\n        x: mt * p[0].x + t * p[1].x,\n        y: mt * p[0].y + t * p[1].y,\n        t: t,\n      };\n      if (_3d) {\n        ret.z = mt * p[0].z + t * p[1].z;\n      }\n      return ret;\n    }\n\n    // quadratic/cubic curve?\n    if (order < 4) {\n      let mt2 = mt * mt,\n        t2 = t * t,\n        a,\n        b,\n        c,\n        d = 0;\n      if (order === 2) {\n        p = [p[0], p[1], p[2], ZERO];\n        a = mt2;\n        b = mt * t * 2;\n        c = t2;\n      } else if (order === 3) {\n        a = mt2 * mt;\n        b = mt2 * t * 3;\n        c = mt * t2 * 3;\n        d = t * t2;\n      }\n      const ret = {\n        x: a * p[0].x + b * p[1].x + c * p[2].x + d * p[3].x,\n        y: a * p[0].y + b * p[1].y + c * p[2].y + d * p[3].y,\n        t: t,\n      };\n      if (_3d) {\n        ret.z = a * p[0].z + b * p[1].z + c * p[2].z + d * p[3].z;\n      }\n      return ret;\n    }\n\n    // higher order curves: use de Casteljau's computation\n    const dCpts = JSON.parse(JSON.stringify(points));\n    while (dCpts.length > 1) {\n      for (let i = 0; i < dCpts.length - 1; i++) {\n        dCpts[i] = {\n          x: dCpts[i].x + (dCpts[i + 1].x - dCpts[i].x) * t,\n          y: dCpts[i].y + (dCpts[i + 1].y - dCpts[i].y) * t,\n        };\n        if (typeof dCpts[i].z !== \"undefined\") {\n          dCpts[i] = dCpts[i].z + (dCpts[i + 1].z - dCpts[i].z) * t;\n        }\n      }\n      dCpts.splice(dCpts.length - 1, 1);\n    }\n    dCpts[0].t = t;\n    return dCpts[0];\n  },\n\n  computeWithRatios: function (t, points, ratios, _3d) {\n    const mt = 1 - t,\n      r = ratios,\n      p = points;\n\n    let f1 = r[0],\n      f2 = r[1],\n      f3 = r[2],\n      f4 = r[3],\n      d;\n\n    // spec for linear\n    f1 *= mt;\n    f2 *= t;\n\n    if (p.length === 2) {\n      d = f1 + f2;\n      return {\n        x: (f1 * p[0].x + f2 * p[1].x) / d,\n        y: (f1 * p[0].y + f2 * p[1].y) / d,\n        z: !_3d ? false : (f1 * p[0].z + f2 * p[1].z) / d,\n        t: t,\n      };\n    }\n\n    // upgrade to quadratic\n    f1 *= mt;\n    f2 *= 2 * mt;\n    f3 *= t * t;\n\n    if (p.length === 3) {\n      d = f1 + f2 + f3;\n      return {\n        x: (f1 * p[0].x + f2 * p[1].x + f3 * p[2].x) / d,\n        y: (f1 * p[0].y + f2 * p[1].y + f3 * p[2].y) / d,\n        z: !_3d ? false : (f1 * p[0].z + f2 * p[1].z + f3 * p[2].z) / d,\n        t: t,\n      };\n    }\n\n    // upgrade to cubic\n    f1 *= mt;\n    f2 *= 1.5 * mt;\n    f3 *= 3 * mt;\n    f4 *= t * t * t;\n\n    if (p.length === 4) {\n      d = f1 + f2 + f3 + f4;\n      return {\n        x: (f1 * p[0].x + f2 * p[1].x + f3 * p[2].x + f4 * p[3].x) / d,\n        y: (f1 * p[0].y + f2 * p[1].y + f3 * p[2].y + f4 * p[3].y) / d,\n        z: !_3d\n          ? false\n          : (f1 * p[0].z + f2 * p[1].z + f3 * p[2].z + f4 * p[3].z) / d,\n        t: t,\n      };\n    }\n  },\n\n  derive: function (points, _3d) {\n    const dpoints = [];\n    for (let p = points, d = p.length, c = d - 1; d > 1; d--, c--) {\n      const list = [];\n      for (let j = 0, dpt; j < c; j++) {\n        dpt = {\n          x: c * (p[j + 1].x - p[j].x),\n          y: c * (p[j + 1].y - p[j].y),\n        };\n        if (_3d) {\n          dpt.z = c * (p[j + 1].z - p[j].z);\n        }\n        list.push(dpt);\n      }\n      dpoints.push(list);\n      p = list;\n    }\n    return dpoints;\n  },\n\n  between: function (v, m, M) {\n    return (\n      (m <= v && v <= M) ||\n      utils.approximately(v, m) ||\n      utils.approximately(v, M)\n    );\n  },\n\n  approximately: function (a, b, precision) {\n    return abs(a - b) <= (precision || epsilon);\n  },\n\n  length: function (derivativeFn) {\n    const z = 0.5,\n      len = utils.Tvalues.length;\n\n    let sum = 0;\n\n    for (let i = 0, t; i < len; i++) {\n      t = z * utils.Tvalues[i] + z;\n      sum += utils.Cvalues[i] * utils.arcfn(t, derivativeFn);\n    }\n    return z * sum;\n  },\n\n  map: function (v, ds, de, ts, te) {\n    const d1 = de - ds,\n      d2 = te - ts,\n      v2 = v - ds,\n      r = v2 / d1;\n    return ts + d2 * r;\n  },\n\n  lerp: function (r, v1, v2) {\n    const ret = {\n      x: v1.x + r * (v2.x - v1.x),\n      y: v1.y + r * (v2.y - v1.y),\n    };\n    if (v1.z !== undefined && v2.z !== undefined) {\n      ret.z = v1.z + r * (v2.z - v1.z);\n    }\n    return ret;\n  },\n\n  pointToString: function (p) {\n    let s = p.x + \"/\" + p.y;\n    if (typeof p.z !== \"undefined\") {\n      s += \"/\" + p.z;\n    }\n    return s;\n  },\n\n  pointsToString: function (points) {\n    return \"[\" + points.map(utils.pointToString).join(\", \") + \"]\";\n  },\n\n  copy: function (obj) {\n    return JSON.parse(JSON.stringify(obj));\n  },\n\n  angle: function (o, v1, v2) {\n    const dx1 = v1.x - o.x,\n      dy1 = v1.y - o.y,\n      dx2 = v2.x - o.x,\n      dy2 = v2.y - o.y,\n      cross = dx1 * dy2 - dy1 * dx2,\n      dot = dx1 * dx2 + dy1 * dy2;\n    return atan2(cross, dot);\n  },\n\n  // round as string, to avoid rounding errors\n  round: function (v, d) {\n    const s = \"\" + v;\n    const pos = s.indexOf(\".\");\n    return parseFloat(s.substring(0, pos + 1 + d));\n  },\n\n  dist: function (p1, p2) {\n    const dx = p1.x - p2.x,\n      dy = p1.y - p2.y;\n    return sqrt(dx * dx + dy * dy);\n  },\n\n  closest: function (LUT, point) {\n    let mdist = pow(2, 63),\n      mpos,\n      d;\n    LUT.forEach(function (p, idx) {\n      d = utils.dist(point, p);\n      if (d < mdist) {\n        mdist = d;\n        mpos = idx;\n      }\n    });\n    return { mdist: mdist, mpos: mpos };\n  },\n\n  abcratio: function (t, n) {\n    // see ratio(t) note on http://pomax.github.io/bezierinfo/#abc\n    if (n !== 2 && n !== 3) {\n      return false;\n    }\n    if (typeof t === \"undefined\") {\n      t = 0.5;\n    } else if (t === 0 || t === 1) {\n      return t;\n    }\n    const bottom = pow(t, n) + pow(1 - t, n),\n      top = bottom - 1;\n    return abs(top / bottom);\n  },\n\n  projectionratio: function (t, n) {\n    // see u(t) note on http://pomax.github.io/bezierinfo/#abc\n    if (n !== 2 && n !== 3) {\n      return false;\n    }\n    if (typeof t === \"undefined\") {\n      t = 0.5;\n    } else if (t === 0 || t === 1) {\n      return t;\n    }\n    const top = pow(1 - t, n),\n      bottom = pow(t, n) + top;\n    return top / bottom;\n  },\n\n  lli8: function (x1, y1, x2, y2, x3, y3, x4, y4) {\n    const nx =\n        (x1 * y2 - y1 * x2) * (x3 - x4) - (x1 - x2) * (x3 * y4 - y3 * x4),\n      ny = (x1 * y2 - y1 * x2) * (y3 - y4) - (y1 - y2) * (x3 * y4 - y3 * x4),\n      d = (x1 - x2) * (y3 - y4) - (y1 - y2) * (x3 - x4);\n    if (d == 0) {\n      return false;\n    }\n    return { x: nx / d, y: ny / d };\n  },\n\n  lli4: function (p1, p2, p3, p4) {\n    const x1 = p1.x,\n      y1 = p1.y,\n      x2 = p2.x,\n      y2 = p2.y,\n      x3 = p3.x,\n      y3 = p3.y,\n      x4 = p4.x,\n      y4 = p4.y;\n    return utils.lli8(x1, y1, x2, y2, x3, y3, x4, y4);\n  },\n\n  lli: function (v1, v2) {\n    return utils.lli4(v1, v1.c, v2, v2.c);\n  },\n\n  makeline: function (p1, p2) {\n    return new Bezier(\n      p1.x,\n      p1.y,\n      (p1.x + p2.x) / 2,\n      (p1.y + p2.y) / 2,\n      p2.x,\n      p2.y\n    );\n  },\n\n  findbbox: function (sections) {\n    let mx = nMax,\n      my = nMax,\n      MX = nMin,\n      MY = nMin;\n    sections.forEach(function (s) {\n      const bbox = s.bbox();\n      if (mx > bbox.x.min) mx = bbox.x.min;\n      if (my > bbox.y.min) my = bbox.y.min;\n      if (MX < bbox.x.max) MX = bbox.x.max;\n      if (MY < bbox.y.max) MY = bbox.y.max;\n    });\n    return {\n      x: { min: mx, mid: (mx + MX) / 2, max: MX, size: MX - mx },\n      y: { min: my, mid: (my + MY) / 2, max: MY, size: MY - my },\n    };\n  },\n\n  shapeintersections: function (\n    s1,\n    bbox1,\n    s2,\n    bbox2,\n    curveIntersectionThreshold\n  ) {\n    if (!utils.bboxoverlap(bbox1, bbox2)) return [];\n    const intersections = [];\n    const a1 = [s1.startcap, s1.forward, s1.back, s1.endcap];\n    const a2 = [s2.startcap, s2.forward, s2.back, s2.endcap];\n    a1.forEach(function (l1) {\n      if (l1.virtual) return;\n      a2.forEach(function (l2) {\n        if (l2.virtual) return;\n        const iss = l1.intersects(l2, curveIntersectionThreshold);\n        if (iss.length > 0) {\n          iss.c1 = l1;\n          iss.c2 = l2;\n          iss.s1 = s1;\n          iss.s2 = s2;\n          intersections.push(iss);\n        }\n      });\n    });\n    return intersections;\n  },\n\n  makeshape: function (forward, back, curveIntersectionThreshold) {\n    const bpl = back.points.length;\n    const fpl = forward.points.length;\n    const start = utils.makeline(back.points[bpl - 1], forward.points[0]);\n    const end = utils.makeline(forward.points[fpl - 1], back.points[0]);\n    const shape = {\n      startcap: start,\n      forward: forward,\n      back: back,\n      endcap: end,\n      bbox: utils.findbbox([start, forward, back, end]),\n    };\n    shape.intersections = function (s2) {\n      return utils.shapeintersections(\n        shape,\n        shape.bbox,\n        s2,\n        s2.bbox,\n        curveIntersectionThreshold\n      );\n    };\n    return shape;\n  },\n\n  getminmax: function (curve, d, list) {\n    if (!list) return { min: 0, max: 0 };\n    let min = nMax,\n      max = nMin,\n      t,\n      c;\n    if (list.indexOf(0) === -1) {\n      list = [0].concat(list);\n    }\n    if (list.indexOf(1) === -1) {\n      list.push(1);\n    }\n    for (let i = 0, len = list.length; i < len; i++) {\n      t = list[i];\n      c = curve.get(t);\n      if (c[d] < min) {\n        min = c[d];\n      }\n      if (c[d] > max) {\n        max = c[d];\n      }\n    }\n    return { min: min, mid: (min + max) / 2, max: max, size: max - min };\n  },\n\n  align: function (points, line) {\n    const tx = line.p1.x,\n      ty = line.p1.y,\n      a = -atan2(line.p2.y - ty, line.p2.x - tx),\n      d = function (v) {\n        return {\n          x: (v.x - tx) * cos(a) - (v.y - ty) * sin(a),\n          y: (v.x - tx) * sin(a) + (v.y - ty) * cos(a),\n        };\n      };\n    return points.map(d);\n  },\n\n  roots: function (points, line) {\n    line = line || { p1: { x: 0, y: 0 }, p2: { x: 1, y: 0 } };\n\n    const order = points.length - 1;\n    const aligned = utils.align(points, line);\n    const reduce = function (t) {\n      return 0 <= t && t <= 1;\n    };\n\n    if (order === 2) {\n      const a = aligned[0].y,\n        b = aligned[1].y,\n        c = aligned[2].y,\n        d = a - 2 * b + c;\n      if (d !== 0) {\n        const m1 = -sqrt(b * b - a * c),\n          m2 = -a + b,\n          v1 = -(m1 + m2) / d,\n          v2 = -(-m1 + m2) / d;\n        return [v1, v2].filter(reduce);\n      } else if (b !== c && d === 0) {\n        return [(2 * b - c) / (2 * b - 2 * c)].filter(reduce);\n      }\n      return [];\n    }\n\n    // see http://www.trans4mind.com/personal_development/mathematics/polynomials/cubicAlgebra.htm\n    const pa = aligned[0].y,\n      pb = aligned[1].y,\n      pc = aligned[2].y,\n      pd = aligned[3].y;\n\n    let d = -pa + 3 * pb - 3 * pc + pd,\n      a = 3 * pa - 6 * pb + 3 * pc,\n      b = -3 * pa + 3 * pb,\n      c = pa;\n\n    if (utils.approximately(d, 0)) {\n      // this is not a cubic curve.\n      if (utils.approximately(a, 0)) {\n        // in fact, this is not a quadratic curve either.\n        if (utils.approximately(b, 0)) {\n          // in fact in fact, there are no solutions.\n          return [];\n        }\n        // linear solution:\n        return [-c / b].filter(reduce);\n      }\n      // quadratic solution:\n      const q = sqrt(b * b - 4 * a * c),\n        a2 = 2 * a;\n      return [(q - b) / a2, (-b - q) / a2].filter(reduce);\n    }\n\n    // at this point, we know we need a cubic solution:\n\n    a /= d;\n    b /= d;\n    c /= d;\n\n    const p = (3 * b - a * a) / 3,\n      p3 = p / 3,\n      q = (2 * a * a * a - 9 * a * b + 27 * c) / 27,\n      q2 = q / 2,\n      discriminant = q2 * q2 + p3 * p3 * p3;\n\n    let u1, v1, x1, x2, x3;\n    if (discriminant < 0) {\n      const mp3 = -p / 3,\n        mp33 = mp3 * mp3 * mp3,\n        r = sqrt(mp33),\n        t = -q / (2 * r),\n        cosphi = t < -1 ? -1 : t > 1 ? 1 : t,\n        phi = acos(cosphi),\n        crtr = crt(r),\n        t1 = 2 * crtr;\n      x1 = t1 * cos(phi / 3) - a / 3;\n      x2 = t1 * cos((phi + tau) / 3) - a / 3;\n      x3 = t1 * cos((phi + 2 * tau) / 3) - a / 3;\n      return [x1, x2, x3].filter(reduce);\n    } else if (discriminant === 0) {\n      u1 = q2 < 0 ? crt(-q2) : -crt(q2);\n      x1 = 2 * u1 - a / 3;\n      x2 = -u1 - a / 3;\n      return [x1, x2].filter(reduce);\n    } else {\n      const sd = sqrt(discriminant);\n      u1 = crt(-q2 + sd);\n      v1 = crt(q2 + sd);\n      return [u1 - v1 - a / 3].filter(reduce);\n    }\n  },\n\n  droots: function (p) {\n    // quadratic roots are easy\n    if (p.length === 3) {\n      const a = p[0],\n        b = p[1],\n        c = p[2],\n        d = a - 2 * b + c;\n      if (d !== 0) {\n        const m1 = -sqrt(b * b - a * c),\n          m2 = -a + b,\n          v1 = -(m1 + m2) / d,\n          v2 = -(-m1 + m2) / d;\n        return [v1, v2];\n      } else if (b !== c && d === 0) {\n        return [(2 * b - c) / (2 * (b - c))];\n      }\n      return [];\n    }\n\n    // linear roots are even easier\n    if (p.length === 2) {\n      const a = p[0],\n        b = p[1];\n      if (a !== b) {\n        return [a / (a - b)];\n      }\n      return [];\n    }\n\n    return [];\n  },\n\n  curvature: function (t, d1, d2, _3d, kOnly) {\n    let num,\n      dnm,\n      adk,\n      dk,\n      k = 0,\n      r = 0;\n\n    //\n    // We're using the following formula for curvature:\n    //\n    //              x'y\" - y'x\"\n    //   k(t) = ------------------\n    //           (x' + y')^(3/2)\n    //\n    // from https://en.wikipedia.org/wiki/Radius_of_curvature#Definition\n    //\n    // With it corresponding 3D counterpart:\n    //\n    //          sqrt( (y'z\" - y\"z') + (z'x\" - z\"x') + (x'y\" - x\"y'))\n    //   k(t) = -------------------------------------------------------\n    //                     (x' + y' + z')^(3/2)\n    //\n\n    const d = utils.compute(t, d1);\n    const dd = utils.compute(t, d2);\n    const qdsum = d.x * d.x + d.y * d.y;\n\n    if (_3d) {\n      num = sqrt(\n        pow(d.y * dd.z - dd.y * d.z, 2) +\n          pow(d.z * dd.x - dd.z * d.x, 2) +\n          pow(d.x * dd.y - dd.x * d.y, 2)\n      );\n      dnm = pow(qdsum + d.z * d.z, 3 / 2);\n    } else {\n      num = d.x * dd.y - d.y * dd.x;\n      dnm = pow(qdsum, 3 / 2);\n    }\n\n    if (num === 0 || dnm === 0) {\n      return { k: 0, r: 0 };\n    }\n\n    k = num / dnm;\n    r = dnm / num;\n\n    // We're also computing the derivative of kappa, because\n    // there is value in knowing the rate of change for the\n    // curvature along the curve. And we're just going to\n    // ballpark it based on an epsilon.\n    if (!kOnly) {\n      // compute k'(t) based on the interval before, and after it,\n      // to at least try to not introduce forward/backward pass bias.\n      const pk = utils.curvature(t - 0.001, d1, d2, _3d, true).k;\n      const nk = utils.curvature(t + 0.001, d1, d2, _3d, true).k;\n      dk = (nk - k + (k - pk)) / 2;\n      adk = (abs(nk - k) + abs(k - pk)) / 2;\n    }\n\n    return { k: k, r: r, dk: dk, adk: adk };\n  },\n\n  inflections: function (points) {\n    if (points.length < 4) return [];\n\n    // FIXME: TODO: add in inflection abstraction for quartic+ curves?\n\n    const p = utils.align(points, { p1: points[0], p2: points.slice(-1)[0] }),\n      a = p[2].x * p[1].y,\n      b = p[3].x * p[1].y,\n      c = p[1].x * p[2].y,\n      d = p[3].x * p[2].y,\n      v1 = 18 * (-3 * a + 2 * b + 3 * c - d),\n      v2 = 18 * (3 * a - b - 3 * c),\n      v3 = 18 * (c - a);\n\n    if (utils.approximately(v1, 0)) {\n      if (!utils.approximately(v2, 0)) {\n        let t = -v3 / v2;\n        if (0 <= t && t <= 1) return [t];\n      }\n      return [];\n    }\n\n    const d2 = 2 * v1;\n\n    if (utils.approximately(d2, 0)) return [];\n\n    const trm = v2 * v2 - 4 * v1 * v3;\n\n    if (trm < 0) return [];\n\n    const sq = Math.sqrt(trm);\n\n    return [(sq - v2) / d2, -(v2 + sq) / d2].filter(function (r) {\n      return 0 <= r && r <= 1;\n    });\n  },\n\n  bboxoverlap: function (b1, b2) {\n    const dims = [\"x\", \"y\"],\n      len = dims.length;\n\n    for (let i = 0, dim, l, t, d; i < len; i++) {\n      dim = dims[i];\n      l = b1[dim].mid;\n      t = b2[dim].mid;\n      d = (b1[dim].size + b2[dim].size) / 2;\n      if (abs(l - t) >= d) return false;\n    }\n    return true;\n  },\n\n  expandbox: function (bbox, _bbox) {\n    if (_bbox.x.min < bbox.x.min) {\n      bbox.x.min = _bbox.x.min;\n    }\n    if (_bbox.y.min < bbox.y.min) {\n      bbox.y.min = _bbox.y.min;\n    }\n    if (_bbox.z && _bbox.z.min < bbox.z.min) {\n      bbox.z.min = _bbox.z.min;\n    }\n    if (_bbox.x.max > bbox.x.max) {\n      bbox.x.max = _bbox.x.max;\n    }\n    if (_bbox.y.max > bbox.y.max) {\n      bbox.y.max = _bbox.y.max;\n    }\n    if (_bbox.z && _bbox.z.max > bbox.z.max) {\n      bbox.z.max = _bbox.z.max;\n    }\n    bbox.x.mid = (bbox.x.min + bbox.x.max) / 2;\n    bbox.y.mid = (bbox.y.min + bbox.y.max) / 2;\n    if (bbox.z) {\n      bbox.z.mid = (bbox.z.min + bbox.z.max) / 2;\n    }\n    bbox.x.size = bbox.x.max - bbox.x.min;\n    bbox.y.size = bbox.y.max - bbox.y.min;\n    if (bbox.z) {\n      bbox.z.size = bbox.z.max - bbox.z.min;\n    }\n  },\n\n  pairiteration: function (c1, c2, curveIntersectionThreshold) {\n    const c1b = c1.bbox(),\n      c2b = c2.bbox(),\n      r = 100000,\n      threshold = curveIntersectionThreshold || 0.5;\n\n    if (\n      c1b.x.size + c1b.y.size < threshold &&\n      c2b.x.size + c2b.y.size < threshold\n    ) {\n      return [\n        (((r * (c1._t1 + c1._t2)) / 2) | 0) / r +\n          \"/\" +\n          (((r * (c2._t1 + c2._t2)) / 2) | 0) / r,\n      ];\n    }\n\n    let cc1 = c1.split(0.5),\n      cc2 = c2.split(0.5),\n      pairs = [\n        { left: cc1.left, right: cc2.left },\n        { left: cc1.left, right: cc2.right },\n        { left: cc1.right, right: cc2.right },\n        { left: cc1.right, right: cc2.left },\n      ];\n\n    pairs = pairs.filter(function (pair) {\n      return utils.bboxoverlap(pair.left.bbox(), pair.right.bbox());\n    });\n\n    let results = [];\n\n    if (pairs.length === 0) return results;\n\n    pairs.forEach(function (pair) {\n      results = results.concat(\n        utils.pairiteration(pair.left, pair.right, threshold)\n      );\n    });\n\n    results = results.filter(function (v, i) {\n      return results.indexOf(v) === i;\n    });\n\n    return results;\n  },\n\n  getccenter: function (p1, p2, p3) {\n    const dx1 = p2.x - p1.x,\n      dy1 = p2.y - p1.y,\n      dx2 = p3.x - p2.x,\n      dy2 = p3.y - p2.y,\n      dx1p = dx1 * cos(quart) - dy1 * sin(quart),\n      dy1p = dx1 * sin(quart) + dy1 * cos(quart),\n      dx2p = dx2 * cos(quart) - dy2 * sin(quart),\n      dy2p = dx2 * sin(quart) + dy2 * cos(quart),\n      // chord midpoints\n      mx1 = (p1.x + p2.x) / 2,\n      my1 = (p1.y + p2.y) / 2,\n      mx2 = (p2.x + p3.x) / 2,\n      my2 = (p2.y + p3.y) / 2,\n      // midpoint offsets\n      mx1n = mx1 + dx1p,\n      my1n = my1 + dy1p,\n      mx2n = mx2 + dx2p,\n      my2n = my2 + dy2p,\n      // intersection of these lines:\n      arc = utils.lli8(mx1, my1, mx1n, my1n, mx2, my2, mx2n, my2n),\n      r = utils.dist(arc, p1);\n\n    // arc start/end values, over mid point:\n    let s = atan2(p1.y - arc.y, p1.x - arc.x),\n      m = atan2(p2.y - arc.y, p2.x - arc.x),\n      e = atan2(p3.y - arc.y, p3.x - arc.x),\n      _;\n\n    // determine arc direction (cw/ccw correction)\n    if (s < e) {\n      // if s<m<e, arc(s, e)\n      // if m<s<e, arc(e, s + tau)\n      // if s<e<m, arc(e, s + tau)\n      if (s > m || m > e) {\n        s += tau;\n      }\n      if (s > e) {\n        _ = e;\n        e = s;\n        s = _;\n      }\n    } else {\n      // if e<m<s, arc(e, s)\n      // if m<e<s, arc(s, e + tau)\n      // if e<s<m, arc(s, e + tau)\n      if (e < m && m < s) {\n        _ = e;\n        e = s;\n        s = _;\n      } else {\n        e += tau;\n      }\n    }\n    // assign and done.\n    arc.s = s;\n    arc.e = e;\n    arc.r = r;\n    return arc;\n  },\n\n  numberSort: function (a, b) {\n    return a - b;\n  },\n};\n\nexport { utils };\n","import { utils } from \"./utils.js\";\n\n/**\n * Poly Bezier\n * @param {[type]} curves [description]\n */\nclass PolyBezier {\n  constructor(curves) {\n    this.curves = [];\n    this._3d = false;\n    if (!!curves) {\n      this.curves = curves;\n      this._3d = this.curves[0]._3d;\n    }\n  }\n\n  valueOf() {\n    return this.toString();\n  }\n\n  toString() {\n    return (\n      \"[\" +\n      this.curves\n        .map(function (curve) {\n          return utils.pointsToString(curve.points);\n        })\n        .join(\", \") +\n      \"]\"\n    );\n  }\n\n  addCurve(curve) {\n    this.curves.push(curve);\n    this._3d = this._3d || curve._3d;\n  }\n\n  length() {\n    return this.curves\n      .map(function (v) {\n        return v.length();\n      })\n      .reduce(function (a, b) {\n        return a + b;\n      });\n  }\n\n  curve(idx) {\n    return this.curves[idx];\n  }\n\n  bbox() {\n    const c = this.curves;\n    var bbox = c[0].bbox();\n    for (var i = 1; i < c.length; i++) {\n      utils.expandbox(bbox, c[i].bbox());\n    }\n    return bbox;\n  }\n\n  offset(d) {\n    const offset = [];\n    this.curves.forEach(function (v) {\n      offset.push(...v.offset(d));\n    });\n    return new PolyBezier(offset);\n  }\n}\n\nexport { PolyBezier };\n","/**\n  A javascript Bezier curve library by Pomax.\n\n  Based on http://pomax.github.io/bezierinfo\n\n  This code is MIT licensed.\n**/\n\nimport { utils } from \"./utils.js\";\nimport { PolyBezier } from \"./poly-bezier.js\";\n\n// math-inlining.\nconst { abs, min, max, cos, sin, acos, sqrt } = Math;\nconst pi = Math.PI;\n// a zero coordinate, which is surprisingly useful\nconst ZERO = { x: 0, y: 0, z: 0 };\n\n/**\n * Bezier curve constructor.\n *\n * ...docs pending...\n */\nclass Bezier {\n  constructor(coords) {\n    let args =\n      coords && coords.forEach ? coords : Array.from(arguments).slice();\n    let coordlen = false;\n\n    if (typeof args[0] === \"object\") {\n      coordlen = args.length;\n      const newargs = [];\n      args.forEach(function (point) {\n        [\"x\", \"y\", \"z\"].forEach(function (d) {\n          if (typeof point[d] !== \"undefined\") {\n            newargs.push(point[d]);\n          }\n        });\n      });\n      args = newargs;\n    }\n\n    let higher = false;\n    const len = args.length;\n\n    if (coordlen) {\n      if (coordlen > 4) {\n        if (arguments.length !== 1) {\n          throw new Error(\n            \"Only new Bezier(point[]) is accepted for 4th and higher order curves\"\n          );\n        }\n        higher = true;\n      }\n    } else {\n      if (len !== 6 && len !== 8 && len !== 9 && len !== 12) {\n        if (arguments.length !== 1) {\n          throw new Error(\n            \"Only new Bezier(point[]) is accepted for 4th and higher order curves\"\n          );\n        }\n      }\n    }\n\n    const _3d = (this._3d =\n      (!higher && (len === 9 || len === 12)) ||\n      (coords && coords[0] && typeof coords[0].z !== \"undefined\"));\n\n    const points = (this.points = []);\n    for (let idx = 0, step = _3d ? 3 : 2; idx < len; idx += step) {\n      var point = {\n        x: args[idx],\n        y: args[idx + 1],\n      };\n      if (_3d) {\n        point.z = args[idx + 2];\n      }\n      points.push(point);\n    }\n    const order = (this.order = points.length - 1);\n\n    const dims = (this.dims = [\"x\", \"y\"]);\n    if (_3d) dims.push(\"z\");\n    this.dimlen = dims.length;\n\n    // is this curve, practically speaking, a straight line?\n    const aligned = utils.align(points, { p1: points[0], p2: points[order] });\n    const baselength = utils.dist(points[0], points[order]);\n    this._linear = aligned.reduce((t, p) => t + abs(p.y), 0) < baselength / 50;\n\n    this._lut = [];\n    this._t1 = 0;\n    this._t2 = 1;\n    this.update();\n  }\n\n  static quadraticFromPoints(p1, p2, p3, t) {\n    if (typeof t === \"undefined\") {\n      t = 0.5;\n    }\n    // shortcuts, although they're really dumb\n    if (t === 0) {\n      return new Bezier(p2, p2, p3);\n    }\n    if (t === 1) {\n      return new Bezier(p1, p2, p2);\n    }\n    // real fitting.\n    const abc = Bezier.getABC(2, p1, p2, p3, t);\n    return new Bezier(p1, abc.A, p3);\n  }\n\n  static cubicFromPoints(S, B, E, t, d1) {\n    if (typeof t === \"undefined\") {\n      t = 0.5;\n    }\n    const abc = Bezier.getABC(3, S, B, E, t);\n    if (typeof d1 === \"undefined\") {\n      d1 = utils.dist(B, abc.C);\n    }\n    const d2 = (d1 * (1 - t)) / t;\n\n    const selen = utils.dist(S, E),\n      lx = (E.x - S.x) / selen,\n      ly = (E.y - S.y) / selen,\n      bx1 = d1 * lx,\n      by1 = d1 * ly,\n      bx2 = d2 * lx,\n      by2 = d2 * ly;\n    // derivation of new hull coordinates\n    const e1 = { x: B.x - bx1, y: B.y - by1 },\n      e2 = { x: B.x + bx2, y: B.y + by2 },\n      A = abc.A,\n      v1 = { x: A.x + (e1.x - A.x) / (1 - t), y: A.y + (e1.y - A.y) / (1 - t) },\n      v2 = { x: A.x + (e2.x - A.x) / t, y: A.y + (e2.y - A.y) / t },\n      nc1 = { x: S.x + (v1.x - S.x) / t, y: S.y + (v1.y - S.y) / t },\n      nc2 = {\n        x: E.x + (v2.x - E.x) / (1 - t),\n        y: E.y + (v2.y - E.y) / (1 - t),\n      };\n    // ...done\n    return new Bezier(S, nc1, nc2, E);\n  }\n\n  static getUtils() {\n    return utils;\n  }\n\n  getUtils() {\n    return Bezier.getUtils();\n  }\n\n  static get PolyBezier() {\n    return PolyBezier;\n  }\n\n  valueOf() {\n    return this.toString();\n  }\n\n  toString() {\n    return utils.pointsToString(this.points);\n  }\n\n  toSVG() {\n    if (this._3d) return false;\n    const p = this.points,\n      x = p[0].x,\n      y = p[0].y,\n      s = [\"M\", x, y, this.order === 2 ? \"Q\" : \"C\"];\n    for (let i = 1, last = p.length; i < last; i++) {\n      s.push(p[i].x);\n      s.push(p[i].y);\n    }\n    return s.join(\" \");\n  }\n\n  setRatios(ratios) {\n    if (ratios.length !== this.points.length) {\n      throw new Error(\"incorrect number of ratio values\");\n    }\n    this.ratios = ratios;\n    this._lut = []; //  invalidate any precomputed LUT\n  }\n\n  verify() {\n    const print = this.coordDigest();\n    if (print !== this._print) {\n      this._print = print;\n      this.update();\n    }\n  }\n\n  coordDigest() {\n    return this.points\n      .map(function (c, pos) {\n        return \"\" + pos + c.x + c.y + (c.z ? c.z : 0);\n      })\n      .join(\"\");\n  }\n\n  update() {\n    // invalidate any precomputed LUT\n    this._lut = [];\n    this.dpoints = utils.derive(this.points, this._3d);\n    this.computedirection();\n  }\n\n  computedirection() {\n    const points = this.points;\n    const angle = utils.angle(points[0], points[this.order], points[1]);\n    this.clockwise = angle > 0;\n  }\n\n  length() {\n    return utils.length(this.derivative.bind(this));\n  }\n\n  static getABC(order = 2, S, B, E, t = 0.5) {\n    const u = utils.projectionratio(t, order),\n      um = 1 - u,\n      C = {\n        x: u * S.x + um * E.x,\n        y: u * S.y + um * E.y,\n      },\n      s = utils.abcratio(t, order),\n      A = {\n        x: B.x + (B.x - C.x) / s,\n        y: B.y + (B.y - C.y) / s,\n      };\n    return { A, B, C, S, E };\n  }\n\n  getABC(t, B) {\n    B = B || this.get(t);\n    let S = this.points[0];\n    let E = this.points[this.order];\n    return Bezier.getABC(this.order, S, B, E, t);\n  }\n\n  getLUT(steps) {\n    this.verify();\n    steps = steps || 100;\n    if (this._lut.length === steps) {\n      return this._lut;\n    }\n    this._lut = [];\n    // n steps means n+1 points\n    steps++;\n    this._lut = [];\n    for (let i = 0, p, t; i < steps; i++) {\n      t = i / (steps - 1);\n      p = this.compute(t);\n      p.t = t;\n      this._lut.push(p);\n    }\n    return this._lut;\n  }\n\n  on(point, error) {\n    error = error || 5;\n    const lut = this.getLUT(),\n      hits = [];\n    for (let i = 0, c, t = 0; i < lut.length; i++) {\n      c = lut[i];\n      if (utils.dist(c, point) < error) {\n        hits.push(c);\n        t += i / lut.length;\n      }\n    }\n    if (!hits.length) return false;\n    return (t /= hits.length);\n  }\n\n  project(point) {\n    // step 1: coarse check\n    const LUT = this.getLUT(),\n      l = LUT.length - 1,\n      closest = utils.closest(LUT, point),\n      mpos = closest.mpos,\n      t1 = (mpos - 1) / l,\n      t2 = (mpos + 1) / l,\n      step = 0.1 / l;\n\n    // step 2: fine check\n    let mdist = closest.mdist,\n      t = t1,\n      ft = t,\n      p;\n    mdist += 1;\n    for (let d; t < t2 + step; t += step) {\n      p = this.compute(t);\n      d = utils.dist(point, p);\n      if (d < mdist) {\n        mdist = d;\n        ft = t;\n      }\n    }\n    ft = ft < 0 ? 0 : ft > 1 ? 1 : ft;\n    p = this.compute(ft);\n    p.t = ft;\n    p.d = mdist;\n    return p;\n  }\n\n  get(t) {\n    return this.compute(t);\n  }\n\n  point(idx) {\n    return this.points[idx];\n  }\n\n  compute(t) {\n    if (this.ratios) {\n      return utils.computeWithRatios(t, this.points, this.ratios, this._3d);\n    }\n    return utils.compute(t, this.points, this._3d, this.ratios);\n  }\n\n  raise() {\n    const p = this.points,\n      np = [p[0]],\n      k = p.length;\n    for (let i = 1, pi, pim; i < k; i++) {\n      pi = p[i];\n      pim = p[i - 1];\n      np[i] = {\n        x: ((k - i) / k) * pi.x + (i / k) * pim.x,\n        y: ((k - i) / k) * pi.y + (i / k) * pim.y,\n      };\n    }\n    np[k] = p[k - 1];\n    return new Bezier(np);\n  }\n\n  derivative(t) {\n    return utils.compute(t, this.dpoints[0], this._3d);\n  }\n\n  dderivative(t) {\n    return utils.compute(t, this.dpoints[1], this._3d);\n  }\n\n  align() {\n    let p = this.points;\n    return new Bezier(utils.align(p, { p1: p[0], p2: p[p.length - 1] }));\n  }\n\n  curvature(t) {\n    return utils.curvature(t, this.dpoints[0], this.dpoints[1], this._3d);\n  }\n\n  inflections() {\n    return utils.inflections(this.points);\n  }\n\n  normal(t) {\n    return this._3d ? this.__normal3(t) : this.__normal2(t);\n  }\n\n  __normal2(t) {\n    const d = this.derivative(t);\n    const q = sqrt(d.x * d.x + d.y * d.y);\n    return { t, x: -d.y / q, y: d.x / q };\n  }\n\n  __normal3(t) {\n    // see http://stackoverflow.com/questions/25453159\n    const r1 = this.derivative(t),\n      r2 = this.derivative(t + 0.01),\n      q1 = sqrt(r1.x * r1.x + r1.y * r1.y + r1.z * r1.z),\n      q2 = sqrt(r2.x * r2.x + r2.y * r2.y + r2.z * r2.z);\n    r1.x /= q1;\n    r1.y /= q1;\n    r1.z /= q1;\n    r2.x /= q2;\n    r2.y /= q2;\n    r2.z /= q2;\n    // cross product\n    const c = {\n      x: r2.y * r1.z - r2.z * r1.y,\n      y: r2.z * r1.x - r2.x * r1.z,\n      z: r2.x * r1.y - r2.y * r1.x,\n    };\n    const m = sqrt(c.x * c.x + c.y * c.y + c.z * c.z);\n    c.x /= m;\n    c.y /= m;\n    c.z /= m;\n    // rotation matrix\n    const R = [\n      c.x * c.x,\n      c.x * c.y - c.z,\n      c.x * c.z + c.y,\n      c.x * c.y + c.z,\n      c.y * c.y,\n      c.y * c.z - c.x,\n      c.x * c.z - c.y,\n      c.y * c.z + c.x,\n      c.z * c.z,\n    ];\n    // normal vector:\n    const n = {\n      t,\n      x: R[0] * r1.x + R[1] * r1.y + R[2] * r1.z,\n      y: R[3] * r1.x + R[4] * r1.y + R[5] * r1.z,\n      z: R[6] * r1.x + R[7] * r1.y + R[8] * r1.z,\n    };\n    return n;\n  }\n\n  hull(t) {\n    let p = this.points,\n      _p = [],\n      q = [],\n      idx = 0;\n    q[idx++] = p[0];\n    q[idx++] = p[1];\n    q[idx++] = p[2];\n    if (this.order === 3) {\n      q[idx++] = p[3];\n    }\n    // we lerp between all points at each iteration, until we have 1 point left.\n    while (p.length > 1) {\n      _p = [];\n      for (let i = 0, pt, l = p.length - 1; i < l; i++) {\n        pt = utils.lerp(t, p[i], p[i + 1]);\n        q[idx++] = pt;\n        _p.push(pt);\n      }\n      p = _p;\n    }\n    return q;\n  }\n\n  split(t1, t2) {\n    // shortcuts\n    if (t1 === 0 && !!t2) {\n      return this.split(t2).left;\n    }\n    if (t2 === 1) {\n      return this.split(t1).right;\n    }\n\n    // no shortcut: use \"de Casteljau\" iteration.\n    const q = this.hull(t1);\n    const result = {\n      left:\n        this.order === 2\n          ? new Bezier([q[0], q[3], q[5]])\n          : new Bezier([q[0], q[4], q[7], q[9]]),\n      right:\n        this.order === 2\n          ? new Bezier([q[5], q[4], q[2]])\n          : new Bezier([q[9], q[8], q[6], q[3]]),\n      span: q,\n    };\n\n    // make sure we bind _t1/_t2 information!\n    result.left._t1 = utils.map(0, 0, 1, this._t1, this._t2);\n    result.left._t2 = utils.map(t1, 0, 1, this._t1, this._t2);\n    result.right._t1 = utils.map(t1, 0, 1, this._t1, this._t2);\n    result.right._t2 = utils.map(1, 0, 1, this._t1, this._t2);\n\n    // if we have no t2, we're done\n    if (!t2) {\n      return result;\n    }\n\n    // if we have a t2, split again:\n    t2 = utils.map(t2, t1, 1, 0, 1);\n    return result.right.split(t2).left;\n  }\n\n  extrema() {\n    const result = {};\n    let roots = [];\n\n    this.dims.forEach(\n      function (dim) {\n        let mfn = function (v) {\n          return v[dim];\n        };\n        let p = this.dpoints[0].map(mfn);\n        result[dim] = utils.droots(p);\n        if (this.order === 3) {\n          p = this.dpoints[1].map(mfn);\n          result[dim] = result[dim].concat(utils.droots(p));\n        }\n        result[dim] = result[dim].filter(function (t) {\n          return t >= 0 && t <= 1;\n        });\n        roots = roots.concat(result[dim].sort(utils.numberSort));\n      }.bind(this)\n    );\n\n    result.values = roots.sort(utils.numberSort).filter(function (v, idx) {\n      return roots.indexOf(v) === idx;\n    });\n\n    return result;\n  }\n\n  bbox() {\n    const extrema = this.extrema(),\n      result = {};\n    this.dims.forEach(\n      function (d) {\n        result[d] = utils.getminmax(this, d, extrema[d]);\n      }.bind(this)\n    );\n    return result;\n  }\n\n  overlaps(curve) {\n    const lbbox = this.bbox(),\n      tbbox = curve.bbox();\n    return utils.bboxoverlap(lbbox, tbbox);\n  }\n\n  offset(t, d) {\n    if (typeof d !== \"undefined\") {\n      const c = this.get(t),\n        n = this.normal(t);\n      const ret = {\n        c: c,\n        n: n,\n        x: c.x + n.x * d,\n        y: c.y + n.y * d,\n      };\n      if (this._3d) {\n        ret.z = c.z + n.z * d;\n      }\n      return ret;\n    }\n    if (this._linear) {\n      const nv = this.normal(0),\n        coords = this.points.map(function (p) {\n          const ret = {\n            x: p.x + t * nv.x,\n            y: p.y + t * nv.y,\n          };\n          if (p.z && nv.z) {\n            ret.z = p.z + t * nv.z;\n          }\n          return ret;\n        });\n      return [new Bezier(coords)];\n    }\n    return this.reduce().map(function (s) {\n      if (s._linear) {\n        return s.offset(t)[0];\n      }\n      return s.scale(t);\n    });\n  }\n\n  simple() {\n    if (this.order === 3) {\n      const a1 = utils.angle(this.points[0], this.points[3], this.points[1]);\n      const a2 = utils.angle(this.points[0], this.points[3], this.points[2]);\n      if ((a1 > 0 && a2 < 0) || (a1 < 0 && a2 > 0)) return false;\n    }\n    const n1 = this.normal(0);\n    const n2 = this.normal(1);\n    let s = n1.x * n2.x + n1.y * n2.y;\n    if (this._3d) {\n      s += n1.z * n2.z;\n    }\n    return abs(acos(s)) < pi / 3;\n  }\n\n  reduce() {\n    // TODO: examine these var types in more detail...\n    let i,\n      t1 = 0,\n      t2 = 0,\n      step = 0.01,\n      segment,\n      pass1 = [],\n      pass2 = [];\n    // first pass: split on extrema\n    let extrema = this.extrema().values;\n    if (extrema.indexOf(0) === -1) {\n      extrema = [0].concat(extrema);\n    }\n    if (extrema.indexOf(1) === -1) {\n      extrema.push(1);\n    }\n\n    for (t1 = extrema[0], i = 1; i < extrema.length; i++) {\n      t2 = extrema[i];\n      segment = this.split(t1, t2);\n      segment._t1 = t1;\n      segment._t2 = t2;\n      pass1.push(segment);\n      t1 = t2;\n    }\n\n    // second pass: further reduce these segments to simple segments\n    pass1.forEach(function (p1) {\n      t1 = 0;\n      t2 = 0;\n      while (t2 <= 1) {\n        for (t2 = t1 + step; t2 <= 1 + step; t2 += step) {\n          segment = p1.split(t1, t2);\n          if (!segment.simple()) {\n            t2 -= step;\n            if (abs(t1 - t2) < step) {\n              // we can never form a reduction\n              return [];\n            }\n            segment = p1.split(t1, t2);\n            segment._t1 = utils.map(t1, 0, 1, p1._t1, p1._t2);\n            segment._t2 = utils.map(t2, 0, 1, p1._t1, p1._t2);\n            pass2.push(segment);\n            t1 = t2;\n            break;\n          }\n        }\n      }\n      if (t1 < 1) {\n        segment = p1.split(t1, 1);\n        segment._t1 = utils.map(t1, 0, 1, p1._t1, p1._t2);\n        segment._t2 = p1._t2;\n        pass2.push(segment);\n      }\n    });\n    return pass2;\n  }\n\n  translate(v, d1, d2) {\n    d2 = typeof d2 === \"number\" ? d2 : d1;\n\n    // TODO: make this take curves with control points outside\n    //       of the start-end interval into account\n\n    const o = this.order;\n    let d = this.points.map((_, i) => (1 - i / o) * d1 + (i / o) * d2);\n    return new Bezier(\n      this.points.map((p, i) => ({\n        x: p.x + v.x * d[i],\n        y: p.y + v.y * d[i],\n      }))\n    );\n  }\n\n  scale(d) {\n    const order = this.order;\n    let distanceFn = false;\n    if (typeof d === \"function\") {\n      distanceFn = d;\n    }\n    if (distanceFn && order === 2) {\n      return this.raise().scale(distanceFn);\n    }\n\n    // TODO: add special handling for non-linear degenerate curves.\n\n    const clockwise = this.clockwise;\n    const points = this.points;\n\n    if (this._linear) {\n      return this.translate(\n        this.normal(0),\n        distanceFn ? distanceFn(0) : d,\n        distanceFn ? distanceFn(1) : d\n      );\n    }\n\n    const r1 = distanceFn ? distanceFn(0) : d;\n    const r2 = distanceFn ? distanceFn(1) : d;\n    const v = [this.offset(0, 10), this.offset(1, 10)];\n    const np = [];\n    const o = utils.lli4(v[0], v[0].c, v[1], v[1].c);\n\n    if (!o) {\n      throw new Error(\"cannot scale this curve. Try reducing it first.\");\n    }\n\n    // move all points by distance 'd' wrt the origin 'o',\n    // and move end points by fixed distance along normal.\n    [0, 1].forEach(function (t) {\n      const p = (np[t * order] = utils.copy(points[t * order]));\n      p.x += (t ? r2 : r1) * v[t].n.x;\n      p.y += (t ? r2 : r1) * v[t].n.y;\n    });\n\n    if (!distanceFn) {\n      // move control points to lie on the intersection of the offset\n      // derivative vector, and the origin-through-control vector\n      [0, 1].forEach((t) => {\n        if (order === 2 && !!t) return;\n        const p = np[t * order];\n        const d = this.derivative(t);\n        const p2 = { x: p.x + d.x, y: p.y + d.y };\n        np[t + 1] = utils.lli4(p, p2, o, points[t + 1]);\n      });\n      return new Bezier(np);\n    }\n\n    // move control points by \"however much necessary to\n    // ensure the correct tangent to endpoint\".\n    [0, 1].forEach(function (t) {\n      if (order === 2 && !!t) return;\n      var p = points[t + 1];\n      var ov = {\n        x: p.x - o.x,\n        y: p.y - o.y,\n      };\n      var rc = distanceFn ? distanceFn((t + 1) / order) : d;\n      if (distanceFn && !clockwise) rc = -rc;\n      var m = sqrt(ov.x * ov.x + ov.y * ov.y);\n      ov.x /= m;\n      ov.y /= m;\n      np[t + 1] = {\n        x: p.x + rc * ov.x,\n        y: p.y + rc * ov.y,\n      };\n    });\n    return new Bezier(np);\n  }\n\n  outline(d1, d2, d3, d4) {\n    d2 = d2 === undefined ? d1 : d2;\n\n    if (this._linear) {\n      // TODO: find the actual extrema, because they might\n      //       be before the start, or past the end.\n\n      const n = this.normal(0);\n      const start = this.points[0];\n      const end = this.points[this.points.length - 1];\n      let s, mid, e;\n\n      if (d3 === undefined) {\n        d3 = d1;\n        d4 = d2;\n      }\n\n      s = { x: start.x + n.x * d1, y: start.y + n.y * d1 };\n      e = { x: end.x + n.x * d3, y: end.y + n.y * d3 };\n      mid = { x: (s.x + e.x) / 2, y: (s.y + e.y) / 2 };\n      const fline = [s, mid, e];\n\n      s = { x: start.x - n.x * d2, y: start.y - n.y * d2 };\n      e = { x: end.x - n.x * d4, y: end.y - n.y * d4 };\n      mid = { x: (s.x + e.x) / 2, y: (s.y + e.y) / 2 };\n      const bline = [e, mid, s];\n\n      const ls = utils.makeline(bline[2], fline[0]);\n      const le = utils.makeline(fline[2], bline[0]);\n      const segments = [ls, new Bezier(fline), le, new Bezier(bline)];\n      return new PolyBezier(segments);\n    }\n\n    const reduced = this.reduce(),\n      len = reduced.length,\n      fcurves = [];\n\n    let bcurves = [],\n      p,\n      alen = 0,\n      tlen = this.length();\n\n    const graduated = typeof d3 !== \"undefined\" && typeof d4 !== \"undefined\";\n\n    function linearDistanceFunction(s, e, tlen, alen, slen) {\n      return function (v) {\n        const f1 = alen / tlen,\n          f2 = (alen + slen) / tlen,\n          d = e - s;\n        return utils.map(v, 0, 1, s + f1 * d, s + f2 * d);\n      };\n    }\n\n    // form curve oulines\n    reduced.forEach(function (segment) {\n      const slen = segment.length();\n      if (graduated) {\n        fcurves.push(\n          segment.scale(linearDistanceFunction(d1, d3, tlen, alen, slen))\n        );\n        bcurves.push(\n          segment.scale(linearDistanceFunction(-d2, -d4, tlen, alen, slen))\n        );\n      } else {\n        fcurves.push(segment.scale(d1));\n        bcurves.push(segment.scale(-d2));\n      }\n      alen += slen;\n    });\n\n    // reverse the \"return\" outline\n    bcurves = bcurves\n      .map(function (s) {\n        p = s.points;\n        if (p[3]) {\n          s.points = [p[3], p[2], p[1], p[0]];\n        } else {\n          s.points = [p[2], p[1], p[0]];\n        }\n        return s;\n      })\n      .reverse();\n\n    // form the endcaps as lines\n    const fs = fcurves[0].points[0],\n      fe = fcurves[len - 1].points[fcurves[len - 1].points.length - 1],\n      bs = bcurves[len - 1].points[bcurves[len - 1].points.length - 1],\n      be = bcurves[0].points[0],\n      ls = utils.makeline(bs, fs),\n      le = utils.makeline(fe, be),\n      segments = [ls].concat(fcurves).concat([le]).concat(bcurves);\n\n    return new PolyBezier(segments);\n  }\n\n  outlineshapes(d1, d2, curveIntersectionThreshold) {\n    d2 = d2 || d1;\n    const outline = this.outline(d1, d2).curves;\n    const shapes = [];\n    for (let i = 1, len = outline.length; i < len / 2; i++) {\n      const shape = utils.makeshape(\n        outline[i],\n        outline[len - i],\n        curveIntersectionThreshold\n      );\n      shape.startcap.virtual = i > 1;\n      shape.endcap.virtual = i < len / 2 - 1;\n      shapes.push(shape);\n    }\n    return shapes;\n  }\n\n  intersects(curve, curveIntersectionThreshold) {\n    if (!curve) return this.selfintersects(curveIntersectionThreshold);\n    if (curve.p1 && curve.p2) {\n      return this.lineIntersects(curve);\n    }\n    if (curve instanceof Bezier) {\n      curve = curve.reduce();\n    }\n    return this.curveintersects(\n      this.reduce(),\n      curve,\n      curveIntersectionThreshold\n    );\n  }\n\n  lineIntersects(line) {\n    const mx = min(line.p1.x, line.p2.x),\n      my = min(line.p1.y, line.p2.y),\n      MX = max(line.p1.x, line.p2.x),\n      MY = max(line.p1.y, line.p2.y);\n    return utils.roots(this.points, line).filter((t) => {\n      var p = this.get(t);\n      return utils.between(p.x, mx, MX) && utils.between(p.y, my, MY);\n    });\n  }\n\n  selfintersects(curveIntersectionThreshold) {\n    // \"simple\" curves cannot intersect with their direct\n    // neighbour, so for each segment X we check whether\n    // it intersects [0:x-2][x+2:last].\n\n    const reduced = this.reduce(),\n      len = reduced.length - 2,\n      results = [];\n\n    for (let i = 0, result, left, right; i < len; i++) {\n      left = reduced.slice(i, i + 1);\n      right = reduced.slice(i + 2);\n      result = this.curveintersects(left, right, curveIntersectionThreshold);\n      results.push(...result);\n    }\n    return results;\n  }\n\n  curveintersects(c1, c2, curveIntersectionThreshold) {\n    const pairs = [];\n    // step 1: pair off any overlapping segments\n    c1.forEach(function (l) {\n      c2.forEach(function (r) {\n        if (l.overlaps(r)) {\n          pairs.push({ left: l, right: r });\n        }\n      });\n    });\n    // step 2: for each pairing, run through the convergence algorithm.\n    let intersections = [];\n    pairs.forEach(function (pair) {\n      const result = utils.pairiteration(\n        pair.left,\n        pair.right,\n        curveIntersectionThreshold\n      );\n      if (result.length > 0) {\n        intersections = intersections.concat(result);\n      }\n    });\n    return intersections;\n  }\n\n  arcs(errorThreshold) {\n    errorThreshold = errorThreshold || 0.5;\n    return this._iterate(errorThreshold, []);\n  }\n\n  _error(pc, np1, s, e) {\n    const q = (e - s) / 4,\n      c1 = this.get(s + q),\n      c2 = this.get(e - q),\n      ref = utils.dist(pc, np1),\n      d1 = utils.dist(pc, c1),\n      d2 = utils.dist(pc, c2);\n    return abs(d1 - ref) + abs(d2 - ref);\n  }\n\n  _iterate(errorThreshold, circles) {\n    let t_s = 0,\n      t_e = 1,\n      safety;\n    // we do a binary search to find the \"good `t` closest to no-longer-good\"\n    do {\n      safety = 0;\n\n      // step 1: start with the maximum possible arc\n      t_e = 1;\n\n      // points:\n      let np1 = this.get(t_s),\n        np2,\n        np3,\n        arc,\n        prev_arc;\n\n      // booleans:\n      let curr_good = false,\n        prev_good = false,\n        done;\n\n      // numbers:\n      let t_m = t_e,\n        prev_e = 1,\n        step = 0;\n\n      // step 2: find the best possible arc\n      do {\n        prev_good = curr_good;\n        prev_arc = arc;\n        t_m = (t_s + t_e) / 2;\n        step++;\n\n        np2 = this.get(t_m);\n        np3 = this.get(t_e);\n\n        arc = utils.getccenter(np1, np2, np3);\n\n        //also save the t values\n        arc.interval = {\n          start: t_s,\n          end: t_e,\n        };\n\n        let error = this._error(arc, np1, t_s, t_e);\n        curr_good = error <= errorThreshold;\n\n        done = prev_good && !curr_good;\n        if (!done) prev_e = t_e;\n\n        // this arc is fine: we can move 'e' up to see if we can find a wider arc\n        if (curr_good) {\n          // if e is already at max, then we're done for this arc.\n          if (t_e >= 1) {\n            // make sure we cap at t=1\n            arc.interval.end = prev_e = 1;\n            prev_arc = arc;\n            // if we capped the arc segment to t=1 we also need to make sure that\n            // the arc's end angle is correct with respect to the bezier end point.\n            if (t_e > 1) {\n              let d = {\n                x: arc.x + arc.r * cos(arc.e),\n                y: arc.y + arc.r * sin(arc.e),\n              };\n              arc.e += utils.angle({ x: arc.x, y: arc.y }, d, this.get(1));\n            }\n            break;\n          }\n          // if not, move it up by half the iteration distance\n          t_e = t_e + (t_e - t_s) / 2;\n        } else {\n          // this is a bad arc: we need to move 'e' down to find a good arc\n          t_e = t_m;\n        }\n      } while (!done && safety++ < 100);\n\n      if (safety >= 100) {\n        break;\n      }\n\n      // console.log(\"L835: [F] arc found\", t_s, prev_e, prev_arc.x, prev_arc.y, prev_arc.s, prev_arc.e);\n\n      prev_arc = prev_arc ? prev_arc : arc;\n      circles.push(prev_arc);\n      t_s = prev_e;\n    } while (t_e < 1);\n    return circles;\n  }\n}\n\nexport { Bezier };\n","import { guard as guardPoint } from './Point.js';\nimport { Path } from './Path.js';\nimport { Line } from './Line.js';\nimport { Points, Rects } from  './index.js';\nimport { Arrays } from '../collections/index.js';\nconst piPi = Math.PI *2;\n\n/**\n * A circle\n */\nexport type Circle = {\n  readonly radius:number\n}\n\n/**\n * A {@link Circle} with position\n */\nexport type CirclePositioned = Points.Point & Circle;\n\nexport type CircularPath = Circle & Path & {\n  readonly kind:`circular`\n};\n\n/**\n * Returns true if parameter has x,y. Does not verify if parameter is a circle or not\n * \n * ```js\n * import { Circles } from \"https://unpkg.com/ixfx/dist/geometry.js\" \n * \n * const circleA = { radius: 5 };\n * Circles.isPositioned(circle); // false\n * \n * const circleB = { radius: 5, x: 10, y: 10 }\n * Circles.isPositioned(circle); // true\n * ```\n * @param p Circle\n * @returns \n */\nexport const isPositioned = (p:Circle | Points.Point):p is Points.Point => (p as Points.Point).x !== undefined && (p as Points.Point).y !== undefined;\n//eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport const isCircle = (p:Circle|CirclePositioned|any):p is Circle => (p as Circle).radius !== undefined;\n//eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport const isCirclePositioned = (p:Circle|CirclePositioned|any):p is CirclePositioned => isCircle(p) && isPositioned(p);\n\n/**\n * Returns a point on a circle at a specified angle in radians\n * \n * ```js\n * import { Circles } from \"https://unpkg.com/ixfx/dist/geometry.js\" \n * \n * // Circle without position\n * const circleA = { radius: 5 };\n * \n * // Get point at angle Math.PI, passing in a origin coordinate\n * const ptA = Circles.point(circleA, Math.PI, {x: 10, y: 10 });\n * \n * // Point on circle with position\n * const circleB = { radius: 5, x: 10, y: 10};\n * const ptB = Circles.point(circleB, Math.PI);\n * ```\n * @param circle\n * @param angleRadian Angle in radians\n * @param Origin or offset of calculated point. By default uses center of circle or 0,0 if undefined\n * @returns Point oo circle\n */\nexport const point = (circle:Circle|CirclePositioned, angleRadian:number, origin?:Points.Point):Points.Point => {\n  if (origin === undefined) {\n    if (isPositioned(circle)) {\n      origin = circle;\n    } else {\n      origin = { x:0, y:0 };\n    }\n  }\n  return {\n    x: (Math.cos(-angleRadian) * circle.radius) + origin.x,\n    y: (Math.sin(-angleRadian) * circle.radius) + origin.y\n  };\n};\n\n/**\n * Throws if radius is out of range. If x,y is present, these will be validated too.\n * @param circle \n * @param paramName \n */\nconst guard = (circle:CirclePositioned|Circle, paramName =`circle`) => {\n  if (isPositioned(circle)) {\n    guardPoint(circle, `circle`);\n  }\n\n  if (Number.isNaN(circle.radius)) throw new Error(`${paramName}.radius is NaN`);\n  if (circle.radius <= 0) throw new Error(`${paramName}.radius must be greater than zero`);\n};\n\n/**\n * Throws if `circle` is not positioned or has dodgy fields\n * @param circle \n * @param paramName \n * @returns \n */\nconst guardPositioned = (circle:CirclePositioned, paramName = `circle`) => {\n  if (!isPositioned(circle)) throw new Error(`Expected a positioned circle with x,y`);\n  return guard(circle, paramName);\n};\n\n/**\n * Returns the center of a circle\n * \n * If the circle has an x,y, that is the center.\n * If not, `radius` is used as the x and y.\n * \n * ```js\n * import { Circles } from \"https://unpkg.com/ixfx/dist/geometry.js\" \n * const circle = { radius: 5, x: 10, y: 10};\n * \n * // Yields: { x: 5, y: 10 }\n * Circles.center(circle);\n * ```\n * \n * It's a trivial function, but can make for more understandable code\n * @param circle \n * @returns Center of circle\n */\nexport const center = (circle:CirclePositioned|Circle) => {\n  if (isPositioned(circle)) return Object.freeze({ x: circle.x, y: circle.y });\n  else return Object.freeze({ x: circle.radius, y: circle.radius });\n};\n/**\n * Computes relative position along circle\n * \n * ```js\n * import { Circles } from \"https://unpkg.com/ixfx/dist/geometry.js\" \n * const circle = { radius: 100, x: 100, y: 100 };\n * \n * // Get a point halfway around circle\n * // Yields { x, y }\n * const pt = Circles.interpolate(circle, 0.5);\n * ```\n * @param circle \n * @param t Position, 0-1\n * @returns \n */\nexport const interpolate = (circle:CirclePositioned, t:number):Points.Point => point(circle, t*piPi);\n\n/**\n * Returns circumference of `circle` (alias of {@link circumference})\n * @param circle \n * @returns \n */\nexport const length = (circle:Circle):number => circumference(circle);\n\n/**\n * Returns circumference of `circle` (alias of {@link length})\n * @param circle \n * @returns \n */\nexport const circumference = (circle:Circle):number => {\n  guard(circle);\n  return piPi*circle.radius;\n};\n\n/**\n * Returns the area of `circle`.\n * @param circle \n * @returns \n */\nexport const area = (circle:Circle) => {\n  guard(circle);\n  return Math.PI * circle.radius * circle.radius;\n};\n\n/**\n * Computes a bounding box that encloses circle\n * @param circle\n * @returns \n */\nexport const bbox = (circle:CirclePositioned|Circle):Rects.RectPositioned|Rects.Rect => {\n  if (isPositioned(circle)) {\n    return Rects.fromCenter(circle, circle.radius*2, circle.radius*2);\n  } else {\n    return { width: circle.radius*2, height: circle.radius*2 };\n  }\n};\n\n/**\n * Returns true if `b` is completely contained by `a`\n *\n * @param a Circle\n * @param b Circle or point to compare to\n * @returns\n */\nexport const isContainedBy = (a:CirclePositioned, b:CirclePositioned|Points.Point):boolean => {\n  const d = distanceCenter(a, b);\n  if (isCircle(b)) {\n    return (d < Math.abs(a.radius - b.radius));\n  } else {\n    return d <= a.radius;\n  }\n};\n\n/***\n * Returns true if radius, x or y are NaN\n */\nexport const isNaN = (a:Circle|CirclePositioned):boolean => {\n  if (Number.isNaN(a.radius)) return true;\n  if (isPositioned(a)) {\n    if (Number.isNaN(a.x)) return true;\n    if (Number.isNaN(a.y)) return true;\n  }\n  return false;\n};\n/**\n * Returns true if a or b overlap or are equal\n * \n * Use `intersections` to find the points of intersection\n *\n * @param a Circle\n * @param b Circle or point to test\n * @returns True if circle overlap\n */\nexport const isIntersecting = (a:CirclePositioned, b:CirclePositioned|Points.Point):boolean => {\n  if (Points.isEqual(a, b)) return true;\n  if (isContainedBy(a, b)) return true;\n  if (isCircle(b)) {\n    return intersections(a, b).length === 2;\n  } \n  return false;\n};\n\n/**\n * Returns the points of intersection betweeen `a` and `b`.\n * \n * Returns an empty array if circles are equal, one contains the other or if they don't touch at all.\n *\n * @param a Circle\n * @param b Circle\n * @returns Points of intersection, or an empty list if there are none\n */\nexport const intersections = (a:CirclePositioned, b:CirclePositioned):readonly Points.Point[] => {\n  const vector = Points.subtract(b, a);\n  const centerD = Math.sqrt((vector.y*vector.y) + (vector.x*vector.x));\n\n  // Do not intersect\n  if (centerD > a.radius + b.radius) return [];\n\n  // Circle contains another\n  if (centerD < Math.abs(a.radius - b.radius)) return [];\n\n  // Circles are the same\n  if (isEqual(a, b)) return [];\n\n  const centroidD = ((a.radius*a.radius) - (b.radius*b.radius) + (centerD*centerD)) / (2.0 * centerD);\n  const centroid = {\n    x: a.x + (vector.x * centroidD / centerD),\n    y: a.y + (vector.y * centroidD / centerD)\n  };\n\n  const centroidIntersectionD = Math.sqrt((a.radius*a.radius) - (centroidD*centroidD));\n\n  const intersection =  {\n    x: -vector.y * (centroidIntersectionD/centerD),\n    y: vector.x * (centroidIntersectionD/centerD)\n  };\n  return [\n    Points.sum(centroid, intersection),\n    Points.subtract(centroid, intersection)\n  ];\n};\n\n/**\n * Returns true if the two objects have the same values\n *\n * ```js\n * const circleA = { radius: 10, x: 5, y: 5 };\n * const circleB = { radius: 10, x: 5, y: 5 };\n * \n * circleA === circleB; // false, because identity of objects is different\n * Circles.isEqual(circleA, circleB); // true, because values are the same\n * ```\n * \n * Circles must both be positioned or not.\n * @param a\n * @param b\n * @returns\n */\nexport const isEqual = (a:CirclePositioned|Circle, b:CirclePositioned|Circle):boolean => {\n  if (a.radius !== b.radius) return false;\n\n  if (isPositioned(a) && isPositioned(b)) {\n    if (a.x !== b.x) return false;\n    if (a.y !== b.y) return false;\n    if (a.z !== b.z) return false;\n    return true;\n  } else if (!isPositioned(a) && !isPositioned(b)) {\n    // no-op\n  } else return false; // one is positioned one not\n\n  return false;\n};\n\n\nexport function multiplyScalar(a:CirclePositioned, value:number):CirclePositioned;\n\nexport function multiplyScalar(a:Circle, value:number):Circle;\n\n/**\n * Multiplies a circle's radius and position (if provided) by `value`.\n * \n * ```js\n * multiplyScalar({ radius: 5 }, 5);\n * // Yields: { radius: 25 }\n * \n * multiplyScalar({ radius: 5, x: 10, y: 20 }, 5);\n * // Yields: { radius: 25, x: 50, y: 100 }\n * ```\n */\nexport function multiplyScalar(a:Circle|CirclePositioned, value:number):Circle|CirclePositioned {\n  if (isPositioned(a)) {\n    const pt = Points.multiplyScalar(a, value);\n    return Object.freeze({\n      ...a,\n      ...pt,\n      radius: a.radius * value\n    });\n  } else {\n    return Object.freeze({\n      ...a,\n      radius: a.radius * value\n    });\n  }\n}\n\n\n/**\n * Returns the distance between two circle centers.\n * \n * ```js\n * import { Circles } from \"https://unpkg.com/ixfx/dist/geometry.js\" \n * const circleA = { radius: 5, x: 5, y: 5 }\n * const circleB = { radius: 10, x: 20, y: 20 }\n * const distance = Circles.distanceCenter(circleA, circleB);\n * ```\n * Throws an error if either is lacking position.\n * @param a \n * @param b \n * @returns Distance\n */\nexport const distanceCenter = (a:CirclePositioned, b:CirclePositioned|Points.Point):number => {\n  guardPositioned(a, `a`);\n  if (isCirclePositioned(b)) {\n    guardPositioned(b, `b`);\n  }\n  return Points.distance(a, b);\n};\n\n/**\n * Returns the distance between the exterior of two circles, or between the exterior of a circle and point.\n * If `b` overlaps or is enclosed by `a`, distance is 0.\n * \n * ```js\n * import { Circles } from \"https://unpkg.com/ixfx/dist/geometry.js\" \n * const circleA = { radius: 5, x: 5, y: 5 }\n * const circleB = { radius: 10, x: 20, y: 20 }\n * const distance = Circles.distanceCenter(circleA, circleB);\n * ```\n * @param a\n * @param b \n */\nexport const distanceFromExterior = (a:CirclePositioned, b:CirclePositioned|Points.Point):number => {\n  guardPositioned(a, `a`);\n  if (isCirclePositioned(b)) {\n    return Math.max(0, distanceCenter(a, b) - a.radius - b.radius);\n  } else if (Points.isPoint(b)) {\n    const dist =  Points.distance(a, b);\n    if (dist < a.radius) return 0;\n    return dist;\n  } else throw new Error(`Second parameter invalid type`);\n};\n\ntype ToSvg = {\n  (radius:number, sweep:boolean, origin:Points.Point):readonly string[];\n  (circle:Circle, sweep:boolean, origin:Points.Point):readonly string[];\n  (circle:CirclePositioned, sweep:boolean):readonly string[];\n};\n\n\n/**\n * Creates a SVG path segment.\n * @param a Circle or radius\n * @param sweep If true, path is 'outward'\n * @param origin Origin of path. Required if first parameter is just a radius or circle is non-positioned\n * @returns \n */\nexport const toSvg:ToSvg = (a:CirclePositioned|number|Circle, sweep:boolean, origin?:Points.Point):readonly string[] => {\n  if (isCircle(a)) {\n    if (origin !== undefined) {\n      return toSvgFull(a.radius, origin, sweep);\n    }\n    if (isPositioned(a)) {\n      return toSvgFull(a.radius, a, sweep);\n    } else throw new Error(`origin parameter needed for non-positioned circle`);\n  } else {\n    if (origin !== undefined) {\n      return toSvgFull(a, origin, sweep);\n    } else throw new Error(`origin parameter needed`);\n  }  \n};\n\nconst toSvgFull = (radius:number, origin:Points.Point, sweep:boolean):readonly string[] => {\n  // https://stackoverflow.com/questions/5737975/circle-drawing-with-svgs-arc-path\n  const { x, y } = origin;\n  const s = sweep ? `1` :`0`;\n  return `\n    M ${x}, ${y}\n    m -${radius}, 0\n    a ${radius},${radius} 0 1,${s} ${radius*2},0\n    a ${radius},${radius} 0 1,${s} -${radius*2},0\n  `.split(`\\n`);\n};\n\n/**\n * Returns the nearest point on `circle` closest to `point`.\n * \n * ```js\n * import { Circles } from 'https://unpkg.com/ixfx/dist/geometry.js'\n * const pt = Circles.nearest(circle, {x:10,y:10});\n * ```\n * \n * If an array of circles is provided, it will be the closest point amongst all the circles\n * @param circle Circle or array of circles\n * @param point\n * @returns Point `{ x, y }`\n */\nexport const nearest = (circle:CirclePositioned|readonly CirclePositioned[], b:Points.Point):Points.Point => {\n  const n = (a:CirclePositioned):Points.Point => {\n    const l = Math.sqrt(Math.pow(b.x - a.x, 2) + Math.pow(b.y-a.y, 2));\n    const x = a.x + (a.radius * ((b.x - a.x) / l));\n    const y = a.y + (a.radius * ((b.y - a.y) / l));\n    return { x, y };\n  };\n\n  if (Array.isArray(circle)) {\n    const pts = circle.map(l => n(l));\n    const dists = pts.map(p => Points.distance(p, b));\n    return Object.freeze<Points.Point>(pts[Arrays.minIndex(...dists)]);\n  } else {\n    return Object.freeze<Points.Point>(n(circle as CirclePositioned));\n  }\n};\n\n/**\n * Returns a positioned version of a circle.\n * If circle is already positioned, it is returned.\n * If no default position is supplied, 0,0 is used.\n * @param circle \n * @param defaultPositionOrX \n * @param y \n * @returns \n */\nexport const toPositioned = (circle:Circle|CirclePositioned, defaultPositionOrX?:Points.Point|number, y?:number):CirclePositioned => {\n  if (isPositioned(circle)) return circle;\n\n  // Returns 0,0 if params are undefined\n  const pt = Points.getPointParam(defaultPositionOrX, y);\n  return Object.freeze({\n    ...circle,\n    ...pt\n  });\n};\n/**\n * Returns a `CircularPath` representation of a circle\n *\n * @param {CirclePositioned} circle\n * @returns {CircularPath}\n */\nexport const toPath = (circle:CirclePositioned):CircularPath => {\n  guard(circle);\n\n  return Object.freeze({\n    ...circle,\n    nearest: (point:Points.Point) => nearest(circle, point),\n    /**\n     * Returns a relative (0.0-1.0) point on a circle. 0=3 o'clock, 0.25=6 o'clock, 0.5=9 o'clock, 0.75=12 o'clock etc.\n     * @param {t} Relative (0.0-1.0) point\n     * @returns {Point} X,y\n     */\n    interpolate: (t:number) => interpolate(circle, t),\n    bbox:() => bbox(circle) as Rects.RectPositioned,\n    length: () => length(circle),\n    toSvgString: (sweep = true) => toSvg(circle, sweep),\n    kind: `circular`\n  });\n};\n\n/**\n * Returns the point(s) of intersection between a circle and line.\n * \n * ```js\n * import { Circles } from \"https://unpkg.com/ixfx/dist/geometry.js\" \n * const circle = { radius: 5, x: 5, y: 5 };\n * const line = { a: { x: 0, y: 0 }, b: { x: 10, y: 10 } };\n * const pts = Circles.intersectionLine(circle, line);\n * ```\n * @param circle \n * @param line \n * @returns Point(s) of intersection, or empty array\n */\nexport const intersectionLine = (circle:CirclePositioned, line:Line):readonly Points.Point[] => {\n  const v1 = {\n    x: line.b.x - line.a.x,\n    y: line.b.y - line.a.y\n  };\n  const v2 = {\n    x: line.a.x - circle.x,\n    y: line.a.y - circle.y\n  };\n\n  const b = (v1.x * v2.x + v1.y * v2.y) * -2;\n  const c = 2 * (v1.x * v1.x + v1.y * v1.y);\n  \n  const d = Math.sqrt(b * b - 2 * c * (v2.x * v2.x + v2.y * v2.y - circle.radius * circle.radius));\n  if (Number.isNaN(d)) return []; // no intercept\n\n  const u1 = (b - d) / c;  // these represent the unit distance of point one and two on the line\n  const u2 = (b + d) / c;    \n\n  const ret = [];\n  if(u1 <= 1 && u1 >= 0) {  // add point if on the line segment\n    //eslint-disable-next-line functional/immutable-data\n    ret.push({ \n      x: line.a.x + v1.x * u1,\n      y: line.a.y + v1.y * u1\n    });\n  }\n  if(u2 <= 1 && u2 >= 0) {  // second add point if on the line segment\n    //eslint-disable-next-line functional/immutable-data\n    ret.push({\n      x: line.a.x + v1.x * u2,\n      y: line.a.y + v1.y * u2\n    });\n  }       \n  return ret;\n};","import { Points, Paths, Rects } from './index.js';\n\nexport type CompoundPath = Paths.Path & {\n  readonly segments:readonly Paths.Path[]\n  readonly kind:`compound`\n};\n\n/**\n * Returns a new compoundpath, replacing a path at a given index\n *\n * @param {CompoundPath} compoundPath Existing compoundpath\n * @param {number} index Index to replace at\n * @param {Paths.Path} path Path to substitute in\n * @returns {CompoundPath} New compoundpath\n */\nexport const setSegment = (compoundPath:CompoundPath, index:number, path:Paths.Path):CompoundPath => {\n  const existing = [...compoundPath.segments];\n  //eslint-disable-next-line functional/prefer-readonly-type,functional/immutable-data\n  existing[index] = path;\n  return fromPaths(...existing);\n};\n\n/**\n * Computes x,y point at a relative position along compoundpath\n *\n * @param {Paths.Path[]} paths Combined paths (assumes contiguous)\n * @param {number} t Position (given as a percentage from 0 to 1)\n * @param {boolean} [useWidth] If true, widths are used for calulcating. If false, lengths are used\n * @param {Dimensions} [dimensions] Precalculated dimensions of paths, will be computed if omitted\n * @returns\n */\nexport const interpolate = (paths:readonly Paths.Path[], t:number, useWidth?:boolean, dimensions?:Dimensions) => {\n  if (dimensions === undefined) {\n    dimensions = computeDimensions(paths);\n  }\n\n  // Expected value to land on\n  const expected = t * (useWidth ? dimensions.totalWidth : dimensions.totalLength);\n  //eslint-disable-next-line functional/no-let\n  let soFar = 0;\n\n  // Use widths or lengths?\n  const l = useWidth ? dimensions.widths : dimensions.lengths;\n  //eslint-disable-next-line functional/no-let\n  for (let i = 0; i < l.length; i++) {\n    if (soFar + l[i] >= expected) {\n      const relative = expected - soFar;\n      //eslint-disable-next-line functional/no-let\n      let amt = relative / l[i];\n      //eslint-disable-next-line functional/no-let\n      if (amt > 1) amt = 1;\n      return paths[i].interpolate(amt);\n    } else soFar += l[i];\n  }\n  return { x: 0, y: 0 };\n};\n\nexport type Dimensions = {\n  /**\n   * Width of each path (based on bounding box)\n   *\n   * @type {number[]}\n   */\n  readonly widths:readonly number[],\n  /**\n   * Length of each path\n   *\n   * @type {number[]}\n   */\n  readonly lengths:readonly number[],\n\n  /**\n   * Total length of all paths\n   *\n   * @type {number}\n   */\n  readonly totalLength:number,\n  /**\n   * Total width of all paths\n   *\n   * @type {number}\n   */\n  readonly totalWidth:number\n}\n/**\n * Computes the widths and lengths of all paths, adding them up as well\n *\n * @param {Paths.Path[]} paths\n * @returns {Dimensions}\n */\nexport const computeDimensions = (paths:readonly Paths.Path[]):Dimensions => {\n  const widths = paths.map(l => l.bbox().width);\n  const lengths = paths.map(l => l.length());\n  //eslint-disable-next-line functional/no-let\n  let totalLength = 0;\n  //eslint-disable-next-line functional/no-let\n  let totalWidth = 0;\n  //eslint-disable-next-line functional/no-let\n  for (let i = 0; i < lengths.length; i++) totalLength += lengths[i];\n  //eslint-disable-next-line functional/no-let\n  for (let i = 0; i < widths.length; i++) totalWidth += widths[i];\n\n  return { totalLength, totalWidth, widths, lengths };\n};\n\n/**\n * Computes the bounding box that encloses entire compoundpath\n *\n * @param {Paths.Path[]} paths\n * \n * @returns {Rects.Rect}\n */\nexport const bbox = (paths:readonly Paths.Path[]):Rects.RectPositioned => {\n  const boxes = paths.map(p => p.bbox());\n  const corners = boxes.map(b => Rects.corners(b)).flat();\n\n  return Points.bbox(...corners);\n};\n\n/**\n * Produce a human-friendly representation of paths\n *\n * @param {Paths.Path[]} paths\n * @returns {string}\n */\nexport const toString = (paths:readonly Paths.Path[]):string => paths.map(p => p.toString()).join(`, `);\n\n/**\n * Throws an error if paths are not connected together, in order\n *\n * @param {Paths.Path[]} paths\n */\nexport const guardContinuous = (paths:readonly Paths.Path[]) => {\n  //eslint-disable-next-line functional/no-let\n  let lastPos = Paths.getEnd(paths[0]);\n  //eslint-disable-next-line functional/no-let\n  for (let i = 1; i < paths.length; i++) {\n    const start = Paths.getStart(paths[i]);\n    if (!Points.isEqual(start, lastPos)) throw new Error(`Path index ` + i + ` does not start at prior path end. Start: ` + start.x + `,` + start.y + ` expected: ` + lastPos.x + `,` + lastPos.y + ``);\n    lastPos = Paths.getEnd(paths[i]);\n  }\n};\n\nexport const toSvgString = (paths:readonly Paths.Path[]):readonly string[] => paths.flatMap(p => p.toSvgString());\n\n/**\n * Create a compoundpath from an array of paths.\n * All this does is verify they are connected, and precomputes dimensions\n *\n * @param {...Paths.Path[]} paths\n * @returns {CompoundPath}\n */\nexport const fromPaths = (...paths:readonly Paths.Path[]):CompoundPath => {\n  guardContinuous(paths); // Throws an error if paths are not connected\n  const dims = computeDimensions(paths);\n\n  return Object.freeze({\n    segments: paths,\n    length: () => dims.totalLength,\n    nearest:(_:Points.Point) => { throw new Error(`not implemented`); },\n    interpolate: (t:number, useWidth = false) => interpolate(paths, t, useWidth, dims),\n    bbox: () => bbox(paths),\n    toString: () => toString(paths),\n    toSvgString: () => toSvgString(paths),\n    kind: `compound`\n  });\n};\n","import {Rects, Points} from './index.js';\nimport {integer as guardInteger} from '../Guards.js';\nimport {clampIndex} from '../data/Clamp.js';\nimport {randomElement} from '../collections/Arrays.js';\nimport {SetMutable} from '../collections/Interfaces.js';\nimport {setMutable, } from \"../collections/Set.js\";\nimport {zipKeyValue} from \"../collections/Map.js\";\n\nexport type GridVisual = Readonly<{\n  readonly size: number,\n}>\n\nexport type Grid = Readonly<{\n  readonly rows: number\n  readonly cols: number\n}>;\n\nexport type Cell = Readonly<{\n  readonly x: number\n  readonly y: number\n}>;\n\nexport type Neighbours = Readonly<{\n  readonly n: Cell | undefined,\n  readonly e: Cell | undefined,\n  readonly s: Cell | undefined,\n  readonly w: Cell | undefined,\n  readonly ne: Cell | undefined,\n  readonly nw: Cell | undefined,\n  readonly se: Cell | undefined,\n  readonly sw: Cell | undefined\n}>\n\nexport type CardinalDirection = `` | `n` | `ne` | `e` | `se` | `s` | `sw` | `w` | `nw`;\n\nexport type BoundsLogic = `unbounded` | `undefined` | `stop` | `wrap`;\n\nexport type VisitorLogic = {\n  readonly options?: IdentifyNeighbours;\n  readonly select: NeighbourSelector\n}\nexport type VisitGenerator = Generator<Readonly<Cell>, void, unknown>\nexport type VisitorOpts = {\n  readonly visited?: SetMutable<Cell>\n  readonly reversed?: boolean\n  readonly debug?: boolean\n}\nexport type Visitor = (grid: Grid, start: Cell, opts?: VisitorOpts) => VisitGenerator;\n\nexport type NeighbourMaybe = readonly [keyof Neighbours, Cell | undefined];\nexport type Neighbour = readonly [keyof Neighbours, Cell];\n\n/**\n * Neighbour selector logic. For a given set of `neighbours` pick one to visit next.\n */\nexport type NeighbourSelector = (neighbours: ReadonlyArray<Neighbour>) => Neighbour | undefined;\n\n/**\n * Identify neighbours logic. For a given `grid` and `origin`, return a list of neighbours\n */\nexport type IdentifyNeighbours = (grid: Grid, origin: Cell) => ReadonlyArray<Neighbour>;\n\n/**\n * Returns true if `cell` parameter is a cell with x,y fields.\n * Does not check validity of fields.\n *\n * @param cell\n * @return True if parameter is a cell\n */\nconst isCell = (cell: Cell | undefined): cell is Cell => {\n  if (cell === undefined) return false;\n  return (`x` in cell && `y` in cell);\n};\n\n/**\n * Returns true if `n` is a Neighbour type, eliminating NeighbourMaybe possibility\n *\n * @param n\n * @return\n */\nconst isNeighbour = (n: Neighbour | NeighbourMaybe | undefined): n is Neighbour => {\n  if (n === undefined) return false;\n  if (n[1] === undefined) return false;\n  return true;\n};\n\n/**\n * Returns _true_ if grids `a` and `b` are equal in value\n *\n * @param a\n * @param b\n * @return\n */\nexport const isEqual = (a: Grid | GridVisual, b: Grid | GridVisual): boolean => {\n  if (`rows` in a && `cols` in a) {\n    if (`rows` in b && `cols` in b) {\n      if (a.rows !== b.rows || a.cols !== b.cols) return false;\n    } else return false;\n  }\n  if (`size` in a) {\n    if (`size` in b) {\n      if (a.size !== b.size) return false;\n    } else return false;\n  }\n  return true;\n};\n\n/**\n * Returns a key string for a cell instance\n * A key string allows comparison of instances by value rather than reference\n * @param v\n * @returns\n */\nexport const cellKeyString = (v: Cell): string => `Cell{${v.x},${v.y}}`;\n\n/**\n * Returns true if two cells equal. Returns false if either cell (or both) are undefined\n *\n * @param a\n * @param b\n * @returns\n */\nexport const cellEquals = (a: Cell, b: Cell): boolean => {\n  if (b === undefined) return false;\n  if (a === undefined) return false;\n  return a.x === b.x && a.y === b.y;\n};\n\n/**\n * Throws an exception if any of the cell's parameters are invalid\n * @private\n * @param cell \n * @param paramName \n * @param grid \n */\nexport const guardCell = (cell: Cell, paramName: string = `Param`, grid?: Grid) => {\n  if (cell === undefined) throw new Error(paramName + ` is undefined. Expecting {x,y}`);\n  if (cell.x === undefined) throw new Error(paramName + `.x is undefined`);\n  if (cell.y === undefined) throw new Error(paramName + `.y is undefined`);\n  if (!Number.isInteger(cell.x)) throw new Error(paramName + `.x is non-integer`);\n  if (!Number.isInteger(cell.y)) throw new Error(paramName + `.y is non-integer`);\n  if (grid !== undefined) {\n    if (!inside(grid, cell)) throw new Error(`${paramName} is outside of grid. Cell: ${cell.x},${cell.y} Grid: ${grid.cols}, ${grid.rows}`);\n  }\n};\n\n/**\n * Throws an exception if any of the grid's parameters are invalid\n * @param grid\n * @param paramName \n */\nconst guardGrid = (grid: Grid, paramName: string = `Param`) => {\n  if (grid === undefined) throw new Error(`${paramName} is undefined. Expecting grid.`);\n  if (!(`rows` in grid)) throw new Error(`${paramName}.rows is undefined`);\n  if (!(`cols` in grid)) throw new Error(`${paramName}.cols is undefined`);\n\n  if (!Number.isInteger(grid.rows)) throw new Error(`${paramName}.rows is not an integer`);\n  if (!Number.isInteger(grid.cols)) throw new Error(`${paramName}.cols is not an integer`);\n};\n\n/**\n * Returns _true_ if cell coordinates are above zero and within bounds of grid\n *\n * @param grid\n * @param cell\n * @return\n */\nexport const inside = (grid: Grid, cell: Cell): boolean => {\n  if (cell.x < 0 || cell.y < 0) return false;\n  if (cell.x >= grid.cols || cell.y >= grid.rows) return false;\n  return true;\n};\n/**\n * Returns a visual rectangle of the cell, positioned from the top-left corner\n *\n * @param cell\n * @param grid\n * @return\n */\nexport const rectangleForCell = (cell: Cell, grid: Grid & GridVisual): Rects.RectPositioned => {\n  guardCell(cell);\n  const size = grid.size;\n  const x = cell.x * size;\n  const y = cell.y * size;\n  const r = Rects.fromTopLeft({x: x, y: y}, size, size);\n  return r;\n};\n\n/**\n * Returns the cell at a specified visual coordinate\n *\n * @param position Position, eg in pixels\n * @param grid Grid\n * @return Cell at position or undefined if outside of the grid\n */\nexport const cellAtPoint = (position: Points.Point, grid: Grid & GridVisual): Cell | undefined => {\n  const size = grid.size;\n  if (position.x < 0 || position.y < 0) return;\n  const x = Math.floor(position.x / size);\n  const y = Math.floor(position.y / size);\n  if (x >= grid.cols) return;\n  if (y >= grid.rows) return;\n  return {x, y};\n};\n\n/**\n * Returns a list of all cardinal directions\n */\nexport const allDirections = Object.freeze([`n`, `ne`, `nw`, `e`, `s`, `se`, `sw`, `w`]) as ReadonlyArray<CardinalDirection>;\n\n/**\n * Returns a list of + shaped directions (ie. excluding diaganol)\n */\nexport const crossDirections = Object.freeze([`n`, `e`, `s`, `w`]) as ReadonlyArray<CardinalDirection>;\n\n/**\n * Returns neighbours for a cell. If no `directions` are provided, it defaults to all.\n * \n * ```js\n * const n = neighbours = ({rows: 5, cols: 5}, {x:2, y:2} `wrap`);\n * {\n *  n: {x: 2, y: 1}\n *  s: {x: 2, y: 3}\n *  ....\n * }\n * ```\n * @returns Returns a map of cells, keyed by cardinal direction\n * @param grid Grid\n * @param cell Cell\n * @param bounds How to handle edges of grid\n * @param directions Directions to return\n */\nexport const neighbours = (grid: Grid, cell: Cell, bounds: BoundsLogic = `undefined`, directions?: ReadonlyArray<CardinalDirection>): Neighbours => {\n  const dirs = directions ?? allDirections;\n  const points = dirs.map(c => offset(grid, cell, getVectorFromCardinal(c), bounds));\n  return zipKeyValue<Cell>(dirs, points) as Neighbours;\n};\n\n/**\n * Returns the visual midpoint of a cell (eg pixel coordinate)\n *\n * @param cell\n * @param grid\n * @return \n */\nexport const cellMiddle = (cell: Cell, grid: Grid & GridVisual): Points.Point => {\n  guardCell(cell);\n\n  const size = grid.size;\n  const x = cell.x * size; // + (grid.spacing ? cell.x * grid.spacing : 0);\n  const y = cell.y * size; // + (grid.spacing ? cell.y * grid.spacing : 0);\n  return Object.freeze({x: x + size / 2, y: y + size / 2});\n};\n\n/**\n * Returns the cells on the line of start and end, inclusive\n *\n * ```js\n * // Get cells that connect 0,0 and 10,10\n * const cells = getLine({x:0,y:0}, {x:10,y:10});\n * ```\n * \n * This function does not handle wrapped coordinates.\n * @param start Starting cell\n * @param end End cell\n * @returns\n */\nexport const getLine = (start: Cell, end: Cell): ReadonlyArray<Cell> => {\n  // https://stackoverflow.com/a/4672319\n  guardCell(start);\n  guardCell(end);\n\n  // eslint-disable-next-line functional/no-let\n  let startX = start.x;\n  // eslint-disable-next-line functional/no-let\n  let startY = start.y;\n  const dx = Math.abs(end.x - startX);\n  const dy = Math.abs(end.y - startY);\n  const sx = (startX < end.x) ? 1 : -1;\n  const sy = (startY < end.y) ? 1 : -1;\n  // eslint-disable-next-line functional/no-let\n  let err = dx - dy;\n\n  const cells = [];\n  // eslint-disable-next-line no-constant-condition\n  while (true) {\n    // eslint-disable-next-line functional/immutable-data\n    cells.push(Object.freeze({x: startX, y: startY}));\n    if (startX === end.x && startY === end.y) break;\n    const e2 = 2 * err;\n    if (e2 > -dy) {\n      err -= dy;\n      startX += sx;\n    }\n    if (e2 < dx) {\n      err += dx;\n      startY += sy;\n    }\n  }\n  return cells;\n};\n\n/**\n * Returns cells that correspond to the cardinal directions at a specified distance\n *\n * @param grid Grid\n * @param steps Distance\n * @param start Start poiint\n * @param bound Logic for if bounds of grid are exceeded\n * @returns Cells corresponding to cardinals\n */\nexport const offsetCardinals = (grid: Grid, start: Cell, steps: number, bounds: BoundsLogic = `stop`): Neighbours => {\n  guardGrid(grid, `grid`);\n  guardCell(start, `start`);\n  guardInteger(steps, `aboveZero`, `steps`);\n\n  const directions = allDirections;\n  const vectors = directions.map(d => getVectorFromCardinal(d, steps));\n  const cells = directions.map((d, i) => offset(grid, start, vectors[i], bounds));\n\n  return zipKeyValue(directions, cells) as Neighbours;\n};\n\n/**\n * Returns an `{ x, y }` signed vector corresponding to the provided cardinal direction.\n * ```js\n * const n = getVectorFromCardinal(`n`); // {x: 0, y: -1}\n * ```\n * \n * Optional `multiplier` can be applied to vector\n * ```js\n * const n = getVectorFromCardinal(`n`, 10); // {x: 0, y: -10}\n * ```\n * \n * Blank direction returns `{ x: 0, y: 0 }`\n * @param cardinal Direction\n * @param multiplier Multipler\n * @returns Signed vector in the form of `{ x, y }`\n */\nexport const getVectorFromCardinal = (cardinal: CardinalDirection, multiplier: number = 1): Cell => {\n  // eslint-disable-next-line functional/no-let\n  let v;\n  switch (cardinal) {\n  case `n`:\n    v = {x: 0, y: -1 * multiplier};\n    break;\n  case `ne`:\n    v = {x: 1 * multiplier, y: -1 * multiplier};\n    break;\n  case `e`:\n    v = {x: 1 * multiplier, y: 0};\n    break;\n  case `se`:\n    v = {x: 1 * multiplier, y: 1 * multiplier};\n    break;\n  case `s`:\n    v = {x: 0, y: 1 * multiplier};\n    break;\n  case `sw`:\n    v = {x: -1 * multiplier, y: 1 * multiplier};\n    break;\n  case `w`:\n    v = {x: -1 * multiplier, y: 0};\n    break;\n  case `nw`:\n    v = {x: -1 * multiplier, y: -1 * multiplier};\n    break;\n  default:\n    v = {x: 0, y: 0};\n  }\n  return Object.freeze(v);\n};\n\n/**\n * Returns a list of cells from `start` to `end`.\n * \n * Throws an error if start and end are not on same row or column.\n *\n * @param start Start cell\n * @param end end clel\n * @param endInclusive\n * @return Array of cells\n */\nexport const simpleLine = function (start: Cell, end: Cell, endInclusive: boolean = false): ReadonlyArray<Cell> {\n  // eslint-disable-next-line functional/prefer-readonly-type\n  const cells: Cell[] = [];\n  if (start.x === end.x) {\n    // Vertical\n    const lastY = endInclusive ? end.y + 1 : end.y;\n    // eslint-disable-next-line functional/no-let\n    for (let y = start.y; y < lastY; y++) {\n      // eslint-disable-next-line functional/immutable-data\n      cells.push({x: start.x, y: y});\n    }\n  } else if (start.y === end.y) {\n    // Horizontal\n    const lastX = endInclusive ? end.x + 1 : end.x;\n    // eslint-disable-next-line functional/no-let\n    for (let x = start.x; x < lastX; x++) {\n      // eslint-disable-next-line functional/immutable-data\n      cells.push({x: x, y: start.y});\n    }\n  } else {\n    throw new Error(`Only does vertical and horizontal: ${start.x},${start.y} - ${end.x},${end.y}`);\n  }\n  return cells;\n};\n\n/**\n *\n * Returns a coordinate offset from `start` by `vector` amount.\n * \n * Different behaviour can be specified for how to handle when coordinates exceed the bounds of the grid\n * \n * \n * Note: x and y wrapping are calculated independently. A large wrapping of x, for example won't shift down a line \n * @param grid Grid to traverse\n * @param vector Offset in x/y\n * @param start Start point\n * @param bounds\n * @returns Cell\n */\nexport const offset = function (grid: Grid, start: Cell, vector: Cell, bounds: BoundsLogic = `undefined`): Cell | undefined {\n  guardCell(start, `start`, grid);\n  guardCell(vector);\n  guardGrid(grid, `grid`);\n\n  // eslint-disable-next-line functional/no-let\n  let x = start.x;\n  // eslint-disable-next-line functional/no-let\n  let y = start.y;\n  switch (bounds) {\n  case `wrap`:\n    x += vector.x % grid.cols;\n    y += vector.y % grid.rows;\n    if (x < 0) x = grid.cols + x;\n    else if (x >= grid.cols) {\n      x -= grid.cols;\n    }\n    if (y < 0) y = grid.rows + y;\n    else if (y >= grid.rows) {\n      y -= grid.rows;\n    }\n    break;\n  case `stop`:\n    x += vector.x;\n    y += vector.y;\n    x = clampIndex(x, grid.cols);\n    y = clampIndex(y, grid.rows);\n    break;\n  case `undefined`:\n    x += vector.x;\n    y += vector.y;\n    if (x < 0 || y < 0) return;\n    if (x >= grid.cols || y >= grid.rows) return;\n    break;\n  case `unbounded`:\n    x += vector.x;\n    y += vector.y;\n    break;\n  default:\n    throw new Error(`Unknown BoundsLogic case ${bounds}`);\n  }\n  return Object.freeze({x, y});\n};\n\nconst neighbourList = (grid: Grid, cell: Cell, directions: ReadonlyArray<CardinalDirection>, bounds: BoundsLogic): ReadonlyArray<Neighbour> => {\n  // Get neighbours for cell\n  const cellNeighbours = neighbours(grid, cell, bounds, directions);\n\n  // Filter out undefined cells\n  const entries = Object.entries(cellNeighbours);\n  return (entries as Array<NeighbourMaybe>).filter(isNeighbour);\n};\n\n/**\n * Visits every cell in grid using supplied selection function\n * In-built functions to use: visitorDepth, visitorBreadth, visitorRandom,\n * visitorColumn, visitorRow.\n * \n * Usage example:\n * ```js\n *  let visitor = Grids.visitor(Grids.visitorRandom, grid, startCell);\n *  for (let cell of visitor) {\n *   // do something with cell\n *  }\n * ```\n *\n * If you want to keep tabs on the visitor, pass in a MutableValueSet. This is\n * updated with visited cells (and is used internally anyway)\n * ```js\n *  let visited = new mutableValueSet<Grids.Cell>(c => Grids.cellKeyString(c));\n *  let visitor = Grids.visitor(Grids.visitorRandom, grid, startCell, visited);\n * ```\n * \n * To visit with some delay, try this pattern\n * ```js\n *  const delayMs = 100;\n *  const run = () => {\n *   let cell = visitor.next().value;\n *   if (cell === undefined) return;\n *   // Do something with cell\n *   setTimeout(run, delayMs);\n *  }\n *  setTimeout(run, delayMs);\n * ```\n * @param neighbourSelect Select neighbour to visit\n * @param grid Grid to visit\n * @param start Starting cell\n * @param visited Optional tracker of visited cells\n * @returns Cells\n */\n// eslint-disable-next-line functional/prefer-readonly-type\nexport const visitor = function* (\n  logic: VisitorLogic,\n  grid: Grid,\n  start: Cell,\n  opts: VisitorOpts = {}\n): VisitGenerator {\n\n  guardGrid(grid, `grid`);\n  guardCell(start, `start`, grid);\n\n\n  const v = opts.visited ?? setMutable<Cell>(c => cellKeyString(c));\n  const possibleNeighbours = logic.options ? logic.options : (g: Grid, c: Cell) => neighbourList(g, c, crossDirections, `undefined`);\n\n  if (!isCell(start)) throw new Error(`'start' parameter is undefined or not a cell`);\n\n  // eslint-disable-next-line functional/no-let\n  let cellQueue: Cell[] = [start];\n  // eslint-disable-next-line functional/no-let\n  let moveQueue: Neighbour[] = [];\n  // eslint-disable-next-line functional/no-let\n  let current: Cell | null = null;\n\n  while (cellQueue.length > 0) {\n    // console.log(`cell queue: ${cellQueue.length} move queue: ${moveQueue.length} current: ${JSON.stringify(current)}` );\n    if (current === null) {\n      // eslint-disable-next-line functional/immutable-data\n      const nv = cellQueue.pop();\n      if (nv === undefined) {\n        // console.log(`cellQueue drained`);\n        break;\n      }\n      current = nv;\n    }\n\n    if (!v.has(current)) {\n      v.add(current);\n      yield (current);\n\n      const nextSteps = possibleNeighbours(grid, current)\n        .filter(step => !v.has(step[1]));\n\n      if (nextSteps.length === 0) {\n        // No more moves for this cell\n        if (current !== null) {\n          cellQueue = cellQueue.filter(cq => cellEquals(cq, current as Cell));\n        }\n      } else {\n        // eslint-disable-next-line functional/immutable-data\n        moveQueue.push(...nextSteps);\n      }\n    }\n\n    // Remove steps already made\n    moveQueue = moveQueue.filter(step => !v.has(step[1]));\n\n    if (moveQueue.length === 0) {\n      // console.log(`moveQueue empty`);\n      current = null;\n    } else {\n      // Pick move\n      const potential = logic.select(moveQueue);\n      if (potential !== undefined) {\n        // eslint-disable-next-line functional/immutable-data\n        cellQueue.push(potential[1]);\n        current = potential[1];\n      }\n    }\n  }\n};\n\nexport const visitorDepth = (grid: Grid, start: Cell, opts: VisitorOpts = {}) => visitor({\n  select: (nbos) => nbos[nbos.length - 1]\n},\ngrid,\nstart,\nopts);\n\nexport const visitorBreadth = (grid: Grid, start: Cell, opts: VisitorOpts = {}) => visitor({\n  select: (nbos) => nbos[0]\n},\ngrid,\nstart,\nopts);\n\nconst randomNeighbour = (nbos: readonly Neighbour[]) => randomElement(nbos); // .filter(isNeighbour));\n\nexport const visitorRandomContiguous = (grid: Grid, start: Cell, opts: VisitorOpts = {}) => visitor({\n  select: randomNeighbour\n},\ngrid,\nstart,\nopts);\n\nexport const visitorRandom = (grid: Grid, start: Cell, opts: VisitorOpts = {}) => visitor({\n  options: (grid, cell) => {\n    const t: Neighbour[] = [];\n    for (const c of cells(grid, cell)) {\n      // eslint-disable-next-line functional/immutable-data\n      t.push([`n`, c]);\n    }\n    return t;\n  },\n  select: randomNeighbour\n},\ngrid,\nstart,\nopts);\n\nexport const visitorRow = (grid: Grid, start: Cell, opts: VisitorOpts = {}) => {\n  const {reversed = false} = opts;\n\n  const neighbourSelect = (nbos: readonly Neighbour[]) => nbos.find(n => n[0] === (reversed ? `w` : `e`));\n\n  const possibleNeighbours = (grid: Grid, cell: Cell): ReadonlyArray<Neighbour> => {\n    if (reversed) {\n      // WALKING BACKWARD ALONG RONG\n      if (cell.x > 0) {\n        // All fine, step to the left\n        cell = {x: cell.x - 1, y: cell.y};\n      } else {\n        // At the beginning of a row\n        if (cell.y > 0) {\n          // Wrap to next row up\n          cell = {x: grid.cols - 1, y: cell.y - 1};\n        } else {\n          // Wrap to end of grid\n          cell = {x: grid.cols - 1, y: grid.rows - 1};\n        }\n      }\n    } else {\n      /*\n       * WALKING FORWARD ALONG ROWS\n       * console.log(`${cell.x}, ${cell.y}`);\n       */\n      if (cell.x < grid.rows - 1) {\n        // All fine, step to the right\n        cell = {x: cell.x + 1, y: cell.y};\n      } else {\n        // At the end of a row\n        if (cell.y < grid.rows - 1) {\n          // More rows available, wrap to next row down\n          cell = {x: 0, y: cell.y + 1};\n        } else {\n          // No more rows available, wrap to start of the grid\n          cell = {x: 0, y: 0};\n        }\n      }\n    }\n    return [[(reversed ? `w` : `e`), cell]];\n  };\n\n  const logic: VisitorLogic = {\n    select: neighbourSelect,\n    options: possibleNeighbours\n  };\n\n  return visitor(logic, grid, start, opts);\n};\n\n/**\n * Runs the provided `visitor` for `steps`, returning the cell we end at\n * \n * ```js\n * // Get a cell 10 steps away (row-wise) from start\n * const cell = visitFor(grid, start, 10, visitorRow);\n * ```\n * @param grid Grid to traverse\n * @param start Start point\n * @param steps Number of steps\n * @param visitor Visitor function\n * @returns \n */\nexport const visitFor = (grid: Grid, start: Cell, steps: number, visitor: Visitor): Cell => {\n  guardInteger(steps, ``, `steps`);\n\n  const opts: VisitorOpts = {\n    reversed: steps < 0\n  };\n  steps = Math.abs(steps);\n\n  // eslint-disable-next-line functional/no-let\n  let c = start;\n  // eslint-disable-next-line functional/no-let\n  let v = visitor(grid, start, opts);\n  v.next(); // Burn up starting cell\n\n  // eslint-disable-next-line functional/no-let\n  let stepsMade = 0;\n\n  while (stepsMade < steps) {\n    stepsMade++;\n    const {value} = v.next();\n    if (value) {\n      c = value;\n      if (opts.debug) console.log(`stepsMade: ${stepsMade} cell: ${c.x}, ${c.y} reverse: ${opts.reversed}`);\n    } else {\n      if (steps >= grid.cols * grid.rows) {\n        steps -= grid.cols * grid.rows;\n        stepsMade = 0;\n        v = visitor(grid, start, opts);\n        v.next();\n        c = start;\n        if (opts.debug) console.log(`resetting visitor to ${steps}`);\n      } else throw new Error(`Value not received by visitor`);\n    }\n  }\n  return c;\n};\n\n/**\n * Visits cells running down columns, left-to-right.\n * @param grid Grid to traverse\n * @param start Start cell\n * @param opts Options\n * @returns Visitor generator\n */\nexport const visitorColumn = (grid: Grid, start: Cell, opts: VisitorOpts = {}):VisitGenerator => {\n  const {reversed = false} = opts;\n  const logic: VisitorLogic = {\n    select: (nbos) => nbos.find(n => n[0] === (reversed ? `n` : `s`)),\n    options: (grid, cell): ReadonlyArray<Neighbour> => {\n      if (reversed) {\n        // WALK UP COLUMN, RIGHT-TO-LEFT\n        if (cell.y > 0) {\n          // Easy case\n          cell = {x: cell.x, y: cell.y - 1};\n        } else {\n          // Top of column\n          if (cell.x === 0) {\n            // Top-left corner, need to wrap\n            cell = {x: grid.cols - 1, y: grid.rows - 1};\n          } else {\n            cell = {x: cell.x - 1, y: grid.rows - 1};\n          }\n        }\n      } else {\n        // WALK DOWN COLUMNS, LEFT-TO-RIGHT\n        if (cell.y < grid.rows - 1) {\n          // Easy case, move down by one\n          cell = {x: cell.x, y: cell.y + 1};\n        } else {\n          // End of column\n          if (cell.x < grid.cols - 1) {\n            // Move to next column and start at top\n            cell = {x: cell.x + 1, y: 0};\n          } else {\n            // Move to start of grid\n            cell = {x: 0, y: 0};\n          }\n        }\n      }\n      return [[reversed ? `n` : `s`, cell]];\n    }\n  };\n  return visitor(logic, grid, start, opts);\n};\n\n/**\n * Enumerate rows of grid, returning all the cells in the row\n * ```js\n * for (const row of Grid.rows(shape)) {\n *  // row is an array of Cells.\n * }\n * ```\n * @param grid \n * @param start \n */\nexport const rows = function* (grid: Grid, start: Cell = {x: 0, y: 0}) {\n  //eslint-disable-next-line functional/no-let\n  let row = start.y;\n  //eslint-disable-next-line functional/no-let\n  let rowCells: Cell[] = [];\n \n  for (const c of cells(grid, start)) {\n    if (c.y !== row) {\n      yield rowCells;\n      rowCells = [c];\n      row = c.y;\n    } else {\n      //eslint-disable-next-line functional/immutable-data\n      rowCells.push(c);\n    }\n  }\n  if (rowCells.length > 0) yield rowCells;\n};\n\n/**\n * Enumerate all cells in an efficient manner. Runs left-to-right, top-to-bottom.\n * If end of grid is reached, iterator will wrap to ensure all are visited.\n *\n * @param grid\n * @param start\n */\nexport const cells = function* (grid: Grid, start: Cell = {x: 0, y: 0}) {\n  guardGrid(grid, `grid`);\n  guardCell(start, `start`, grid);\n\n  // eslint-disable-next-line functional/no-let\n  let {x, y} = start;\n  // eslint-disable-next-line functional/no-let\n  let canMove = true;\n  do {\n    yield {x, y};\n    x++;\n    if (x === grid.cols) {\n      y++;\n      x = 0;\n    }\n    if (y === grid.rows) {\n      y = 0;\n      x = 0;\n    }\n    if (x === start.x && y === start.y) canMove = false; // Complete\n  } while (canMove);\n};","import { Lines, Beziers, Rects, Points } from './index.js';\n\n//eslint-disable-next-line  functional/no-mixed-type\nexport type Path = {\n  length():number\n/**\n   * Returns a point at a relative (0.0-1.0) position along the path\n   *\n   * @param {number} t Relative position (0.0-1.0)\n   * @returns {Point} Point\n   */\n  interpolate(t:number):Points.Point\n  bbox():Rects.RectPositioned\n  /**\n   * Returns the nearest point on path to `point`\n   * @param point \n   */\n  nearest(point:Points.Point):Points.Point\n  toString():string\n  toSvgString():readonly string[]\n  readonly kind:`compound` | `elliptical` | `circular` | `arc` | `bezier/cubic` | `bezier/quadratic` | `line`\n}\n/**\n * Return the start point of a path\n *\n * @param path\n * @return Point\n */\nexport const getStart = function (path:Path):Points.Point {\n  if (Beziers.isQuadraticBezier(path)) return path.a;\n  else if (Lines.isLine(path)) return path.a;\n  else throw new Error(`Unknown path type ${JSON.stringify(path)}`);\n};\n\n/**\n * Return the end point of a path\n *\n * @param path\n * @return Point\n */\nexport const getEnd = function (path:Path):Points.Point {\n  if (Beziers.isQuadraticBezier(path)) return path.b;\n  else if (Lines.isLine(path)) return path.b;\n  else throw new Error(`Unknown path type ${JSON.stringify(path)}`);\n};\n\nexport type WithBeziers = {\n  //eslint-disable-next-line  functional/no-method-signature\n  getBeziers():readonly Path[]\n};","import { Points, Lines } from './index.js';\nimport { RandomSource, defaultRandom } from \"../Random.js\";\nexport type Rect = {\n  readonly width:number,\n  readonly height:number,\n}\nexport type RectPositioned = Points.Point & Rect;\n\nexport const empty = Object.freeze({ width:0, height: 0 });\nexport const emptyPositioned = Object.freeze({ x:0, y:0, width:0, height: 0 });\n\nexport const placeholder = Object.freeze({ width: Number.NaN, height: Number.NaN });\nexport const placeholderPositioned = Object.freeze({ x: Number.NaN, y:Number.NaN, width: Number.NaN, height: Number.NaN });\n\nexport const isEmpty = (rect:Rect):boolean => rect.width === 0 && rect.height === 0;\nexport const isPlaceholder = (rect:Rect):boolean => Number.isNaN(rect.width) && Number.isNaN(rect.height);\n\n/**\n * Returns _true_ if `p` has a position (x,y) \n * @param p Point, Rect or RectPositiond\n * @returns \n */\nexport const isPositioned = (p:Points.Point | Rect | RectPositioned):p is Points.Point => (p as Points.Point).x !== undefined && (p as Points.Point).y !== undefined;\n\n/**\n * Returns _true_ if `p` has width and height.\n * @param p\n * @returns \n */\nexport const isRect = (p:number|unknown):p is Rect => {\n  if (p === undefined) return false;\n  if ((p as Rect).width === undefined) return false;\n  if ((p as Rect).height === undefined) return false;\n  return true;\n};\n\n/**\n * Returns _true_ if `p` is a positioned rectangle\n * Having width, height, x and y properties.\n * @param p \n * @returns \n */\n//eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport const isRectPositioned = (p:Rect|RectPositioned|any):p is RectPositioned => isRect(p) && isPositioned(p);\n\n/**\n * Initialise a rectangle based on the width and height of a HTML element.\n * \n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\" \n * Rects.fromElement(document.querySelector(`body`));\n * ```\n * @param el \n * @returns \n */\nexport const fromElement = (el:HTMLElement):Rect => ({ width: el.clientWidth, height: el.clientHeight });\n\n/**\n * Returns _true_ if the width & height of the two rectangles is the same.\n * \n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * const rectA = { width: 10, height: 10, x: 10, y: 10 };\n * const rectB = { width: 10, height: 10, x: 20, y: 20 };\n * \n * // True, even though x,y are different\n * Rects.isEqualSize(rectA, rectB);\n * \n * // False, because coordinates are different\n * Rects.isEqual(rectA, rectB)\n * ```\n * @param a \n * @param b \n * @returns \n */\nexport const isEqualSize = (a:Rect, b:Rect):boolean => {\n  if (a === undefined) throw new Error(`a undefined`);\n  if (b === undefined) throw new Error(`b undefined`);\n  return a.width === b.width && a.height === b.height;\n};\n\n/**\n * Returns a rectangle from width, height\n * ```js\n * const r = Rects.fromNumbers(100, 200);\n * // {width: 100, height: 200}\n * ```\n * \n * Use {@link toArray} for the opposite conversion.\n * \n * @param width \n * @param height \n */\nexport function fromNumbers(width:number, height:number):Rect;\n\n/**\n * Returns a rectangle from x,y,width,height\n * \n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * const r = Rects.fromNumbers(10, 20, 100, 200);\n * // {x: 10, y: 20, width: 100, height: 200}\n * ```\n * \n * Use the spread operator (...) if the source is an array:\n * ```js\n * const r3 = Rects.fromNumbers(...[10, 20, 100, 200]);\n * ```\n * \n * Use {@link toArray} for the opposite conversion.\n * \n * @param x \n * @param y \n * @param width \n * @param height \n */\nexport function fromNumbers(x:number, y:number, width:number, height:number):RectPositioned;\n\n/**\n * Returns a rectangle from a series of numbers: x, y, width, height OR width, height\n * \n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * const r1 = Rects.fromNumbers(100, 200);\n * // {width: 100, height: 200}\n * \n * const r2 = Rects.fromNumbers(10, 20, 100, 200);\n * // {x: 10, y: 20, width: 100, height: 200}\n * ```\n * Use the spread operator (...) if the source is an array:\n * \n * ```js\n * const r3 = Rects.fromNumbers(...[10, 20, 100, 200]);\n * ```\n * \n * Use {@link toArray} for the opposite conversion.\n * \n * @see toArray\n * @param xOrWidth \n * @param yOrHeight \n * @param width \n * @param height \n * @returns \n */\n//eslint-disable-next-line func-style\nexport function fromNumbers(xOrWidth:number, yOrHeight:number, width?:number, height?:number):Rect|RectPositioned {\n\n  if (width === undefined || height === undefined) {\n    if (typeof xOrWidth !== `number`) throw new Error(`width is not an number`);\n    if (typeof yOrHeight !== `number`) throw new Error(`height is not an number`);\n    return Object.freeze({ width:xOrWidth, height:yOrHeight });\n  }\n  if (typeof xOrWidth !== `number`) throw new Error(`x is not an number`);\n  if (typeof yOrHeight !== `number`) throw new Error(`y is not an number`);\n  if (typeof width !== `number`) throw new Error(`width is not an number`);\n  if (typeof height !== `number`) throw new Error(`height is not an number`);\n\n  return Object.freeze({ x:xOrWidth, y:yOrHeight, width, height });\n}\n\n/**\n * Rectangle as array: `[width, height]`\n */\nexport type RectArray = readonly [width:number, height:number];\n\n/**\n * Positioned rectangle as array: `[x, y, width, height]`\n */\nexport type RectPositionedArray = readonly [x:number, y:number, width:number, height:number];\n\n/**\n * Converts a rectangle to an array of numbers. See {@link fromNumbers} for the opposite conversion.\n * \n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * \n * const r1 = Rects.toArray({ x: 10, y:20, width: 100, height: 200 });\n * // [10, 20, 100, 200]\n * const r2 = Rects.toArray({ width: 100, height: 200 });\n * // [100, 200]\n * ```\n * @param rect \n * @see fromNumbers\n */\nexport function toArray (rect:Rect):RectArray;\n\n/**\n * Converts a rectangle to an array of numbers. See {@link fromNumbers} for the opposite conversion.\n * \n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n *\n * const r1 = Rects.toArray({ x: 10, y:20, width: 100, height: 200 });\n * // [10, 20, 100, 200]\n * const r2 = Rects.toArray({ width: 100, height: 200 });\n * // [100, 200]\n * ```\n * @param rect \n * @see fromNumbers\n */\nexport function toArray(rect:RectPositioned):RectPositionedArray;\n\n/**\n * Converts a rectangle to an array of numbers. See {@link fromNumbers} for the opposite conversion.\n * \n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * const r1 = Rects.toArray({ x: 10, y:20, width: 100, height: 200 });\n * // [10, 20, 100, 200]\n * const r2 = Rects.toArray({ width: 100, height: 200 });\n * // [100, 200]\n * ```\n * @param rect \n * @see fromNumbers\n */\n// eslint-disable-next-line func-style\nexport function toArray(rect:Rect|RectPositioned):RectArray|RectPositionedArray {\n  if (isPositioned(rect)) {\n    return [rect.x, rect.y, rect.width, rect.height];\n  } else if (isRect(rect)) {\n    return [rect.width, rect.height];\n  } else throw new Error(`rect param is not a rectangle. Got: ${JSON.stringify(rect)}`);\n}\n\n/**\n * Returns _true_ if two rectangles have identical values.\n * Both rectangles must be positioned or not.\n * \n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * const rectA = { width: 10, height: 10, x: 10, y: 10 };\n * const rectB = { width: 10, height: 10, x: 20, y: 20 };\n * \n * // False, because coordinates are different\n * Rects.isEqual(rectA, rectB)\n * \n * // True, even though x,y are different\n * Rects.isEqualSize(rectA, rectB);\n * ```\n * @param a \n * @param b \n * @returns \n */\nexport const isEqual = (a:Rect|RectPositioned, b:Rect|RectPositioned):boolean => {\n  if (isPositioned(a) && isPositioned(b)) {\n    if (!Points.isEqual(a, b)) return false;\n    return a.width === b.width && a.height === b.height;\n\n  } else if (!isPositioned(a) && !isPositioned(b)) {\n    return a.width === b.width && a.height === b.height;\n  } else {\n    // One param is positioned, the other is not\n    return false;\n  }\n};\n\n/**\n * Subtracts width/height of `b` from `a` (ie: a - b), returning result.\n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * const rectA = { width: 100, height: 100 };\n * const rectB = { width: 200, height: 200 };\n * \n * // Yields: { width: -100, height: -100 }\n * Rects.subtract(rectA, rectB);\n * ```\n * @param a \n * @param b \n */\nexport function subtract (a:Rect, b:Rect):Rect;\n/**\n * Subtracts a width/height from `a`, returning result.\n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * const rect = { width: 100, height: 100 };\n * \n * // Yields: { width: -100, height: -100 }\n * Rects.subtract(rect, 200, 200);\n * ```\n * @param a \n * @param width \n * @param height \n */\nexport function subtract (a:Rect, width:number, height?:number):Rect;\n\n/**\n * Subtracts width/height from `a`.\n * \n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * const rectA = { width: 100, height: 100 };\n * const rectB = { width: 200, height: 200 };\n * \n * // Yields: { width: -100, height: -100 }\n * Rects.subtract(rectA, rectB);\n * Rects.subtract(rectA, 200, 200);\n * ```\n * @param a \n * @param b \n * @param c \n * @returns \n */\n//eslint-disable-next-line func-style\nexport function subtract(a:Rect, b:Rect|number, c?:number):Rect {\n  if (a === undefined) throw new Error(`First parameter undefined`);\n  if (typeof b === `number`) {\n    const height = c === undefined ? 0 : c;\n    return Object.freeze({\n      ...a,\n      width: a.width - b,\n      height: a.height - height\n    });\n  } else {\n    return Object.freeze({\n      ...a,\n      width: a.width - b.width,\n      height: a.height - b.height\n    });\n  }\n}\n\n\n/**\n * Sums width/height of `b` with `a` (ie: a + b), returning result.\n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * const rectA = { width: 100, height: 100 };\n * const rectB = { width: 200, height: 200 };\n * \n * // Yields: { width: 300, height: 300 }\n * Rects.sum(rectA, rectB);\n * ```\n * @param a \n * @param b \n */\nexport function sum (a:Rect, b:Rect):Rect;\n/**\n  * Sums width/height of `b` with `a` (ie: a + b), returning result.\n  * ```js\n  * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n  * const rect = { width: 100, height: 100 };\n  * \n  * // Yields: { width: 300, height: 300 }\n  * Rects.subtract(rect, 200, 200);\n  * ```\n  * @param a \n  * @param width \n  * @param height \n  */\nexport function sum (a:Rect, width:number, height?:number):Rect;\n \n/**\n  * Sums width/height of `b` with `a` (ie: a + b), returning result.\n  * \n  * ```js\n  * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n  * const rectA = { width: 100, height: 100 };\n  * const rectB = { width: 200, height: 200 };\n  * \n  * // Yields: { width: 300, height: 300 }\n  * Rects.sum(rectA, rectB);\n  * Rects.sum(rectA, 200, 200);\n  * ```\n  * @param a \n  * @param b \n  * @param c \n  * @returns \n  */\n//eslint-disable-next-line func-style\nexport function sum(a:Rect, b:Rect|number, c?:number):Rect {\n  if (a === undefined) throw new Error(`First parameter undefined`);\n  if (typeof b === `number`) {\n    const height = c === undefined ? 0 : c;\n    return Object.freeze({\n      ...a,\n      width: a.width + b,\n      height: a.height + height\n    });\n  } else {\n    return Object.freeze({\n      ...a,\n      width: a.width + b.width,\n      height: a.height + b.height\n    });\n  }\n}\n\n/**\n * Returns _true_ if `point` is within, or on boundary of `rect`.\n * \n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * Rects.intersectsPoint(rect, { x: 100, y: 100});\n * ```\n * @param rect \n * @param point \n */\nexport function intersectsPoint (rect:Rect|RectPositioned, point:Points.Point):boolean;\n\n/**\n * Returns true if x,y coordinate is within, or on boundary of `rect`.\n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * Rects.intersectsPoint(rect, 100, 100);\n * ```\n * @param rect\n * @param x \n * @param y \n */\nexport function intersectsPoint (rect:Rect|RectPositioned, x:number, y:number):boolean;\n\n/**\n * Returns true if point is within or on boundary of `rect`.\n * \n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * Rects.intersectsPoint(rect, { x: 100, y: 100});\n * Rects.intersectsPoint(rect, 100, 100);\n * ```\n * @param rect \n * @param a \n * @param b \n * @returns \n */\n//eslint-disable-next-line func-style\nexport function intersectsPoint(rect:Rect|RectPositioned, a:Points.Point|number, b?:number):boolean {\n  guard(rect, `rect`);\n  //eslint-disable-next-line functional/no-let\n  let x = 0;\n  //eslint-disable-next-line functional/no-let\n  let y = 0;\n  if (typeof a === `number`) {\n    if (b === undefined) throw new Error(`x and y coordinate needed`);\n    x = a;\n    y = b;\n  } else {\n    x = a.x;\n    y = a.y;\n  }\n  if (isPositioned(rect)) {\n    if (x - rect.x > rect.width || x < rect.x) return false;\n    if (y - rect.y > rect.height || y < rect.y) return false;\n  } else {\n    // Assume 0,0\n    if (x > rect.width || x < 0) return false;\n    if (y > rect.height || y < 0) return false;\n  }\n  return true;\n}\n\n/**\n * Initialises a rectangle based on its center, a width and height\n * \n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * \n * // Rectangle with center at 50,50, width 100 height 200\n * Rects.fromCenter({x: 50, y:50}, 100, 200);\n * ```\n * @param origin \n * @param width \n * @param height \n * @returns \n */\nexport const fromCenter = (origin:Points.Point, width:number, height:number):RectPositioned => {\n  Points.guard(origin, `origin`);\n\n  guardDim(width, `width`);\n  guardDim(height, `height`);\n\n  const halfW = width / 2;\n  const halfH = height / 2;\n  return { x: origin.x - halfW, y: origin.y - halfH, width: width, height: height };\n};\n\n/**\n * Returns the distance from the perimeter of `rect` to `pt`.\n * If the point is within the rectangle, 0 is returned.\n * \n * If `rect` does not have an x,y it's assumed to be 0,0\n * \n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * const rect = { width: 100, height: 100, x: 0, y: 0 };\n * Rects.distanceFromExterior(rect, { x: 20, y: 20 });\n * ```\n * @param rect Rectangle\n * @param pt Point\n * @returns Distance\n */\nexport const distanceFromExterior = (rect:RectPositioned, pt:Points.Point):number => {\n  guardPositioned(rect, `rect`);\n  Points.guard(pt, `pt`);\n  if (intersectsPoint(rect, pt)) return 0;\n  const dx = Math.max(rect.x - pt.x, 0, pt.x - rect.x + rect.width);\n  const dy = Math.max(rect.y - pt.y, 0, pt.y - rect.y + rect.height);\n  return Math.sqrt(dx*dx + dy*dy);\n};\n\n/**\n * Return the distance of `pt` to the center of `rect`.\n * \n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * const rect = { width: 100, height: 100, x: 0, y: 0 };\n * Rects.distanceFromCenter(rect, { x: 20, y: 20 });\n * ```\n * @param rect \n * @param pt \n * @returns \n */\nexport const distanceFromCenter = (rect:RectPositioned, pt:Points.Point):number => Points.distance(center(rect), pt);\n\n\n/**\n * Returns a rectangle based on provided four corners.\n * \n * To create a rectangle that contains an arbitary set of points, use {@link Geometry.Points.bbox | Geometry.Points.bbox}.\n * \n * Does some sanity checking such as:\n *  - x will be smallest of topLeft/bottomLeft\n *  - y will be smallest of topRight/topLeft\n *  - width will be largest between top/bottom left and right\n *  - height will be largest between left and right top/bottom\n * \n */\nexport const maxFromCorners = (topLeft:Points.Point, topRight:Points.Point, bottomRight:Points.Point, bottomLeft:Points.Point):RectPositioned => {\n  if (topLeft.y > bottomRight.y) throw new Error(`topLeft.y greater than bottomRight.y`);\n  if (topLeft.y > bottomLeft.y) throw new Error(`topLeft.y greater than bottomLeft.y`);\n\n  const w1  = topRight.x - topLeft.x;\n  const w2 = bottomRight.x - bottomLeft.x;\n  const h1 = Math.abs(bottomLeft.y - topLeft.y);\n  const h2 = Math.abs(bottomRight.y - topRight.y);\n  return {\n    x: Math.min(topLeft.x, bottomLeft.x),\n    y: Math.min(topRight.y, topLeft.y),\n    width: Math.max(w1, w2),\n    height: Math.max(h1, h2) \n  };\n};\n\nconst guardDim = (d:number, name:string = `Dimension`) => {\n  if (d === undefined) throw Error(`${name} is undefined`);\n  if (isNaN(d)) throw Error(`${name} is NaN`);\n  if (d < 0) throw Error(`${name} cannot be negative`);\n};\n\n/**\n * Throws an error if rectangle is missing fields or they\n * are not valid.\n * @param rect \n * @param name \n */\nexport const guard = (rect:Rect, name:string = `rect`) => {\n  if (rect === undefined) throw Error(`{$name} undefined`);\n  if (isPositioned(rect)) Points.guard(rect, name);\n  guardDim(rect.width, name + `.width`);\n  guardDim(rect.height, name + `.height`);\n};\n\nconst guardPositioned = (rect:RectPositioned, name:string = `rect`) => {\n  if (!isPositioned(rect)) throw new Error(`Expected ${name} to have x,y`);\n  guard(rect, name);\n};\n\n/**\n * Creates a rectangle from its top-left coordinate, a width and height.\n * \n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * \n * // Rectangle at 50,50 with width of 100, height of 200.\n * const rect = Rects.fromTopLeft({ x: 50, y:50 }, 100, 200);\n * ```\n * @param origin \n * @param width \n * @param height \n * @returns \n */\nexport const fromTopLeft = (origin:Points.Point, width:number, height:number):RectPositioned => {\n  guardDim(width, `width`);\n  guardDim(height, `height`);\n  Points.guard(origin, `origin`);\n\n  return { x: origin.x, y: origin.y, width: width, height: height };\n};\n\n/**\n * Returns the four corners of a rectangle as an array of Points.\n * \n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * const rect = { width: 100, height: 100, x: 0, y: 0};\n * const pts = Rects.corners(rect);\n * ```\n * \n * If the rectangle is not positioned, is origin can be provided.\n * @param rect \n * @param origin \n * @returns \n */\nexport const corners = (rect:RectPositioned|Rect, origin?:Points.Point):readonly Points.Point[] => {\n  guard(rect);\n  if (origin === undefined && Points.isPoint(rect)) origin = rect;\n  else if (origin === undefined) throw new Error(`Unpositioned rect needs origin param`);\n\n  return [\n    { x: origin.x, y: origin.y },\n    { x: origin.x + rect.width, y: origin.y },\n    { x: origin.x + rect.width, y: origin.y + rect.height },\n    { x: origin.x, y: origin.y + rect.height }\n  ];\n};\n\n/**\n * Returns a point on the edge of rectangle\n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * \n * const r1 = {x: 10, y: 10, width: 100, height: 50};\n * Rects.getEdgeX(r1, `right`);  // Yields: 110\n * Rects.getEdgeX(r1, `bottom`); // Yields: 10\n * \n * const r2 = {width: 100, height: 50};\n * Rects.getEdgeX(r2, `right`);  // Yields: 100\n * Rects.getEdgeX(r2, `bottom`); // Yields: 0\n * ```\n * @param rect \n * @param edge Which edge: right, left, bottom, top\n * @returns \n */\nexport const getEdgeX = (rect:RectPositioned|Rect, edge:`right`|`bottom`|`left`|`top`):number => {\n  guard(rect);\n  switch (edge) {\n  case `top`:\n    return (Points.isPoint(rect)) ? rect.x  : 0;\n  case `bottom`:\n    return (Points.isPoint(rect)) ? rect.x  : 0;\n  case `left`:\n    return (Points.isPoint(rect)) ? rect.y  : 0;\n  case `right`:\n    return (Points.isPoint(rect)) ? rect.x + rect.width  : rect.width;\n  }\n};\n\n/**\n * Returns a point on the edge of rectangle\n * \n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * \n * const r1 = {x: 10, y: 10, width: 100, height: 50};\n * Rects.getEdgeY(r1, `right`);  // Yields: 10\n * Rects.getEdgeY(r1, `bottom`); // Yields: 60\n * \n * const r2 = {width: 100, height: 50};\n * Rects.getEdgeY(r2, `right`);  // Yields: 0\n * Rects.getEdgeY(r2, `bottom`); // Yields: 50\n * ```\n * @param rect \n * @param edge Which edge: right, left, bottom, top\n * @returns \n */\nexport const getEdgeY = (rect:RectPositioned|Rect, edge:`right`|`bottom`|`left`|`top`):number => {\n  guard(rect);\n  switch (edge) {\n  case `top`:\n    return (Points.isPoint(rect)) ? rect.y  : 0;\n  case `bottom`:\n    return (Points.isPoint(rect)) ? rect.y + rect.height : rect.height;\n  case `left`:\n    return (Points.isPoint(rect)) ? rect.y  : 0;\n  case `right`:\n    return (Points.isPoint(rect)) ? rect.y  : 0;\n  }\n};\n\n/**\n * Returns `rect` divided by the width,height of `normaliseBy`. \n * This can be useful for normalising based on camera frame.\n * \n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * \n * const frameSize = {width: 640, height: 320};\n * const object = { x: 320, y: 160, width: 64, height: 32};\n * \n * const n = Rects.normaliseByRect(object, frameSize);\n * // Yields: {x: 0.5, y: 0.5, width: 0.1, height: 0.1}\n * ```\n * \n * Height and width can be supplied instead of a rectangle too:\n * ```js\n * const n = Rects.normaliseByRect(object, 640, 320);\n * ```\n * @param rect \n * @param normaliseBy \n * @returns \n */\nexport const normaliseByRect = (rect:Rect|RectPositioned, normaliseByOrWidth:Rect|number, height?:number):Rect|RectPositioned => {\n  //eslint-disable-next-line functional/no-let\n  let width;\n  if (height === undefined) {\n    if (isRect(normaliseByOrWidth)) {\n      height = normaliseByOrWidth.height;\n      width = normaliseByOrWidth.width;\n    } else {\n      throw new Error(`Expects rectangle or width and height parameters for normaliseBy`);\n    }\n  } else {\n    if (typeof normaliseByOrWidth === `number`) {\n      width = normaliseByOrWidth;\n    } else {\n      throw new Error(`Expects rectangle or width and height parameters for normaliseBy`);\n    }\n  }\n\n  if (isPositioned(rect)) {\n    return Object.freeze({\n      x: rect.x / width,\n      y: rect.y / height,\n      width: rect.width / width,\n      height: rect.height / height\n    });\n  } else {\n    return Object.freeze({\n      width: rect.width / width,\n      height: rect.height / height\n    });\n  }\n};\n\n/**\n * Multiplies `a` by rectangle or width/height. Useful for denormalising a value.\n * \n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * \n * // Normalised rectangle of width 50%, height 50%\n * const r = {width: 0.5, height: 0.5};\n * \n * // Map to window:\n * const rr = Rects.multiply(r, window.innerWidth, window.innerHeight);\n * ```\n * \n * ```js\n * // Returns {width: someRect.width * someOtherRect.width ...}\n * Rects.multiply(someRect, someOtherRect);\n * \n * // Returns {width: someRect.width * 100, height: someRect.height * 200}\n * Rects.multiply(someRect, 100, 200);\n * ```\n * \n * Multiplication applies to the first parameter's x/y fields, if present.\n */\nexport function multiply(a:RectPositioned, b:Rect|number, c?:number):RectPositioned;\n\n/**\n * Multiplies `a` by rectangle or width/height. Useful for denormalising a value.\n * \n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * \n * // Normalised rectangle of width 50%, height 50%\n * const r = {width: 0.5, height: 0.5};\n * \n * // Map to window:\n * const rr = Rects.multiply(r, window.innerWidth, window.innerHeight);\n * ```\n * \n * ```js\n * // Returns {width: someRect.width * someOtherRect.width ...}\n * Rects.multiply(someRect, someOtherRect);\n * \n * // Returns {width: someRect.width * 100, height: someRect.height * 200}\n * Rects.multiply(someRect, 100, 200);\n * ```\n * \n * Multiplication applies to the first parameter's x/y fields, if present.\n */\nexport function multiply(a:Rect, b:Rect|number, c?:number):Rect;\nexport function multiply(a:RectPositioned, b:Rect):RectPositioned;\n\n/**\n * Multiplies `a` by rectangle or width/height. Useful for denormalising a value.\n * \n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * \n * // Normalised rectangle of width 50%, height 50%\n * const r = {width: 0.5, height: 0.5};\n * \n * // Map to window:\n * const rr = Rects.multiply(r, window.innerWidth, window.innerHeight);\n * ```\n * \n * ```js\n * // Returns {width: someRect.width * someOtherRect.width ...}\n * Rects.multiply(someRect, someOtherRect);\n * \n * // Returns {width: someRect.width * 100, height: someRect.height * 200}\n * Rects.multiply(someRect, 100, 200);\n * ```\n * \n * Multiplication applies to the first parameter's x/y fields, if present.\n */\n//eslint-disable-next-line func-style\nexport function multiply(a:RectPositioned|Rect, b:Rect|number, c?:number):RectPositioned|Rect {\n  guard(a, `a`);\n  if (isRect(b)) {\n    if (isRectPositioned(a)) {\n      return Object.freeze({\n        ...a,\n        x: a.x * b.width,\n        y: a.y * b.height,\n        width: a.width * b.width,\n        height: a.height * b.height\n      });\n    } else {\n      return Object.freeze({\n        ...a,\n        width: a.width * b.width,\n        height: a.height * b.height\n      });\n    }\n  } else {\n    if (typeof b !== `number`) throw new Error(`Expected second parameter of type Rect or number. Got ${JSON.stringify(b)}`);\n    if (c === undefined) c = b;\n\n    if (isRectPositioned(a)) {\n      return Object.freeze({\n        ...a,\n        x: a.x * b,\n        y: a.y * c,\n        width: a.width * b,\n        height: a.height * c\n      });\n    } else {\n      return Object.freeze({\n        ...a,\n        width: a.width * b,\n        height: a.height * c\n      });\n    }\n  }\n}\n\n/**\n * Multiplies all components of `rect` by `amount`\n * @param rect \n * @param amount \n */\nexport function multiplyScalar(rect:Rect, amount:number):Rect;\n/**\n * Multiplies all components of `rect` by `amount`\n * @param rect \n * @param amount \n */\nexport function multiplyScalar(rect:RectPositioned, amount:number):RectPositioned;\n/**\n * Multiplies all components of `rect` by `amount`\n * @param rect \n * @param amount \n */\nexport function multiplyScalar(rect:Rect|RectPositioned, amount:number):Rect|RectPositioned {\n  if (isPositioned(rect)) {\n    return Object.freeze({\n      ...rect,\n      x: rect.x * amount,\n      y: rect.y * amount,\n      width: rect.width * amount,\n      height: rect.height * amount\n    });\n  } else {\n    return Object.freeze({\n      ...rect,\n      width: rect.width * amount,\n      height: rect.height * amount\n    });\n  }\n}\n\n/**\n * Returns the center of a rectangle as a {@link Geometry.Points.Point}.\n *  If the rectangle lacks a position and `origin` parameter is not provided, 0,0 is used instead.\n * \n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * \n * const p = Rects.center({x:10, y:20, width:100, height:50});\n * const p2 = Rects.center({width: 100, height: 50}); // Assumes 0,0 for rect x,y\n * ```\n * @param rect Rectangle\n * @param origin Optional origin. Overrides `rect` position if available. If no position is available 0,0 is used by default.\n * @returns \n */\nexport const center = (rect:RectPositioned|Rect, origin?:Points.Point):Points.Point => {\n  guard(rect);\n  if (origin === undefined && Points.isPoint(rect)) origin = rect;\n  else if (origin === undefined) origin = { x:0, y:0 }; // throw new Error(`Unpositioned rect needs origin param`);\n\n  return Object.freeze({\n    x: origin.x + rect.width / 2,\n    y: origin.y + rect.height / 2\n  });\n};\n\n/**\n * Returns the length of each side of the rectangle (top, right, bottom, left)\n * \n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * const rect = { width: 100, height: 100, x: 100, y: 100 };\n * // Yields: array of length four\n * const lengths = Rects.lengths(rect);\n * ```\n * @param rect \n * @returns \n */\nexport const lengths = (rect:RectPositioned):readonly number[] => {\n  guardPositioned(rect, `rect`);\n  return edges(rect).map(l => Lines.length(l));\n};\n\n/**\n * Returns four lines based on each corner.\n * Lines are given in order: top, right, bottom, left\n * \n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * const rect = { width: 100, height: 100, x: 100, y: 100 };\n * // Yields: array of length four\n * const lines = Rects.lines(rect);\n * ```\n *\n * @param {(RectPositioned|Rect)} rect\n * @param {Points.Point} [origin]\n * @returns {Lines.Line[]}\n */\nexport const edges = (rect:RectPositioned|Rect, origin?:Points.Point):readonly Lines.Line[] => {\n  const c = corners(rect, origin);\n\n  // Connect all the corners, back to first corner again\n  return Lines.joinPointsToLines(...c, c[0]);\n};\n\n/**\n * Returns the perimeter of `rect` (ie. sum of all edges)\n *  * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * const rect = { width: 100, height: 100, x: 100, y: 100 };\n * Rects.perimeter(rect);\n * ```\n * @param rect \n * @returns \n */\nexport const perimeter = (rect:Rect):number => {\n  guard(rect);\n  return rect.height + rect.height + rect.width + rect.width;\n};\n\n/**\n * Returns the area of `rect`\n * \n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * const rect = { width: 100, height: 100, x: 100, y: 100 };\n * Rects.area(rect);\n * ```\n * @param rect \n * @returns \n */\nexport const area = (rect:Rect):number => {\n  guard(rect);\n  return rect.height*rect.width;\n};\n\n/**\n * Returns a random positioned Rect on a 0..1 scale.\n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * const r = Rects.random(); // eg {x: 0.2549012, y:0.859301, width: 0.5212, height: 0.1423 }\n * ```\n * \n * A custom source of randomness can be provided:\n * ```js\n * import { Rects } from \"https://unpkg.com/ixfx/dist/geometry.js\";\n * import { weightedSkewed } from \"https://unpkg.com/ixfx/dist/random.js\"\n * const r = Rects.random(weightedSkewed(`quadIn`));\n * ```\n * @param rando \n * @returns \n */\nexport const random = (rando?:RandomSource):RectPositioned => {\n  if (rando === undefined) rando = defaultRandom;\n\n  return Object.freeze({\n    x: rando(),\n    y: rando(),\n    width: rando(),\n    height: rando()\n  });\n};","import {Path} from './Path.js';\r\nimport {degreeToRadian, Points} from './index.js';\r\n\r\n/**\r\n * An ellipse\r\n */\r\nexport type Ellipse = {\r\n  readonly radiusX: number\r\n  readonly radiusY: number\r\n  /**\r\n   * Rotation, in radians\r\n   */\r\n  readonly rotation?:number\r\n  readonly startAngle?:number\r\n  readonly endAngle?:number\r\n}\r\n\r\n/**\r\n * A {@link Ellipse} with position\r\n */\r\nexport type EllipsePositioned = Points.Point & Ellipse\r\n\r\n\r\nexport const fromDegrees = (radiusX:number, radiusY:number, rotationDeg:number = 0, startAngleDeg:number = 0, endAngleDeg:number = 360):Ellipse => ({\r\n  radiusX, radiusY,\r\n  rotation: degreeToRadian(rotationDeg),\r\n  startAngle: degreeToRadian(startAngleDeg),\r\n  endAngle: degreeToRadian(endAngleDeg)\r\n});\r\n\r\nexport type EllipticalPath = Ellipse & Path & {\r\n  readonly kind: `elliptical`\r\n};","import { toCartesian } from \"./Polar.js\";\nimport { integer as guardInteger } from \"../Guards.js\";\nimport { Triangles, Points, Rects, Circles } from \"./index.js\";\n\n/**\n * Returns the center of a shape\n * Shape can be: rectangle, triangle, circle\n * @param shape \n * @returns \n */\nexport const center = (shape?:Rects.Rect|Triangles.Triangle|Circles.Circle):Points.Point => {\n  if (shape === undefined) {\n    return Object.freeze({ x:0.5, y:0.5 });\n  } else if (Rects.isRect(shape)) {\n    return Rects.center(shape as Rects.Rect);\n  } else if (Triangles.isTriangle(shape)) {\n    return Triangles.centroid(shape);\n  } else if (Circles.isCircle(shape)) {\n    return Circles.center(shape);\n  } else {\n    throw new Error(`Unknown shape: ${JSON.stringify(shape)}`);\n  }\n};\n\n/**\n * Generates a starburst shape, returning an array of points. By default, initial point is top and horizontally-centred.\n * \n * ```\n * // Generate a starburst with four spikes\n * const pts = starburst(4, 100, 200);\n * ```\n * \n * `points` of two produces a lozenge shape.\n * `points` of three produces a triangle shape.\n * `points` of five is the familiar 'star' shape.\n *  \n * Note that the path will need to be closed back to the first point to enclose the shape.\n * \n * @example Create starburst and draw it. Note use of 'loop' flag to close the path\n * ```\n * const points = starburst(4, 100, 200);\n * Drawing.connectedPoints(ctx, pts, {loop: true, fillStyle: `orange`, strokeStyle: `red`});\n * ```\n * \n * Options:\n * * initialAngleRadian: angle offset to begin from. This overrides the `-Math.PI/2` default.\n * \n * @param points Number of points in the starburst. Defaults to five, which produces a typical star\n * @param innerRadius Inner radius. A proportionally smaller inner radius makes for sharper spikes. If unspecified, 50% of the outer radius is used.\n * @param outerRadius Outer radius. Maximum radius of a spike to origin\n * @param opts Options\n * @param origin Origin, or `{ x:0, y:0 }` by default.\n */\nexport const starburst = (outerRadius:number, points:number = 5, innerRadius?:number, origin:Points.Point = { x:0, y:0 }, opts?:{readonly initialAngleRadian?:number}):readonly Points.Point[] => {\n  guardInteger(points, `positive`, `points`);\n  const angle = Math.PI * 2 / points;\n  const angleHalf = angle / 2;\n\n  const initialAngle = opts?.initialAngleRadian ?? -Math.PI/2;\n  if (innerRadius === undefined) innerRadius = outerRadius/2;\n\n  //eslint-disable-next-line functional/no-let\n  let a = initialAngle;\n  const pts = [];\n  \n  //eslint-disable-next-line functional/no-let\n  for (let i = 0; i < points; i++) {\n    const peak = toCartesian(outerRadius, a, origin);\n    const left = toCartesian(innerRadius, a - angleHalf, origin);\n    const right = toCartesian(innerRadius, a + angleHalf, origin);\n\n    //eslint-disable-next-line functional/immutable-data\n    pts.push(left, peak);\n    //eslint-disable-next-line functional/immutable-data\n    if (i + 1 < points) pts.push(right);\n    a += angle;\n  }\n  return pts;\n};\n\n\nexport type ArrowOpts = {\n  readonly arrowSize?:number\n  readonly tailLength?:number\n  readonly tailThickness?:number\n  readonly angleRadian?:number\n}\n\n/**\n * Returns the points forming an arrow.\n * \n * @example Create an arrow anchored by its tip at 100,100\n * ```js\n * const opts = {\n *  tailLength: 10,\n *  arrowSize: 20,\n *  tailThickness: 5,\n *  angleRadian: degreeToRadian(45)\n * }\n * const arrow = Shapes.arrow({x:100, y:100}, `tip`, opts); // Yields an array of points\n * \n * // Eg: draw points\n * Drawing.connectedPoints(ctx, arrow, {strokeStyle: `red`, loop: true});\n * ```\n * \n * @param origin Origin of arrow \n * @param from Does origin describe the tip, tail or middle?\n * @param opts Options for arrow \n * @returns \n */\nexport const arrow = (origin:Points.Point, from:`tip`|`tail`|`middle`, opts:ArrowOpts = {}):readonly Points.Point[] => {\n  const tailLength = opts.tailLength ?? 10;\n  const tailThickness = opts.tailThickness ?? Math.max(tailLength/5, 5);\n  const angleRadian = opts.angleRadian ?? 0;\n  const arrowSize = opts.arrowSize ?? Math.max(tailLength/5, 15);\n\n  const triAngle = Math.PI/2;\n\n  //eslint-disable-next-line functional/no-let\n  let tri:Triangles.Triangle;\n  //eslint-disable-next-line functional/no-let\n  let tailPoints:readonly Points.Point[];\n\n  if (from === `tip`) {\n    tri = Triangles.equilateralFromVertex(origin, arrowSize, triAngle);\n    tailPoints = Rects.corners(Rects.fromTopLeft(\n      { x: tri.a.x - tailLength, y: origin.y - tailThickness / 2 },\n      tailLength,\n      tailThickness\n    ));\n  } else if (from === `middle`) {\n    const midX = tailLength + arrowSize / 2;\n    const midY = tailThickness / 2;\n    tri = Triangles.equilateralFromVertex({\n      x: origin.x + arrowSize*1.2,\n      y: origin.y \n    }, arrowSize, triAngle);\n\n    tailPoints = Rects.corners(Rects.fromTopLeft(\n      { x: origin.x - midX, y: origin.y - midY },\n      tailLength + arrowSize,\n      tailThickness\n    ));\n  } else {\n    //const midY = origin.y - tailThickness/2;\n    tailPoints = Rects.corners(Rects.fromTopLeft({ x: origin.x, y: origin.y - tailThickness/2 }, tailLength, tailThickness));\n    tri = Triangles.equilateralFromVertex({ x: origin.x + tailLength + arrowSize*0.7, y: origin.y }, arrowSize, triAngle);\n  }\n\n  const arrow = Points.rotate([\n    tailPoints[0], tailPoints[1], tri.a,\n    tri.b,\n    tri.c, tailPoints[2], tailPoints[3]\n  ], angleRadian, origin);\n\n  return arrow;\n};\n","import { degreeToRadian, radianToDegree } from \"./index.js\";\nimport * as Points from \"./Point.js\";\nimport { number as guardNumber } from '../Guards.js';\nconst piPi = Math.PI*2;\n\n//eslint-disable-next-line @typescript-eslint/naming-convention\nconst EmptyCartesian = Object.freeze({ x:0, y: 0 });\n\n/**\n * Polar coordinate, made up of a distance and angle in radians.\n * Most computations involving Coords require an `origin` as well.\n */\nexport type Coord = {\n  readonly distance:number,\n  readonly angleRadian:number\n}\n\n/**\n * Converts to Cartesian coordiantes\n */\ntype ToCartesian = {\n  (point:Coord, origin?:Points.Point):Points.Point\n  (distance:number, angleRadians:number, origin?:Points.Point):Points.Point\n}\n\n/**\n * Returns true if `p` seems to be a {@link Coord} (ie has both distance & angleRadian fields)\n * @param p \n * @returns True if `p` seems to be a Coord\n */\nexport const isCoord = (p:number|unknown):p is Coord => {\n  if ((p as Coord).distance === undefined) return false;\n  if ((p as Coord).angleRadian === undefined) return false;\n  return true;\n};\n\n/**\n * Converts a Cartesian coordinate to polar\n * \n * ```js\n * import { Polar } from 'https://unpkg.com/ixfx/dist/geometry.js';\n * \n * // Yields: { angleRadian, distance }\n * const polar = Polar.fromCartesian({x: 50, y: 50}, origin);\n * ```\n * \n * Any additional properties of `point` are copied to object.\n * @param point Point\n * @param origin Origin\n * @returns \n */\nexport const fromCartesian = (point:Points.Point, origin:Points.Point):Coord => {\n  point = Points.subtract(point, origin);\n  //eslint-disable-next-line functional/no-let\n  //let a =  Math.atan2(point.y, point.x);\n  //if (a < 0) a = Math.abs(a);\n  //else a = Math.PI + (Math.PI - a);\n\n  const angle = Math.atan2(point.y, point.x);\n  //if (point.x < 0 && point.y > 0) angle += 180;\n  //if (point.x > 0 && point.y < 0) angle += 360;\n  //if (point.x < 0 && point.y < 0) angle += 180;\n  \n  return Object.freeze({\n    ...point,\n    angleRadian: angle,\n    distance: Math.sqrt(point.x * point.x + point.y * point.y)\n  });\n};\n\n/**\n * Converts to Cartesian coordinate from polar.\n * \n * ```js\n * import { Polar } from 'https://unpkg.com/ixfx/dist/geometry.js';\n * \n * const origin = { x: 50, y: 50}; // Polar origin\n * // Yields: { x, y }\n * const polar = Polar.toCartesian({ distance: 10, angleRadian: 0 }, origin);\n * ```\n * \n * Distance and angle can be provided as numbers intead:\n * \n * ```\n * // Yields: { x, y }\n * const polar = Polar.toCartesian(10, 0, origin);\n * ```\n * \n * @param a\n * @param b \n * @param c \n * @returns \n */\nexport const toCartesian:ToCartesian = (a:Coord|number, b?:Points.Point|number, c?:Points.Point):Points.Point => {\n  if (isCoord(a)) {\n    if (b === undefined) b = Points.Empty;\n    if (Points.isPoint(b)) {\n      return polarToCartesian(a.distance, a.angleRadian, b);  \n    }\n    throw new Error(`Expecting (Coord, Point). Second parameter is not a point`);\n  } else {\n    if (typeof a === `number` && typeof b === `number`) {\n      if (c === undefined) c = Points.Empty;\n      if (!Points.isPoint(c)) throw new Error(`Expecting (number, number, Point). Point param wrong type`);\n      return polarToCartesian(a, b, c);\n    } else {\n      throw new Error(`Expecting parameters of (number, number). Got: (${typeof(a)}, ${typeof(b)}, ${typeof(c)}). a: ${JSON.stringify(a)}`);\n    }\n  }\n};\n\n/**\n * Produces an Archimedean spiral. It's a generator.\n * \n * ```js\n * const s = spiral(0.1, 1);\n * for (const coord of s) {\n *  // Use Polar coord...\n *  if (coord.step === 1000) break; // Stop after 1000 iterations\n * }\n * ```\n * \n * @param smoothness 0.1 pretty rounded, at around 5 it starts breaking down\n * @param zoom At smoothness 0.1, zoom starting at 1 is OK\n */\n//eslint-disable-next-line func-style\nexport function* spiral(smoothness:number, zoom:number):IterableIterator<Coord & {readonly step:number}> {\n  //eslint-disable-next-line functional/no-let\n  let step = 0;\n  \n  while (true) {\n    //eslint-disable-next-line functional/no-let\n    const a = smoothness * step++;\n    yield {\n      distance: zoom * a,\n      angleRadian: a,\n      step: step\n    };\n  }\n}\n\n/**\n * Returns a rotated coordiante\n * @param c Coordinate\n * @param amountRadian Amount to rotate, in radians \n * @returns \n */\nexport const rotate = (c:Coord, amountRadian:number):Coord => Object.freeze({\n  ...c,\n  angleRadian: c.angleRadian + amountRadian\n});\n\nexport const normalise = (c:Coord):Coord => {\n  //guard(v, `v`);\n  if (c.distance === 0) throw new Error(`Cannot normalise vector of length 0`);\n  return Object.freeze({\n    ...c,\n    distance: 1\n  });\n};\n\n/**\n * Throws an error if Coord is invalid\n * @param p \n * @param name \n */\nexport const guard = (p:Coord, name = `Point`) => {\n  if (p === undefined) throw new Error(`'${name}' is undefined. Expected {distance, angleRadian} got ${JSON.stringify(p)}`);\n  if (p === null) throw new Error(`'${name}' is null. Expected {distance, angleRadian} got ${JSON.stringify(p)}`);\n  if (p.angleRadian === undefined) throw new Error(`'${name}.angleRadian' is undefined. Expected {distance, angleRadian} got ${JSON.stringify(p)}`);\n  if (p.distance === undefined) throw new Error(`'${name}.distance' is undefined. Expected {distance, angleRadian} got ${JSON.stringify(p)}`);\n  if (typeof p.angleRadian !== `number`) throw new Error(`'${name}.angleRadian' must be a number. Got ${p.angleRadian}`);\n  if (typeof p.distance !== `number`) throw new Error(`'${name}.distance' must be a number. Got ${p.distance}`);\n \n  if (p.angleRadian === null) throw new Error(`'${name}.angleRadian' is null`);\n  if (p.distance === null) throw new Error(`'${name}.distance' is null`);\n  \n  if (Number.isNaN(p.angleRadian)) throw new Error(`'${name}.angleRadian' is NaN`);\n  if (Number.isNaN(p.distance)) throw new Error(`'${name}.distance' is NaN`);\n};\n/**\n * Calculate dot product of two Coords.\n * \n * Eg, power is the dot product of force and velocity\n * \n * Dot products are also useful for comparing similarity of\n *  angle between two unit Coord.\n * @param a \n * @param b \n * @returns \n */\nexport const dotProduct = (a:Coord, b:Coord):number => {\n  guard(a, `a`);\n  guard(b, `b`);\n  return a.distance * b.distance * Math.cos(b.angleRadian - a.angleRadian);\n};\n\n/**\n * Inverts the direction of coordinate. Ie if pointing north, will point south.\n * @param p \n * @returns \n */\nexport const invert = (p:Coord):Coord => {\n  guard(p, `c`);\n  return Object.freeze({\n    ...p,\n    angleRadian: p.angleRadian- Math.PI \n  });\n};\n\n/**\n * Returns true if Coords have same magnitude but opposite direction\n * @param a \n * @param b \n * @returns \n */\nexport const isOpposite = (a:Coord, b:Coord):boolean => {\n  guard(a, `a`);\n  guard(b, `b`);\n  if (a.distance !== b.distance) return false;\n  return a.angleRadian === -b.angleRadian;\n};\n\n/**\n * Returns true if Coords have the same direction, regardless of magnitude\n * @param a \n * @param b \n * @returns \n */\nexport const isParallel = (a:Coord, b:Coord):boolean => {\n  guard(a, `a`);\n  guard(b, `b`);\n  return a.angleRadian === b.angleRadian;\n};\n\n/**\n * Returns true if coords are opposite direction, regardless of magnitude\n * @param a \n * @param b \n * @returns \n */\nexport const isAntiParallel = (a:Coord, b:Coord):boolean => {\n  guard(a, `a`);\n  guard(b, `b`);\n  return a.angleRadian === -b.angleRadian;\n};\n\n/**\n * Returns a rotated coordinate\n * @param c Coordinate\n * @param amountDeg Amount to rotate, in degrees\n * @returns \n */\nexport const rotateDegrees = (c:Coord, amountDeg:number):Coord => Object.freeze({\n  ...c,\n  angleRadian: c.angleRadian + degreeToRadian(amountDeg)\n});\n\n/**\n * Produces an Archimedian spiral with manual stepping.\n * @param step Step number. Typically 0, 1, 2 ...\n * @param smoothness 0.1 pretty rounded, at around 5 it starts breaking down\n * @param zoom At smoothness 0.1, zoom starting at 1 is OK\n * @returns \n */\nexport const spiralRaw = (step:number, smoothness:number, zoom:number):Coord => {\n  const a = smoothness * step;\n  return Object.freeze({\n    distance: zoom * a,\n    angleRadian: a\n  });\n};\n\n/**\n * Multiplies the magnitude of a coord by `amt`.\n * Direction is unchanged.\n * @param v \n * @param amt \n * @returns \n */\nexport const multiply = (v:Coord, amt:number):Coord => {\n  guard(v);\n  guardNumber(amt, ``, `amt`);\n  return Object.freeze({\n    ...v,\n    distance: v.distance * amt\n  });\n};\n\n/**\n * Divides the magnitude of a coord by `amt`.\n * Direction is unchanged.\n * @param v \n * @param amt \n * @returns \n */\nexport const divide = (v:Coord, amt:number):Coord => {\n  guard(v);\n  guardNumber(amt, ``, `amt`);\n  return Object.freeze({\n    ...v,\n    distance: v.distance / amt\n  });\n};\n\n/**\n * Clamps the magnitude of a vector\n * @param v \n * @param max \n * @param min \n * @returns \n */\nexport const clampMagnitude = (v:Coord, max = 1, min = 0):Coord => {\n  //eslint-disable-next-line functional/no-let\n  let mag = v.distance;\n  if (mag > max) mag = max;\n  if (mag < min) mag = min;\n  return Object.freeze({\n    ...v,\n    distance: mag\n  });\n};\n\n/**\n * Converts a polar coordiante to Cartesian\n * @param distance Distance\n * @param angleRadians Angle in radians\n * @param origin Origin, or 0,0 by default.\n * @returns \n */\nconst polarToCartesian = (distance:number, angleRadians:number, origin:Points.Point = Points.Empty):Points.Point => {\n  Points.guard(origin);\n  return Object.freeze({\n    x: origin.x + (distance * Math.cos(angleRadians)),\n    y: origin.y + (distance * Math.sin(angleRadians)),\n  });\n};\n\n/**\n * Returns a human-friendly string representation `(distance, angleDeg)`.\n * If `precision` is supplied, this will be the number of significant digits.\n * @param p\n * @returns \n */\nexport const toString = (p:Coord, digits?:number):string => {\n  if (p === undefined) return `(undefined)`;\n  if (p === null) return `(null)`;\n\n  const angleDeg = radianToDegree(p.angleRadian);\n  const d = digits ? p.distance.toFixed(digits) : p.distance;\n  const a = digits ? angleDeg.toFixed(digits) : angleDeg;\n  return `(${d},${a})`;\n};\n\nexport const toPoint = (v:Coord, origin = EmptyCartesian):Points.Point => {\n  guard(v, `v`);\n  return Object.freeze({\n    x: origin.x + (v.distance * Math.cos(v.angleRadian)),\n    y: origin.y + (v.distance * Math.sin(v.angleRadian))\n  });\n};\n\n\n","import { Polar, radianToDegree } from \"./index.js\";\nimport { number as guardNumber } from '../Guards.js';\nimport * as Lines from \"./Line.js\";\nimport * as Points from \"./Point.js\";\n\n//eslint-disable-next-line @typescript-eslint/naming-convention\nconst EmptyCartesian = Object.freeze({ x:0, y: 0 });\n\nconst piPi = Math.PI * 2;\nconst pi = Math.PI;\n\n// const Q1 = Math.PI / 2;\n// const Q2 = Math.PI;\n// const Q3 = Q1 + Q2;\n// const Q4 = Math.PI * 2;\n\nexport type Vector = Points.Point | Polar.Coord;\n\n\n/**\n * Create a vector from a point\n * \n * If `unipolar` normalisation is used, direction will be fixed to 0..2\n * if `bipolar` normalisation is used, direction will be fixed to -...\n * @param pt Point\n * @param angleNormalisation Technique to normalise angle\n * @param origin Origin to calculate vector from or 0,0 if left empty\n * @returns \n */\nexport const fromPointPolar = (pt:Points.Point, angleNormalisation:`` | `unipolar` | `bipolar` = ``, origin:Points.Point = EmptyCartesian):Polar.Coord => {\n\n  pt = Points.subtract(pt, origin);\n\n  //eslint-disable-next-line functional/no-let\n  let dir = Math.atan2(pt.y, pt.x);\n  if (angleNormalisation === `unipolar` && dir < 0) dir += piPi;\n  else if (angleNormalisation === `bipolar`) {\n    if (dir > pi) dir -= piPi;\n    else if (dir <= -pi) dir += piPi;\n  }\n\n  return Object.freeze({\n    distance: Points.distance(pt),\n    angleRadian: dir\n  });\n};\n\n/**\n * Returns a Cartesian-coordiante vector from a line a -> b\n * @param line \n * @returns \n */\nexport const fromLineCartesian = (line:Lines.Line):Points.Point => Points.subtract(line.b, line.a);\n\n/**\n * Returns a polar-coordinate vector from a line a -> b\n * @param line \n * @returns \n */\nexport const fromLinePolar = (line:Lines.Line):Polar.Coord => {\n  Lines.guard(line, `line`);\n  const pt = Points.subtract(line.b, line.a);\n  return fromPointPolar(pt);\n};\n\nconst isPolar = (v:Vector):v is Polar.Coord => {\n  if (Polar.isCoord(v)) return true;\n  return false;\n};\n\nconst isCartesian = (v:Vector):v is Points.Point => {\n  if (Points.isPoint(v)) return true;\n  return false;\n};\n\n/**\n * Returns the normalised vector (aka unit vector). This is where\n * direction is kept, but magnitude set to 1. This then just\n * suggests direction.\n * @param v \n * @returns \n */\nexport const normalise = (v:Vector):Vector => {\n  if (isPolar(v)) {\n    return Polar.normalise(v);\n  } else if (isCartesian(v)) {\n    return Points.normalise(v);\n  }\n  throw new Error(`Expected polar/cartesian vector. Got: ${v}`);\n};\n\n\nexport const quadrantOffsetAngle = (p:Points.Point):number => {\n  if (p.x >= 0 && p.y >= 0) return 0; // Q1\n  if (p.x < 0 && p.y >= 0) return pi; // Q2\n  if (p.x < 0 && p.y < 0) return pi;  // Q3\n  return piPi; // Q4\n};\n\n/**\n * Converts a vector to a polar coordinate. If the provided\n * value is already Polar, it is returned.\n * @param v \n * @param origin \n * @returns Polar vector\n */\nexport const toPolar = (v:Vector, origin = Points.Empty):Polar.Coord => {\n  if (isPolar(v)) {\n    return v;\n  } else if (isCartesian(v)) {\n    return Polar.fromCartesian(v, origin);\n  }\n  throw new Error(`Expected polar/cartesian vector. Got: ${v}`);\n};\n\n/**\n * Converts a Vector to a Cartesian coordinate. If the provided\n * value is already Cartesian, it is returned.\n * @param v \n * @returns Cartestian vector\n */\nexport const toCartesian = (v:Vector):Points.Point => {\n  if (isPolar(v)) {\n    return Polar.toPoint(v);\n  } else if (isCartesian(v)) {\n    return v;\n  }\n  throw new Error(`Expected polar/cartesian vector. Got: ${v}`);\n};\n\n/**\n * Return a human-friendly representation of vector\n * @param v \n * @param digits \n * @returns \n */\nexport const toString = (v:Vector, digits?:number) => {\n  if (isPolar(v)) {\n    return Polar.toString(v, digits);\n  } else if (isCartesian(v)) {\n    return Points.toString(v, digits);\n  }\n  throw new Error(`Expected polar/cartesian vector. Got: ${v}`);\n};\n\n/**\n * Calculate dot product of a vector\n * @param a \n * @param b \n * @returns \n */\nexport const dotProduct = (a:Vector, b:Vector) => {\n  if (isPolar(a) && isPolar(b)) {\n    return Polar.dotProduct(a, b);\n  } else if (isCartesian(a) && isCartesian(b)) {\n    return Points.dotProduct(a, b);\n  }\n  throw new Error(`Expected two polar/Cartesian vectors.`);\n};\n\n/**\n * Clamps the magnitude of a vector\n * @param v Vector to clamp\n * @param max Maximum magnitude\n * @param min Minium magnitude\n * @returns \n */\nexport const clampMagnitude = (v:Vector, max = 1, min = 0) => {\n  if (isPolar(v)) {\n    return Polar.clampMagnitude(v, max, min);\n  } else if (isCartesian(v)) {\n    return Points.clampMagnitude(v, max, min);\n  }\n  throw new Error(`Expected either polar or Cartesian vector`);\n};\n\n/**\n * Returns `a + b`.\n * \n * Vector is returned in the same type as `a`.\n * @param a \n * @param b \n * @returns \n */\nexport const sum = (a:Vector, b:Vector) => {\n  const polar = isPolar(a);\n  a = toCartesian(a);\n  b = toCartesian(b);\n  const c = Points.sum(a, b);\n  return polar ? toPolar(c) : c;\n};\n\n/**\n * Returns `a - b`.\n * \n * Vector is returned in the same type as `a`\n * @param a \n * @param b \n */\nexport const subtract = (a:Vector, b:Vector) => {\n  const polar = isPolar(a);\n  a = toCartesian(a);\n  b = toCartesian(b);\n  const c = Points.subtract(a, b);\n  return polar ? toPolar(c) : c;\n};\n\n/**\n * Returns `a * b`.\n * \n * Vector is returned in the same type `a`.\n * @param a \n * @param b \n */\nexport const multiply = (a:Vector, b:Vector) => {\n  const polar = isPolar(a);\n  a = toCartesian(a);\n  b = toCartesian(b);\n  const c = Points.multiply(a, b);\n  return polar ? toPolar(c) : c;\n};\n\n/**\n * Returns `a / b`.\n * \n * Vector is returned in the same type `a`.\n * @param a \n * @param b \n */\nexport const divide = (a:Vector, b:Vector) => {\n  const polar = isPolar(a);\n  a = toCartesian(a);\n  b = toCartesian(b);\n  const c = Points.divide(a, b);\n  return polar ? toPolar(c) : c;\n};\n","import * as Lines from \"./Line.js\";\nimport * as Points from \"./Point.js\";\nimport { CirclePositioned } from \"./Circle.js\";\nimport { Arrays, Maps } from \"../collections/index.js\";\nimport { Path } from \"./Path.js\";\n\ntype Waypoint = CirclePositioned;\n\nexport type Opts = {\n  readonly maxDistanceFromLine?:number\n  readonly enforceOrder?:boolean\n}\n\nexport const fromPoints = (waypoints:readonly Points.Point[], opts:Opts= {}) => {\n  const lines = Lines.joinPointsToLines(...waypoints);\n  return init(lines.map(l => Lines.toPath(l)), opts);\n};\n\nexport const init = (paths:readonly Path[], opts:Opts = {}) => {\n  //const enforceOrder = opts.enforceOrder ?? true;\n  const maxDistanceFromLine = opts.maxDistanceFromLine ?? 0.1;\n\n  const checkUnordered = (pt:Points.Point) => {\n    const results = paths.map((p, index) => {\n      const nearest = p.nearest(pt);\n      const distance = Points.distance(pt, nearest);\n      return { path: p, index, nearest, distance };\n    });\n\n    const filtered = results.filter(v => v.distance <= maxDistanceFromLine);\n    const sorted = Arrays.sortByNumericProperty(filtered, `distance`);\n\n    return sorted;\n  };\n\n  // const checkUnordered = (p:Points.Point) => {\n  //   // Calculate progress of pointer between all the waypoint lines\n  //   const progresses = lines.map((line, index) => (\n  //     { \n  //       index, \n  //       score: Points.progressBetween(p, line.a, line.b)\n  //     }));\n  \n  //   // Sort by closest\n  //   const sorted = Arrays.sortByNumericProperty(progresses, `score`);\n  \n  // };\n  return checkUnordered;\n};","import * as Points from './Point.js';\n\n\nexport type Sphere = Points.Point3d & {\n  readonly radius:number\n}\n\n\n","\nimport { Point, isPoint } from './Point.js';\nimport { Rect, isRect, placeholder as PlaceholderRect } from './Rect.js';\n\n/**\n * A scale function that takes an input value to scale. \n * Input can be in the form of `{ x, y }` or two number parameters.\n *  \n * ```js\n * scale(10, 20);\n * scale({ x:10, y:20 });\n * ```\n * \n * Output range can be specified as a `{ width, height }` or two number parameters. \n * If omitted, the default range\n * is used.\n * \n * ```js\n * // Scale 10,20 with range w:800 h:600\n * scale(10, 20, 800, 600);\n * scale({x:10, y:20}, 800, 600);\n * scale({x:10, y:20}, {width: 800, height: 600});\n * ```\n */\nexport type ScaleFn = (a:number|Point, b?:number|Rect, c?:number|Rect, d?:number)=>Point\n\n/**\n * A scaler than can convert to a from an output range\n */\nexport type Scaler = {\n  /**\n   * Relative to absolute coordinates\n   */\n  readonly abs:ScaleFn\n  /**\n   * Absolute to relative coordintes\n   */\n  readonly rel:ScaleFn\n}\n\n/**\n * Returns a set of scaler functions, to convert to and from ranges.\n * \n * ```js\n * const scaler = Scaler.scaler(`both`, window.innerWidth, window.innerHeight);\n * // Assuming screen of 800x400...\n * scaler.abs(400,200);          // Yields { x:0.5, y:0.5 }\n * scaler.abs({ x:400, y:200 }); // Yields { x:0.5, y:0.5 }\n * \n * scaler.rel(0.5, 0.5);         // Yields: { x:400, y:200 }\n * scaler.rel({ x:0.5, y:0.5 }); // Yields: { x:400, y:200 }\n * ```\n * \n * If no default range is provided, it must be given each time the scale function is used.\n * \n * ```js\n * const scaler = Scaler.scaler(`both`);\n * \n * scaler.abs(400, 200, 800, 400); \n * scaler.abs(400, 200, { width: 800, height: 400 });\n * scaler.abs({ x:400, y: 200}, { width: 800, height: 400 });\n * scaler.abs({ x:400, y: 200}, 800, 400);\n * // All are the same, yielding { x:0.5, y:0.5 }\n * \n * scaler.abs(400, 200); // Throws an exception because there is no scale\n * ```\n * @param scaleBy Dimension to scale by\n * @param defaultRect Default range\n * @returns \n */\nexport const scaler = (scaleBy:`both`|`min`|`max`|`width`|`height` = `both`, defaultRect?:Rect):Scaler => {\n  const defaultBounds = defaultRect ?? PlaceholderRect;\n\n  //eslint-disable-next-line functional/no-let\n  let sw = 1;\n  //eslint-disable-next-line functional/no-let\n  let sh = 1;\n  //eslint-disable-next-line functional/no-let\n  let s = { x:1, y:1 };\n\n  const computeScale = () => {\n    switch (scaleBy) {\n    case `height`:\n      return { x:sh, y: sh };\n    case `width`:\n      return { x:sw, y:sw };\n    case `min`:\n      return { x:Math.min(sw, sh), y:Math.min(sw, sh) };\n    case `max`:\n      return { x:Math.max(sw, sh), y:Math.max(sw, sh) };\n    default:\n      return { x:sw, y:sh };\n    }\n  };\n  \n  const normalise = (a:number|Point, b?:number|Rect, c?:number|Rect, d?:number):[x:number, y:number, w:number, h:number] => {\n    //eslint-disable-next-line functional/no-let\n    let inX = Number.NaN;\n    //eslint-disable-next-line functional/no-let\n    let inY = Number.NaN;\n    //eslint-disable-next-line functional/no-let\n    let outW = defaultBounds.width;\n    //eslint-disable-next-line functional/no-let\n    let outH = defaultBounds.height;\n\n    if (typeof a === `number`) {\n      inX = a;\n      if (typeof b === `number`) {\n        inY = b;\n        if (c === undefined) return [inX, inY, outW, outH];\n        if (isRect(c)) {\n          outW =c.width;\n          outH = c.height;\n        } else if (typeof c === `number`) {\n          outW = c;\n          if (typeof d === `number`) {\n            outH = d;\n          } else {\n            throw new Error(`Missing final height value`);\n          }\n        } else throw new Error(`Missing valid output range`);\n      } else if (isRect(b)) {\n        outW = b.width;\n        outH = b.height;\n      } else throw new Error(`Expected input y or output Rect to follow first number parameter`);\n    } else if (isPoint(a)) {\n      inX = a.x;\n      inY = a.y;\n      if (b === undefined) return [inX, inY, outW, outH];\n      if (isRect(b)) {\n        outW = b.width;\n        outH = b.height;\n      } else if (typeof b === `number`) {\n        outW = b;\n        if (typeof c === `number`) {\n          outH = c;\n        } else {\n          throw new Error(`Expected height as third parameter after Point and output width`);\n        }\n      } else {\n        throw new Error(`Expected Rect or width as second parameter when first parameter is a Point`);\n      }\n    } else {\n      throw new Error(`Expected input Point or x value as first parameter`);\n    }\n    return [inX, inY, outW, outH];\n  };\n\n  const scaleAbs = (a:number|Point, b?:number|Rect, c?:number|Rect, d?:number):Point => {\n    const n = normalise(a, b, c, d);\n    return scaleNormalised(true, ...n);\n  };\n\n  const scaleRel = (a:number|Point, b?:number|Rect, c?:number|Rect, d?:number):Point => {\n    const n = normalise(a, b, c, d);\n    return scaleNormalised(false, ...n);\n  };\n  \n  const scaleNormalised = (abs:boolean, x:number, y:number, w:number, h:number):Point => {\n    if (Number.isNaN(w)) throw new Error(`Output width range missing`);\n    if (Number.isNaN(h)) throw new Error(`Output height range missing`);\n\n    // If output dimensions has changed since last, create a new scale\n    if (w !== sw || h !== sh) {\n      sw = w;\n      sh = h;\n      s = computeScale();\n    }\n\n    if (abs) {\n      return {\n        x: x * s.x,\n        y: y * s.y\n      };\n    } else {\n      return {\n        x: x / s.x,\n        y: y / s.y\n      };\n    }\n  \n  };\n\n  return {\n    rel: scaleRel,\n    abs: scaleAbs\n  };\n};","import { Sphere } from \"./Sphere.js\";\nimport * as Points from './Point.js';\nimport { Circle, CirclePositioned, toPositioned as circleToPositioned } from \"./Circle.js\";\nimport { scale } from \"../data/Scale.js\";\nimport { linearSpace } from \"~/Numbers.js\";\n\nconst cos = Math.cos;\nconst sin = Math.sin;\nconst asin = Math.asin;\nconst sqrt = Math.sqrt;\nconst pow = Math.pow;\nconst pi = Math.PI;\nconst piPi = Math.PI*2;\nconst goldenAngle = pi * (3 - sqrt(5));\nconst goldenSection = (1 + sqrt(5)) / 2;\n\n/**\n * Options for a Vogel spiral\n */\nexport type VogelSpiralOpts = {\n  /**\n   * Upper limit of points to produce.\n   * By default, 5000.\n   */\n  readonly maxPoints?:number\n  /**\n   * Density value (0..1) which determines spacing of points.\n   * This is useful because it scales with whatever circle radius is given\n   * Use this parameter OR the `spacing` parameter.\n   */\n  readonly density?:number\n  /**\n   * Spacing between points.\n   * Use this option OR the density value.\n   */\n  readonly spacing?:number\n  /**\n   * Rotation offset to apply, in radians. 0 by default\n   */\n  readonly rotation?:number\n}\n\n/**\n * Generates points on a Vogel spiral - a sunflower-like arrangement of points.\n * \n * @example With no arguments, assumes a unit circle\n * ```js\n * for (const pt of circleVogelSpiral()) {\n *  // Generate points on a unit circle, with 95% density\n * }\n * ```\n * \n * \n * @example Specifying a circle and options\n * ```js\n * const circle = { radius: 100, x: 100, y: 100 };\n * const opts = {\n *  maxPoints: 50,\n *  density: 0.99\n * };\n * for (const pt of circleVogelSpiral(circle, opts)) {\n *  // Do something with point...\n * }\n * ```\n * \n * @example Array format\n * ```js\n * const ptsArray = [...circleVogelSpiral(circle, opts)];\n * ```\n * @param circle \n * @param opts \n */\nexport function* circleVogelSpiral(circle?:Circle, opts:VogelSpiralOpts = {}):IterableIterator<Points.Point> {\n  const maxPoints = opts.maxPoints ?? 5000;\n  const density = opts.density ?? 0.95;\n  const rotationOffset = opts.rotation ?? 0;\n\n  const c = circleToPositioned(circle ?? { radius: 1, x: 0, y: 0 });\n  const max = c.radius;\n  //eslint-disable-next-line functional/no-let\n  let spacing = c.radius * scale(density, 0, 1, 0.3, 0.01);\n  if (opts.spacing) spacing = opts.spacing;\n\n  //eslint-disable-next-line functional/no-let\n  let radius = 0;\n  //eslint-disable-next-line functional/no-let\n  let count = 0;\n  //eslint-disable-next-line functional/no-let\n  let angle = 0;\n  while (count < maxPoints && radius < max) {\n    radius = spacing * count ** 0.5;\n    angle = rotationOffset + ((count * 2 * pi) / goldenSection);\n    yield Object.freeze({\n      x: c.x + (radius * cos(angle)),\n      y: c.y + (radius * sin(angle))\n    });\n    count++;\n  }\n}\n\nexport type CircleRingsOpts = {\n  readonly rings?:number\n}\n/**\n * Source: http://www.holoborodko.com/pavel/2015/07/23/generating-equidistant-points-on-unit-disk/#more-3453\n * @param circle \n */\nexport function* circleRings(circle?:Circle|CirclePositioned, opts:CircleRingsOpts = {}):IterableIterator<Points.Point> {\n  const rings = opts.rings ?? 5;\n  const c = circleToPositioned(circle ?? { radius: 1, x: 0, y: 0 });\n  const ringR = 1/rings;\n\n  //eslint-disable-next-line functional/no-let\n  let ringCount = 1;\n  \n  // Origin\n  yield Object.freeze({ x: c.x, y: c.y });\n\n  console.log(`ringR: ${ringR}`);\n  //eslint-disable-next-line functional/no-let\n  for (let r=ringR;r<1;r+=ringR) {\n    const n = Math.round(pi/asin(1/(2*ringCount)));\n    console.log(`n: ${n} ringR: ${ringR} ringCount: ${ringCount}`);\n    for (const theta of linearSpace(0, piPi, n+1)) {\n      yield Object.freeze({\n        x: c.x + (r*cos(theta) * c.radius),\n        y: c.y + (r*sin(theta) * c.radius)\n      });\n    }\n    ringCount++;\n  } \n}\n/**\n * Fibonacci sphere algorithm. Generates points\n * distributed on a sphere.\n * \n * @example Generate points of a unit sphere\n * ```js\n * for (const pt of sphereFibonacci(100)) {\n *  // pt.x, pt.y, pt.z\n * }\n * ```\n * \n * @example Generate points into an array\n * ```js\n * const sphere = { radius: 10, x: 10, y: 200 }\n * const pts = [...sphereFibonacci(100, 0, sphere)];\n * ```\n * \n * Source: https://codepen.io/elchininet/pen/vXeRyL\n * \n * @param samples \n * @returns \n */\nexport function* sphereFibonacci(samples:number = 100, rotationRadians:number = 0, sphere?:Sphere):IterableIterator<Points.Point3d> {\n  const offset = 2 / samples;\n  const s = sphere ?? { x: 0, y: 0, z: 0, radius: 1 };\n\n  //eslint-disable-next-line functional/no-let\n  for (let i=0;i<samples;i++) {\n    const y = (i * offset - 1) + (offset / 2);\n    const r = sqrt(1 - pow(y, 2));\n    const a = ((i + 1) % samples) * goldenAngle + rotationRadians;\n    const x = cos(a) * r;\n    const z = sin(a) * r;\n    //eslint-disable-next-line functional/immutable-data\n    yield Object.freeze({\n      x: s.x + (x * s.radius), \n      y: s.y + (y * s.radius), \n      z: s.z + (z * s.radius)\n    });\n  }\n}","import { Lines,  radianToDegree, Polar, Circles, Rects } from './index.js';\nimport * as Points from './Point.js';\n\nimport { number as guardNumber } from '../Guards.js';\n\n/**\n * Functions for working with equilateral triangles, defined by length\n */\nexport * as Equilateral from './TriangleEquilateral.js';\n\n/**\n * Functions for working with right-angled triangles, defined by two of three edges\n */\nexport * as Right from './TriangleRight.js';\n\nexport * as Isosceles from './TriangleIsosceles.js';\n\nconst piPi = Math.PI*2;\n\n/**\n * Triangle.\n * \n * Helpers for creating:\n *  - {@link fromFlatArray}: Create from [x1, y1, x2, y2, x3, y3]\n *  - {@link fromPoints}: Create from three `{x,y}` sets\n *  - {@link fromRadius}: Equilateral triangle of a given radius and center\n */\nexport type Triangle = {\n  readonly a:Points.Point,\n  readonly b:Points.Point,\n  readonly c:Points.Point\n}\n\n/**\n * A triangle consisting of three empty points (Points.Empty)\n */\n//eslint-disable-next-line @typescript-eslint/naming-convention\nexport const Empty = Object.freeze({ a: { x:0, y:0 }, b:{ x:0, y:0 }, c:{ x:0, y:0 } });\n\n/**\n * A triangle consisting of three placeholder points (Points.Placeholder)\n */\n//eslint-disable-next-line @typescript-eslint/naming-convention\nexport const Placeholder = Object.freeze({ a: { x:NaN, y:NaN }, b:{ x:NaN, y:NaN }, c:{ x:NaN, y:NaN } });\n\n/**\n * Returns true if triangle is empty\n * @param t \n * @returns \n */\nexport const isEmpty = (t:Triangle):boolean => Points.isEmpty(t.a) && Points.isEmpty(t.b) && Points.isEmpty(t.c);\n\n/**\n * Returns true if triangle is a placeholder\n * @param t \n * @returns \n */\nexport const isPlaceholder = (t:Triangle):boolean => Points.isPlaceholder(t.a) && Points.isPlaceholder(t.b) && Points.isPlaceholder(t.c);\n\n/**\n * Applies `fn` to each of a triangle's corner points, returning the result. \n * \n * @example Add some random to the x of each corner\n * ```\n * const t = apply(tri, p => {\n *  const r = 10;\n *  return {\n *    x: p.x + (Math.random()*r*2) - r,\n *    y: p.y\n *  }\n * });\n * ```\n * @param t \n * @param fn \n * @returns \n */\nexport const apply = (t:Triangle, fn:(p:Points.Point, label?:string)=>Points.Point) => Object.freeze<Triangle>(\n  {\n    ...t,\n    a: fn(t.a, `a`),\n    b: fn(t.b, `b`),\n    c: fn(t.c, `c`),\n  }\n);\n\n/**\n * Throws an exception if the triangle is invalid\n * @param t \n * @param name \n */\nexport const guard = (t:Triangle, name:string = `t`) => {\n  if (t === undefined) throw Error(`{$name} undefined`);\n  Points.guard(t.a, name + `.a`);\n  Points.guard(t.b, name + `.b`);\n  Points.guard(t.c, name + `.c`);\n};\n\n/**\n * Returns true if the parameter appears to be a valid triangle\n * @param p \n * @returns \n */\nexport const isTriangle = (p:number | unknown):p is Triangle => {\n  if (p === undefined) return false;\n  const tri = p as Triangle;\n  if (!Points.isPoint(tri.a)) return false;\n  if (!Points.isPoint(tri.b)) return false;\n  if (!Points.isPoint(tri.c)) return false;\n  return true; \n};\n\n/**\n * Returns true if the two parameters have equal values\n * @param a \n * @param b \n * @returns \n */\nexport const isEqual = (a:Triangle, b:Triangle):boolean => Points.isEqual(a.a, b.a) && Points.isEqual(a.b, b.b) && Points.isEqual(a.c, b.c);\n\n/**\n * Returns the corners (vertices) of the triangle as an array of points\n * @param t \n * @returns Array of length three\n */\nexport const corners = (t:Triangle):readonly Points.Point[] => {\n  guard(t);\n  return [t.a, t.b, t.c];\n};\n\n/**\n * Returns the edges (ie sides) of the triangle as an array of lines\n * @param t \n * @returns Array of length three\n */\nexport const edges = (t:Triangle):Lines.PolyLine => {\n  guard(t);\n  return Lines.joinPointsToLines(t.a, t.b, t.c, t.a);\n};\n\n/**\n * Returns the lengths of the triangle sides\n * @param t \n * @returns Array of length three\n */\nexport const lengths = (t:Triangle):readonly number[] => {\n  guard(t);\n  return [\n    Points.distance(t.a, t.b),\n    Points.distance(t.b, t.c),\n    Points.distance(t.c, t.a)\n  ];\n};\n\n/**\n * Return the three interior angles of the triangle, in radians. \n * @param t \n * @returns \n */\nexport const angles = (t:Triangle):readonly number[] => {\n  guard(t);\n  return [\n    Points.angle(t.a, t.b),\n    Points.angle(t.b, t.c),\n    Points.angle(t.c, t.a)\n  ];\n};\n\n/**\n * Returns the three interior angles of the triangle, in degrees\n * @param t \n * @returns \n */\nexport const anglesDegrees = (t:Triangle):readonly number[] => {\n  guard(t);\n  return radianToDegree(angles(t));\n};\n\n/**\n * Returns true if it is an equilateral triangle\n * @param t \n * @returns \n */\nexport const isEquilateral = (t:Triangle):boolean => {\n  guard(t);\n  const [a, b, c] = lengths(t);\n  return a === b && b === c;\n};\n\n/**\n * Returns true if it is an isosceles triangle\n * @param t\n * @returns \n */\nexport const isIsosceles = (t:Triangle):boolean => {\n  const [a, b, c] = lengths(t);\n  if (a === b) return true;\n  if (b === c) return true;\n  if (c === a) return true;\n  return false;\n};\n\n/**\n * Returns true if at least one interior angle is 90 degrees\n * @param t \n * @returns \n */\nexport const isRightAngle = (t:Triangle):boolean => (angles(t).some(v => v === Math.PI/2));\n\n/**\n * Returns true if triangle is oblique: No interior angle is 90 degrees\n * @param t \n * @returns \n */\nexport const isOblique = (t:Triangle):boolean => !isRightAngle(t);\n\n/**\n * Returns true if triangle is actue: all interior angles less than 90 degrees\n * @param t \n * @returns \n */\nexport const isAcute = (t:Triangle):boolean => (!angles(t).some(v => v >= Math.PI/2));\n\n/**\n * Returns true if triangle is obtuse: at least one interior angle is greater than 90 degrees\n * @param t \n * @returns \n */\nexport const isObtuse = (t:Triangle):boolean => (angles(t).some(v => v > Math.PI/2));\n\n/**\n * Returns simple centroid of triangle\n * @param t \n * @returns \n */\nexport const centroid = (t:Triangle):Points.Point => {\n  guard(t);\n  const total = Points.reduce([t.a, t.b, t.c], (p:Points.Point, acc:Points.Point) => ({\n    x: p.x + acc.x,\n    y: p.y + acc.y\n  }));\n  const div = {\n    x: total.x / 3,\n    y: total.y / 3\n  };\n  return div;\n};\n\n/**\n * Calculates perimeter of a triangle\n * @param t \n * @returns \n */\nexport const perimeter = (t:Triangle):number => {\n  guard(t);\n  return edges(t).reduce<number>((acc, v) => acc + Lines.length(v), 0);\n};\n\n/**\n * Calculates the area of a triangle\n * @param t \n * @returns \n */\nexport const area = (t:Triangle):number => {\n  guard(t, `t`);\n\n  // Get length of edges\n  const e = edges(t).map(l => Lines.length(l));\n\n  // Add up length of edges, halve\n  const p = (e[0] + e[1] + e[2]) / 2;\n  return Math.sqrt(p * (p - e[0]) * (p - e[1]) * (p - e[2]));\n};\n\n/**\n * Returns the largest circle enclosed by triangle `t`.\n * @param t \n */\nexport const innerCircle = (t:Triangle):Circles.CirclePositioned => {\n  const c = centroid(t);\n  const p = perimeter(t) / 2;\n  const a = area(t);\n  const radius = a / p;\n  return { radius, ...c };\n};\n\n/**\n * Returns the largest circle touching the corners of triangle `t`.\n * @param t \n * @returns \n */\nexport const outerCircle = (t:Triangle):Circles.CirclePositioned => {\n  const [a, b, c]= edges(t).map(l => Lines.length(l));\n  const cent = centroid(t);\n  const radius = a*b*c / Math.sqrt((a+b+c)*(-a+b+c)*(a-b+c)*(a+b-c));\n  return {\n    radius,\n    ...cent\n  };\n};\n\n/**\n * Returns an equilateral triangle centered at the origin.\n * \n * ```js\n * // Create a triangle at 100,100 with radius of 60\n * const tri = fromRadius({x:100,y:100}, 60);\n * \n * // Triangle with point A upwards, B to the right, C to the left\n * constr tri2 = fromRadius({x:100,y:100}, 60, {initialAngleRadian: -Math.PI / 2});\n * ```\n * \n * \n * @param origin \n * @param length \n */\nexport const fromRadius = (origin:Points.Point, radius:number, opts:{readonly initialAngleRadian?:number} = {}):Triangle => {\n  guardNumber(radius, `positive`, `radius`);\n  Points.guard(origin, `origin`);\n\n  const initialAngleRadian = opts.initialAngleRadian ?? 0;\n\n  const angles = [initialAngleRadian, initialAngleRadian + piPi*1/3, initialAngleRadian + piPi*2/3];\n  const points = angles.map(a => Polar.toCartesian(radius, a, origin));\n  return fromPoints(points);\n};\n\n/**\n * Rotates the vertices of the triangle around one point (by default, `b`).\n * @param triangle Triangle\n * @param vertex Name of vertex: a, b or c.\n */\nexport const rotateByVertex = (triangle:Triangle, amountRadian:number, vertex:`a`|`b`|`c` = `b`):Triangle => {\n  const origin = vertex === `a` ? triangle.a : vertex === `b` ? triangle.b : triangle.c;\n  return Object.freeze({\n    a: Points.rotate(triangle.a, amountRadian, origin),\n    b: Points.rotate(triangle.b, amountRadian, origin),\n    c: Points.rotate(triangle.c, amountRadian, origin)\n  });\n};\n\n/**\n * Returns a triangle anchored at `origin` with a given `length` and `angleRadian`.\n * The origin will be point `b` of the triangle, and the angle will be the angle for b.\n * @param origin Origin\n * @param length Length\n * @param angleRadian Angle\n * @returns \n */\nexport const equilateralFromVertex = (origin:Points.Point = { x:0, y:0 }, length:number = 10, angleRadian:number = Math.PI/2):Triangle => {  \n  const a = Points.project(origin, length, (Math.PI - (-angleRadian / 2)));\n  const c = Points.project(origin, length, (Math.PI - (angleRadian / 2)));\n  return { a, b:origin, c };\n};\n\n\n/**\n * Returns the coordinates of triangle in a flat array form:\n * [xA, yA, xB, yB, xC, yC]\n * @param t \n * @returns \n */\nexport const toFlatArray = (t:Triangle):readonly number[] => {\n  guard(t);\n  return [\n    t.a.x, t.a.y,\n    t.b.x, t.b.y,\n    t.c.x, t.c.y\n  ];\n};\n\n/**\n * Returns a triangle from a set of coordinates in a flat array form:\n * [xA, yA, xB, yB, xC, yC]\n * @param coords \n * @returns \n */\nexport const fromFlatArray = (coords:readonly number[]):Triangle => {\n  if (!Array.isArray(coords)) throw new Error(`coords expected as array`);\n  if (coords.length !== 6) throw new Error(`coords array expected with 6 elements. Got ${coords.length}`);\n  return fromPoints(Points.fromNumbers(...coords));\n};\n\n/**\n * Returns a triangle from an array of three points\n * @param points \n * @returns \n */\nexport const fromPoints = (points:readonly Points.Point[]):Triangle => {\n  if (!Array.isArray(points)) throw new Error(`points expected as array`);\n  if (points.length !== 3) throw new Error(`points array expected with 3 elements. Got ${points.length}`);\n  const t:Triangle = {\n    a: points[0],\n    b: points[1],\n    c: points[2]\n  };\n  return t;\n};\n\n/**\n * Returns the bounding box that encloses the triangle.\n * @param t \n * @param inflation If specified, box will be inflated by this much. Default: 0.\n * @returns \n */\nexport const bbox = (t:Triangle, inflation = 0):Rects.RectPositioned => {\n  const { a, b, c } = t;\n  const xMin = Math.min(a.x, b.x, c.x) - inflation;\n  const xMax = Math.max(a.x, b.x, c.x) + inflation;\n  const yMin = Math.min(a.y, b.y, c.y) - inflation;\n  const yMax = Math.max(a.y, b.y, c.y) + inflation;\n\n  const r:Rects.RectPositioned = {\n    x: xMin,\n    y: yMin,\n    width: xMax - xMin,\n    height: yMax - yMin  \n  };\n  return r;\n};\n\nexport type BarycentricCoord = {\n  readonly a:number\n  readonly b:number,\n  readonly c:number\n}\n\n/**\n * Returns the [Barycentric coordinate](https://en.wikipedia.org/wiki/Barycentric_coordinate_system) of a point within a triangle\n * \n * @param t \n * @param a \n * @param b \n * @returns \n */\nexport const barycentricCoord = (t:Triangle, a:Points.Point|number, b?:number):BarycentricCoord => {\n  const pt = Points.getPointParam(a, b);\n\n  const ab = (x:number, y:number, pa:Points.Point, pb:Points.Point) => (pa.y - pb.y) * x + (pb.x - pa.x) * y + pa.x*pb.y - pb.x*pa.y;\n  \n  const alpha = ab(pt.x, pt.y, t.b, t.c) / ab(t.a.x, t.a.y, t.b, t.c);\n  const theta = ab(pt.x, pt.y, t.c, t.a) / ab(t.b.x, t.b.y, t.c, t.a);\n  const gamma = ab(pt.x, pt.y, t.a, t.b) / ab(t.c.x, t.c.y, t.a, t.b);\n\n  return {\n    a:alpha,\n    b:theta,\n    c:gamma\n  };\n};\n\n/**\n * Convert Barycentric coordinate to Cartesian\n * @param t \n * @param bc \n * @returns \n */\nexport const barycentricToCartestian = (t:Triangle, bc:BarycentricCoord):Points.Point => {\n  guard(t);\n  const { a, b, c } = t;\n  \n  const x = a.x*bc.a + b.x*bc.b + c.x*bc.c;\n  const y = a.y*bc.a + b.y*bc.b + c.y*bc.c;\n  \n  if (a.z && b.z && c.z) {\n    const z = a.z*bc.a + b.z*bc.b + c.z*bc.c;\n    return Object.freeze({ x, y, z });\n  } else {\n    return Object.freeze({ x, y });\n  }\n};\n\n/**\n * Returns true if point is within or on the boundary of triangle\n * @param t \n * @param a \n * @param b \n */\nexport const intersectsPoint = (t:Triangle, a:Points.Point|number, b?:number):boolean => {\n  const box = bbox(t);\n\n  const pt = Points.getPointParam(a, b);\n\n  // If it's not in the bounding box, can return false straight away\n  if (!Rects.intersectsPoint(box, pt)) return false;\n\n  const bc = barycentricCoord(t, pt);\n\n  return 0 <= bc.a && bc.a <= 1 && 0 <= bc.b && bc.b <= 1 && 0 <= bc.c && bc.c <= 1;\n};\n\n/**\n * Returns a triangle that is rotated by `angleRad`. By default it rotates\n * around its center but an arbitrary `origin` point can be provided.\n * \n * ```js\n * // Rotate triangle by 5 degrees\n * rotate(triangle, degreeToRadian(5));\n * \n * // Rotate by 90 degrees\n * rotate(triangle, Math.PI / 2);\n * ```\n * @param line Line to rotate\n * @param amountRadian Angle in radians to rotate by\n * @param origin Point to rotate around. If undefined, middle of line will be used\n * @returns \n */\nexport const rotate = (t:Triangle, amountRadian?:number, origin?:Points.Point):Triangle => {\n  if (amountRadian === undefined || amountRadian === 0) return t;\n  if (origin === undefined) origin = centroid(t);\n  return Object.freeze({\n    ...t,\n    a: Points.rotate(t.a, amountRadian, origin),\n    b: Points.rotate(t.b, amountRadian, origin),\n    c: Points.rotate(t.c, amountRadian, origin)\n  });\n};","import {Circle} from './Circle.js';\r\nimport {Point} from './Point.js';\r\nimport {Triangle} from './Triangle.js';\r\n\r\nconst pi4over3 = Math.PI*4/3;\r\nconst pi2over3 = Math.PI*2/3;\r\n\r\nexport type TriangleEquilateral = {\r\n  readonly length:number\r\n} | number;\r\n\r\n\r\nconst resolveLength = (t:TriangleEquilateral):number => {\r\n  if (typeof t === `number`) return t;\r\n  return t.length;\r\n};\r\n\r\n/**\r\n * Returns a positioned `Triangle` from an equilateral triangle definition.\r\n * By default the rotation is such that point `a` and `c` are lying on the horizontal, \r\n * and `b` is the upward-facing tip.\r\n * \r\n * Default is a triangle pointing upwards with b at the top, c to the left and b to right on the baseline.\r\n * \r\n * Example rotation values in radians:\r\n * *  0: a and c on vertical, b at the tip\r\n * *  Math.PI: `c`and `a` are on vertical, with `b` at the tip.\r\n * *  Math.PI/2: `c` and `a` are on horizontal, `c` to the left. `b` at the bottom.\r\n * *  Math.PI*1.5: `c` and `a` are on horizontal, `c` to the right. `b` at the top. (default)\r\n * @param t \r\n * @param origin \r\n * @param rotationRad \r\n * @returns \r\n */\r\nexport const fromCenter = (t:TriangleEquilateral, origin:Point = {x: 0, y: 0 }, rotationRad?:number):Triangle => {\r\n  const r = resolveLength(t) / Math.sqrt(3);\r\n  const rot = rotationRad ?? Math.PI*1.5;\r\n  const b = {\r\n    x: r * Math.cos(rot) + origin.x,\r\n    y: r * Math.sin(rot) + origin.y\r\n  };\r\n  const a = {\r\n    x: r * Math.cos(rot + pi4over3) + origin.x,\r\n    y: r * Math.sin(rot + pi4over3) + origin.y\r\n  };\r\n  const c = {\r\n    x: r * Math.cos(rot + pi2over3) + origin.x,\r\n    y: r * Math.sin(rot + pi2over3) + origin.y\r\n  };\r\n\r\n  return Object.freeze({a, b, c });\r\n};\r\n\r\n/**\r\n * Calculate center from the given point A\r\n * @param t \r\n * @param ptA \r\n * @returns \r\n */\r\nexport const centerFromA = (t:TriangleEquilateral, ptA: Point = {x:0, y:0}):Point => {\r\n  const r = resolveLength(t);\r\n  const {radius} = incircle(t);\r\n  return  {\r\n    x: ptA.x + r/2,\r\n    y: ptA.y - radius\r\n  };\r\n};\r\n\r\n/**\r\n * Calculate center from the given point B\r\n * @param t \r\n * @param ptB\r\n * @returns \r\n */\r\nexport const centerFromB = (t:TriangleEquilateral, ptB: Point = {x:0, y:0}):Point => {\r\n  const {radius} = incircle(t);\r\n  return  {\r\n    x: ptB.x,\r\n    y: ptB.y + (radius*2)\r\n  };\r\n};\r\n\r\n/**\r\n * Calculate center from the given point C\r\n * @param t \r\n * @param ptC\r\n * @returns \r\n */\r\nexport const centerFromC = (t:TriangleEquilateral, ptC: Point = {x:0, y:0}):Point => {\r\n  const r = resolveLength(t);\r\n  const {radius} = incircle(t);\r\n\r\n  return  {\r\n    x: ptC.x - r/2,\r\n    y: ptC.y - (radius)\r\n  };\r\n};\r\n\r\n/**\r\n * Returns the height (or rise) of an equilateral triangle.\r\n * Ie. from one vertex to the perpendicular edge. \r\n * (line marked x in the diagram below)\r\n * \r\n * ```\r\n *      .\r\n *     .x .\r\n *    . x  .\r\n *   .  x   .\r\n *  ..........\r\n * ```\r\n * @param t \r\n */\r\nexport const height = (t:TriangleEquilateral):number => Math.sqrt(3) / 2 * resolveLength(t);\r\n\r\nexport const perimeter = (t:TriangleEquilateral):number => resolveLength(t)*3;\r\n\r\nexport const area = (t:TriangleEquilateral):number => Math.pow(resolveLength(t), 2) * Math.sqrt(3) / 4;\r\n\r\n/**\r\n * Circle that encompasses all points of triangle\r\n * @param t \r\n */\r\nexport const circumcircle = (t:TriangleEquilateral):Circle => ({\r\n  radius: Math.sqrt(3) / 3 * resolveLength(t)\r\n});\r\n\r\n/**\r\n * Circle that is inside the edges of the triangle\r\n * @param t \r\n * @returns \r\n */\r\nexport const incircle = (t:TriangleEquilateral):Circle => ({\r\n  radius: Math.sqrt(3) / 6 * resolveLength(t)\r\n});","import { Points, Triangles } from \"./index.js\";\nimport { Circle } from \"./Circle\";\n\nexport type Right = {\n  readonly adjacent?:number\n  readonly hypotenuse?:number\n  readonly opposite?:number\n}\n\nexport type DefinedRight = {\n  readonly adjacent:number\n  readonly hypotenuse:number\n  readonly opposite:number\n}\n\n/**\n * Returns a positioned triangle from a point for A.\n * \n * ```  \n *             c (90 deg)\n *             .\n *          .   .\n *       .       .\n *    .           .\n * a .............. b\n * ```\n * @param t \n * @param origin \n * @returns \n */\nexport const fromA = (t:Right, origin:Points.Point = { x:0, y:0 }):Triangles.Triangle => {\n  const tt = resolveLengths(t);\n  const seg = hypotenuseSegments(t);\n  const h = height(t);\n  const a = { x: origin.x, y:origin.y };\n  const b = { x: origin.x + tt.hypotenuse, y: origin.y };\n  const c = { x: origin.x + seg[1], y: origin.y - h };\n  return { a, b, c };\n};\n\n/**\n * Returns a positioned triangle from a point for B.\n * \n * ```     \n *             c (90 deg)\n *             .\n *          .   .\n *       .       .\n *    .           .\n * a .............. b\n * ```\n * @param t \n * @param origin \n * @returns \n */\nexport const fromB = (t:Right, origin:Points.Point = { x:0, y:0 }):Triangles.Triangle => {\n  const tt = resolveLengths(t);\n  const seg = hypotenuseSegments(t);\n  const h = height(t);\n  const b = { x: origin.x, y:origin.y };\n  const a = { x: origin.x - tt.hypotenuse, y: origin.y };\n  const c = { x: origin.x - seg[0], y: origin.y - h };\n  return { a, b, c };\n};\n\n/**\n * Returns a positioned triangle from a point for C.\n * \n * ```\n *             c (90 deg)\n *             .\n *          .   .\n *       .       .\n *    .           .\n * a .............. b\n * ```\n * \n * \n * ```js\n * // Triangle pointing up to 0,0 with sides of 15\n * Triangles.Right.fromC({ adjacent: 15, opposite:15 }, { x: 0, y: 0 });\n * ```\n * @param t \n * @param origin \n * @returns \n */\nexport const fromC = (t:Right, origin:Points.Point = { x:0, y:0 }):Triangles.Triangle => {\n  const seg = hypotenuseSegments(t);\n  const h = height(t);\n  const c = { x: origin.x, y:origin.y };\n  const a = { x: origin.x - seg[1], y: origin.y + h };\n  const b = { x: origin.x + seg[0], y: origin.y + h };\n  return { a, b, c };\n};\n\n/**\n * Returns a right triangle with all lengths defined.\n * At least two lengths must already exist\n * @param t \n * @returns \n */\nexport const resolveLengths = (t:Right):DefinedRight => {\n  const a = t.adjacent;\n  const o = t.opposite;\n  const h = t.hypotenuse;\n\n  if (a !== undefined && o !== undefined) {\n    return {\n      ...t,\n      adjacent: a,\n      opposite: o,\n      hypotenuse: Math.sqrt(a*a + o*o)\n    };\n  } else if (a && h) {\n    return {\n      ...t,\n      adjacent: a,\n      hypotenuse: h,\n      opposite: h*h - a*a \n    };\n  } else if (o && h) {\n    return {\n      ...t,\n      hypotenuse: h,\n      opposite: o,\n      adjacent: h*h - o*o \n    };\n  } else if (t.opposite && t.hypotenuse && t.adjacent) {\n    return t as DefinedRight;\n  }\n  throw new Error(`Missing at least two edges`);\n};\n\n/**\n * Height of right-triangle\n * @param t \n * @returns \n */\nexport const height = (t:Right):number => {\n  const tt = resolveLengths(t);\n  const p = tt.opposite*tt.opposite / tt.hypotenuse;\n  const q = tt.adjacent*tt.adjacent / tt.hypotenuse;\n  return Math.sqrt(p * q);\n};\n\n/**\n * Returns the lengths of the hypotenuse split into p and q segments.\n * In other words, if one makes a line from the right-angle vertex down to hypotenuse.\n * \n * [See here](https://rechneronline.de/pi/right-triangle.php)\n * @param t \n * @returns \n */\nexport const hypotenuseSegments = (t:Right):readonly [p:number, q:number] => {\n  const tt = resolveLengths(t);\n  const p = tt.opposite*tt.opposite / tt.hypotenuse;\n  const q = tt.adjacent*tt.adjacent / tt.hypotenuse;\n  return [p, q];\n};\n\n\nexport const perimeter = (t:Right):number => {\n  const tt= resolveLengths(t);\n  return tt.adjacent + tt.hypotenuse + tt.opposite;\n};\n\nexport const area = (t:Right):number => {\n  const tt = resolveLengths(t);\n  return tt.opposite * tt.adjacent / 2;\n};\n\n/**\n * Angle (in radians) between hypotenuse and adjacent edge\n * @param t \n * @returns \n */\nexport const angleAtPointA = (t:Right):number => {\n  const tt = resolveLengths(t);\n  return Math.acos(\n    (tt.adjacent*tt.adjacent + tt.hypotenuse*tt.hypotenuse - tt.opposite*tt.opposite)\n    / \n    (2*tt.adjacent*tt.hypotenuse)\n  );\n};\n\n/**\n * Angle (in radians) between opposite edge and hypotenuse\n * @param t \n * @returns \n */\nexport const angleAtPointB = (t:Right):number => {\n  const tt = resolveLengths(t);\n  return Math.acos(\n    (tt.opposite*tt.opposite + tt.hypotenuse*tt.hypotenuse - tt.adjacent*tt.adjacent)\n    / \n    (2*tt.opposite*tt.hypotenuse)\n  );\n};\n\n/**\n * Returns the median line lengths a, b and c in an array.\n * \n * The median lines are the lines from each vertex to the center.\n * \n * @param t \n * @returns \n */\nexport const medians = (t:Right):readonly [a:number, b:number, c:number] => {\n  const tt = resolveLengths(t);\n  const b = tt.adjacent*tt.adjacent;\n  const c = tt.hypotenuse*tt.hypotenuse;\n  const a = tt.opposite*tt.opposite;\n  \n  return [\n    Math.sqrt(2*(b+c) -a) /2,\n    Math.sqrt(2*(c+a) - b) /2,\n    Math.sqrt(2*(a+b) - c) /2\n  ];\n};\n\n/**\n * The circle which passes through the points of the triangle\n * @param t \n * @returns \n */\nexport const circumcircle = (t:Right):Circle => {\n  const tt = resolveLengths(t);\n  return { radius: tt.hypotenuse / 2 };\n};\n\n/**\n * Circle enclosed by triangle\n * @param t \n * @returns \n */\nexport const incircle = (t:Right):Circle => {\n  const tt = resolveLengths(t);\n  return {\n    radius: (tt.adjacent + tt.opposite - tt.hypotenuse) / 2\n  };\n};\n\n\n/**\n * Returns the opposite length of a right-angle triangle,\n * marked here\n * \n * ```\n *    .  <\n *   ..  <\n * ....  <\n * ```\n * \n * This is just:\n * ```js\n * opposite = Math.tan(angle) * adjacent\n * ```\n * @param angleRad\n * @param adjacent \n * @returns \n */\nexport const oppositeFromAdjacent = (angleRad:number, adjacent:number):number => Math.tan(angleRad) * adjacent;\n\n/**\n * Returns the opposite length of a right-angle triangle,\n * marked here\n * \n * ```\n *    .  <\n *   ..  <\n * ....  <\n * ```\n * \n * This is just:\n * ```js\n * opposite = Math.tan(angle) * adjacent\n * ```\n * @param angleRad\n * @param hypotenuse \n * @returns \n */\nexport const oppositeFromHypotenuse = (angleRad:number, hypotenuse:number):number => Math.sin(angleRad) * hypotenuse;\n\n\n/**\n * Returns the adjecent length of a right-angle triangle,\n * marked here\n * ```\n *    .  \n *   ..  o\n * ....  \n * ^^^^\n * ```\n * This is just:\n * ```js\n * opposite = Math.tan(angle) * adjacent\n * ```\n * @param angleRad \n * @param adjacent \n * @returns \n */\nexport const adjacentFromHypotenuse = (angleRad:number, hypotenuse:number):number => Math.cos(angleRad) * hypotenuse;\n\n/**\n * Returns the adjecent length of a right-angle triangle,\n * marked here\n * ```\n *    .  \n *   ..  o\n * ....  \n * ^^^^\n * ```\n * This is just:\n * ```js\n * opposite = Math.tan(angle) * adjacent\n * ```\n * @param angleRad \n * @param opposite \n * @returns \n */\nexport const adjacentFromOpposite = (angleRad:number, opposite:number):number => opposite / Math.tan(angleRad);\n\n/**\n * Returns the hypotenuse length of a right-angle triangle,\n * marked here\n * ``` \n *      .\n * >   ..\n * >  ...  \n * > ....  opp\n *  .....  \n *   adj \n * ```\n * This is just:\n * ```js\n * opposite = Math.tan(angle) * adjacent\n * ```\n * @param angleRad \n * @param adjacent \n * @returns \n */\nexport const hypotenuseFromOpposite = (angleRad:number, opposite:number):number => opposite / Math.sin(angleRad);\n\n/**\n * Returns the hypotenuse length of a right-angle triangle,\n * marked here\n * ``` \n *      .\n * >   ..\n * >  ...  \n * > ....  opp\n *  .....  \n *   adj \n * ```\n * This is just:\n * ```js\n * opposite = Math.tan(angle) * adjacent\n * ```\n * @param angleRad \n * @param adjacent \n * @returns \n */\nexport const hypotenuseFromAdjacent = (angleRad:number, adjacent:number):number => adjacent / Math.cos(angleRad);","import {Points, Triangles} from \"./index.js\";\r\nimport {Circle} from \"./Circle\";\r\n\r\nexport type Isosceles  = {\r\n  readonly legs: number\r\n  readonly base: number\r\n}\r\n\r\n\r\nexport const baseAngle = (t:Isosceles):number => Math.acos(t.base /  (2*t.legs));\r\n\r\nexport const apexAngle = (t:Isosceles):number => {\r\n  const aa = t.legs*t.legs;\r\n  const cc = t.base*t.base;\r\n  return Math.acos((2*aa - cc) / (2*aa));\r\n};\r\n\r\nexport const height = (t:Isosceles):number => {\r\n  const aa = t.legs*t.legs;\r\n  const cc = t.base*t.base;\r\n  return Math.sqrt((4*aa - cc) / 4);\r\n};\r\n\r\nexport const legHeights = (t:Isosceles):number => {\r\n  const b = baseAngle(t);\r\n  return t.base * Math.sin(b); \r\n};\r\n\r\nexport const perimeter =(t:Isosceles):number => 2*t.legs + t.base;\r\n\r\nexport const area = (t:Isosceles):number => {\r\n  const h = height(t);\r\n  return h * t.base / 2;\r\n};\r\n\r\nexport const circumcircle = (t:Isosceles):Circle => {\r\n  const h = height(t);\r\n  const hh = h*h;\r\n  const cc = t.base*t.base;\r\n  return {radius: (4*hh + cc) / (8*h) };\r\n};\r\n\r\nexport const incircle = (t:Isosceles):Circle => {\r\n  const h = height(t);\r\n  return {radius: t.base * h / (2 * t.legs + t.base)};\r\n};\r\n\r\nexport const medians = (t:Isosceles):readonly [a:number, b:number, c:number] => {\r\n  const aa = t.legs*t.legs;\r\n  const cc = t.base*t.base;\r\n  const medianAB = Math.sqrt(aa + 2 * cc) / 2;\r\n  const medianC = Math.sqrt(4*aa - cc) / 2;\r\n  return [medianAB, medianAB, medianC];\r\n};\r\n\r\n/**\r\n * Returns a positioned `Triangle` based on a center origin.\r\n * Center is determined by the intesecting of the medians.\r\n * \r\n * See: https://rechneronline.de/pi/isosceles-triangle.php\r\n * @param t \r\n * @param origin \r\n * @returns \r\n */\r\nexport const fromCenter = (t:Isosceles, origin:Points.Point = {x:0, y:0}):Triangles.Triangle => {\r\n  const h = height(t);\r\n  const incircleR = incircle(t).radius;\r\n  const verticalToApex = h - incircleR;\r\n \r\n  const a = {x: origin.x - t.base/2, y: origin.y + incircleR};\r\n  const b = {x: origin.x + t.base/2, y: origin.y + incircleR};\r\n  const c = {x: origin.x, y: origin.y - verticalToApex};\r\n  return {a, b, c};\r\n};\r\n\r\n\r\nexport const fromA = (t:Isosceles, origin:Points.Point = {x:0, y:0}):Triangles.Triangle => {\r\n  const h = height(t);\r\n  const a = {x: origin.x, y:origin.y};\r\n  const b = {x: origin.x + t.base, y: origin.y};\r\n  const c = {x: origin.x + t.base/2, y: origin.y - h};\r\n  return {a, b, c};\r\n};\r\n\r\nexport const fromB = (t:Isosceles, origin:Points.Point = {x:0, y:0}):Triangles.Triangle => {\r\n  const h = height(t);\r\n  const b = {x: origin.x, y:origin.y};\r\n  const a = {x: origin.x - t.base, y: origin.y};\r\n  const c = {x: origin.x - t.base/2, y: origin.y - h};\r\n  return {a, b, c};\r\n};\r\n\r\nexport const fromC = (t:Isosceles, origin:Points.Point = {x:0, y:0}):Triangles.Triangle => {\r\n  const h = height(t);\r\n  const c = {x: origin.x, y:origin.y};\r\n  const a = {x: origin.x - t.base/2, y: origin.y + h};\r\n  const b = {x: origin.x + t.base/2, y: origin.y + h};\r\n  return {a, b, c};\r\n};\r\n","/**\n * Generic support for Bluetooth LE devices\n */\nexport * as Bluetooth from './NordicBleDevice.js';\n\nexport * as AudioAnalysers from './AudioAnalyser.js';\nexport * as AudioVisualisers from './AudioVisualiser.js';\n\nexport { StringReceiveBuffer } from './StringReceiveBuffer.js';\nexport { StringWriteBuffer } from './StringWriteBuffer.js';\nexport { Codec } from './Codec.js';\n\n/**\n * Espruino-based devices connected via Bluetooth LE\n * \n * See [demos](https://clinth.github.io/ixfx-demos/io/)\n * \n * Overview:\n * * {@link puck}: Connects a [Espruino BLE Device](../classes/Io.Espruino.EspruinoBleDevice.html).\n * * {@link Espruino.connectBle}: Connect to a generic Espruino via BLE\n */\nexport * as Espruino from './Espruino.js';\n\nexport * as Camera from './Camera.js';\n\nexport * as VideoFile from './VideoFile.js';\n\nexport { FrameProcessor, FrameProcessorOpts } from './FrameProcessor.js';\n\n/**\n * Microcontrollers such as Arduinos connected via USB serial\n * \n * Overview\n * * {@link Serial.Device}\n * \n */\nexport * as Serial from './Serial.js';\n\n","import {BleDevice} from \"./BleDevice.js\";\r\n\r\nexport const defaultOpts = {\r\n  chunkSize: 20,\r\n  service: `6e400001-b5a3-f393-e0a9-e50e24dcca9e`,\r\n  txGattCharacteristic: `6e400002-b5a3-f393-e0a9-e50e24dcca9e`,\r\n  rxGattCharacteristic: `6e400003-b5a3-f393-e0a9-e50e24dcca9e`,\r\n  name: `NordicDevice`,\r\n  connectAttempts: 5,\r\n  debug: false\r\n};\r\n\r\nexport type Opts = {\r\n  readonly chunkSize?:number\r\n  readonly name?:string\r\n  readonly connectAttempts?:number\r\n  readonly debug?:boolean\r\n}\r\n\r\nexport class NordicBleDevice extends BleDevice  {\r\n  constructor(device: BluetoothDevice, opts:Opts = {}) {\r\n    super(device, {...defaultOpts, ...opts});\r\n  }\r\n}\r\n\r\n","\r\n/**\r\n * Handles utf-8 text encoding/decoding\r\n */\r\nexport class Codec {\r\n  enc = new TextEncoder();\r\n  dec = new TextDecoder(`utf-8`);\r\n\r\n  /**\r\n   * Convert string to Uint8Array buffer\r\n   * @param str \r\n   * @returns \r\n   */\r\n  toBuffer(str: string) {\r\n    return this.enc.encode(str);\r\n  }\r\n\r\n  /**\r\n   * Returns a string from a provided buffer\r\n   * @param buffer \r\n   * @returns \r\n   */\r\n  fromBuffer(buffer: ArrayBuffer) {\r\n    return this.dec.decode(buffer);\r\n  }\r\n}","\n/**\n * Receives text\n */\nexport class StringReceiveBuffer {\n  buffer: string = ``;\n  stream:WritableStream<string>|undefined;\n\n  constructor(private onData: (data: string) => void, public separator = `\\n`) {\n\n  }\n\n  async close() {\n    const s= this.stream;\n    if (!s) return;\n    await s.abort();\n\n    await s.close();\n  }\n\n  clear() {\n    this.buffer = ``;\n  }\n\n  writable() {\n    if (this.stream === undefined) this.stream = this.createWritable();\n    return this.stream;\n  }\n\n  private createWritable() {\n    //eslint-disable-next-line @typescript-eslint/no-this-alias\n    const b = this;\n    return new WritableStream<string>({\n      write(chunk) {\n        b.add(chunk);\n      },\n      close() {\n        b.clear();\n      }\n    });\n  }\n\n  addImpl(str: string):string {\n    // Look for separator in new string\n    const pos = str.indexOf(this.separator);\n    if (pos < 0) {\n      // Not found, just add to buffer and return\n      this.buffer += str;\n      return ``;\n    }\n\n    // Found! Trigger callback for existing buffer and part of new string\n    const part = str.substring(0, pos);\n    try {\n      this.onData(this.buffer + part);\n      str = str.substring(part.length+this.separator.length);\n    } catch (ex) {\n      console.warn(ex);\n    }\n    \n    this.buffer = ``;\n\n    return str;\n  }\n\n  add(str:string) {\n    while (str.length > 0) {\n      str = this.addImpl(str);\n    }\n  }\n}","import {QueueMutable, queueMutable} from \"../collections/index.js\";\nimport {Continuously, continuously} from \"../flow/index.js\";\nimport {splitByLength} from \"../Text.js\";\n\nexport class StringWriteBuffer {\n  paused = false;\n  queue: QueueMutable<string>;\n  writer: Continuously;\n  intervalMs: number;\n  stream:WritableStream<string>|undefined;\n\n  constructor(private onData: (data: string) => Promise<void>, private chunkSize = -1) {\n    this.intervalMs = 10;\n    this.queue = queueMutable<string>();\n    this.writer = continuously(() => this.onWrite(), this.intervalMs);\n  }\n\n  async close() {\n    const w = this.stream?.getWriter();\n    w?.releaseLock();\n    await w?.close();\n  }\n\n  clear() {\n    this.queue = queueMutable<string>();\n  }\n\n  writable() {\n    if (this.stream === undefined) this.stream = this.createWritable();\n    return this.stream;\n  }\n\n  private createWritable() {\n    //eslint-disable-next-line @typescript-eslint/no-this-alias\n    const b = this;\n    return new WritableStream<string>({\n      write(chunk) {\n        b.add(chunk);\n      },\n      close() {\n        b.clear();\n      }\n    });\n  }\n\n  async onWrite(): Promise<boolean> {\n    if (this.queue.isEmpty) {\n      //console.warn(`WriteBuffer.onWrite: queue empty`);\n      return false; // Stop continuously\n    }\n\n    if (this.paused) {\n      console.warn(`WriteBuffer.onWrite: paused...`);\n      return true; // Keep going tho\n    }\n\n    // Dequeue and send\n    const s = this.queue.dequeue();\n    if (s === undefined) return false;\n    await this.onData(s);\n\n    return true;\n  }\n\n  add(str: string) {\n    // Add whole string or chunked string\n    if (this.chunkSize > 0) {\n      this.queue.enqueue(...splitByLength(str, this.chunkSize));\n    } else {\n      this.queue.enqueue(str);\n    }\n\n    // Run continuously loop if it's not already running\n    this.writer.start();\n  }\n}","import {integer as guardInteger} from '../Guards.js';\nimport {sleep} from './Sleep.js';\n\nexport type CancelToken = {\n  readonly cancel:boolean\n};\n\n/**\n * Keeps executing `calback` until it runs without an exception being thrown.\n * \n * ```\n * // Retry up to five times, starting at 200ms delay\n * await retry(async () => {\n *  // Do something, sometimes throwing an error\n * }, 5, 200);\n * ```\n * \n * Each loop will run at twice the duration of the last, beginning at `startingTimeoutMs`.\n * \n * @param callback Async code to run\n * @param attempts Number of times to try\n * @param startingTimeoutMs Time to sleep for first iteration\n * @param cancelToken If provided, this is checked before and after each sleep to see if retry should continue. If cancelled, promise will be rejected\n * @returns \n */\nexport const retry = async <V>(callback:() => Promise<V>, attempts:number = 5, startingTimeoutMs:number = 200, cancelToken?:CancelToken):Promise<V> => {\n  guardInteger(attempts, `positive`, `attempts`);\n  guardInteger(startingTimeoutMs, `positive`, `startingTimeoutMs`);\n\n  //eslint-disable-next-line functional/no-let\n  let timeout = startingTimeoutMs;\n  //eslint-disable-next-line functional/no-let\n  let totalSlept = 0;\n  while (attempts > 0) {\n    try {\n      return await callback();\n    } catch (ex) {\n      attempts--;\n    }\n    totalSlept += timeout;\n\n    if (cancelToken && cancelToken.cancel) throw new Error(`Cancelled`);\n    await sleep(timeout);\n    if (cancelToken && cancelToken.cancel) throw new Error(`Cancelled`);\n\n    timeout *= 2;\n  }\n  throw new Error(`Retry failed after ${attempts} attempts over ${totalSlept} ms.`);\n\n};","import {SimpleEventEmitter} from \"../Events.js\";\nimport { StateMachine} from \"../flow/StateMachine.js\";\nimport {indexOfCharCode, omitChars} from \"../Text.js\";\nimport {Codec} from \"./Codec.js\";\nimport {StringReceiveBuffer} from \"./StringReceiveBuffer.js\";\nimport {StringWriteBuffer} from \"./StringWriteBuffer.js\";\nimport {retry} from \"../flow/Retry.js\";\nimport {Events} from \"./Espruino.js\";\n\nexport type Opts = {\n  readonly service:string\n  readonly rxGattCharacteristic:string\n  readonly txGattCharacteristic:string\n  readonly chunkSize:number\n  readonly name:string\n  readonly connectAttempts:number\n  readonly debug:boolean\n}\n\nconst reconnect = async () => {\n  console.log(`Connect?`);\n  if (!(`bluetooth` in navigator)) return false;\n  if (!(`getDevices` in navigator.bluetooth)) return false;\n\n  const devices = await navigator.bluetooth.getDevices();\n  console.log(devices);\n\n  for (const device of devices) {\n    console.log(device);\n    // Start a scan for each device before connecting to check that they're in\n    // range.\n    const abortController = new AbortController();\n    await device.watchAdvertisements({ signal: abortController.signal });\n    device.addEventListener(`advertisementreceived`, async (evt) => {\n      console.log(evt);\n      // Stop the scan to conserve power on mobile devices.\n      abortController.abort();\n   \n   \n      // At this point, we know that the device is in range, and we can attempt\n      // to connect to it.\n      await evt.device.gatt?.connect();\n      console.log(`Connected!`);\n    });\n  }\n};\n\nexport class BleDevice extends SimpleEventEmitter<Events> {\n  states: StateMachine;\n  codec: Codec;\n  rx: BluetoothRemoteGATTCharacteristic | undefined;\n  tx: BluetoothRemoteGATTCharacteristic | undefined;\n  gatt: BluetoothRemoteGATTServer | undefined;\n  verboseLogging = false;\n\n  rxBuffer: StringReceiveBuffer;\n  txBuffer: StringWriteBuffer;\n\n  constructor(private device: BluetoothDevice, private config:Opts) {\n    super();\n    this.verboseLogging = config.debug;\n    this.txBuffer = new StringWriteBuffer(async data => {\n      await this.writeInternal(data);\n    }, config.chunkSize);\n\n    this.rxBuffer = new StringReceiveBuffer(line => {\n      this.fireEvent(`data`, { data:line });\n    });\n\n    this.codec = new Codec();\n    this.states = new StateMachine(`ready`, {\n      ready: `connecting`,\n      connecting: [`connected`, `closed`],\n      connected: [`closed`],\n      closed: `connecting`\n    });\n\n    this.states.addEventListener(`change`, evt => {\n      this.fireEvent(`change`, evt);\n      this.verbose(`${evt.priorState} -> ${evt.newState}`);\n      if (evt.priorState === `connected`) {\n        // Clear out buffers\n        this.rxBuffer.clear();\n        this.txBuffer.clear();\n      }\n    });\n\n    device.addEventListener(`gattserverdisconnected`, () => {\n      if (this.isClosed) return;\n      this.verbose(`GATT server disconnected`);\n      this.states.state = `closed`;\n    });\n\n    this.verbose(`ctor ${device.name} ${device.id}`);\n  }\n\n  get isConnected():boolean {\n    return this.states.state === `connected`;\n  }\n\n  get isClosed():boolean {\n    return this.states.state === `closed`;\n  }\n\n  write(txt: string) {\n    if (this.states.state !== `connected`) throw new Error(`Cannot write while state is ${this.states.state}`);\n    this.txBuffer.add(txt);\n  }\n\n  private async writeInternal(txt: string) {\n    this.verbose(`writeInternal ${txt}`);\n    const tx = this.tx;\n    if (tx === undefined) throw new Error(`Unexpectedly without tx characteristic`);\n    try {\n      await tx.writeValue(this.codec.toBuffer(txt));\n    } catch (ex:unknown) {\n      this.warn(ex);\n    }\n  }\n\n  disconnect() {\n    if (this.states.state !== `connected`) return;\n    this.gatt?.disconnect();\n  }\n\n  async connect() {\n    const attempts = this.config.connectAttempts ?? 3;\n\n    this.states.state = `connecting`;\n\n    this.verbose(`connect`);\n    const gatt = this.device.gatt;\n    if (gatt === undefined) throw new Error(`Gatt not available on device`);\n\n    await retry(async () => {\n      const server = await gatt.connect();\n      this.verbose(`Getting primary service`);\n      const service = await server.getPrimaryService(this.config.service);\n      this.verbose(`Getting characteristics`);\n      const rx = await service.getCharacteristic(this.config.rxGattCharacteristic);\n      const tx = await service.getCharacteristic(this.config.txGattCharacteristic);\n  \n      rx.addEventListener(`characteristicvaluechanged`, (evt) => this.onRx(evt));\n      this.rx = rx;\n      this.tx = tx;\n      this.gatt = gatt;\n      this.states.state = `connected`;\n  \n      await rx.startNotifications();\n    }, attempts, 200);\n  }\n\n  private onRx(evt: Event) {\n    const rx = this.rx;\n    if (rx === undefined) return;\n\n    //eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const view = (evt.target as any).value as DataView;\n    if (view === undefined) return;\n\n    //eslint-disable-next-line functional/no-let\n    let str = this.codec.fromBuffer(view.buffer);\n\n    // Check for flow control chars\n    const plzStop = indexOfCharCode(str, 19);\n    const plzStart = indexOfCharCode(str, 17);\n\n    // Remove if found\n    if (plzStart && plzStop < plzStart) {\n      this.verbose(`Tx plz start`);\n      str = omitChars(str, plzStart, 1);\n      this.txBuffer.paused = false;\n    }\n    if (plzStop && plzStop > plzStart) {\n      this.verbose(`Tx plz stop`);\n      str = omitChars(str, plzStop, 1);\n      this.txBuffer.paused = true;\n    }\n\n    this.rxBuffer.add(str);\n  }\n\n  protected verbose(m: string) {\n    if (this.verboseLogging) console.info(`${this.config.name} `, m);\n  }\n\n  protected log(m: string) {\n    console.log(`${this.config.name} `, m);\n  }\n\n  protected warn(m:unknown) {\n    console.warn(`${this.config.name} `, m);\n  }\n}\n\n","import {Arrays} from \"../collections/index.js\";\nimport AudioVisualiser from \"./AudioVisualiser.js\";\nimport {number as guardNumber, integer as guardInteger} from \"../Guards.js\";\nimport {isPowerOfTwo} from \"../Util.js\";\n\n/**\n * Options for audio processing\n * \n * fftSize: Must be a power of 2, from 32 - 32768. Higher number means\n * more precision and higher CPU overhead\n * @see https://developer.mozilla.org/en-US/docs/Web/API/AnalyserNode/fftSize\n * \n * smoothingTimeConstant: Range from 0-1, default is 0.8.\n * @see https://developer.mozilla.org/en-US/docs/Web/API/AnalyserNode/smoothingTimeConstant\n * \n * debug: If true, additonal console logging will happen\n */\nexport type Opts = Readonly<{\n  readonly showVis?:boolean\n  /**\n   * FFT size. Must be a power of 2, from 32 - 32768. Higher number means\n   * more precision and higher CPU overhead\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/AnalyserNode/fftSize\n   */\n  readonly fftSize?:number\n  /**\n   * Range from 0-1, default is 0.8\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/AnalyserNode/smoothingTimeConstant\n   */\n  readonly smoothingTimeConstant?:number\n  readonly debug?:boolean\n}>;\n\nexport type DataAnalyser = (node:AnalyserNode, analyser:AudioAnalyser) => void;\n\n/**\n * Basic audio analyser. Returns back waveform and FFT analysis. Use {@link peakLevel} if you want sound level, or {@link freq} if you just want FFT results.\n * \n * ```js\n * const onData = (freq, wave, analyser) => {\n *  // Demo: Get FFT results just for 100Hz-1KHz.\n *  const freqSlice = analyser.sliceByFrequency(100,1000,freq);\n * \n *  // Demo: Get FFT value for a particular frequency (1KHz)\n *  const amt = freq[analyser.getIndexForFrequency(1000)];\n * }\n * basic(onData, {fftSize: 512});\n * ```\n * \n * An `Analyser` instance is returned and can be controlled:\n * ```js\n * const analyser = basic(onData);\n * analyser.paused = true;\n * ```\n * \n * Note: Browers won't allow microphone access unless the call has come from a user-interaction, eg pointerup event handler. \n * \n * @param onData Handler for data\n * @param opts Options\n * @returns Analyser instance\n */\nexport const basic = (onData:(freq:Float32Array, wave:Float32Array, analyser:AudioAnalyser) => void, opts:Opts = {}):AudioAnalyser => new AudioAnalyser((node, analyser) => {\n  // Get frequency and amplitude data\n  const freq = new Float32Array(node.frequencyBinCount);\n  const wave = new Float32Array(node.fftSize);\n\n  // Load arrays with data\n  node.getFloatFrequencyData(freq);\n  node.getFloatTimeDomainData(wave);\n\n  // Send back\n  onData(freq, wave, analyser);\n}, opts);\n\n/**\n * Basic audio analyser. Returns FFT analysis. Use {@link peakLevel} if you want the sound level, or {@link basic} if you also want the waveform.\n * \n * ```js\n * const onData = (freq, analyser) => {\n *  // Demo: Print out each sound frequency (Hz) and amount of energy in that band\n *  for (let i=0;i<freq.length;i++) {\n *    const f = analyser.getFrequencyAtIndex(0);\n *    console.log(`${i}. frequency: ${f} amount: ${freq[i]}`);\n *  }\n * }\n * freq(onData, {fftSize:512});\n * ```\n * \n * Note: Browers won't allow microphone access unless the call has come from a user-interaction, eg pointerup event handler. \n * \n * @param onData \n * @param opts \n * @returns \n */\nexport const freq = (onData:(freq:Float32Array, analyser:AudioAnalyser)=>void, opts:Opts={}):AudioAnalyser => new AudioAnalyser((node, analyser) => {\n  const freq = new Float32Array(node.frequencyBinCount);\n  node.getFloatFrequencyData(freq);\n  onData(freq, analyser);\n}, opts);\n\n/**\n * Basic audio analyser which reports the peak sound level.\n * \n * ```js\n * peakLevel(level => {\n *  console.log(level);\n * });\n * ```\n * \n * Note: Browers won't allow microphone access unless the call has come from a user-interaction, eg pointerup event handler. \n * @param onData \n * @param opts \n * @returns \n */\nexport const peakLevel = (onData:(level:number, analyser:AudioAnalyser)=>void, opts:Opts={}):AudioAnalyser => new AudioAnalyser((node, analyser) => {\n  const wave = new Float32Array(node.fftSize);\n  node.getFloatTimeDomainData(wave);\n  onData(Arrays.maxFast(wave), analyser);\n}, opts);\n\n/**\n * Helper for doing audio analysis. It takes case of connecting the audio stream, running in a loop and pause capability.\n * \n * Provide a function which works with an [AnalyserNode](https://developer.mozilla.org/en-US/docs/Web/API/AnalyserNode), and does something with the result.\n * ```js\n * const myAnalysis = (node, analyser) => {\n *  const freq = new Float32Array(node.frequencyBinCount);\n *  node.getFloatFrequencyData(freq);\n *  // Do something with frequency data...\n * }\n * const a = new Analyser(myAnalysis);\n * ```\n * \n * Two helper functions provide ready-to-use Analysers:\n * * {@link peakLevel} peak decibel reading\n * * {@link freq} FFT results\n * * {@link basic} FFT results and waveform\n * \n * Note: Browers won't allow microphone access unless the call has come from a user-interaction, eg pointerup event handler.\n *\n */\nexport class AudioAnalyser {\n  showVis:boolean;\n  fftSize:number;\n  smoothingTimeConstant:number;\n  #isPaused = false;\n  debug:boolean;\n  #initInProgress = false;\n\n  visualiser:AudioVisualiser|undefined;  \n  audioCtx:AudioContext|undefined;\n  analyserNode:AnalyserNode|undefined;\n\n  analyse:DataAnalyser;\n\n  constructor(analyse:DataAnalyser, opts:Opts = {}) {\n    this.showVis = opts.showVis ?? false;\n    this.fftSize = opts.fftSize ?? 1024;\n    this.debug = opts.debug ?? false;\n    this.smoothingTimeConstant = opts.smoothingTimeConstant ?? 0.8;\n\n    guardInteger(this.fftSize, `positive`, `opts.fftSize`);\n    guardNumber(this.smoothingTimeConstant, `percentage`, `opts.smoothingTimeConstant`);\n\n    if (!isPowerOfTwo(this.fftSize)) throw new Error(`fftSize must be a power of two from 32 to 32768 (${this.fftSize})`);\n    if(this.fftSize < 32) throw new Error(`fftSize must be at least 32`);\n    if (this.fftSize > 32768) throw new Error(`fftSize must be no greater than 32768`);\n\n    this.analyse = analyse;\n    this.paused = false;\n\n    this.init();\n\n    const visualiserEl = document.getElementById(`audio-visualiser`);\n    if (visualiserEl) {\n      const visualiser = new AudioVisualiser(visualiserEl, this);\n      visualiser.setExpanded(this.showVis);\n      this.visualiser = visualiser;\n    }\n  }\n\n  init() {\n    if (this.#initInProgress) {\n      if (this.debug) console.debug(`Init already in progress`);\n      return;\n    }\n    this.#initInProgress = true;\n\n    // Initalise microphone\n    navigator.mediaDevices.getUserMedia({audio: true})\n      .then(stream => {     \n        this.onMicSuccess(stream);\n      })\n      .catch(err => {\n        this.#initInProgress = false;\n        console.error(err);\n      });\n  }\n\n  get paused():boolean {\n    return this.#isPaused;\n  }\n\n  set paused(v:boolean) {\n    if (v === this.#isPaused) return;\n    this.#isPaused = v;\n    if (!v) {\n      if (this.debug) console.log(`Unpaused`);\n      window.requestAnimationFrame(this.analyseLoop.bind(this));\n    } else {\n      if (this.debug) console.log(`Paused`);\n    }\n  }\n\n  private setup(audioCtx:AudioContext, stream:MediaStream) {\n    const analyser = audioCtx.createAnalyser();\n\n    // fftSize must be a power of 2. Higher values slower, more detailed\n    // Range is 32-32768\n    analyser.fftSize = this.fftSize;\n\n    // smoothingTimeConstant ranges from 0.0 to 1.0\n    // 0 = no averaging. Fast response, jittery\n    // 1 = maximum averaging. Slow response, smooth\n    analyser.smoothingTimeConstant = this.smoothingTimeConstant;\n\n    // Microphone -> analyser\n    const micSource = audioCtx.createMediaStreamSource(stream);\n    micSource.connect(analyser);\n    return analyser;\n  }\n\n  // Microphone successfully initalised, now have access to audio data\n  private onMicSuccess(stream:MediaStream) {\n    try {\n      const audioCtx = new AudioContext();\n\n      audioCtx.addEventListener(`statechange`, () => {\n        if (this.debug) console.log(`Audio context state: ${audioCtx.state}`);\n      });\n\n      this.audioCtx = audioCtx;\n      this.analyserNode = this.setup(audioCtx, stream);\n\n      // Start loop\n      window.requestAnimationFrame(this.analyseLoop.bind(this));\n    } catch (ex) {\n      this.#initInProgress = false;\n      console.error(ex);\n    }\n  }\n\n  private analyseLoop() {\n    if (this.paused) {\n      if (this.debug) console.log(`Paused`);\n      return;\n    }\n\n    const a = this.analyserNode;\n    if (a === undefined) {\n      console.warn(`Analyser undefined`);\n      return;\n    }\n\n    try {\n      // Perform analysis\n      this.analyse(a, this);\n    } catch (e) {\n      console.error(e);\n    }\n\n    // Run again\n    window.requestAnimationFrame(this.analyseLoop.bind(this));\n  }\n\n  // visualise(wave, freq) {\n  //   if (!this.visualiser) return;\n  //   this.visualiser.renderWave(wave, true);\n  //   this.visualiser.renderFreq(freq);\n  // }\n\n  /**\n   * Returns the maximum FFT value within the given frequency range\n   */\n  getFrequencyRangeMax(lowFreq:number, highFreq:number, freqData:readonly number[]):number {\n    const samples = this.sliceByFrequency(lowFreq, highFreq, freqData);\n    return Arrays.max(samples);\n  }\n\n  /**\n   * Returns a sub-sampling of frequency analysis data that falls between\n   * `lowFreq` and `highFreq`.\n   * @param lowFreq Low frequency\n   * @param highFreq High frequency\n   * @param freqData Full-spectrum frequency data\n   * @returns Sub-sampling of analysis\n   */\n  sliceByFrequency(lowFreq:number, highFreq:number, freqData:readonly number[]) {\n    const lowIndex = this.getIndexForFrequency(lowFreq);\n    const highIndex = this.getIndexForFrequency(highFreq);\n\n    // Grab a 'slice' of the array between these indexes\n    const samples = freqData.slice(lowIndex, highIndex);\n    return samples;\n  }\n\n  /**\n   * Returns the starting frequency for a given binned frequency index.\n   * @param index Array index\n   * @returns Sound frequency\n   */\n  getFrequencyAtIndex(index:number):number {\n    const a = this.analyserNode;\n    const ctx = this.audioCtx;\n    if (a === undefined) throw new Error(`Analyser not available`);\n    if (ctx === undefined) throw new Error(`Audio context not available`);\n\n    guardInteger(index, `positive`, `index`);\n    if (index > a.frequencyBinCount) throw new Error(`Index ${index} exceeds frequency bin count ${a.frequencyBinCount}`);\n\n    return index * ctx.sampleRate / (a.frequencyBinCount * 2);\n  }\n\n  /**\n   * Returns a binned array index for a given frequency\n   * @param freq Sound frequency\n   * @returns Array index into frequency bins\n   */\n  getIndexForFrequency(freq:number):number {\n    const a = this.analyserNode;\n    if (a === undefined) throw new Error(`Analyser not available`);\n\n    const nyquist = a.context.sampleRate / 2.0;\n    const index = Math.round(freq / nyquist * a.frequencyBinCount);\n    if (index < 0) return 0;\n    if (index >= a.frequencyBinCount) return a.frequencyBinCount - 1;\n    return index;\n  }\n}","/**\n * Visualiser component\n *\n * Usage: import visualiser.js. Instantiate on document load, and pass in the\n * parent element into the constructor.\n *\n * eg: const v = new Visualiser(document.getElementById('renderer'));\n *\n * Data must be passed to the component via renderFreq or renderWave.\n * \n * Draws on https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API/Visualizations_with_Web_Audio_API\n */\n\nimport { Arrays } from '../collections/index.js';\nimport { Points } from '../geometry/index.js';\nimport { numberTracker } from '../data/NumberTracker.js';\nimport { AudioAnalyser } from './AudioAnalyser.js';\n\n// TODO: This is an adaption of old code. Needs to be smartened up further\nexport default class AudioVisualiser {\n  freqMaxRange = 200;\n  audio:AudioAnalyser;\n  parent:HTMLElement;\n \n  lastPointer:Points.Point = { x:0, y:0 };\n  pointerDown = false;\n  pointerClicking = false;\n  pointerClickDelayMs = 100;\n  pointerDelaying = false;\n\n  waveTracker;\n  freqTracker;\n  el:HTMLElement;\n\n  constructor(parentElem:HTMLElement, audio:AudioAnalyser) {\n    this.audio = audio;\n    this.parent = parentElem;\n    this.waveTracker = numberTracker();\n    this.freqTracker = numberTracker();\n   \n    // Add HTML\n    parentElem.innerHTML = `\n    <section>\n      <button id=\"rendererComponentToggle\"></button>\n      <div>\n        <h1>Visualiser</h1>\n        <div style=\"display:flex; flex-wrap: wrap\">\n          <div class=\"visPanel\">\n            <h2>Frequency distribution</h2>\n            <br />\n            <canvas id=\"rendererComponentFreqData\" height=\"200\" width=\"400\"></canvas>\n          </div>\n          <div class=\"visPanel\">\n            <h2>Waveform</h2>\n            <button id=\"rendererComponentWaveReset\">Reset</button>\n            <div>\n              Press and hold on wave to measure\n            </div>\n            <br />\n            <canvas id=\"rendererComponentWaveData\" height=\"200\" width=\"400\"></canvas>\n          </div>\n        </div>\n      </div>\n    </section>\n    `;\n    this.el = parentElem.children[0] as HTMLElement;\n\n    document.getElementById(`rendererComponentToggle`)?.addEventListener(`click`, () => {\n      this.setExpanded(!this.isExpanded());\n    });\n    this.el.addEventListener(`pointermove`, (e) => this.onPointer(e));\n    //this.el.addEventListener(`touchbegin`, (e) => this.onPointer(e));\n    this.el.addEventListener(`pointerup`, () => { \n      this.pointerDelaying = false; \n      this.pointerDown = false;\n    });\n    this.el.addEventListener(`pointerdown`, () => {\n      this.pointerDelaying = true;\n      setTimeout(() => {\n        if (this.pointerDelaying) { this.pointerDelaying = false; this.pointerDown = true; }\n      }, this.pointerClickDelayMs);\n    });\n    this.el.addEventListener(`pointerleave`, () => { \n      this.pointerDelaying = false; \n      this.pointerDown = false; });\n\n    document.getElementById(`rendererComponentWaveReset`)?.addEventListener(`click`, () => {\n      this.clear();\n    });\n  }\n\n  renderFreq(freq:readonly number[]) {\n    if (!this.isExpanded()) return; // Don't render if collapsed\n    if (!freq) return; // Data is undefined/null\n\n    const canvas = document.getElementById(`rendererComponentFreqData`) as HTMLCanvasElement;\n    if (canvas === null) throw new Error(`Cannot find canvas element`);\n    const g = canvas.getContext(`2d`);\n    if (g === null) throw new Error(`Cannot create drawing context`);\n\n    const bins = freq.length;\n    const canvasWidth = canvas.clientWidth;\n    const canvasHeight = canvas.clientHeight;\n    g.clearRect(0, 0, canvasWidth, canvasHeight);\n\n    const pointer = this.getPointerRelativeTo(canvas);\n    const width = (canvasWidth / bins);\n    const minMax = Arrays.minMaxAvg(freq);\n\n    //eslint-disable-next-line functional/no-let\n    for (let i = 0; i < bins; i++) {\n      if (!Number.isFinite(freq[i])) continue;\n\n      const value = freq[i] - minMax.min;\n      const valueRelative = value / this.freqMaxRange;\n      const height = Math.abs(canvasHeight * valueRelative);\n      const offset = canvasHeight - height;\n\n      const hue = i / bins * 360;\n      const left = i * width;\n      g.fillStyle = `hsl(` + hue + `, 100%, 50%)`;\n\n      // Show info about data under pointer\n      if (pointer.y > 0 && pointer.y <= canvasHeight && pointer.x >= left && pointer.x <= left + width) {\n        // Keep track of data\n        if (this.freqTracker.id !== i.toString()) {\n          this.freqTracker = numberTracker({ id: i.toString() });\n        }\n        this.freqTracker.seen(freq[i]);\n\n        const freqMma = this.freqTracker.getMinMaxAvg();\n\n        // Display\n        g.fillStyle = `black`;\n        if (this.audio) { \n          g.fillText(`Frequency (${i}) at pointer: ${this.audio.getFrequencyAtIndex(i).toLocaleString(`en`)} - ${this.audio.getFrequencyAtIndex(i + 1).toLocaleString(`en`)}`, 2, 10); \n        }\n        g.fillText(`Raw value: ${freq[i].toFixed(2)}`, 2, 20);\n        g.fillText(`Min: ${freqMma.min.toFixed(2)}`, 2, 40);\n        g.fillText(`Max: ${freqMma.max.toFixed(2)}`, 60, 40);\n        g.fillText(`Avg: ${freqMma.avg.toFixed(2)}`, 120, 40);\n\n      }\n      g.fillRect(left, offset, width, height);\n    }\n  }\n\n  isExpanded() {\n    const contentsElem = this.el.querySelector(`div`);\n    if (contentsElem === null) throw new Error(`contents div not found`);\n    return (contentsElem.style.display === ``);\n  }\n\n  setExpanded(value:boolean) {\n    const contentsElem = this.el.querySelector(`div`);\n    const button = this.el.querySelector(`button`);\n\n    if (button === null) throw new Error(`Button element not found`);\n    if (contentsElem === null) throw new Error(`Contents element not found`);\n    if (value) {\n      contentsElem.style.display = ``;\n      button.innerText = ``;\n    } else {\n      contentsElem.style.display = `none`;\n      button.innerText = ``;\n    }\n  }\n\n  clear() {\n    this.clearCanvas(document.getElementById(`rendererComponentFreqData`) as HTMLCanvasElement);\n    this.clearCanvas(document.getElementById(`rendererComponentWaveData`) as HTMLCanvasElement);\n  }\n\n  // Clears a canvas to white\n  clearCanvas(canvas:HTMLCanvasElement|null) {\n    if (canvas === null) throw new Error(`Canvas is null`);\n    const g = canvas.getContext(`2d`);\n    if (g === null) throw new Error(`Cannot create drawing context`);\n    g.fillStyle = `white`;\n    g.fillRect(0, 0, canvas.clientWidth, canvas.clientHeight);\n  }\n\n  // Renders waveform data.\n  // Adapted from MDN's AnalyserNode.getFloatTimeDomainData() example\n  renderWave(wave:readonly number[], bipolar = true) {\n    if (!this.isExpanded()) return; // Don't render if collapsed\n    if (!wave) return; // Undefined or null data\n    const canvas = document.getElementById(`rendererComponentWaveData`) as HTMLCanvasElement;\n    if (canvas === null) throw new Error(`Cannot find wave canvas`);\n    \n    const g = canvas.getContext(`2d`);\n    if (g === null) throw new Error(`Cannot create drawing context for wave`);\n\n    const canvasWidth = canvas.clientWidth;\n    const canvasHeight = canvas.clientHeight;\n    const pointer = this.getPointerRelativeTo(canvas);\n    const infoAreaHeight = 20;\n    const infoAreaWidth = 60;\n    const bins = wave.length;\n    g.fillStyle = `white`;\n    g.fillRect(0, 0, infoAreaWidth, infoAreaHeight);\n\n    const width = canvasWidth / bins;\n\n    // Clears the screen with very light tint of white\n    // to fade out last waveform. Set this higher to remove effect\n    g.fillStyle = `rgba(255, 255, 255, 0.03)`;\n    g.fillRect(0, 20, canvasWidth, canvasHeight);\n\n    g.fillStyle = `red`;\n    if (bipolar) {\n      g.fillRect(0, canvasHeight / 2, canvasWidth, 1);\n    } else {\n      g.fillRect(0, canvasHeight - 1, canvasWidth, 1);\n    }\n\n    g.lineWidth = 1;\n    g.strokeStyle = `black`;\n    g.beginPath();\n\n    //eslint-disable-next-line functional/no-let\n    let x = 0;\n\n    //eslint-disable-next-line functional/no-let\n    for (let i = 0; i < bins; i++) {\n      const height = wave[i] * canvasHeight;\n      const y = bipolar ? (canvasHeight / 2) - height : canvasHeight - height;\n\n      if (i === 0) {\n        g.moveTo(x, y);\n      } else {\n        g.lineTo(x, y);\n      }\n      x += width;\n\n      if (this.pointerDown) this.waveTracker.seen(wave[i]);\n    }\n    g.lineTo(canvasWidth, bipolar ? canvasHeight / 2 : canvasHeight);//canvas.height / 2);\n    g.stroke();\n\n    // Draw\n    if (this.pointerDown) {\n      const waveMma = this.waveTracker.getMinMaxAvg();\n      g.fillStyle = `rgba(255,255,0,1)`;\n      g.fillRect(infoAreaWidth, 0, 150, 20);\n      g.fillStyle = `black`;\n      g.fillText(`Min: ` + waveMma.min.toFixed(2), 60, 10);\n      g.fillText(`Max: ` + waveMma.max.toFixed(2), 110, 10);\n      g.fillText(`Avg: ` + waveMma.avg.toFixed(2), 160, 10);\n    } else {\n      this.waveTracker.reset();\n    }\n\n    // Show info about data under pointer\n    if (pointer.y > 0 && pointer.y <= canvasHeight && pointer.x >= 0 && pointer.x <= canvasWidth) {\n      g.fillStyle = `black`;\n      g.fillText(`Level: ` + (1.0 - (pointer.y / canvasHeight)).toFixed(2), 2, 10);\n    }\n\n  }\n\n  // Yields pointer position relative to given element\n  getPointerRelativeTo(elem:HTMLElement) {\n    const rect = elem.getBoundingClientRect();\n    return {\n      x: this.lastPointer.x - rect.left - window.scrollX, //elem.offsetLeft + window.scrollX,\n      y: this.lastPointer.y - rect.top - window.scrollY//elem.offsetTop + window.scrollY\n    };\n  }\n\n  // Keeps track of last pointer position in page coordinate space\n  onPointer(evt:MouseEvent|PointerEvent) {\n    this.lastPointer = {\n      x: evt.pageX,\n      y: evt.pageY\n    };\n    evt.preventDefault();\n  }\n\n  // getMinMax(data, start = 0, end = data.length) {\n  //   if (end > data.length) throw new Error(`end is past size of array`);\n  //   if (start < 0) throw new Error(`start should be at least 0`);\n  //   if (end <= start) throw new Error(`end should be greater than start`);\n\n  //   let max = Number.MIN_SAFE_INTEGER;\n  //   let min = Number.MAX_SAFE_INTEGER;\n  //   for (let i = start; i < end; i++) {\n  //     max = Math.max(data[i], max);\n  //     min = Math.min(data[i], min);\n  //   }\n  //   if (!Number.isFinite(max)) max = 0;\n  //   if (!Number.isFinite(min)) min = 0;\n\n  //   return {max: max, min: min};\n  // }\n}","import {EspruinoBleDevice} from \"./EspruinoBleDevice.js\";\nimport {defaultOpts as NordicDefaults } from \"./NordicBleDevice.js\";\nimport {StateChangeEvent} from \"../flow/StateMachine.js\";\nimport {ISimpleEventEmitter} from \"../Events.js\";\nimport {string as randomString} from \"../Random.js\";\nimport {waitFor} from \"../flow/WaitFor.js\";\nimport {EspruinoSerialDevice, EspruinoSerialDeviceOpts} from \"./EspruinoSerialDevice.js\";\n\nexport {EspruinoBleDevice, EspruinoSerialDevice, EspruinoSerialDeviceOpts};\n\nexport type DataEvent = {\n  readonly data:string\n}\n\nexport type Events = {\n  readonly data: DataEvent\n  readonly change: StateChangeEvent\n};\n\nexport type EspruinoStates = `ready`|`connecting`|`connected`|`closed`|`closing`|`connecting`;\n\n/**\n * Options for device\n */\nexport type Options = {\n  /**\n   * Default milliseconds to wait before giving up on a well-formed reply. 5 seconds is the default.\n   */\n  readonly evalTimeoutMs?: number;\n  /**\n   * Name of device. Only used for printing log mesages to the console\n   */\n  readonly name?: string;\n\n  /**\n   * If true, additional logging information is printed\n   */\n  readonly debug?: boolean;\n}\n\n/**\n * Options for code evaluation\n */\nexport type EvalOpts = {\n  /**\n   * Milliseconds to wait before giving up on well-formed reply. 5 seconds is the default.\n   */\n  readonly timeoutMs?: number\n  /**\n   * If true (default), it assumes that anything received from the board\n   * is a response to the eval\n   */\n  readonly assumeExclusive?: boolean\n\n  /**\n   * If true, executed code is traced\n   */\n  readonly debug?: boolean\n};\n\n\nexport type EspruinoBleOpts = {\n  /**\n   * If the name is specified, this value is used\n   * for filtering Bluetooth devices\n   */\n  readonly name?:string,\n  /**\n   * If true, additional logging messages are\n   * displayed on the console\n   */\n  readonly debug?:boolean\n  /**\n   * If specified, these filtering options are used instead\n   */\n  readonly filters?: readonly BluetoothLEScanFilter[]\n}\n\n/**\n * Instantiates a Puck.js. See {@link EspruinoBleDevice} for more info.\n * [Online demos](https://clinth.github.io/ixfx-demos/io/)\n * \n * If `opts.name` is specified, this will the the Bluetooth device sought.\n * \n * ```js\n * import { Espruino } from 'https://unpkg.com/ixfx/dist/io.js'\n * const e = await Espruino.puck({ name:`Puck.js a123` });\n * ```\n * \n * If no name is specified, a list of all devices starting with `Puck.js` are shown.\n * \n * To get more control over filtering, pass in `opts.filter`. `opts.name` is not used as a filter in this scenario.\n * \n * ```js\n * import { Espruino } from 'https://unpkg.com/ixfx/dist/io.js'\n * const filters = [\n *  { namePrefix: `Puck.js` },\n *  { namePrefix: `Pixl.js` },\n *  {services: [NordicDefaults.service] }\n * ]\n * const e = await Espruino.puck({ filters });\n * ```\n * \n * @returns Returns a connected instance, or throws exception if user cancelled or could not connect.\n */\nexport const puck = async (opts:EspruinoBleOpts = {}) => {\n  const name = opts.name ?? `Puck`;\n  const debug = opts.debug ?? false;\n\n  const device = await navigator.bluetooth.requestDevice({\n    filters:getFilters(opts), \n    optionalServices: [NordicDefaults.service]\n  });\n\n  console.log(device.name);\n  const d = new EspruinoBleDevice(device, {name, debug});\n  await d.connect();\n  return d;\n};\n\n/**\n * Create a serial-connected Espruino device.\n * \n * ```js\n * import { Espruino } from 'https://unpkg.com/ixfx/dist/io.js'\n * const e = await Espruio.serial();\n * e.connect();\n * ```\n * \n * Options:\n * ```js\n * import { Espruino } from 'https://unpkg.com/ixfx/dist/io.js'\n * const e = await Espruino.serial({ debug: true, evalTimeoutMs: 1000, name: `My Pico` });\n * e.connect();\n * ```\n * \n * Listen for events:\n * ```js\n * e.addEventListener(`change`, evt => {\n *  console.log(`State change ${evt.priorState} -> ${evt.newState}`);\n *  if (evt.newState === `connected`) {\n *    // Do something when connected...\n *  }\n * });\n * ```\n * \n * Reading incoming data:\n * ```\n * // Parse incoming data as JSON\n * s.addEventListener(`data`, evt => {\n *  try {\n *    const o = JSON.parse(evt.data);\n *    // If we get this far, JSON is legit \n *  } catch (ex) {\n *  }\n * });\n * ```\n * \n * Writing to the microcontroller\n * ```\n * s.write(JSON.stringify({msg:\"hello\"}));\n * ```\n * @param opts \n * @returns Returns a connected instance, or throws exception if user cancelled or could not connect.\n */\nexport const serial = async (opts:{readonly name?:string, readonly debug?:boolean, readonly evalTimeoutMs?:number} = {}) => {\n  const d = new EspruinoSerialDevice(opts);\n  await d.connect();\n  return d;\n};\n\n/**\n * Returns a list of BLE scan filters, given the\n * connect options.\n * @param opts \n * @returns \n */\nconst getFilters = (opts:EspruinoBleOpts) => {\n  //eslint-disable-next-line functional/no-let\n  const filters:BluetoothLEScanFilter[] = [];\n\n  if (opts.filters) {\n    //eslint-disable-next-line functional/immutable-data\n    filters.push(...opts.filters);\n  } else if (opts.name) {\n    // Name filter\n    //eslint-disable-next-line functional/immutable-data\n    filters.push({ name: opts.name });\n    console.info(`Filtering Bluetooth devices by name '${opts.name}'`); \n  } else {\n    // Default filter\n    //eslint-disable-next-line functional/immutable-data\n    filters.push({namePrefix: `Puck.js`});\n  }\n  // {namePrefix: 'Pixl.js'},\n  // {namePrefix: 'MDBT42Q'},\n  // {namePrefix: 'RuuviTag'},\n  // {namePrefix: 'iTracker'},\n  // {namePrefix: 'Thingy'},\n  // {namePrefix: 'Espruino'},\n  //{services: [NordicDefaults.service]}\n\n  return filters;\n};\n/**\n * Connects to a generic Espruino BLE device. See  {@link EspruinoBleDevice} for more info.\n * Use {@link puck} if you're connecting to a Puck.js\n * \n * If `opts.name` is specified, only this BLE device will be shown.\n * ```js\n * const e = await connectBle({ name: `Puck.js a123` });\n * ```\n * \n * `opts.filters` overrides and sets arbitary filters.\n * \n * ```js\n * import { Espruino } from 'https://unpkg.com/ixfx/dist/io.js'\n * const filters = [\n *  { namePrefix: `Puck.js` },\n *  { namePrefix: `Pixl.js` },\n *  {services: [NordicDefaults.service] }\n * ]\n * const e = await Espruino.connectBle({ filters });\n * ```\n * \n * @returns Returns a connected instance, or throws exception if user cancelled or could not connect.\n */\nexport const connectBle = async (opts:EspruinoBleOpts = {}) => {\n  const device = await navigator.bluetooth.requestDevice({\n    filters: getFilters(opts),\n    optionalServices: [NordicDefaults.service]\n  });\n  const d = new EspruinoBleDevice(device, {name:`Espruino`});\n  await d.connect();\n  return d;\n};\n\n/**\n * EspruinoDevice\n * \n * This base interface is implemented by {@link EspruinoBleDevice} and {@link EspruinoSerialDevice}.\n */\nexport interface EspruinoDevice extends ISimpleEventEmitter<Events> {\n    /**\n   * Sends some code to be executed on the Espruino. The result\n   * is packaged into JSON and sent back to your code. An exception is\n   * thrown if code can't be executed for some reason.\n   * \n   * ```js\n   * const sum = await e.eval(`2+2`);\n   * ```\n   * \n   * It will wait for a period of time for a well-formed response from the\n   * Espruino. This might not happen if there is a connection problem\n   * or a syntax error in the code being evaled. In cases like the latter,\n   * it will take up to `timeoutMs` (default 5 seconds) before we give up\n   * waiting for a correct response and throw an error.\n   * \n   * Tweaking of the timeout may be required if `eval()` is giving up too quickly\n   * or too slowly. A default timeout can be given when creating the class.\n   * \n   * Options:\n   *  timeoutMs: Timeout for execution. 5 seconds by default\n   *  assumeExclusive If true, eval assumes all replies from controller are in response to eval. True by default\n   *  debug: If true, execution is traced via `warn` callback\n   * @param code Code to run on the Espruino.\n   * @param opts Options\n   * @param warn Function to pass warning/trace messages to. If undefined, this.warn is used, printing to console.\n   */\n  eval(code:string, opts?:EvalOpts, warn?:(msg:string) => void):Promise<string>;\n\n  /**\n   * Write some code for immediate execution. This is a lower-level\n   * alternative to {@link writeScript}. Be sure to include a new line character '\\n' at the end.\n   * @param m Code\n   */\n  write(m:string):void\n\n  /**\n   * Writes a script to Espruino.\n   * \n   * It will first send a CTRL+C to cancel any previous input, `reset()` to clear the board,\n   * and then the provided `code` followed by a new line.\n   * \n   * Use {@link eval} instead to execute remote code and get the result back.\n   * \n   * ```js\n   * // Eg from https://www.espruino.com/Web+Bluetooth\n   * espruino.writeScript(`\n   *  setInterval(() => Bluetooth.println(E.getTemperature()), 1000);\n   *  NRF.on('disconnect',()=>reset());\n   * `);\n   * ```\n   * \n   * @param code Code to send. A new line is added automatically.\n   */\n  writeScript(code:string):void\n\n  /**\n   * Disconnect\n   */\n  disconnect():void\n\n  /**\n   * Gets the current evaluation (millis)\n   */\n  get evalTimeoutMs():number\n\n  get isConnected():boolean;\n}\n\n/**\n * Evaluates some code on an Espruino device.\n * \n * Options:\n * * timeoutMs: how many millis to wait before assuming code failed. If not specified, `device.evalTimeoutMs` is used as a default.\n * * assumeExlusive: assume device is not producing any other output than for our evaluation\n * \n * A random string is created to pair eval requests and responses. `code` will be run on the device, with the result\n * wrapped in JSON, and in turn wrapped in a object that is sent back.\n * \n * The actual code that gets sent to the device is then:\n * `\\x10${evalReplyPrefix}(JSON.stringify({reply:\"${id}\", result:JSON.stringify(${code})}))\\n`\n * \n * For example, it might end up being:\n * `\\x10Bluetooth.println(JSON.stringify({reply: \"a35gP\", result: \"{ 'x': '10' }\" }))\\n`\n * \n * @param code Code to evaluation\n * @param opts Options for evaluation\n * @param device Device to execute on\n * @param evalReplyPrefix How to send code back (eg `Bluetooth.println`, `console.log`)\n * @param debug If true, the full evaled code is printed locally to the console\n * @param warn Callback to display warnings\n * @returns \n */\nexport const deviceEval = async (code:string, opts:EvalOpts = {}, device:EspruinoDevice, evalReplyPrefix:string, debug:boolean, warn:(m:string) => void):Promise<string> => {\n  const timeoutMs = opts.timeoutMs ?? device.evalTimeoutMs;\n  const assumeExclusive = opts.assumeExclusive ?? true;\n\n  if (typeof code !== `string`) throw new Error(`code parameter should be a string`);\n    \n  return new Promise((resolve, reject) => {\n    // Generate a random id so reply can be matched up with this request\n    const id = randomString(5);\n\n    const onData = (d:DataEvent) => {\n      try {\n        //eslint-disable-next-line functional/no-let\n        let cleaned = d.data;\n        \n        // Prefixed with angled bracket sometimes?\n        if (cleaned.startsWith(`>{`) && cleaned.endsWith(`}`)) cleaned = cleaned.substring(1);\n       \n        // Parse reply, expecting JSON.\n        const dd = JSON.parse(cleaned);\n\n        // Check for reply field, and that it matches\n        if (`reply` in dd) {\n          if (dd.reply === id) {\n            done(); // Stop waiting for result\n            if (`result` in dd) {\n              resolve(dd.result);\n            }\n          } else {\n            warn(`Expected reply ${id}, got ${dd.reply}`);\n          }\n        } else {\n          warn(`Expected packet, missing 'reply' field. Got: ${d.data}`);\n        }\n      } catch (ex:unknown) {\n        // If there was a syntax error, response won't be JSON\n        if (assumeExclusive) {\n          // Fail with unexpected reply as the message\n          done(d.data);\n        } else {\n          // Unexpected reply, but we cannot be sure if it's in response to eval or\n          // some other code running on board. So just warn and eventually timeout\n          warn(ex as string);\n        }\n      }\n    };\n\n    const onStateChange = (e:StateChangeEvent) => {\n      if (e.newState !== `connected`) done(`State changed to '${e.newState}', aborting`);\n    };\n\n    device.addEventListener(`data`, onData);\n    device.addEventListener(`change`, onStateChange);\n\n    // Init waitFor\n    const done = waitFor(timeoutMs, (reason:string) => {\n      reject(reason);\n    }, () => {\n      // If we got a response or there was a timeout, remove event listeners\n      device.removeEventListener(`data`, onData);\n      device.removeEventListener(`change`, onStateChange);\n    });\n\n    const src = `\\x10${evalReplyPrefix}(JSON.stringify({reply:\"${id}\", result:JSON.stringify(${code})}))\\n`;\n    if (debug) warn(src);\n    device.write(src);\n  });\n};","import {EvalOpts, Options,  deviceEval} from \"./Espruino.js\";\nimport {NordicBleDevice} from \"./NordicBleDevice.js\";\n\n/**\n * An Espruino BLE-connection\n * \n * See [online demos](https://clinth.github.io/ixfx-demos/io/)\n * \n * Use the `puck` function to initialise and connect to a Puck.js.\n * It must be called in a UI event handler for browser security reasons.\n * \n * ```js\n * import { Espruino } from 'https://unpkg.com/ixfx/dist/io.js'\n * const e = await Espruino.puck();\n * ```\n * \n * To connect to a particular device:\n * \n * ```js\n * import { Espruino } from 'https://unpkg.com/ixfx/dist/io.js'\n * const e = await Espruino.puck({name:`Puck.js a123`});\n * ```\n *\n * Listen for events:\n * ```js\n * // Received something\n * e.addEventListener(`data`, d => console.log(d.data));\n * // Monitor connection state\n * e.addEventListener(`change`, c => console.log(`${d.priorState} -> ${d.newState}`));\n * ```\n * \n * Write to the device (note the \\n for a new line at the end of the string). This will\n * execute the code on the Espruino.\n * \n * ```js\n * e.write(`digitalPulse(LED1,1,[10,500,10,500,10]);\\n`);\n * ```\n * \n * Run some code and return result:\n * ```js\n * const result = await e.eval(`2+2\\n`);\n * ```\n */\nexport class EspruinoBleDevice extends NordicBleDevice {\n  evalTimeoutMs:number;\n  evalReplyBluetooth = true;\n\n  /**\n   * Creates instance. You probably would rather use {@link puck} to create.\n   * @param device\n   * @param opts \n   */\n  constructor(device:BluetoothDevice, opts:Options = {}) {\n    super(device, opts);\n    this.evalTimeoutMs = opts.evalTimeoutMs ?? 5*1000;\n  }\n\n  /**\n   * Writes a script to Espruino.\n   * \n   * It will first send a CTRL+C to cancel any previous input, `reset()` to clear the board,\n   * and then the provided `code` followed by a new line.\n   * \n   * Use {@link eval} instead to execute remote code and get the result back.\n   * \n   * ```js\n   * // Eg from https://www.espruino.com/Web+Bluetooth\n   * writeScript(`\n   *  setInterval(() => Bluetooth.println(E.getTemperature()), 1000);\n   *  NRF.on('disconnect',()=>reset());\n   * `);\n   * ```\n   * \n   * @param code Code to send. A new line is added automatically.\n   */\n  async writeScript(code:string) {\n    this.write(`\\x03\\x10reset();\\n`);\n    this.write(`\\x10${code}\\n`);\n  }\n\n  /**\n   * Sends some code to be executed on the Espruino. The result\n   * is packaged into JSON and sent back to your code. An exception is\n   * thrown if code can't be executed for some reason.\n   * \n   * ```js\n   * const sum = await e.eval(`2+2`);\n   * ```\n   * \n   * It will wait for a period of time for a well-formed response from the\n   * Espruino. This might not happen if there is a connection problem\n   * or a syntax error in the code being evaled. In cases like the latter,\n   * it will take up to `timeoutMs` (default 5 seconds) before we give up\n   * waiting for a correct response and throw an error.\n   * \n   * Tweaking of the timeout may be required if `eval()` is giving up too quickly\n   * or too slowly. A default timeout can be given when creating the class.\n   * \n   * Options:\n   *  timeoutMs: Timeout for execution. 5 seconds by default\n   *  assumeExclusive If true, eval assumes all replies from controller are in response to eval. True by default\n   *  debug: If true, execution is traced via `warn` callback\n   * @param code Code to run on the Espruino.\n   * @param opts Options\n   * @param warn Function to pass warning/trace messages to. If undefined, this.warn is used, printing to console.\n   */\n  async eval(code:string, opts:EvalOpts = {}, warn?:(msg:string) => void):Promise<string> {\n    const debug = opts.debug ?? false;\n    const warnCb = warn ?? ((m) => this.warn(m));\n    return deviceEval(code, opts, this, `Bluetooth.println`, debug, warnCb);\n  }\n  /*\n    const timeoutMs = opts.timeoutMs ?? this.evalTimeoutMs;\n    const assumeExclusive = opts.assumeExclusive ?? true;\n\n    if (typeof code !== `string`) throw new Error(`code parameter should be a string`);\n      \n    return new Promise((resolve, reject) => {\n      // Generate a random id so reply can be matched up with this request\n      const id = randomString(5);\n\n      const onData = (d:DataEvent) => {\n        try {\n          // Parse reply, expecting JSON.\n          const dd = JSON.parse(d.data);\n\n          // Check for reply field, and that it matches\n          if (`reply` in dd) {\n            if (dd.reply === id) {\n              done(); // Stop waiting for result\n              if (`result` in dd) {\n                resolve(dd.result);\n              }\n            } else {\n              this.warn(`Expected reply ${id}, got ${dd.reply}`);\n            }\n          }\n        } catch (ex:unknown) {\n          // If there was a syntax error, response won't be JSON\n          if (assumeExclusive) {\n            // Fail with unexpected reply as the message\n            done(d.data);\n          } else {\n            // Unexpected reply, but we cannot be sure if it's in response to eval or\n            // some other code running on board. So just warn and eventually timeout\n            this.warn(ex);\n          }\n        }\n      };\n\n      const onStateChange = (e:StateChangeEvent) => {\n        if (e.newState !== `connected`) done(`State changed to '${e.newState}', aborting`);\n      };\n\n      this.addEventListener(`data`, onData);\n      this.addEventListener(`change`, onStateChange);\n\n      // Init waitFor\n      const done = waitFor(timeoutMs, (reason:string) => {\n        reject(reason);\n      }, () => {\n        // If we got a response or there was a timeout, remove event listeners\n        this.removeEventListener(`data`, onData);\n        this.removeEventListener(`change`, onStateChange);\n      });\n\n      this.write(`\\x10Bluetooth.println(JSON.stringify({reply:\"${id}\", result:JSON.stringify(${code})}))\\n`);\n    });\n  */\n}\n\n","import {JsonDevice, JsonDeviceOpts, JsonDeviceEvents, JsonDataEvent} from \"./JsonDevice.js\";\n\nexport {JsonDeviceEvents, JsonDeviceOpts, JsonDataEvent};\n\nexport type SerialOpts = JsonDeviceOpts & {\n  readonly filters?:ReadonlyArray<SerialPortFilter>\n  readonly baudRate?:number\n  /**\n   * End-of-line string sequence. \\r\\n by default.\n   */\n  readonly eol?:string\n}\n\n/**\n * Serial device. Assumes data is sent with new line characters (\\r\\n) between messages.\n * \n * ```\n * const s = new Device();\n * s.addEventListener(`change`, evt => {\n *  console.log(`State change ${evt.priorState} -> ${evt.newState}`);\n *  if (evt.newState === `connected`) {\n *    // Do something when connected...\n *  }\n * });\n * \n * // In a UI event handler...\n * s.connect();\n * ```\n * \n * Reading incoming data:\n * ```\n * // Parse incoming data as JSON\n * s.addEventListener(`data`, evt => {\n *  try {\n *    const o = JSON.parse(evt.data);\n *    // If we get this far, JSON is legit \n *  } catch (ex) {\n *  }\n * });\n * ```\n * \n * Writing to the microcontroller\n * ```\n * s.write(JSON.stringify({msg:\"hello\"}));\n * ```\n */\nexport class Device extends JsonDevice {\n  port:SerialPort|undefined;\n  tx:WritableStreamDefaultWriter<string>|undefined;\n  abort:AbortController;\n  baudRate:number;\n\n  constructor(private config:SerialOpts = {}) {\n    super(config);\n\n    this.abort = new AbortController();\n\n    const eol = config.eol ?? `\\r\\n`;\n\n    this.baudRate = config.baudRate ?? 9600;\n    if (config.name === undefined) super.name = `Serial.Device`;\n\n    // Serial.println on microcontroller == \\r\\n\n    this.rxBuffer.separator = eol;\n  }\n\n  /**\n   * Writes text collected in buffer\n   * @param txt \n   */\n  protected async writeInternal(txt: string) {\n    if (this.tx === undefined) throw new Error(`tx not ready`);\n    try {\n      this.tx.write(txt);\n    } catch (ex:unknown) {\n      this.warn(ex);\n    }\n  }\n\n  onClosed(): void {\n    this.tx?.releaseLock();\n\n    this.abort.abort(`closing port`);\n    // try {\n    //   this.port?.close();\n    // } catch (ex) {\n    //   this.warn(ex);\n    // }\n    this.states.state = `closed`; \n  }\n\n  onPreConnect(): Promise<void> {\n    return Promise.resolve();\n  }\n\n  async onConnectAttempt(): Promise<void> {\n    //eslint-disable-next-line functional/no-let\n    let reqOpts:SerialPortRequestOptions = { };\n    const openOpts:SerialOptions = {\n      baudRate: this.baudRate\n    };\n\n    if (this.config.filters) reqOpts = { filters: [...this.config.filters] };\n    this.port = await navigator.serial.requestPort(reqOpts);\n\n    this.port.addEventListener(`disconnect`, _ => {\n      this.close();\n    });\n\n    await this.port.open(openOpts);\n\n    const txW = this.port.writable;\n    const txText = new TextEncoderStream();\n    if (txW !== null) {\n      txText.readable.pipeTo(txW, { signal: this.abort.signal }).catch(err => {\n        console.log(`Serial.onConnectAttempt txText pipe:`);\n        console.log(err);\n      });\n      this.tx = txText.writable.getWriter();\n    }\n\n    const rxR = this.port.readable;\n    const rxText = new TextDecoderStream(); \n    if (rxR !== null) {\n      rxR.pipeTo(rxText.writable, { signal: this.abort.signal }).catch(err => {\n        console.log(`Serial.onConnectAttempt rxR pipe:`);\n        console.log(err);\n      });\n      rxText.readable.pipeTo(this.rxBuffer.writable(), { signal: this.abort.signal }).catch(err => {\n        console.log(`Serial.onConnectAttempt rxText pipe:`);\n        console.log(err);\n        try {\n          this.port?.close();\n        } catch (ex) {\n          console.log(ex);\n        }\n      });\n    }\n  }\n}\n","import {SimpleEventEmitter} from \"../Events.js\";\nimport {StateChangeEvent, StateMachine} from \"../flow/StateMachine.js\";\nimport {indexOfCharCode, omitChars} from \"../Text.js\";\nimport {Codec} from \"./Codec.js\";\nimport {StringReceiveBuffer} from \"./StringReceiveBuffer.js\";\nimport {StringWriteBuffer} from \"./StringWriteBuffer.js\";\nimport {retry} from \"../flow/Retry.js\";\n\n/**\n * Options for JsonDevice\n */\nexport type JsonDeviceOpts = {\n  /**\n   * How much data to transfer at a time\n   */\n  readonly chunkSize?: number\n  /**\n   * Name of device. This is only used for assisting the console.log output\n   */\n  readonly name?: string\n  /**\n   * Number of times to automatically try to reconnect\n   */\n  readonly connectAttempts?: number\n  /**\n   * If true, additional logging will be done\n   */\n  readonly debug?: boolean\n}\n\n/**\n * Data received event\n */\nexport type JsonDataEvent = {\n  /**\n   * Data received\n   */\n  readonly data: string\n}\n\n/**\n * Events emitted by JsonDevice\n */\nexport type JsonDeviceEvents = {\n  /**\n   * Data received\n   */\n  readonly data: JsonDataEvent\n  /**\n   * State changed\n   */\n  readonly change: StateChangeEvent\n};\n\nexport abstract class JsonDevice extends SimpleEventEmitter<JsonDeviceEvents> {\n  states: StateMachine;\n  codec: Codec;\n\n  verboseLogging = false;\n  name:string;\n  connectAttempts:number;\n  chunkSize:number;\n\n  rxBuffer: StringReceiveBuffer;\n  txBuffer: StringWriteBuffer;\n\n  constructor(config: JsonDeviceOpts = {}) {\n    super();\n\n    // Init\n    this.verboseLogging = config.debug ?? false;\n    this.chunkSize = config.chunkSize ?? 1024;\n    this.connectAttempts = config.connectAttempts ?? 3;\n    this.name = config.name ?? `JsonDevice`;\n\n    // Transmit buffer\n    this.txBuffer = new StringWriteBuffer(async data => {\n      // When we have data to actually write to device\n      await this.writeInternal(data);\n    }, config.chunkSize);\n\n    // Receive buffer\n    this.rxBuffer = new StringReceiveBuffer(line => {\n      this.fireEvent(`data`, {data: line});\n    });\n\n    this.codec = new Codec();\n    this.states = new StateMachine(`ready`, {\n      ready: `connecting`,\n      connecting: [`connected`, `closed`],\n      connected: [`closed`],\n      closed: `connecting`\n    });\n\n    this.states.addEventListener(`change`, evt => {\n      this.fireEvent(`change`, evt);\n      this.verbose(`${evt.priorState} -> ${evt.newState}`);\n      if (evt.priorState === `connected`) {\n        // Clear out buffers\n        this.rxBuffer.clear();\n        this.txBuffer.clear();\n      }\n    });\n  }\n\n  get isConnected(): boolean {\n    return this.states.state === `connected`;\n  }\n\n  get isClosed(): boolean {\n    return this.states.state === `closed`;\n  }\n\n  write(txt: string) {\n    if (this.states.state !== `connected`) throw new Error(`Cannot write while state is ${this.states.state}`);\n    this.txBuffer.add(txt);\n  }\n\n  /**\n   * Writes text to output device\n   * @param txt \n   */\n  protected abstract writeInternal(txt: string):void;\n\n  async close() {\n    if (this.states.state !== `connected`) return;\n    \n    // console.log(`rxBuffer closing`);\n    // try {\n    //   await this.rxBuffer.close();\n    // } catch (e) {\n    //   console.warn(e);\n    // }\n\n    // console.log(`txBuffer closing`);\n    // try {\n    //   await this.txBuffer.close();\n    // } catch (e) {\n    //   console.warn(e);\n    // }\n\n    // console.log(`calling onClose`);\n    \n    this.onClosed();\n  }\n\n  /**\n   * Must change state\n   */\n  abstract onClosed():void;\n\n  abstract onPreConnect():Promise<void>;\n\n  async connect() {\n    const attempts = this.connectAttempts;\n\n    this.states.state = `connecting`;\n    await this.onPreConnect();\n    \n    await retry(async () => {\n      await this.onConnectAttempt();   \n      this.states.state = `connected`;\n    }, attempts, 200);\n  }\n\n  /**\n   * Should throw if did not succeed.\n   */\n  protected abstract onConnectAttempt():Promise<void>;\n\n  private onRx(evt: Event) {\n    //const rx = this.rx;\n    //if (rx === undefined) return;\n\n    //eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const view = (evt.target as any).value as DataView;\n    if (view === undefined) return;\n\n    //eslint-disable-next-line functional/no-let\n    let str = this.codec.fromBuffer(view.buffer);\n\n    // Check for flow control chars\n    const plzStop = indexOfCharCode(str, 19);\n    const plzStart = indexOfCharCode(str, 17);\n\n    // Remove if found\n    if (plzStart && plzStop < plzStart) {\n      this.verbose(`Tx plz start`);\n      str = omitChars(str, plzStart, 1);\n      this.txBuffer.paused = false;\n    }\n    if (plzStop && plzStop > plzStart) {\n      this.verbose(`Tx plz stop`);\n      str = omitChars(str, plzStop, 1);\n      this.txBuffer.paused = true;\n    }\n\n    this.rxBuffer.add(str);\n  }\n\n  protected verbose(m: string) {\n    if (this.verboseLogging) console.info(`${this.name} `, m);\n  }\n\n  protected log(m: string) {\n    console.log(`${this.name} `, m);\n  }\n\n  protected warn(m: unknown) {\n    console.warn(`${this.name} `, m);\n  }\n}\n\n","import { deviceEval, EvalOpts} from \"./Espruino.js\";\nimport {Device as SerialDevice, SerialOpts} from \"./Serial.js\";\n\nexport type EspruinoSerialDeviceOpts = SerialOpts & {\n  readonly evalTimeoutMs?:number\n};\n\nexport class EspruinoSerialDevice extends SerialDevice {\n  evalTimeoutMs:number;\n  evalReplyBluetooth = false;\n\n  constructor(opts?:EspruinoSerialDeviceOpts) {\n    super(opts);\n\n    if (opts === undefined) opts = {};\n    this.evalTimeoutMs = opts.evalTimeoutMs ?? 5*1000;  \n  }\n\n  async disconnect() {\n    return super.close();\n  }\n\n  /**\n   * Writes a script to Espruino.\n   * \n   * It will first send a CTRL+C to cancel any previous input, `reset()` to clear the board,\n   * and then the provided `code` followed by a new line.\n   * \n   * Use {@link eval} instead to execute remote code and get the result back.\n   * \n   * ```js\n   * // Eg from https://www.espruino.com/Web+Bluetooth\n   * writeScript(`\n   *  setInterval(() => Bluetooth.println(E.getTemperature()), 1000);\n   *  NRF.on('disconnect',()=>reset());\n   * `);\n   * ```\n   * \n   * @param code Code to send. A new line is added automatically.\n   */\n  async writeScript(code:string) {\n    this.write(`\\x03\\x10reset();\\n`);\n    this.write(`\\x10${code}\\n`);\n  }\n\n  /**\n   * Sends some code to be executed on the Espruino. The result\n   * is packaged into JSON and sent back to your code. An exception is\n   * thrown if code can't be executed for some reason.\n   * \n   * ```js\n   * const sum = await e.eval(`2+2`);\n   * ```\n   * \n   * It will wait for a period of time for a well-formed response from the\n   * Espruino. This might not happen if there is a connection problem\n   * or a syntax error in the code being evaled. In cases like the latter,\n   * it will take up to `timeoutMs` (default 5 seconds) before we give up\n   * waiting for a correct response and throw an error.\n   * \n   * Tweaking of the timeout may be required if `eval()` is giving up too quickly\n   * or too slowly. A default timeout can be given when creating the class.\n   * \n   * Options:\n   *  timeoutMs: Timeout for execution. 5 seconds by default\n   *  assumeExclusive: If true, eval assumes all replies from controller are in response to eval. True by default\n   *  debug: If true, execution is traced via `warn` callback\n   * @param code Code to run on the Espruino.\n   * @param opts Options\n   * @param warn Function to pass warning/trace messages to. If undefined, this.warn is used, printing to console.\n   */\n  async eval(code:string, opts:EvalOpts = {}, warn?:(msg:string) => void):Promise<string> {\n    const debug = opts.debug ?? false;\n    const warnCb = warn ?? ((m) => this.warn(m));\n\n    return deviceEval(code, opts, this, `USB.println`, debug, warnCb);\n  }\n}","import { waitFor } from '../flow/WaitFor.js';\nimport * as Rects from '../geometry/Rect.js';\n\nconst startTimeoutMs = 10000;\n\n/**\n * Print available media devices to console\n * @param filterKind Defaults `videoinput`\n */\nexport const dumpDevices = async (filterKind = `videoinput`) => {\n  const devices = await navigator.mediaDevices.enumerateDevices();\n\n  devices.forEach(d => {\n    \n    if (d.kind !== filterKind) return;\n    console.log(d.label);\n    console.log(` Kind: ${d.kind}`);\n    console.log(` Device id: ${d.deviceId}`);\n  });\n};\n\n/**\n * Constraints when requesting a camera source\n */\nexport type Constraints = {\n  /**\n   * Camera facing: user is front-facing, environment is a rear camera\n   */\n  readonly facingMode?:`user`|`environment`,\n  /**\n   * Maximum resolution\n   */\n  readonly max?:Rects.Rect,\n  /**\n   * Minimum resolution\n   */\n  readonly min?:Rects.Rect\n  /**\n   * Ideal resolution\n   */\n  readonly ideal?:Rects.Rect\n  /**\n   * If specified, will try to use this media device id\n   */\n  readonly deviceId?:string\n\n  /**\n   * Number of milliseconds to wait on `getUserMedia` before giving up.\n   * Defaults to 30seconds\n   */\n  readonly startTimeoutMs?:number\n}\n\n/**\n * Result from starting a camera\n */\n//eslint-disable-next-line functional/no-mixed-type\nexport type StartResult = {\n  /**\n   * Call dispose to stop the camera feed and remove any created resources, \n   * such as a VIDEO element\n   */\n  readonly dispose:()=>void;\n  /**\n   * Video element camera is connected to\n   */\n  readonly videoEl:HTMLVideoElement;\n}\n\n/**\n * Attempts to start a video-only stream from a camera into a hidden\n * VIDEO element for frame capture. The VIDEO element is created automatically.\n * \n * \n * ```js\n * import {Camera} from 'https://unpkg.com/ixfx/dist/visual.js'\n * try \n *  const { videoEl, dispose } = await Camera.start();\n *  for await (const frame of frames(videoEl)) {\n *   // Do something with pixels...\n *  }\n * } catch (ex) {\n *  console.error(`Video could not be started`);\n * }\n * ```\n * \n * Be sure to call the dispose() function to stop the video stream and remov\n * the created VIDEO element.\n * \n * _Constraints_ can be specified to select a camera and resolution:\n * ```js\n * import {Camera} from 'https://unpkg.com/ixfx/dist/visual.js'\n * try \n *  const { videoEl, dispose } = await Camera.start({\n *    facingMode: `environment`,\n *    max: { width: 640, height: 480 }\n *  });\n *  for await (const frame of frames(videoEl)) {\n *   // Do something with pixels...\n *  }\n * } catch (ex) {\n *  console.error(`Video could not be started`);\n * }\n * ```\n * @param constraints \n * @returns Returns `{ videoEl, dispose }`, where `videoEl` is the created VIDEO element, and `dispose` is a function for removing the element and stopping the video.\n */\nexport const start = async (constraints:Constraints = {}):Promise<StartResult> => {\n  const videoEl = document.createElement(`VIDEO`) as HTMLVideoElement;\n  //eslint-disable-next-line functional/immutable-data\n  videoEl.style.display = `none`;\n  //eslint-disable-next-line functional/immutable-data\n  videoEl.playsInline = true;\n  //eslint-disable-next-line functional/immutable-data\n  videoEl.muted = true;\n  \n  videoEl.classList.add(`ixfx-camera`);\n  \n  document.body.appendChild(videoEl);\n  \n  //eslint-disable-next-line functional/no-let\n  let stopVideo = () => { /* no-op */ };\n\n  const dispose = () => {\n    try {\n      // Stop source\n      stopVideo();\n    } catch {\n      /* no-op */\n    }\n\n    // Remove the element we created\n    videoEl.remove();\n  };\n\n  try {\n    // Attempt to start video \n    const r = await startWithVideoEl(videoEl, constraints);\n    stopVideo = r.dispose;\n    return  { videoEl, dispose };\n  } catch (ex) {\n    // If it didn't work, delete the created element \n    console.error(ex);\n    dispose();\n    throw ex;\n  }\n\n};\n\n/**\n * Attempts to start a video-only stream from a camera into the designated VIDEO element.\n * @param videoEl \n * @param constraints \n * @returns Result contains videoEl and dispose function\n */\nconst startWithVideoEl = async (videoEl:HTMLVideoElement, constraints:Constraints = {}):Promise<StartResult> => {\n  if (videoEl === undefined) throw new Error(`videoEl undefined`);\n  if (videoEl === null) throw new Error(`videoEl null`);\n\n  const maxRes = constraints.max;\n  const minRes = constraints.min;\n  const idealRes = constraints.ideal;\n\n  // Setup constraints\n  const c = {\n    audio: false,\n    video: {\n      width: {},\n      height: {}\n    }\n  };\n\n  // Just in case some intuitive values are passed in...\n  //eslint-disable-next-line @typescript-eslint/no-explicit-any\n  if ((constraints as any).facingMode === `front`) constraints = { ...constraints, facingMode: `user` };\n  //eslint-disable-next-line @typescript-eslint/no-explicit-any\n  if ((constraints as any).facingMode === `back`) constraints = { ...constraints, facingMode: `environment` };\n\n  if (constraints.facingMode) {\n    //eslint-disable-next-line functional/immutable-data,@typescript-eslint/no-explicit-any\n    (c.video as any).facingMode = constraints.facingMode;\n  }\n\n  if (constraints.deviceId) {\n    //eslint-disable-next-line functional/immutable-data,@typescript-eslint/no-explicit-any\n    (c.video as any).deviceId = constraints.deviceId;\n  }\n\n  if (idealRes) {\n    //eslint-disable-next-line functional/immutable-data\n    c.video.width = {\n      ...c.video.width,\n      ideal: idealRes.width\n    };\n    //eslint-disable-next-line functional/immutable-data\n    c.video.height = {\n      ...c.video.height,\n      ideal: idealRes.height\n    };\n  } \n\n  if (maxRes) {\n    //eslint-disable-next-line functional/immutable-data\n    c.video.width = {\n      ...c.video.width,\n      max: maxRes.width\n    };\n    //eslint-disable-next-line functional/immutable-data\n    c.video.height = {\n      ...c.video.height,\n      max: maxRes.height\n    };\n  }\n\n  if (minRes) {\n    //eslint-disable-next-line functional/immutable-data\n    c.video.width = {\n      ...c.video.width,\n      min: minRes.width\n    };\n    //eslint-disable-next-line functional/immutable-data\n    c.video.height = {\n      ...c.video.height,\n      min: minRes.height\n    };\n  }\n\n  // Request stream\n  const done = waitFor(constraints.startTimeoutMs ?? startTimeoutMs, \n    (reason) => {\n      throw new Error(`Camera getUserMedia failed: ${reason}`);\n    });\n\n  try {\n    const stream = await navigator.mediaDevices.getUserMedia(c);\n\n    // Clean-up function\n    const dispose = () => {\n      videoEl.pause();\n      const t = stream.getTracks();\n      t.forEach(track => track.stop());\n    };\n\n    // Assign to VIDEO element\n    //eslint-disable-next-line functional/immutable-data\n    videoEl.srcObject = stream;\n    done();\n\n    const ret = { videoEl, dispose };\n    const p = new Promise<StartResult>((resolve, reject) => {\n      videoEl.addEventListener(`loadedmetadata`,  () => {\n        videoEl.play().then(() => {\n          resolve(ret);\n        }).catch((ex) => {\n          reject(ex);\n        });\n      });\n    });\n    return p;\n  } catch (ex) {\n    //eslint-disable-next-line @typescript-eslint/no-explicit-any\n    done((ex as any).toString());\n    throw ex;\n  }\n\n};","/**\n * Result from starting a camera\n */\n//eslint-disable-next-line functional/no-mixed-type\nexport type StartResult = {\n  /**\n   * Call dispose to stop the camera feed and remove any created resources, \n   * such as a VIDEO element\n   */\n  readonly dispose:()=>void;\n  /**\n   * Video element camera is connected to\n   */\n  readonly videoEl:HTMLVideoElement;\n}\n\n/**\n * Starts video file playback, creating a VIDEO element automatically.\n * @param file File\n * @returns StartResult\n */\nexport const start = async (file:File):Promise<StartResult> => {\n  const videoEl = document.createElement(`VIDEO`) as HTMLVideoElement;\n  //eslint-disable-next-line functional/immutable-data\n  videoEl.style.display = `none`;\n  //eslint-disable-next-line functional/immutable-data\n  videoEl.playsInline = true;\n  //eslint-disable-next-line functional/immutable-data\n  videoEl.muted = true;\n  \n  videoEl.classList.add(`ixfx-video`);\n  \n  document.body.appendChild(videoEl);\n  \n  //eslint-disable-next-line functional/no-let\n  let stopVideo = () => { /* no-op */ };\n\n  const dispose = () => {\n    try {\n      // Stop source\n      stopVideo();\n    } catch {\n      /* no-op */\n    }\n\n    // Remove the element we created\n    videoEl.remove();\n  };\n\n  try {\n    // Attempt to start video \n    const r = await startWithVideoEl(videoEl, file);\n    stopVideo = r.dispose;\n    return  { videoEl, dispose };\n  } catch (ex) {\n    // If it didn't work, delete the created element \n    console.error(ex);\n    dispose();\n    throw ex;\n  }\n};\n\n/**\n * Starts playback of a video file in the provided VIDEO element.\n * @param videoEl \n * @param file \n * @returns \n */\nconst startWithVideoEl = async (videoEl:HTMLVideoElement, file:File):Promise<StartResult> => {\n  if (videoEl === undefined) throw new Error(`videoEl undefined`);\n  if (videoEl === null) throw new Error(`videoEl null`);\n\n  const url = URL.createObjectURL(file);\n  \n  //eslint-disable-next-line functional/immutable-data\n  videoEl.src = url;\n  //eslint-disable-next-line functional/immutable-data\n  videoEl.loop = true;\n\n  // Clean-up function\n  const dispose = () => {\n    videoEl.pause();\n  };\n\n    \n  const ret = { videoEl, dispose };\n  const p = new Promise<StartResult>((resolve, reject) => {\n    videoEl.addEventListener(`loadedmetadata`,  () => {\n      videoEl.play().then(() => {\n        resolve(ret);\n      }).catch((ex) => {\n        reject(ex);\n      });\n    });\n  });\n  return p;\n};","/* eslint-disable @typescript-eslint/no-non-null-assertion,functional/immutable-data */\nimport { continuously, delayLoop } from \"../flow/index.js\";\n\n//eslint-disable-next-line functional/no-mixed-type\nexport type Capturer = {\n  start():void;\n  cancel():void;\n  readonly canvasEl:HTMLCanvasElement;\n}\n\n//eslint-disable-next-line functional/no-mixed-type\nexport type ManualCapturer = {\n  capture():ImageData;\n  readonly canvasEl:HTMLCanvasElement;\n  dispose():void;\n};\n\n//eslint-disable-next-line functional/no-mixed-type\nexport type CaptureOpts = {\n  readonly maxIntervalMs?:number;\n  readonly showCanvas?:boolean;\n  readonly workerScript?:string;\n  readonly onFrame?:(pixels:ImageData)=>void;\n};\n\n//eslint-disable-next-line functional/no-mixed-type\nexport type ManualCaptureOpts = {\n  /**\n   * If true, the intermediate canvas is shown\n   * The intermediate canvas is where captures from the source are put in order\n   * to get the ImageData\n   */\n  readonly showCanvas?:boolean\n  /**\n   * If specified, this function will be called after ImageData is captured\n   * from the intermediate canvs. This allows for drawing on top of the\n   * captured image.\n   */\n  readonly postCaptureDraw?:(ctx:CanvasRenderingContext2D, width:number, height:number)=>void\n\n  /**\n   * If specified, this is the canvas captured to\n   */\n  readonly canvasEl?:HTMLCanvasElement\n}\n\n/**\n * Options for frames generator\n */\nexport type FramesOpts = {\n  /**\n   * Max frame rate (millis per frame), or 0 for animation speed\n   */\n  readonly maxIntervalMs?:number;\n  /**\n   * False by default, created canvas will be hidden\n   */\n  readonly showCanvas?:boolean;\n  /**\n   * If provided, this canvas will be used as the buffer rather than creating one.\n   */\n  readonly canvasEl?:HTMLCanvasElement;\n}\n\n/**\n * Generator that yields frames from a video element as [ImageData](https://developer.mozilla.org/en-US/docs/Web/API/ImageData).\n * \n * ```js\n * import {Video} from 'https://unpkg.com/ixfx/dist/visual.js'\n * \n * const ctx = canvasEl.getContext(`2d`); \n * for await (const frame of Video.frames(videoEl)) {\n *   // TODO: Some processing of pixels\n *\n *   // Draw image on to the visible canvas\n *   ctx.putImageData(frame, 0, 0);\n * }\n * ```\n * \n * Under the hood it creates a hidden canvas where frames are drawn to. This is necessary\n * to read back pixel data. An existing canvas can be used if it is passed in as an option.\n * \n * Options:\n * * `canvasEl`: CANVAS element to use as a buffer (optional)\n * * `maxIntervalMs`: Max frame rate (0 by default, ie runs as fast as possible)\n * * `showCanvas`: Whether buffer canvas will be shown (false by default)\n * @param sourceVideoEl \n * @param opts \n */\n//eslint-disable-next-line func-style\nexport async function* frames(sourceVideoEl:HTMLVideoElement, opts:FramesOpts = {}):AsyncIterable<ImageData>  {\n  // TODO: Ideally use OffscreenCanvas when it has wider support?\n  // TODO: When ImageBitmap has possibility to get pixels, that might also help to avoid having to write to hidden canvas\n\n  const maxIntervalMs = opts.maxIntervalMs ?? 0;\n  const showCanvas = opts.showCanvas ?? false;\n  //eslint-disable-next-line functional/no-let\n  let canvasEl = opts.canvasEl;\n  //eslint-disable-next-line functional/no-let\n  let w, h;\n  w = h = 0;\n\n  // Create & setup canvas\n  if (canvasEl === undefined) {\n    canvasEl = document.createElement(`CANVAS`) as HTMLCanvasElement;\n    canvasEl.classList.add(`ixfx-frames`);\n    if (!showCanvas) {\n      canvasEl.style.display = `none`;\n    }\n    document.body.appendChild(canvasEl);\n  }\n  \n  // Update size of canvas based on video\n  const updateSize = () => {\n    if (canvasEl === undefined) return;\n    w = sourceVideoEl.videoWidth;\n    h = sourceVideoEl.videoHeight;\n    canvasEl.width = w;\n    canvasEl.height = h;\n  };\n\n  //eslint-disable-next-line functional/no-let\n  let c:CanvasRenderingContext2D|null = null;\n\n  const looper = delayLoop(maxIntervalMs);\n  for await (const _ of looper) {\n    // If we don't yet have the size of video, get it\n    if (w === 0 || h === 0) updateSize();\n    \n    // If there is still no dimensions (ie stream has not started), there's nothing to do yet\n    if (w === 0 || h === 0) continue;\n\n    // Draw current frame from video element to hidden canvas\n    if (c === null) c = canvasEl.getContext(`2d`);\n    if (c === null) return;\n    c.drawImage(sourceVideoEl, 0, 0, w, h);\n\n    // Get pixels\n    const pixels = c.getImageData(\n      0, 0, w, h\n    );\n    yield pixels;\n  }\n}\n\n/**\n * Captures frames from a video element. It can send pixel data to a function or post to a worker script.\n * \n * @example Using a function\n * ```js\n * import {Video} from 'https://unpkg.com/ixfx/dist/visual.js'\n * \n * // Capture from a VIDEO element, handling frame data\n * // imageData is ImageData type: https://developer.mozilla.org/en-US/docs/Web/API/ImageData\n * Video.capture(sourceVideoEl, {\n *  onFrame(imageData => {\n *    // Do something with pixels...\n *  });\n * });\n * ```\n * \n * @example Using a worker\n * ```js\n * import {Video} from 'https://unpkg.com/ixfx/dist/visual.js'\n * \n * Video.capture(sourceVideoEl, {\n *  workerScript: `./frameProcessor.js`\n * });\n * ```\n * \n * In frameProcessor.js:\n * ```\n * const process = (frame) => {\n *  // ...process frame\n * \n *  // Send image back?\n *  self.postMessage({frame});\n * };\n * \n * self.addEventListener(`message`, evt => {\n *   const {pixels, width, height} = evt.data;\n *   const frame = new ImageData(new Uint8ClampedArray(pixels),\n *     width, height);\n *\n *   // Process it\n *   process(frame);\n * });\n * ```\n * \n * Options:\n * * `canvasEl`: CANVAS element to use as a buffer (optional)\n * * `maxIntervalMs`: Max frame rate (0 by default, ie runs as fast as possible)\n * * `showCanvas`: Whether buffer canvas will be shown (false by default)\n * * `workerScript`: If this specified, this URL will be loaded as a Worker, and frame data will be automatically posted to it\n * \n * Implementation: frames are captured using a animation-speed loop to a hidden canvas. From there\n * the pixel data is extracted and sent to either destination. In future the intermediate drawing to a\n * canvas could be skipped if it becomes possible to get pixel data from an ImageBitmap.\n * @param sourceVideoEl Source VIDEO element\n * @param opts \n * @returns \n */\nexport const capture = (sourceVideoEl:HTMLVideoElement, opts:CaptureOpts = {}):Capturer => {\n  const maxIntervalMs = opts.maxIntervalMs ?? 0;\n  const showCanvas = opts.showCanvas ?? false;\n  const onFrame = opts.onFrame;\n\n  // Ideally use OffscreenCanvas when it has support?\n  const w = sourceVideoEl.videoWidth;\n  const h = sourceVideoEl.videoHeight;\n\n  // Create canvas\n  const canvasEl = document.createElement(`CANVAS`) as HTMLCanvasElement;\n  canvasEl.classList.add(`ixfx-capture`);\n  \n  if (!showCanvas) {\n    canvasEl.style.display = `none`;\n  }\n  canvasEl.width = w;\n  canvasEl.height = h;\n  //eslint-disable-next-line functional/no-let\n  let c:CanvasRenderingContext2D|null = null;\n  //eslint-disable-next-line functional/no-let\n  let worker:Worker|undefined;\n  if (opts.workerScript) {\n    worker = new Worker(opts.workerScript);\n  }\n\n  // Should we get image data?\n  const getPixels = worker || onFrame;\n  if (!getPixels && !showCanvas) {\n    console.warn(`Video will be captured to hidden element without any processing. Is this what you want?`);\n  }\n\n  const loop = continuously(() => {\n    // Draw current frame from video element to hidden canvas\n    if (c === null) c = canvasEl.getContext(`2d`);\n    if (c === null) return;\n    c.drawImage(sourceVideoEl, 0, 0, w, h);\n    //eslint-disable-next-line functional/no-let\n    let pixels:ImageData|undefined;\n\n    if (getPixels) {\n      // ImageData necessary\n      pixels = c.getImageData(\n        0, 0, w, h\n      );\n    }\n\n    if (worker) {\n      // Send to worker\n      worker.postMessage({\n        pixels: pixels!.data.buffer,\n        width: w,\n        height: h,\n        channels: 4\n      }, [pixels!.data.buffer]); \n    }\n    if (onFrame) {\n      // Send to callback\n      try {\n        onFrame(pixels!);\n      } catch (e) {\n        console.error(e);\n      }\n    }\n  \n  }, maxIntervalMs);\n\n  return {\n    start: () => loop.start(),\n    cancel: () => loop.cancel(),\n    canvasEl\n  };\n};\n\n\nexport const manualCapture =(sourceVideoEl:HTMLVideoElement, opts:ManualCaptureOpts = {}):ManualCapturer => {\n  const showCanvas = opts.showCanvas ?? false;\n    \n  // Ideally use OffscreenCanvas when it has support?\n  const w = sourceVideoEl.videoWidth;\n  const h = sourceVideoEl.videoHeight;\n  \n  // Create canvas if necessary\n  const definedCanvasEl = opts.canvasEl !== undefined;\n  //eslint-disable-next-line functional/no-let\n  let canvasEl = opts.canvasEl;\n  if (!canvasEl) {\n    canvasEl = document.createElement(`CANVAS`) as HTMLCanvasElement;\n    canvasEl.classList.add(`ixfx-capture`);\n    document.body.append(canvasEl);\n    if (!showCanvas) canvasEl.style.display = `none`;\n  }\n  \n  canvasEl.width = w;\n  canvasEl.height = h;\n\n  const capture = ():ImageData => {\n    //eslint-disable-next-line functional/no-let\n    let c:CanvasRenderingContext2D|undefined|null;\n\n    // Draw current frame from video element to canvas\n    if (!c) c = canvasEl?.getContext(`2d`, { willReadFrequently: true });\n    if (!c) throw new Error(`Could not create graphics context`);\n    c.drawImage(sourceVideoEl, 0, 0, w, h);\n    \n    //eslint-disable-next-line functional/no-let\n    const pixels =  c.getImageData(\n      0, 0, w, h\n    );\n\n    //eslint-disable-next-line @typescript-eslint/no-explicit-any\n    (pixels as any).currentTime = sourceVideoEl.currentTime;\n\n    if (opts.postCaptureDraw) opts.postCaptureDraw(c, w, h);\n    return pixels;\n  };\n\n  const dispose = ():void => {\n    if (definedCanvasEl) return; // we didn't create it\n    try {\n      canvasEl?.remove();\n    } catch (_) {\n      // no-op\n    }\n  };\n\n  const c:ManualCapturer = {\n    canvasEl,\n    capture,\n    dispose\n  };\n  return c;\n};","export type Sources = ``| `camera` | `video`;\nimport * as Camera from './Camera.js';\nimport * as VideoFile from './VideoFile.js';\nimport * as Video from '../visual/Video.js';\n\ntype State = `ready`|`initialised`|`disposed`;\n\n/**\n * Frame procesor options\n */\n//eslint-disable-next-line functional/no-mixed-type\nexport type FrameProcessorOpts = {\n  /**\n   * If true, capture canvas will be shown\n   */\n  readonly showCanvas?:boolean\n  /**\n   * If true, raw source will be shown\n   */\n  readonly showPreview?:boolean\n  /**\n   * If specified, this function will be called after ImageData is captured\n   * from the intermediate canvs. This allows for drawing on top of the\n   * captured image.\n   */\n   readonly postCaptureDraw?:(ctx:CanvasRenderingContext2D, width:number, height:number)=>void\n\n   /**\n    * Default constraints to use for the camera source\n    */\n   readonly cameraConstraints?:Camera.Constraints;\n\n   /**\n    * If specified, this canvas will be used for capturing frames to\n    */\n   readonly captureCanvasEl?:HTMLCanvasElement;\n}\n\n/**\n * Frame Processor\n * Simplifies grabbing frames from a source\n */\nexport class FrameProcessor {\n  private _source:Sources;\n  private _state:State;\n  private _teardownNeeded = false;\n  \n  private _cameraConstraints:Camera.Constraints|undefined;\n  private _cameraStartResult:Camera.StartResult|undefined;\n  private _videoSourceCapture:Video.ManualCapturer|undefined;\n\n  private _videoFile:File|undefined;\n  private _videoStartResult:VideoFile.StartResult|undefined;\n\n  private _showCanvas:boolean;\n  private _showPreview:boolean;\n  private _postCaptureDraw;\n  private _timer:number;\n  private _captureCanvasEl?:HTMLCanvasElement;\n\n  /**\n   * Create a new frame processor\n   * @param opts \n   */\n  constructor(opts:FrameProcessorOpts = {}) {\n    this._state = `ready`;\n    this._source = ``;\n    this._timer = performance.now();\n    this._showCanvas = opts.showCanvas ?? false;\n    this._showPreview = opts.showPreview ?? false;\n    this._cameraConstraints = opts.cameraConstraints ?? undefined;\n    this._captureCanvasEl = opts.captureCanvasEl ?? undefined;\n    this._postCaptureDraw = opts.postCaptureDraw;\n  }\n\n  /**\n   * Hides or shows the raw source in the DOM\n   * @param enabled Preview enabled\n   */\n  showPreview(enabled:boolean) {\n    if (this._state === `disposed`) throw new Error(`Disposed`);\n    //eslint-disable-next-line functional/no-let\n    let el:HTMLElement|undefined;\n\n    switch (this._source) {\n    case `camera`:\n      el = this._cameraStartResult?.videoEl;\n      if (el !== undefined) el.style.display = enabled ? `block` : `none`;\n      break;\n    }\n\n    this._showPreview = enabled;\n  }\n\n  /**\n   * Shows or hides the Canvas we're capturing to\n   * @param enabled \n   */\n  showCanvas(enabled:boolean) {\n    if (this._state === `disposed`) throw new Error(`Disposed`);\n    //eslint-disable-next-line functional/no-let\n    let el:HTMLElement|undefined;\n\n    if (this._source === `camera` || this._source ===`video`) {\n      el = this._videoSourceCapture?.canvasEl;\n      if (el !== undefined) el.style.display = enabled ? `block` : `none`;  \n      \n    } else throw new Error(`Source not implemented: ${this._source}`);\n\n    this._showCanvas = enabled;\n  }\n\n  /**\n   * Returns the current capturer instance\n   * @returns \n   */\n  getCapturer():Video.ManualCapturer|undefined {\n    if (this._state === `disposed`) throw new Error(`Disposed`);\n    if (this._source ===`camera` || this._source === `video`) {\n      return this._videoSourceCapture;\n    }\n    throw new Error(`Source kind not supported ${this._source}`);\n  }\n\n  /**\n   * Grab frames from a video camera source and initialises\n   * frame processor.\n   * \n   * If `constraints` are not specified, it will use the ones\n   * provided when creating the class, or defaults.\n   * \n   * @param constraints Override of constraints when requesting camera access\n   */\n  async useCamera(constraints?:Camera.Constraints) {\n    if (this._state === `disposed`) throw new Error(`Disposed`);\n\n    this._source = `camera`;\n    if (this._teardownNeeded) this.teardown();\n    if (constraints) this._cameraConstraints;\n  \n    await this.init();\n  }\n\n  async useVideo(file:File) {\n    if (this._state === `disposed`) throw new Error(`Disposed`);\n    this._source = `video`;\n    if (this._teardownNeeded) this.teardown();\n    this._videoFile = file;\n    await this.init();\n  }\n\n  /**\n   * Initialises camera\n   */\n  private async initCamera() {\n    const r = await Camera.start(this._cameraConstraints);\n    if (r === undefined) throw new Error(`Could not start camera`);\n    this._cameraStartResult = r;\n    this.postInit(r);\n\n  }\n\n  private async initVideo() {\n    if (!this._videoFile) throw new Error(`Video file not defined`);\n    const r = await VideoFile.start(this._videoFile);  \n    this._videoStartResult = r;\n\n    this.postInit(r);\n  }\n\n  private async postInit(r:Camera.StartResult|VideoFile.StartResult) {\n    if (this._showPreview) r.videoEl.style.display = `block`;\n\n    // Set up manual capturer\n    this._videoSourceCapture = Video.manualCapture(r.videoEl, {\n      postCaptureDraw:this._postCaptureDraw,\n      showCanvas: this._showCanvas,\n      canvasEl: this._captureCanvasEl\n    });\n\n    this._teardownNeeded = true;\n    this._cameraStartResult = r;\n  }\n\n  /**\n   * Closes down connections and removes created elements.\n   * Once disposed, the frame processor cannot be used\n   * @returns \n   */\n  dispose() {\n    if (this._state === `disposed`) return;\n    this.teardown();\n    this._state = `disposed`;\n  }\n\n  private async init() {\n    this._timer = performance.now();\n    switch (this._source) {\n    case `camera`:\n      await this.initCamera();\n      break;\n    case `video`:\n      await this.initVideo();\n      break;\n    }\n    this._state = `initialised`;\n  }\n\n  private teardown() {\n    if (!this._teardownNeeded) return;\n    if (this._source === `camera` || this._source ===`video`) {\n      this._videoSourceCapture?.dispose();\n\n    }\n    switch (this._source) {\n    case `camera`:\n      this._cameraStartResult?.dispose();\n      break;\n    case `video`:\n      this._videoStartResult?.dispose();\n      break;\n    }\n    this._teardownNeeded = false;\n  }\n\n  /**\n   * Get the last frame\n   * @returns \n   */\n  getFrame():ImageData|undefined {\n    if (this._state === `disposed`) throw new Error(`Disposed`);\n\n    switch (this._source) {\n    case `camera`:\n      return this.getFrameCamera();\n    case `video`:\n      return this.getFrameCamera();\n    default:\n      throw new Error(`source type unhandled ${this._source}`);\n    }\n  }\n\n  /**\n   * Get the timestamp of the processor (elapsed time since starting)\n   * @returns \n   */\n  getTimestamp():number {\n    return performance.now() - this._timer;\n  }\n\n  private getFrameCamera():ImageData|undefined {\n    return this._videoSourceCapture?.capture();\n  }\n} \n","import * as Drawing from './Drawing.js';\nimport * as Svg from './Svg.js';\nimport * as Plot from './Plot.js';\nimport * as Plot2 from './Plot2.js';\n\nimport * as Palette from  './Palette.js';\nimport * as Colour from './Colour.js';\nimport * as SceneGraph from './SceneGraph.js';\nimport * as Video from './Video.js';\n\n/**\n * Colour interpolation, scale generation and parsing\n * \n * Overview\n * * {@link interpolate}: Blend colours\n * * {@link scale}: Produce colour scale\n * * {@link opacity}: Give a colour opacity\n * * {@link randomHue}: Generate a random hue\n * * {@link goldenAngleColour}: Pick perceptually different shades\n * \n * CSS\n * * {@link getCssVariable}: Parse a CSS-defined colour\n * \n * Conversions: convert from 'blue', 'rgb(255,0,0)',  'hsl(0, 100%, 50%)' etc:\n * * {@link toHex}: to a hex format string\n * * {@link toHsl}: to a `{h, s, l}` object\n * * {@link toRgb}: to a `{r, g, b}` object\n */\nexport {Colour};\n\n/**\n * Working with video, either playback from a file or stream from a video camera.\n * \n * Overview\n * * {@link frames}: Yields frames from a video camera\n * * {@link capture}: Capture frames from a VIDEO element\n * \n * @example Importing\n * ```js\n * // If library is stored two directories up under `ixfx/`\n * import {Video} from '../../ixfx/dist/visual.js';\n * // Import from web\n * import {Video} from 'https://unpkg.com/ixfx/dist/visual.js'\n * ```\n */\nexport {Video};\n\nexport {Palette,  Drawing, Svg, Plot, Plot2, SceneGraph};\n\ntry {\n  if (typeof window !== `undefined`) {\n    //eslint-disable-next-line functional/immutable-data,@typescript-eslint/no-explicit-any\n    (window as any).ixfx = {...(window as any).ixfx, Visuals: {SceneGraph, Plot2, Drawing, Svg, Plot, Palette, Colour, Video}};\n  }\n} catch { /* no-op */ }\n","import * as Points from '../geometry/Point.js';\r\nimport * as Paths from '../geometry/Path.js';\r\nimport * as Lines from '../geometry/Line.js';\r\nimport * as Triangles from '../geometry/Triangle.js';\r\nimport {array as guardArray} from '../Guards.js';\r\nimport * as Circles from '../geometry/Circle.js';\r\nimport * as Arcs from '../geometry/Arc.js';\r\nimport * as Beziers from '../geometry/Bezier.js';\r\nimport * as Rects from '../geometry/Rect.js';\r\nimport * as Ellipses from'../geometry/Ellipse.js';\r\nimport * as Colours from '../visual/Colour.js';\r\n\r\n//import * as color2k from 'color2k';\r\n\r\nimport {stack, Stack} from '../collections/index.js';\r\nimport {resolveEl} from '../dom/Util.js';\r\nimport {roundUpToMultiple} from '../Util.js';\r\n\r\n\r\n// eslint-disable-next-line @typescript-eslint/naming-convention\r\nconst PIPI = Math.PI * 2;\r\n\r\nexport type CanvasCtxQuery = null | string | CanvasRenderingContext2D | HTMLCanvasElement;\r\n\r\n/**\r\n * Gets a 2d drawing context from canvas element or query, or throws an error\r\n * @param canvasElCtxOrQuery Canvas element reference or DOM query\r\n * @returns Drawing context.\r\n */\r\nexport const getCtx = (canvasElCtxOrQuery:CanvasCtxQuery): CanvasRenderingContext2D => {\r\n  if (canvasElCtxOrQuery === null) throw Error(`canvasElCtxOrQuery null. Must be a 2d drawing context or Canvas element`);\r\n  if (canvasElCtxOrQuery === undefined) throw Error(`canvasElCtxOrQuery undefined. Must be a 2d drawing context or Canvas element`);\r\n  \r\n  const ctx = (canvasElCtxOrQuery instanceof CanvasRenderingContext2D) ?\r\n    canvasElCtxOrQuery : (canvasElCtxOrQuery instanceof HTMLCanvasElement) ?\r\n      canvasElCtxOrQuery.getContext(`2d`) : (typeof canvasElCtxOrQuery === `string`) ?\r\n        resolveEl<HTMLCanvasElement>(canvasElCtxOrQuery).getContext(`2d`): canvasElCtxOrQuery;\r\n  if (ctx === null) throw new Error(`Could not create 2d context for canvas`);\r\n  return ctx;\r\n};\r\n\r\n/**\r\n * Makes a helper object that wraps together a bunch of drawing functions that all use the same drawing context\r\n * @param ctxOrCanvasEl Drawing context or canvs element reference\r\n * @param canvasBounds Bounds of drawing (optional). Used for limiting `textBlock`\r\n * @returns \r\n */\r\nexport const makeHelper = (ctxOrCanvasEl:CanvasCtxQuery, canvasBounds?:Rects.Rect) => {\r\n  // TODO: Is there a way of automagically defining makeHelper to avoid repetition and keep typesafety and JSDoc?\r\n  const ctx = getCtx(ctxOrCanvasEl);\r\n  return {\r\n    paths(pathsToDraw: Paths.Path[], opts?: DrawingOpts): void {\r\n      paths(ctx, pathsToDraw, opts);\r\n    },\r\n    line(lineToDraw: Lines.Line|Lines.Line[], opts?: DrawingOpts): void {\r\n      line(ctx, lineToDraw, opts);\r\n    },\r\n    rect(rectsToDraw:Rects.RectPositioned|Rects.RectPositioned[], opts?:DrawingOpts & { filled?:boolean}): void {\r\n      rect(ctx, rectsToDraw, opts);\r\n    },\r\n    bezier(bezierToDraw: Beziers.QuadraticBezier|Beziers.CubicBezier, opts?:DrawingOpts): void {\r\n      bezier(ctx, bezierToDraw, opts);\r\n    },\r\n    connectedPoints(pointsToDraw: Points.Point[], opts?: DrawingOpts & {loop?: boolean}): void {\r\n      connectedPoints(ctx, pointsToDraw, opts);\r\n    },\r\n    pointLabels(pointsToDraw: Points.Point[], opts?:DrawingOpts): void {\r\n      pointLabels(ctx, pointsToDraw, opts);\r\n    },\r\n    dot(dotPosition: Points.Point|Points.Point[], opts?: DrawingOpts & {radius: number, outlined?: boolean, filled?: boolean}): void {\r\n      dot(ctx, dotPosition, opts);\r\n    },\r\n    circle(circlesToDraw:Circles.CirclePositioned|Circles.CirclePositioned[], opts:DrawingOpts):void {\r\n      circle(ctx, circlesToDraw, opts);\r\n    },\r\n    arc(arcsToDraw:Arcs.ArcPositioned|Arcs.ArcPositioned[], opts:DrawingOpts):void {\r\n      arc(ctx, arcsToDraw, opts);\r\n    },\r\n    textBlock(lines:string[], opts:DrawingOpts & { anchor:Points.Point, anchorPadding?:number, bounds?: Rects.RectPositioned}):void {\r\n      if (opts.bounds === undefined && canvasBounds !== undefined) opts = {...opts, bounds: {...canvasBounds, x:0, y:0 }};\r\n      textBlock(ctx, lines, opts);\r\n    }\r\n  };\r\n};\r\n\r\n/**\r\n * Drawing options\r\n */\r\nexport type DrawingOpts = {\r\n  /**\r\n   * Stroke style\r\n   */\r\n  readonly strokeStyle?:string\r\n  /**\r\n   * Fill style\r\n   */\r\n  readonly fillStyle?:string\r\n  /**\r\n   * If true, diagnostic helpers will be drawn\r\n   */\r\n  readonly debug?:boolean\r\n};\r\n\r\nexport type LineOpts = {\r\n  readonly lineWidth?:number\r\n  readonly lineCap?:CanvasLineCap\r\n  readonly lineJoin?:CanvasLineJoin\r\n}\r\n\r\n/**\r\n * Creates a drawing op to apply provided options\r\n * @param opts Drawing options that apply\r\n * @returns Stack\r\n */\r\nconst optsOp = (opts:DrawingOpts):StackOp => coloringOp(opts.strokeStyle, opts.fillStyle);\r\n\r\n/**\r\n * Applies drawing options to `ctx`, returning a {@link DrawingStack}\r\n * @param ctx Context\r\n * @param opts Options\r\n * @returns \r\n */\r\nconst applyOpts = (ctx:CanvasRenderingContext2D, opts:DrawingOpts = {}, ...additionalOps:readonly StackOp[]):DrawingStack => {\r\n  if (ctx === undefined) throw Error(`ctx undefined`);\r\n\r\n  // Create a drawing stack, pushing an op generated from drawing options\r\n  const stack = drawingStack(ctx).push(optsOp(opts), ...additionalOps);\r\n  \r\n  \r\n  // Apply stack to context\r\n  stack.apply();\r\n  return stack;\r\n};\r\n\r\n/**\r\n * Draws one or more arcs.\r\n * @param ctx \r\n * @param arcs \r\n * @param opts \r\n */\r\nexport const arc = (ctx:CanvasRenderingContext2D, arcs:Arcs.ArcPositioned|ReadonlyArray<Arcs.ArcPositioned>, opts:DrawingOpts = {}) => {\r\n  applyOpts(ctx, opts);\r\n\r\n  const draw = (arc:Arcs.ArcPositioned) => {\r\n    ctx.beginPath();\r\n    ctx.arc(arc.x, arc.y, arc.radius, arc.startRadian, arc.endRadian);\r\n    ctx.stroke();\r\n  };\r\n\r\n  if (Array.isArray(arcs)) {\r\n    arcs.forEach(draw);\r\n  } else draw(arcs as Arcs.ArcPositioned);\r\n};\r\n\r\n/**\r\n * A drawing stack operation\r\n */\r\nexport type StackOp = (ctx:CanvasRenderingContext2D) => void;\r\n\r\n/**\r\n * A drawing stack (immutable)\r\n */\r\nexport type DrawingStack = Readonly<{\r\n  /**\r\n   * Push a new drawing op\r\n   * @param op Operation to add\r\n   * @returns stack with added op\r\n   */\r\n  push(...ops:readonly StackOp[]):DrawingStack\r\n  /**\r\n   * Pops an operatiomn\r\n   * @returns Drawing stack with item popped\r\n   */\r\n  pop():DrawingStack\r\n  /**\r\n   * Applies drawing stack\r\n   */\r\n  apply():DrawingStack\r\n}>\r\n\r\n/**\r\n * Colouring drawing op. Applies `fillStyle` and `strokeStyle`\r\n * @param strokeStyle \r\n * @param fillStyle \r\n * @returns \r\n */\r\nconst coloringOp = (strokeStyle:string|CanvasGradient|CanvasPattern|undefined, fillStyle:string|CanvasGradient|CanvasPattern|undefined):StackOp => {\r\n  const apply = (ctx:CanvasRenderingContext2D) => {\r\n    // eslint-disable-next-line functional/immutable-data\r\n    if (fillStyle) ctx.fillStyle = fillStyle;\r\n    // eslint-disable-next-line functional/immutable-data\r\n    if (strokeStyle) ctx.strokeStyle = strokeStyle;\r\n  };\r\n  return apply;\r\n};\r\n\r\nconst lineOp = (lineWidth:number|undefined, lineJoin:CanvasLineJoin|undefined, lineCap:CanvasLineCap|undefined):StackOp => {\r\n  const apply = (ctx:CanvasRenderingContext2D) => {\r\n    // eslint-disable-next-line functional/immutable-data\r\n    if (lineWidth) ctx.lineWidth = lineWidth;\r\n    // eslint-disable-next-line functional/immutable-data\r\n    if (lineJoin) ctx.lineJoin = lineJoin;\r\n    // eslint-disable-next-line functional/immutable-data\r\n    if (lineCap) ctx.lineCap = lineCap;\r\n\r\n  };\r\n  return apply;\r\n};\r\n\r\n/**\r\n * Creates and returns an immutable drawing stack for a context\r\n * @param ctx Context\r\n * @param stk Initial stack operations\r\n * @returns \r\n */\r\nexport const drawingStack = (ctx:CanvasRenderingContext2D, stk?:Stack<StackOp>):DrawingStack => {\r\n  if (stk === undefined) stk = stack<StackOp>();\r\n\r\n  const push = (...ops:StackOp[]):DrawingStack => {\r\n    if (stk === undefined) stk = stack<StackOp>();\r\n    const s = stk.push(...ops);\r\n    ops.forEach(o => o(ctx));\r\n    return drawingStack(ctx, s);\r\n  };\r\n\r\n  const pop = ():DrawingStack => {\r\n    const s = stk?.pop();\r\n    return drawingStack(ctx, s);\r\n  };\r\n\r\n  const apply = ():DrawingStack => {\r\n    if (stk === undefined) return drawingStack(ctx);\r\n    stk.forEach(op => op(ctx));\r\n    return drawingStack(ctx, stk);\r\n  };\r\n\r\n  return {push, pop, apply};\r\n};\r\n\r\nexport const lineThroughPoints = (ctx:CanvasRenderingContext2D, points:readonly Points.Point[], opts?:DrawingOpts):void => {\r\n  applyOpts(ctx, opts);\r\n  \r\n  // https://stackoverflow.com/questions/7054272/how-to-draw-smooth-curve-through-n-points-using-javascript-html5-canvas\r\n  ctx.moveTo((points[0].x), points[0].y);\r\n\r\n  points.forEach((p, index) => {\r\n    if (index + 2 >= points.length) return;\r\n    const pNext = points[index+1];\r\n    const mid = {\r\n      x: (p.x + pNext.x) / 2,\r\n      y: (p.y + pNext.y) / 2\r\n    };\r\n    const cpX1 = (mid.x + p.x) / 2;\r\n    const cpX2 = (mid.x + pNext.x) / 2;\r\n    ctx.quadraticCurveTo(cpX1, pNext.y, mid.x, mid.y);\r\n    ctx.quadraticCurveTo(cpX2, pNext.y, pNext.x, pNext.y);\r\n  });\r\n};\r\n\r\n/**\r\n * Draws one or more circles. Will draw outline/fill depending on\r\n * whether `strokeStyle` or `fillStyle` params are present in the drawing options.\r\n * \r\n * ```js\r\n * // Draw a circle with radius of 10 at 0,0\r\n * circle(ctx, {radius:10});\r\n * \r\n * // Draw a circle of radius 10 at 100,100\r\n * circle(ctx, {radius: 10, x: 100, y: 100});\r\n * \r\n * // Draw two blue outlined circles\r\n * circle(ctx, [ {radius: 5}, {radius: 10} ], {strokeStyle:`blue`});\r\n * ```\r\n * @param ctx Drawing context\r\n * @param circlesToDraw Circle(s) to draw\r\n * @param opts Drawing options\r\n */\r\nexport const circle = (ctx:CanvasRenderingContext2D, circlesToDraw:Circles.CirclePositioned|readonly Circles.CirclePositioned[], opts:DrawingOpts = {}) => {\r\n  applyOpts(ctx, opts);\r\n\r\n  const draw = (c:Circles.CirclePositioned) => {\r\n    ctx.beginPath();\r\n    ctx.arc(c.x, c.y, c.radius, 0, PIPI);\r\n    if (opts.strokeStyle) ctx.stroke();\r\n    if (opts.fillStyle) ctx.fill();\r\n  };\r\n  if (Array.isArray(circlesToDraw)) circlesToDraw.forEach(draw);\r\n  else draw(circlesToDraw as Circles.CirclePositioned);\r\n};\r\n\r\n/**\r\n * Draws one or more ellipses. Will draw outline/fill depending on\r\n * whether `strokeStyle` or `fillStyle` params are present in the drawing options.\r\n * @param ctx \r\n * @param ellipsesToDraw \r\n * @param opts \r\n */\r\nexport const ellipse = (ctx:CanvasRenderingContext2D, ellipsesToDraw:Ellipses.EllipsePositioned|readonly Ellipses.EllipsePositioned[], opts:DrawingOpts = {}) => {\r\n  applyOpts(ctx, opts);\r\n\r\n  const draw = (e:Ellipses.EllipsePositioned) => {\r\n    ctx.beginPath();\r\n    const rotation = e.rotation ?? 0;\r\n    const startAngle =e.startAngle ?? 0;\r\n    const endAngle = e.endAngle ?? PIPI;\r\n    ctx.ellipse(e.x, e.y, e.radiusX, e.radiusY, rotation, startAngle, endAngle);\r\n    if (opts.strokeStyle) ctx.stroke();\r\n    if (opts.fillStyle) ctx.fill();\r\n  };\r\n  if (Array.isArray(ellipsesToDraw)) ellipsesToDraw.forEach(draw);\r\n  else draw(ellipsesToDraw as Ellipses.EllipsePositioned);\r\n};\r\n\r\n/**\r\n * Draws one or more paths.\r\n * supported paths are quadratic beziers and lines.\r\n * @param ctx\r\n * @param pathsToDraw \r\n * @param opts \r\n */\r\nexport const paths = (ctx: CanvasRenderingContext2D, pathsToDraw: readonly Paths.Path[]|Paths.Path, opts: Readonly<{readonly strokeStyle?: string, readonly debug?: boolean}> = {}) =>  {\r\n  applyOpts(ctx, opts);\r\n\r\n  const draw = (path:Paths.Path) => {\r\n    // Call appropriate drawing function depending on the type of path\r\n    if (Beziers.isQuadraticBezier(path)) quadraticBezier(ctx, path, opts);\r\n    else if (Lines.isLine(path)) line(ctx, path, opts);\r\n    else throw new Error(`Unknown path type ${JSON.stringify(path)}`);\r\n  };\r\n\r\n  if (Array.isArray(pathsToDraw)) pathsToDraw.forEach(draw);\r\n  else draw(pathsToDraw as Paths.Path);\r\n};\r\n\r\n/**\r\n * Draws a line between all the given points.\r\n * If a fillStyle is specified, it will be filled.\r\n * \r\n * See also: \r\n * * {@link line}: Draw one or more lines \r\n *\r\n * @param ctx\r\n * @param pts\r\n */\r\nexport const connectedPoints = (ctx: CanvasRenderingContext2D, pts: readonly Points.Point[], opts: {readonly loop?: boolean, readonly fillStyle?:string, readonly strokeStyle?: string} = {}) => {\r\n  const shouldLoop = opts.loop ?? false;\r\n\r\n  guardArray(pts);\r\n  if (pts.length === 0) return;\r\n\r\n  // Throw an error if any point is invalid\r\n  pts.forEach((pt, i) => Points.guard(pt, `Index ${i}`));\r\n\r\n  applyOpts(ctx, opts);\r\n\r\n  // Draw points\r\n  ctx.beginPath();\r\n  ctx.moveTo(pts[0].x, pts[0].y);\r\n  pts.forEach((pt) => ctx.lineTo(pt.x, pt.y));\r\n\r\n  if (shouldLoop) ctx.lineTo(pts[0].x, pts[0].y);\r\n  \r\n  // if (opts.strokeStyle) ctx.strokeStyle = opts.strokeStyle;\r\n  if (opts.strokeStyle || (opts.strokeStyle === undefined && opts.fillStyle === undefined)) {\r\n    ctx.stroke();\r\n  }\r\n  if (opts.fillStyle) {\r\n    ctx.fill();\r\n  }\r\n};\r\n\r\n/**\r\n * Draws labels for a set of points\r\n * @param ctx \r\n * @param pts Points to draw\r\n * @param opts \r\n * @param labels Labels for points\r\n */\r\nexport const pointLabels = (ctx: CanvasRenderingContext2D, pts: readonly Points.Point[], opts: {readonly fillStyle?:string} = {}, labels?:readonly string[]) => {\r\n  if (pts.length === 0) return;\r\n\r\n  // Throw an error if any point is invalid\r\n  pts.forEach((pt, i) => Points.guard(pt, `Index ${i}`));\r\n\r\n  applyOpts(ctx, opts);\r\n\r\n  pts.forEach((pt, i) => {\r\n    const label = (labels !== undefined && i<labels.length) ? labels[i] : i.toString();\r\n    ctx.fillText(label.toString(), pt.x, pt.y);    \r\n  });\r\n};\r\n\r\n/**\r\n * Returns `point` with the canvas's translation matrix applied\r\n * @param ctx \r\n * @param point \r\n * @returns \r\n */\r\nexport const translatePoint = (ctx:CanvasRenderingContext2D, point: Points.Point): Points.Point => {\r\n  const m = ctx.getTransform();\r\n  return {\r\n    x: point.x * m.a + point.y * m.c + m.e,\r\n    y: point.x * m.b + point.y * m.d + m.f\r\n  };\r\n};\r\n\r\n/**\r\n * Creates a new HTML IMG element with a snapshot of the\r\n * canvas. Element will need to be inserted into the document.\r\n * \r\n * ```\r\n * const myCanvas = document.getElementById('someCanvas');\r\n * const el = copyToImg(myCanvas);\r\n * document.getElementById('images').appendChild(el);\r\n * ```\r\n * @param canvasEl \r\n * @returns \r\n */\r\nexport const copyToImg = (canvasEl:HTMLCanvasElement): HTMLImageElement => {\r\n  const img = document.createElement(`img`);\r\n  //eslint-disable-next-line functional/immutable-data\r\n  img.src = canvasEl.toDataURL(`image/jpeg`);\r\n  return img;\r\n};\r\n\r\n/**\r\n * Draws filled circle(s) at provided point(s)\r\n * @param ctx\r\n * @param pos \r\n * @param opts \r\n */\r\nexport const dot = (ctx: CanvasRenderingContext2D, pos: Points.Point|readonly Points.Point[], opts?: DrawingOpts & {readonly radius?: number, readonly outlined?: boolean, readonly filled?: boolean})  => {\r\n  if (opts === undefined) opts = {};\r\n  const radius = opts.radius ?? 10;\r\n  \r\n  applyOpts(ctx, opts);\r\n\r\n  ctx.beginPath();\r\n\r\n  // x&y for arc is the center of circle\r\n  if (Array.isArray(pos)) {\r\n    pos.forEach(p => {\r\n      ctx.arc(p.x, p.y, radius, 0, 2 * Math.PI);\r\n    });\r\n  } else {\r\n    const p = pos as Points.Point;\r\n    ctx.arc(p.x, p.y, radius, 0, 2 * Math.PI);\r\n  }\r\n\r\n  if (opts.filled || !opts.outlined) ctx.fill();\r\n  if (opts.outlined) ctx.stroke();\r\n};\r\n\r\n\r\n/**\r\n * Draws a cubic or quadratic bezier\r\n * @param ctx \r\n * @param bezierToDraw \r\n * @param opts \r\n */\r\nexport const bezier = (ctx: CanvasRenderingContext2D, bezierToDraw: Beziers.QuadraticBezier|Beziers.CubicBezier, opts?: DrawingOpts) => {\r\n  if (Beziers.isQuadraticBezier(bezierToDraw)) {\r\n    quadraticBezier(ctx, bezierToDraw, opts);\r\n  } else if (Beziers.isCubicBezier(bezierToDraw)) {\r\n    cubicBezier(ctx, bezierToDraw, opts);\r\n  }\r\n};\r\n\r\nconst cubicBezier = (ctx: CanvasRenderingContext2D, bezierToDraw: Beziers.CubicBezier, opts: DrawingOpts = {}) => {\r\n  // eslint-disable-next-line functional/no-let\r\n  let stack = applyOpts(ctx, opts);\r\n\r\n  const {a, b, cubic1, cubic2} = bezierToDraw;\r\n  const isDebug = opts.debug ?? false;\r\n\r\n  if (isDebug) {\r\n    /*\r\n     * const ss = ctx.strokeStyle;\r\n     * ctx.strokeStyle = ss;\r\n     */\r\n  }\r\n  ctx.beginPath();\r\n  ctx.moveTo(a.x, a.y);\r\n  ctx.bezierCurveTo(cubic1.x, cubic1.y, cubic2.x, cubic2.y, b.x, b.y);\r\n  ctx.stroke();\r\n\r\n  if (isDebug) {\r\n    stack = stack.push(optsOp({...opts, \r\n      strokeStyle: Colours.opacity(opts.strokeStyle ?? `silver`, 0.6),\r\n      fillStyle: Colours.opacity(opts.fillStyle ?? `yellow`, 0.4)}));\r\n\r\n    stack.apply();\r\n    ctx.moveTo(a.x, a.y);\r\n    ctx.lineTo(cubic1.x, cubic1.y);\r\n    ctx.stroke();\r\n    ctx.moveTo(b.x, b.y);\r\n    ctx.lineTo(cubic2.x, cubic2.y);\r\n    ctx.stroke();\r\n\r\n    ctx.fillText(`a`, a.x + 5, a.y);\r\n    ctx.fillText(`b`, b.x + 5, b.y);\r\n    ctx.fillText(`c1`, cubic1.x + 5, cubic1.y);\r\n    ctx.fillText(`c2`, cubic2.x + 5, cubic2.y);\r\n\r\n    dot(ctx, cubic1, {radius: 3});\r\n    dot(ctx, cubic2, {radius: 3});\r\n    dot(ctx, a, {radius: 3});\r\n    dot(ctx, b, {radius: 3});\r\n    stack = stack.pop();\r\n    stack.apply();\r\n  }\r\n};\r\n\r\nconst quadraticBezier = (ctx: CanvasRenderingContext2D, bezierToDraw: Beziers.QuadraticBezier, opts: DrawingOpts = {}) => {\r\n  const {a, b, quadratic} = bezierToDraw;\r\n  const isDebug = opts.debug ?? false;\r\n  // eslint-disable-next-line functional/no-let\r\n  let stack = applyOpts(ctx, opts);\r\n\r\n  ctx.beginPath();\r\n  ctx.moveTo(a.x, a.y);\r\n  ctx.quadraticCurveTo(quadratic.x, quadratic.y, b.x, b.y);\r\n  ctx.stroke();\r\n\r\n  if (isDebug) {\r\n    /*\r\n     * const fs = ctx.fillStyle;\r\n     * const ss = ctx.strokeStyle;\r\n     * ctx.fillStyle = opts.strokeStyle ?? `gray`;\r\n     * ctx.strokeStyle = opts.strokeStyle ?? `gray`;\r\n     */\r\n    stack = stack.push(optsOp({...opts, \r\n      strokeStyle: Colours.opacity(opts.strokeStyle ?? `silver`, 0.6),\r\n      fillStyle: Colours.opacity(opts.fillStyle ?? `yellow`, 0.4)}));\r\n    connectedPoints(ctx, [a, quadratic, b]);\r\n\r\n    ctx.fillText(`a`, a.x + 5, a.y);\r\n    ctx.fillText(`b`, b.x + 5, b.y);\r\n    ctx.fillText(`h`, quadratic.x + 5, quadratic.y);\r\n    dot(ctx, quadratic, {radius: 3});\r\n    dot(ctx, a, {radius: 3});\r\n    dot(ctx, b, {radius: 3});\r\n    /*\r\n     * ctx.fillStyle = fs;\r\n     * ctx.strokeStyle = ss;\r\n     */\r\n    stack = stack.pop();\r\n    stack.apply();\r\n  }\r\n};\r\n\r\n/**\r\n * Draws one or more lines. \r\n * \r\n * Each line is drawn independently, ie it's not assumed lines are connected.\r\n * \r\n * See also:\r\n * * {@link connectedPoints}: Draw a series of connected points\r\n * @param ctx\r\n * @param toDraw \r\n * @param opts \r\n */\r\nexport const line = (ctx: CanvasRenderingContext2D, toDraw: Lines.Line|readonly Lines.Line[], opts: LineOpts & DrawingOpts = {}) => {\r\n  const isDebug = opts.debug ?? false;\r\n  const o = lineOp(opts.lineWidth, opts.lineJoin, opts.lineCap);\r\n  applyOpts(ctx, opts, o);\r\n\r\n  const draw = (d:Lines.Line) => {\r\n    const {a, b} = d;\r\n    ctx.beginPath();\r\n    ctx.moveTo(a.x, a.y);\r\n    ctx.lineTo(b.x, b.y);\r\n    if (isDebug) { \r\n      ctx.fillText(`a`, a.x, a.y);\r\n      ctx.fillText(`b`, b.x, b.y);\r\n      dot(ctx, a, {radius: 5, strokeStyle: `black`});\r\n      dot(ctx, b, {radius: 5, strokeStyle: `black`});\r\n    }\r\n    ctx.stroke();\r\n  };\r\n\r\n  if (Array.isArray(toDraw)) toDraw.forEach(draw);\r\n  else draw(toDraw as Lines.Line);\r\n};\r\n\r\n/**\r\n * Draws one or more triangles\r\n * @param ctx\r\n * @param toDraw \r\n * @param opts \r\n */\r\nexport const triangle = (ctx: CanvasRenderingContext2D, toDraw: Triangles.Triangle|readonly Triangles.Triangle[], opts: DrawingOpts & {readonly filled?:boolean} = {}) => {\r\n  applyOpts(ctx, opts);\r\n\r\n  const draw = (t:Triangles.Triangle) => {\r\n    connectedPoints(ctx, Triangles.corners(t), {...opts, loop: true});\r\n    \r\n    if (opts.debug) {\r\n      pointLabels(ctx, Triangles.corners(t), undefined, [`a`, `b`, `c`]);\r\n    }\r\n  };\r\n\r\n  if (Array.isArray(toDraw)) toDraw.forEach(draw);\r\n  else draw(toDraw as Triangles.Triangle);\r\n};\r\n\r\n// export const arrowFromTip = (ctx:CanvasRenderingContext2D, tipPos: Points.Point, tailLength:number, opts:DrawingOpts) => {\r\n//   if (opts.fillStyle) ctx.fillStyle = opts.fillStyle;\r\n//   if (opts.strokeStyle) ctx.strokeStyle = opts.strokeStyle;\r\n\r\n//   ctx.save();\r\n//   ctx.translate \r\n//   ctx.restore();\r\n// }\r\n\r\n/**\r\n * Draws one or more rectangles\r\n * @param ctx\r\n * @param toDraw \r\n * @param opts \r\n */\r\nexport const rect = (ctx: CanvasRenderingContext2D, toDraw: Rects.RectPositioned|readonly Rects.RectPositioned[], opts: DrawingOpts & {readonly filled?:boolean} = {}) => {\r\n  applyOpts(ctx, opts);\r\n\r\n  const draw = (d:Rects.RectPositioned) => {\r\n    if (opts.filled) ctx.fillRect(d.x, d.y, d.width, d.height);\r\n    ctx.strokeRect(d.x, d.y, d.width, d.height);\r\n\r\n    if (opts.debug) {\r\n      pointLabels(ctx, Rects.corners(d), undefined, [`NW`, `NE`, `SE`, `SW`]);\r\n    }\r\n  };\r\n\r\n  if (Array.isArray(toDraw)) toDraw.forEach(draw);\r\n  else draw(toDraw as Rects.RectPositioned);\r\n};\r\n\r\n/**\r\n * Returns the width of `text`. Rounds number up to nearest multiple if provided. If\r\n * text is empty or undefined, 0 is returned.\r\n * @param ctx \r\n * @param text \r\n * @param widthMultiple \r\n * @returns \r\n */\r\nexport const textWidth = (ctx:CanvasRenderingContext2D, text?:string|null, padding = 0, widthMultiple?:number):number => {\r\n  if (text === undefined || text === null || text.length === 0) return 0;\r\n  const m = ctx.measureText(text);\r\n  if (widthMultiple) return roundUpToMultiple(m.width, widthMultiple) + padding;\r\n  return m.width + padding;\r\n};\r\n\r\n/**\r\n * Draws a block of text. Each array item is considered a line.\r\n * @param ctx\r\n * @param lines \r\n * @param opts \r\n */\r\nexport const textBlock = (ctx:CanvasRenderingContext2D, lines:readonly string[], opts:DrawingOpts & {readonly anchor:Points.Point, readonly anchorPadding?:number, readonly bounds?: Rects.RectPositioned}) => {\r\n  applyOpts(ctx, opts);\r\n  const anchorPadding = opts.anchorPadding ?? 0;\r\n\r\n  const anchor = opts.anchor;\r\n  const bounds = opts.bounds ?? {x:0, y:0, width:1000000, height:1000000};\r\n\r\n  // Measure each line\r\n  const blocks = lines.map(l => ctx.measureText(l));\r\n\r\n  // Get width and height\r\n  const widths = blocks.map(tm => tm.width);\r\n  const heights = blocks.map(tm => tm.actualBoundingBoxAscent + tm.actualBoundingBoxDescent);\r\n\r\n  // Find extremes\r\n  const maxWidth = Math.max(...widths);\r\n  const totalHeight = heights.reduce((acc, val) => acc+val, 0);\r\n\r\n  // eslint-disable-next-line functional/no-let\r\n  let {x, y} = anchor;\r\n\r\n  if (anchor.x + maxWidth > bounds.width) x = bounds.width - (maxWidth + anchorPadding);\r\n  else x -= anchorPadding;\r\n  \r\n  if (x < bounds.x) x = bounds.x + anchorPadding;\r\n\r\n  if (anchor.y + totalHeight > bounds.height) y = bounds.height - (totalHeight + anchorPadding);\r\n  else y -= anchorPadding;\r\n\r\n  if (y < bounds.y) y = bounds.y + anchorPadding;\r\n\r\n  lines.forEach((line, i) => {\r\n    ctx.fillText(line, x, y);\r\n    y += heights[i];\r\n  });\r\n};\r\n\r\nexport type HorizAlign = `left` | `right` | `center`;\r\nexport type VertAlign = `top` | `center` | `bottom`;\r\n\r\n/**\r\n * Draws an aligned text block\r\n */\r\nexport const textBlockAligned = (ctx:CanvasRenderingContext2D, text:readonly string[]|string, opts:DrawingOpts & { readonly bounds: Rects.RectPositioned, readonly horiz?: HorizAlign, readonly vert?:VertAlign}) => {\r\n  const {bounds} = opts;\r\n  const {horiz = `left`, vert = `top`} = opts;\r\n\r\n  //eslint-disable-next-line functional/no-let\r\n  let lines:readonly string[];\r\n  if (typeof text === `string`) lines = [text];\r\n  else lines = text;\r\n\r\n  applyOpts(ctx, opts);\r\n\r\n  ctx.save();\r\n  ctx.translate(bounds.x, bounds.y);\r\n  //eslint-disable-next-line functional/immutable-data\r\n  ctx.textAlign = `left`;\r\n  //eslint-disable-next-line functional/immutable-data\r\n  ctx.textBaseline = `top`;\r\n  const middleX = bounds.width / 2;\r\n  const middleY = bounds.height / 2;\r\n\r\n  // Measure each line\r\n  const blocks = lines.map(l => ctx.measureText(l));\r\n  const heights = blocks.map(tm => tm.actualBoundingBoxAscent + tm.actualBoundingBoxDescent);\r\n  const totalHeight = heights.reduce((acc, val) => acc+val, 0);\r\n  \r\n  //eslint-disable-next-line functional/no-let\r\n  let y = 0;\r\n  if (vert === `center`) y = middleY - totalHeight /2;\r\n  else if (vert === `bottom`) {\r\n    y = bounds.height - totalHeight;\r\n  } \r\n\r\n  lines.forEach((line, i) => {\r\n    //eslint-disable-next-line functional/no-let\r\n    let x = 0;\r\n    if (horiz === `center`) x  = middleX - blocks[i].width / 2;\r\n    else if (horiz === `right`) x = bounds.width - blocks[i].width;\r\n    ctx.fillText(lines[i], x, y);\r\n    y += heights[i];\r\n  });\r\n\r\n  ctx.restore();\r\n};","import tslib from '../tslib.js';\r\nconst {\r\n    __extends,\r\n    __assign,\r\n    __rest,\r\n    __decorate,\r\n    __param,\r\n    __metadata,\r\n    __awaiter,\r\n    __generator,\r\n    __exportStar,\r\n    __createBinding,\r\n    __values,\r\n    __read,\r\n    __spread,\r\n    __spreadArrays,\r\n    __spreadArray,\r\n    __await,\r\n    __asyncGenerator,\r\n    __asyncDelegator,\r\n    __asyncValues,\r\n    __makeTemplateObject,\r\n    __importStar,\r\n    __importDefault,\r\n    __classPrivateFieldGet,\r\n    __classPrivateFieldSet,\r\n} = tslib;\r\nexport {\r\n    __extends,\r\n    __assign,\r\n    __rest,\r\n    __decorate,\r\n    __param,\r\n    __metadata,\r\n    __awaiter,\r\n    __generator,\r\n    __exportStar,\r\n    __createBinding,\r\n    __values,\r\n    __read,\r\n    __spread,\r\n    __spreadArrays,\r\n    __spreadArray,\r\n    __await,\r\n    __asyncGenerator,\r\n    __asyncDelegator,\r\n    __asyncValues,\r\n    __makeTemplateObject,\r\n    __importStar,\r\n    __importDefault,\r\n    __classPrivateFieldGet,\r\n    __classPrivateFieldSet,\r\n};\r\n",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"import { Observable,  debounceTime, fromEvent } from 'rxjs';\nimport * as Points from '../geometry/Point';\nimport JSON5 from 'json5';\nimport { Rects, Scaler } from '../geometry/index.js';\n\nexport type ElementResizeArgs<V extends HTMLElement|SVGSVGElement> = {\n  readonly el:V\n  readonly bounds:{\n    readonly width:number\n    readonly height:number\n    readonly center:Points.Point\n    readonly min:number\n    readonly max:number\n  }\n}\n\nexport type CanvasResizeArgs = ElementResizeArgs<HTMLCanvasElement> & {\n  readonly ctx:CanvasRenderingContext2D\n}\n\n\nexport const fullSizeElement = <V extends HTMLElement>(domQueryOrEl:string|V, onResized?:(args:ElementResizeArgs<V>)=>void) => {\n  const el = resolveEl<V>(domQueryOrEl);\n\n  const r = windowResize();\n  const update = () => {\n    const width = window.innerWidth;\n    const height = window.innerHeight;\n\n    el.setAttribute(`width`, width.toString());\n    el.setAttribute(`height`, height.toString());\n\n    if (onResized !== undefined) {\n      const bounds = { \n        min: Math.min(width, height),\n        max: Math.max(width, height),\n        width, \n        height, \n        center: { \n          x: width/2, \n          y:height/2 \n        } \n      };\n      onResized({ el, bounds });\n    }\n  };\n  r.subscribe(update);\n  \n  update();\n  return r;\n};\n\nexport type CanvasOpts = {\n  readonly skipCss?:boolean\n  readonly fullSize?:boolean\n  readonly scaleBy?:`both`|`width`|`height`|`min`|`max`;\n}\n\nexport const canvasHelper = (domQueryOrEl:string|HTMLCanvasElement|undefined|null, opts:CanvasOpts) => {\n  if (!domQueryOrEl) throw new Error(`domQueryOrEl is null or undefined`);\n  const el = resolveEl<HTMLCanvasElement>(domQueryOrEl);\n  if (el.nodeName !== `CANVAS`) throw new Error(`Expected CANVAS HTML element. Got: ${el.nodeName}`);\n\n  const fullSize = opts.fullSize ?? true;\n  const ratio = Math.round(window.devicePixelRatio) || 1;\n  const scaleBy = opts.scaleBy ?? `both`;\n\n  //eslint-disable-next-line functional/no-let\n  let scaler:Scaler.Scaler = Scaler.scaler(`both`);\n\n  const updateDimensions = (rect:Rects.Rect) => {\n    // Create a new scaler\n    scaler = Scaler.scaler(scaleBy, rect);\n\n    const pixelScaled = Rects.multiply(rect, ratio, ratio);\n\n    //eslint-disable-next-line functional/immutable-data\n    el.width = pixelScaled.width;\n    //eslint-disable-next-line functional/immutable-data\n    el.height = pixelScaled.height;\n\n    //eslint-disable-next-line functional/immutable-data\n    el.style.width = rect.width + `px`;\n    //eslint-disable-next-line functional/immutable-data\n    el.style.height = rect.height +`px`;\n  };\n\n  // Window has resized\n  const onWindowResize = () => {\n    const innerWindow = {\n      width: window.innerWidth,\n      height: window.innerHeight\n    };\n    updateDimensions(innerWindow);\n  };\n\n  const getContext = () => {\n    const ctx = el.getContext(`2d`);\n    if (ctx === null) throw new Error(`Could not create drawing context`);\n\n    ctx.scale(ratio, ratio);\n  };\n\n  if (fullSize) {\n    const r = windowResize();\n    r.subscribe(onWindowResize);\n  }\n\n  return {\n    abs: scaler.abs,\n    rel: scaler.rel,\n    getContext\n  };\n};\n\n\n/**\n * Resizes given canvas element to match window size. \n * To resize canvas to match its parent, use {@link parentSizeCanvas}.\n * \n * To make the canvas appear propery, it sets the following CSS:\n * ```css\n * {\n *  top: 0;\n *  left: 0;\n *  zIndex: -1;\n *  position: fixed;\n * }\n * ```\n * Pass _true_ for `skipCss` to avoid this.\n * \n * Provide a callback for when resize happens.\n * @param domQueryOrEl Query string or reference to canvas element\n * @param onResized Callback for when resize happens, eg for redrawing canvas\n * @param skipCss if true, style are not added\n * @returns Observable\n */\nexport const fullSizeCanvas = (domQueryOrEl:string|HTMLCanvasElement|undefined|null, onResized?:(args:CanvasResizeArgs)=>void, skipCss = false) => {\n  if (domQueryOrEl === null || domQueryOrEl === undefined) throw new Error(`domQueryOrEl is null or undefined`);\n  const el = resolveEl<HTMLCanvasElement>(domQueryOrEl);\n  if (el.nodeName !== `CANVAS`) throw new Error(`Expected HTML element with node name CANVAS, not ${el.nodeName}`);\n\n  const ctx = el.getContext(`2d`);\n  if (ctx === null) throw new Error(`Could not create drawing context`);\n\n  const update = () => {\n    const width = window.innerWidth;\n    const height = window.innerHeight;\n\n    //eslint-disable-next-line functional/immutable-data\n    el.width = width;\n    //eslint-disable-next-line functional/immutable-data\n    el.height = height;\n\n    if (onResized !== undefined) {\n      const bounds = { \n        min: Math.min(width, height),\n        max: Math.max(width, height),\n        width, \n        height, \n        center: { x: width/2, y:height/2 } };\n      onResized({ ctx, el, bounds });\n    }\n  };\n\n  // Setup\n  if (!skipCss) {\n    //eslint-disable-next-line functional/immutable-data\n    el.style.top = `0`;\n    //eslint-disable-next-line functional/immutable-data\n    el.style.left = `0`;\n    //eslint-disable-next-line functional/immutable-data\n    el.style.zIndex = `-100`;\n    //eslint-disable-next-line functional/immutable-data\n    el.style.position = `fixed`;\n  }\n\n  const r = windowResize();\n  r.subscribe(update);\n  \n  update();\n  return r;\n};\n\n/**\n * Given an array of class class names, this will cycle between them each time\n * it is called.\n * \n * Eg, assume `list` is: [ `a`, `b`, `c` ]\n * \n * If `el` already has the class `a`, the first time it is called, class `a`\n * is removed, and `b` added. The next time `b` is swapped for `c`. Once again,\n * `c` will swap with `a` and so on.\n * \n * If `el` is undefined or null, function silently returns.\n * @param el Element\n * @param list List of class names\n * @returns \n */\nexport const cycleCssClass = (el:HTMLElement, list:readonly string[]) => {\n  if (el === null || !el) return;\n  if (!Array.isArray(list)) throw new Error(`List should be an array of strings`);\n  //eslint-disable-next-line functional/no-let\n  for (let i=0;i<list.length;i++) {\n    if (el.classList.contains(list[i])) {\n      el.classList.remove(list[i]);\n      if (i +1 < list.length) {\n        el.classList.add(list[i+1]);\n      } else {\n        el.classList.add(list[0]);\n      }\n      return;\n    }\n  }\n  el.classList.add(list[0]);\n};\n\n/**\n * Sets width/height atributes on the given element according to the size of its parent.\n * @param domQueryOrEl Elememnt to resize\n * @param onResized Callback when resize happens\n * @param timeoutMs Timeout for debouncing events\n * @returns \n */\nexport const parentSize = <V extends HTMLElement|SVGSVGElement>(domQueryOrEl:string|V, onResized?:(args:ElementResizeArgs<V>)=>void, timeoutMs:number = 100) => {\n  const el = resolveEl<V>(domQueryOrEl);\n  const parent = el.parentElement;\n  if (parent === null) throw new Error(`Element has no parent`);\n\n  const ro = resizeObservable(parent, timeoutMs).subscribe((entries:readonly ResizeObserverEntry[]) => {\n    const e = entries.find(v => v.target === parent);\n    if (e === undefined) return;\n\n    const width = e.contentRect.width;\n    const height = e.contentRect.height;\n\n    el.setAttribute(`width`, width + `px`);\n    el.setAttribute(`height`, height + `px`);\n    if (onResized !== undefined) {\n      const bounds = { \n        min: Math.min(width, height),\n        max: Math.max(width, height),\n        width, \n        height, \n        center: { x: width/2, y:height/2 } };\n      onResized({ el, bounds });\n    }\n  });\n\n  return ro;\n};\n\n/**\n * Source: https://zellwk.com/blog/translate-in-javascript\n * @param domQueryOrEl \n */\nexport const getTranslation = (domQueryOrEl:string|HTMLElement):Points.Point => {\n  // Source:\n  // https://raw.githubusercontent.com/zellwk/javascript/master/src/browser/dom/translate-values.js\n\n  const el = resolveEl<HTMLElement>(domQueryOrEl);\n  const style = window.getComputedStyle(el);\n  const matrix = style.transform;\n\n  // No transform property. Simply return 0 values.\n  if (matrix === `none` || typeof matrix === `undefined`) {\n    return {\n      x: 0,\n      y: 0,\n      z: 0\n    };\n  }\n\n  // Can either be 2d or 3d transform\n  const matrixType = matrix.includes(`3d`) ? `3d` : `2d`;\n  // @ts-ignore\n  const matrixValues = matrix.match(/matrix.*\\((.+)\\)/)[1].split(`, `);\n\n  // 2d Matrixes have 6 values\n  // Last 2 values are X and Y.\n  // 2d Matrixes does not have Z value.\n  if (matrixType === `2d`) {\n    return {\n      x: parseFloat(matrixValues[4]),\n      y: parseFloat(matrixValues[5]),\n      z: 0\n    };\n  }\n\n  // 3d Matrixes have 16 values\n  // The 13th, 14th, and 15th values are X, Y, and Z\n  if (matrixType === `3d`) {\n    return {\n      x: parseFloat(matrixValues[12]),\n      y: parseFloat(matrixValues[13]),\n      z: parseFloat(matrixValues[14])\n    };\n  }\n\n  return { x: 0, y: 0, z:0 };\n};\n\n/**\n * Resizes given canvas to its parent element. \n * To resize canvas to match the viewport, use {@link fullSizeCanvas}.\n * \n * Provide a callback for when resize happens.\n * @param domQueryOrEl Query string or reference to canvas element\n * @param onResized Callback for when resize happens, eg for redrawing canvas\n * @returns Observable\n */\nexport const parentSizeCanvas = (domQueryOrEl:string|HTMLCanvasElement, onResized?:(args:CanvasResizeArgs)=>void, timeoutMs:number = 100) => {\n  const el = resolveEl<HTMLCanvasElement>(domQueryOrEl);\n  if (el.nodeName !== `CANVAS`) throw new Error(`Expected HTML element with node name CANVAS, not ${el.nodeName}`);\n\n  const parent = el.parentElement;\n  if (parent === null) throw new Error(`Element has no parent`);\n\n  const ctx = (el as HTMLCanvasElement).getContext(`2d`);\n  if (ctx === null) throw new Error(`Could not create drawing context`);\n  \n  //const safetyMargin = 4;\n\n  //eslint-disable-next-line functional/immutable-data\n  el.style.width = `100%`;\n  //eslint-disable-next-line functional/immutable-data\n  el.style.height = `100%`;\n\n  //console.log('parent height: ' + parent.getBoundingClientRect().height);\n  //console.log(`parent offset Height: ${parent.offsetHeight}`);\n\n  const ro = resizeObservable(parent, timeoutMs).subscribe((entries:readonly ResizeObserverEntry[]) => {\n    const e = entries.find(v => v.target === parent);\n    if (e === undefined) return;\n\n    const width = e.contentRect.width;\n    const height = e.contentRect.height;\n    //console.log(`contentH: ${e.contentRect.height} current: ${el.getBoundingClientRect().height}`);\n\n    // el.setAttribute(`width`, width-safetyMargin + `px`);\n    // el.setAttribute(`height`, height-safetyMargin + `px`);\n    el.setAttribute(`width`, el.offsetWidth + `px`);\n    el.setAttribute(`height`, el.offsetHeight + `px`);\n    \n    if (onResized !== undefined) {\n      const bounds = { \n        min: Math.min(width, height),\n        max: Math.max(width, height),\n        width, \n        height, \n        center: { x: width/2, y:height/2 } };\n      onResized({ ctx, el, bounds });\n    }\n  });\n\n  return ro;\n};\n\n/**\n * Returns an Observable for window resize. Default 100ms debounce.\n * @param timeoutMs \n * @returns \n */\nexport const windowResize = (timeoutMs:number = 100) => fromEvent(window, `resize`).pipe(debounceTime(timeoutMs));\n\n/**\n * Resolves either a string or HTML element to an element.\n * Useful when an argument is either an HTML element or query.\n * \n * ```js \n * resolveEl(`#someId`);\n * resolveEl(someElement);\n * ```\n * @param domQueryOrEl \n * @returns \n */\nexport const resolveEl = <V extends Element>(domQueryOrEl:string|V):V => {\n  if (typeof domQueryOrEl === `string`) {\n    const d = document.querySelector(domQueryOrEl);\n    if (d === null) {\n      if (!domQueryOrEl.startsWith(`#`)) {\n        throw new Error(`Query '${domQueryOrEl}' did not match anything. Did you mean '#${domQueryOrEl}?`);\n      } else {\n        throw new Error(`Query '${domQueryOrEl}' did not match anything. Try '#id', 'div', or '.class'`);\n      }\n    }\n    domQueryOrEl = d as V;\n  } else if (domQueryOrEl === null) throw new Error(`domQueryOrEl ${domQueryOrEl} is null`);\n  else if (domQueryOrEl === undefined) throw new Error(`domQueryOrEl ${domQueryOrEl} is undefined`);\n  \n  const el = domQueryOrEl as V;\n  return el;\n};\n\n/**\n * Creates an element after `sibling`\n * ```\n * const el = createAfter(siblingEl, `DIV`);\n * ```\n * @param sibling Element\n * @param tagName Element to create\n * @returns New element\n */\nexport const createAfter = (sibling:HTMLElement, tagName:string):HTMLElement => {\n  const el = document.createElement(tagName);\n  sibling.parentElement?.insertBefore(el, sibling.nextSibling);\n  return el;\n};\n\n/**\n * Creates an element inside of `parent`\n * ```\n * const newEl = createIn(parentEl, `DIV`);\n * ```\n * @param parent Parent element\n * @param tagName Tag to create\n * @returns New element\n */\nexport const createIn = (parent:HTMLElement, tagName:string):HTMLElement => {\n  const el = document.createElement(tagName);\n  parent.appendChild(el);\n  return el;\n};\n\n/**\n * Creates a table based on a list of objects\n * ```\n * const t = dataTableList(parentEl, map);\n * \n * t(newMap)\n * ```\n */\nexport const dataTableList = (parentOrQuery:HTMLElement|string, data:ReadonlyMap<string, object>):(data:ReadonlyMap<string, object>)=>void => {\n  const parent = resolveEl(parentOrQuery);\n\n  const update = (data:ReadonlyMap<string, object>) => {\n    const seenTables = new Set();\n\n    for (const [key, value] of data) {\n      const tKey = `table-${key}`;\n      seenTables.add(tKey);\n      //eslint-disable-next-line functional/no-let\n      let t = parent.querySelector(`#${tKey}`);\n      if (t === null) {\n        t = document.createElement(`table`);\n        //eslint-disable-next-line functional/immutable-data\n        t.id = tKey;\n        parent.append(t);\n      }\n\n      updateDataTable(t as HTMLTableElement, value);\n    }\n\n    // Remove tables that aren't present in map\n    const tables = Array.from(parent.querySelectorAll(`table`));\n    tables.forEach(t => {\n      if (!seenTables.has(t.id)) {\n        t.remove();\n      }\n    });\n  };\n\n  if (data) update(data);\n\n  return (d:ReadonlyMap<string, object>) => {\n    update(d);\n  };\n  \n};\n\n/**\n * Format data. Return _undefined_ to signal that\n * data was not handled.\n */\nexport type DataFormatter = (data:object, path:string)=>string|undefined;\n\n/**\n * Updates a TABLE elment based on `data`'s key-object pairs\n * @param t \n * @param data \n * @returns \n */\nconst updateDataTable = (t:HTMLTableElement, data:object, opts:DataTableOpts = {}) => {\n  const precision = opts.precision ?? 2;\n \n  if (data === undefined) {\n    //eslint-disable-next-line functional/immutable-data\n    t.innerHTML = ``;\n    return;\n  }\n  const seenRows = new Set();\n  \n  for (const [key, value] of Object.entries(data)) {\n    const domKey = `row-${key}`;\n    seenRows.add(domKey);\n\n    //eslint-disable-next-line functional/no-let\n    let rowEl = t.querySelector(`#${domKey}`);\n    if (rowEl === null) {\n      rowEl = document.createElement(`tr`);\n      t.append(rowEl);\n      //eslint-disable-next-line functional/immutable-data\n      rowEl.id = domKey;\n\n      const keyEl = document.createElement(`td`);\n      //eslint-disable-next-line functional/immutable-data\n      keyEl.innerText = key;\n      rowEl.append(keyEl);\n    }\n\n    //eslint-disable-next-line functional/no-let\n    let valEl = rowEl.querySelector(`#${domKey}-val`);\n    \n    if (valEl === null) {\n      valEl = document.createElement(`td`);\n      //eslint-disable-next-line functional/immutable-data\n      valEl.id = `${domKey}-val`;\n      rowEl.append(valEl);\n    }\n\n    //eslint-disable-next-line functional/no-let\n    let valueHTML:string|undefined;\n    if (opts.formatter) {\n      valueHTML = opts.formatter(value, key);\n    }\n\n    // If there's no formatter, or not handled...\n    if (valueHTML === undefined) {\n      if (typeof value === `object`) {\n        valueHTML = JSON5.stringify(value);\n      } else if (typeof value === `number`) {\n        if (opts.roundNumbers) {\n          valueHTML = Math.round(value).toString();\n        } else {\n          valueHTML = value.toFixed(precision);\n        }\n      } else {\n        valueHTML = (value as object).toString();\n      }\n    }\n    //eslint-disable-next-line functional/immutable-data\n    (valEl as HTMLElement).innerHTML = valueHTML;\n  }\n\n  // Remove rows that aren't present in data\n  const rows = Array.from(t.querySelectorAll(`tr`));\n  rows.forEach(r => {\n    if (!seenRows.has(r.id)) {\n      r.remove();\n    }\n  });\n\n};\n\nexport type DataTableOpts = {\n  readonly formatter?:DataFormatter\n  readonly precision?:number\n  readonly roundNumbers?:boolean\n}\n/**\n * Creates a HTML table where each row is a key-value pair from `data`.\n * First column is the key, second column data.\n * \n * ```js\n * const dt = dataTable(`#hostDiv`);\n * dt({\n *  name: `Blerg`,\n *  height: 120\n * });\n * ```\n */\nexport const dataTable = (parentOrQuery:HTMLElement|string, data?:object, opts?:DataTableOpts):(data:object)=>void => {\n  const parent = resolveEl(parentOrQuery);\n  const t = document.createElement(`table`);\n  parent.append(t);\n  \n  if (data) updateDataTable(t, data, opts);\n  return (d:object) => {\n    updateDataTable(t, d, opts);\n  };\n};\n\n/**\n * Remove all child nodes from `parent`\n * @param parent \n */\nexport const clear = (parent:HTMLElement) => {\n  //eslint-disable-next-line functional/no-let\n  let c = parent.lastElementChild;\n  \n  while (c) {\n    parent.removeChild(c);\n    c = parent.lastElementChild;\n  }\n};\n\n/**\n * Observer when document's class changes\n * \n * ```js\n * const c = themeChangeObservable();\n * c.subscribe(() => {\n *  // Class has changed...\n * });\n * ```\n * @returns \n */\nexport const themeChangeObservable = ():Observable<readonly MutationRecord[]> => {\n  const o = new Observable<MutationRecord[]>(subscriber => {\n    const ro = new MutationObserver(entries => {\n      subscriber.next(entries);\n    });\n\n    const opts:MutationObserverInit = {\n      attributeFilter: [`class`],\n      attributes: true,\n    };\n\n    ro.observe(document.documentElement, opts);\n    return function unsubscribe() {\n      ro.disconnect();\n    };\n  });\n  return o;\n};\n\n/**\n * Observer when element resizes. Specify `timeoutMs` to debounce.\n * \n * ```\n * const o = resizeObservable(myEl, 500);\n * o.subscribe(() => {\n *  // called 500ms after last resize\n * });\n * ```\n * @param elem \n * @param timeoutMs Tiemout before event gets triggered\n * @returns \n */\nexport const resizeObservable = (elem:Element, timeoutMs:number = 1000):Observable<readonly ResizeObserverEntry[]> => {\n  if (elem === null) throw new Error(`elem parameter is null. Expected element to observe`);\n  if (elem === undefined) throw new Error(`elem parameter is undefined. Expected element to observe`);\n  \n  const o = new Observable<ResizeObserverEntry[]>(subscriber => {\n    const ro = new ResizeObserver(entries => {\n      subscriber.next(entries);\n    });\n\n    ro.observe(elem);\n    return function unsubscribe() {\n      ro.unobserve(elem);\n    };\n  });\n  return o.pipe(debounceTime(timeoutMs));\n};\n\n/**\n * Copies string representation of object to clipboard\n * @param obj \n * @returns Promise\n */\nexport const copyToClipboard = (obj:object) => {\n  const p = new Promise((resolve, reject) => {\n    //const json = JSON.stringify(obj, null, 2);\n    const str = JSON5.stringify(obj);\n    navigator.clipboard.writeText(JSON.stringify(str)).then(\n      () => {\n        resolve(true);\n      },\n      (_err) => {\n        console.warn(`Could not copy to clipboard`);\n        console.log(str);\n        reject(_err);\n      }\n    );\n  });\n  return p;\n};\n\nexport type CreateUpdateElement<V> = (item:V, el:HTMLElement|null)=>HTMLElement;\n\nexport const reconcileChildren = <V>(parentEl:HTMLElement, list:ReadonlyMap<string, V>, createUpdate:CreateUpdateElement<V>) => {\n  if (parentEl === null) throw new Error(`parentEl is null`);\n  if (parentEl === undefined) throw new Error(`parentEl is undefined`);\n  \n  const seen = new Set<string>();\n  \n  for (const [key, value] of list) {\n    const id = `c-${key}`;\n    const el = parentEl.querySelector(`#${id}`) as HTMLElement;\n    const finalEl = createUpdate(value, el);\n    //eslint-disable-next-line functional/immutable-data\n    if (el !== finalEl) {\n      //eslint-disable-next-line functional/immutable-data\n      finalEl.id = id;\n      parentEl.append(finalEl);\n    }\n    seen.add(id);\n  }\n\n  const prune:HTMLElement[] = [];\n  //eslint-disable-next-line functional/no-let\n  for (let i=0;i<parentEl.children.length;i++) {\n    const c = parentEl.children[i] as HTMLElement;\n    if (!seen.has(c.id)) {\n      //eslint-disable-next-line functional/immutable-data\n      prune.push(c);\n    }\n  }\n  \n  prune.forEach(p => p.remove());\n};","import { CirclePositioned } from \"../geometry/Circle.js\";\nimport { markerPrebuilt } from \"./SvgMarkers.js\";\nimport * as Lines from \"../geometry/Line.js\";\nimport * as Points from \"../geometry/Point.js\";\nimport * as Elements from \"./SvgElements.js\";\nimport * as Rects from \"../geometry/Rect.js\";\n\nexport { Elements };\n\nexport type MarkerOpts = StrokeOpts & DrawingOpts & {\n  readonly id:string,\n  readonly markerWidth?:number,\n  readonly markerHeight?:number,\n  readonly orient?:string,\n  readonly viewBox?:string,\n  readonly refX?:number,\n  readonly refY?:number\n}\n\n/**\n * Drawing options\n */\nexport type DrawingOpts = {\n  /**\n   * Style for fill. Eg `black`.\n   * @see [fill](https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/fill)\n   */\n  readonly fillStyle?:string\n\n  /**\n   * Opacity (0..1)\n   */\n  readonly opacity?:number\n  /**\n   * If true, debug helpers are drawn\n   */\n  readonly debug?:boolean\n};\n\nexport type StrokeOpts = {\n  /**\n   * Line cap\n   * @see [stroke-linecap](https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/stroke-linecap)\n   */\n  readonly strokeLineCap?:`butt` | `round` | `square`\n  /**\n   * Width of stroke, eg `2`\n   * @see [stroke-width](https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/stroke-width)\n   */\n  readonly strokeWidth?:number\n  /**\n  * Stroke dash pattern, eg `5`\n  * @see [stroke-dasharray](https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/stroke-dasharray)\n  */\n  readonly strokeDash?:string\n  /**\n   * Style for lines. Eg `white`.\n   * @see [stroke](https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/stroke)\n   */\n  readonly strokeStyle?:string\n}\n\n/**\n * Line drawing options\n */\nexport type LineDrawingOpts = DrawingOpts & MarkerDrawingOpts & StrokeOpts;\n\nexport type CircleDrawingOpts = DrawingOpts & StrokeOpts & MarkerDrawingOpts;\n\nexport type PathDrawingOpts = DrawingOpts & StrokeOpts & MarkerDrawingOpts;\n\nexport type MarkerDrawingOpts = {\n  readonly markerEnd?:MarkerOpts\n  readonly markerStart?:MarkerOpts\n  readonly markerMid?:MarkerOpts\n}\n\n\n/**\n * Text drawing options\n */\nexport type TextDrawingOpts = StrokeOpts & DrawingOpts & {\n  readonly anchor?:`start` | `middle` | `end`\n  readonly align?:`text-bottom` | `text-top` | `baseline` | `top` | `hanging` | `middle`,\n  readonly userSelect?:boolean\n}\n\n/**\n * Text path drawing options\n */\nexport type TextPathDrawingOpts = TextDrawingOpts & {\n  readonly method?:`align` | `stretch`\n  readonly side?:`left` | `right`\n  readonly spacing?:`auto` | `exact`\n  readonly startOffset?:number\n  readonly textLength?:number\n}\n\n/**\n * Creates and appends a SVG element. \n * \n * ```js\n * // Create a circle\n * const circleEl = createOrResolve(parentEl, `SVGCircleElement`);\n * ```\n * \n * If `queryOrExisting` is specified, it is used as a query to find an existing element. If\n * query starts with `#`, this will be set as the element id, if created.\n * \n * ```js\n * // Creates an element with id 'myCircle' if it doesn't exist\n * const circleEl = createOrResolve(parentEl, `SVGCircleElement`, `#myCircle`);\n * ```\n * @param parent Parent element\n * @param type Type of SVG element\n * @param queryOrExisting Query, eg `#id`\n * @returns \n */\nexport const createOrResolve = <V extends SVGElement>(parent:SVGElement, type:string, queryOrExisting?:string | V):V => {\n  //eslint-disable-next-line functional/no-let\n  let existing = null;\n  if (queryOrExisting !== undefined) {\n    if (typeof queryOrExisting === `string`) existing = parent.querySelector(queryOrExisting);\n    else existing = queryOrExisting;\n  }\n  if (existing === null) {\n    const p = document.createElementNS(`http://www.w3.org/2000/svg`, type) as V;\n    parent.appendChild(p);\n    if (queryOrExisting && typeof queryOrExisting === `string`) {\n      //eslint-disable-next-line functional/immutable-data\n      if (queryOrExisting.startsWith(`#`)) p.id = queryOrExisting.substring(1);\n    }\n    return p;\n  }\n  return existing as V;\n};\n\nexport const remove = <V extends SVGElement>(parent:SVGElement, queryOrExisting:string | V) => {\n  if (typeof queryOrExisting === `string`) {\n    const e = parent.querySelector(queryOrExisting);\n    if (e === null) return;\n    e.remove();\n  } else {\n    queryOrExisting.remove();\n  }\n};\n\nexport const clear = (parent:SVGElement) => {\n  //eslint-disable-next-line functional/no-let\n  let c = parent.lastElementChild;\n  while (c) {\n    parent.removeChild(c);\n    c = parent.lastElementChild;\n  }\n};\n\n/**\n * Creates an element of `type` and with `id` (if specified)\n * @param type Element type, eg `circle` \n * @param id Optional id to assign to element\n * @returns Element\n */\nexport const createEl = <V extends SVGElement>(type:string, id?:string):V => {\n  const m = document.createElementNS(`http://www.w3.org/2000/svg`, type) as V;\n  if (id) {\n    //eslint-disable-next-line functional/immutable-data\n    m.id = id;\n  }\n  return m;\n};\n\n/**\n * Applies path drawing options to given element\n * Applies: markerEnd, markerStart, markerMid\n * @param elem Element (presumed path)\n * @param opts Options\n */\nexport const applyPathOpts = (elem:SVGElement, opts:PathDrawingOpts) => {\n  if (opts.markerEnd) elem.setAttribute(`marker-end`, markerPrebuilt(elem, opts.markerEnd, opts as DrawingOpts));\n  if (opts.markerStart) elem.setAttribute(`marker-start`, markerPrebuilt(elem, opts.markerStart, opts as DrawingOpts));\n  if (opts.markerMid) elem.setAttribute(`marker-mid`, markerPrebuilt(elem, opts.markerMid, opts as DrawingOpts));\n};\n\n/**\n * Applies drawing options to given SVG element.\n * Applies: fillStyle\n * @param elem Element\n * @param opts Drawing options\n */\nexport const applyOpts = (elem:SVGElement, opts:DrawingOpts) => {\n  if (opts.fillStyle) elem.setAttributeNS(null, `fill`, opts.fillStyle);\n  if (opts.opacity) elem.setAttributeNS(null, `opacity`, opts.opacity.toString());\n};\n\n/**\n * Applies drawing options to given SVG element.\n * Applies: strokeStyle, strokeWidth, strokeDash, strokeLineCap\n * @param elem Element\n * @param opts \n */\nexport const applyStrokeOpts = (elem:SVGElement, opts:StrokeOpts) => {\n  if (opts.strokeStyle) elem.setAttributeNS(null, `stroke`, opts.strokeStyle);\n  if (opts.strokeWidth) elem.setAttributeNS(null, `stroke-width`, opts.strokeWidth.toString());\n  if (opts.strokeDash) elem.setAttribute(`stroke-dasharray`, opts.strokeDash);\n  if (opts.strokeLineCap) elem.setAttribute(`stroke-linecap`, opts.strokeLineCap);\n};\n\n/**\n * Helper to make SVG elements with a common parent.\n *\n * Create with {@link makeHelper}.\n */\nexport type SvgHelper = {\n  remove(queryOrExisting:string | SVGElement):void\n  /**\n   * Creates a text element\n   * @param text Text\n   * @param pos Position\n   * @param opts Drawing options\n   * @param queryOrExisting DOM query to look up existing element, or the element instance \n   */\n  text(text:string, pos:Points.Point, opts?:TextDrawingOpts, queryOrExisting?:string | SVGTextElement):SVGTextElement\n  /**\n   * Creates text on a path\n   * @param pathRef Reference to path element\n   * @param text Text\n   * @param opts Drawing options\n   * @param queryOrExisting DOM query to look up existing element, or the element instance \n   */\n  textPath(pathRef:string, text:string, opts?:TextDrawingOpts, queryOrExisting?:string | SVGTextPathElement):SVGTextPathElement\n  /**\n   * Creates a line\n   * @param line Line\n   * @param opts Drawing options\n   * @param queryOrExisting DOM query to look up existing element, or the element instance \n   */\n  line(line:Lines.Line, opts?:LineDrawingOpts, queryOrExisting?:string | SVGLineElement):SVGLineElement\n  /**\n   * Creates a circle\n   * @param circle Circle\n   * @param opts Drawing options\n   * @param queryOrExisting DOM query to look up existing element, or the element instance \n   */\n  circle(circle:CirclePositioned, opts?:CircleDrawingOpts, queryOrExisting?:string | SVGCircleElement):SVGCircleElement\n  /**\n   * Creates a path\n   * @param svgStr Path description, or empty string\n   * @param opts Drawing options\n   * @param queryOrExisting DOM query to look up existing element, or the element instance \n   */\n  path(svgStr:string | readonly string[], opts?:PathDrawingOpts, queryOrExisting?:string | SVGPathElement):SVGPathElement\n  /**\n   * Creates a grid of horizontal and vertical lines inside of a group\n   * @param center Grid origin\n   * @param spacing Cell size\n   * @param width Width of grid\n   * @param height Height of grid\n   * @param opts Drawing options\n   */\n  grid(center:Points.Point, spacing:number, width:number, height:number, opts?:LineDrawingOpts):SVGGElement\n  /**\n   * Returns an element if it exists in parent\n   * @param selectors Eg `#path`\n   */\n  query<V extends SVGElement>(selectors:string):V | null\n  /**\n   * Gets/sets the width of the parent\n   */\n  get width():number\n  set width(width:number)\n  /**\n   * Gets the parent\n   */\n  get parent():SVGElement\n  /**\n   * Gets/sets the height of the parent\n   */\n  get height():number\n  set height(height:number)\n  /**\n   * Deletes all child elements\n   */\n  clear():void\n};\n\n/**\n * Get the bounds of an SVG element (determined by its width/height attribs)\n * @param svg\n * @returns \n */\nexport const getBounds = (svg:SVGElement):Rects.Rect => {\n  const w = svg.getAttributeNS(null, `width`);\n  const width = w === null ? 0 : parseFloat(w);\n  const h = svg.getAttributeNS(null, `height`);\n  const height = h === null ? 0 : parseFloat(h);\n  return { width, height };\n};\n\n/**\n * Set the bounds of an element, using its width/height attribs.\n * @param svg\n * @param bounds \n */\nexport const setBounds = (svg:SVGElement, bounds:Rects.Rect):void => {\n  svg.setAttributeNS(null, `width`, bounds.width.toString());\n  svg.setAttributeNS(null, `height`, bounds.height.toString());\n};\n\n/**\n * Creates a {@link SvgHelper} for the creating and management of SVG elements.\n * @param parent \n * @param parentOpts \n * @returns \n */\nexport const makeHelper = (parent:SVGElement, parentOpts?:DrawingOpts & StrokeOpts):SvgHelper => {\n  if (parentOpts) {\n    applyOpts(parent, parentOpts);\n    applyStrokeOpts(parent, parentOpts);\n  }\n\n  const o:SvgHelper = {\n    remove: (queryOrExisting:string | SVGElement) => remove(parent, queryOrExisting),\n    text: (text:string, pos:Points.Point, opts?:TextDrawingOpts, queryOrExisting?:string | SVGTextElement) => Elements.text(text, parent, pos, opts, queryOrExisting),\n    textPath: (pathRef:string, text:string, opts?:TextDrawingOpts, queryOrExisting?:string | SVGTextPathElement) => Elements.textPath(pathRef, text, parent, opts, queryOrExisting),\n    line: (line:Lines.Line, opts?:LineDrawingOpts, queryOrExisting?:string | SVGLineElement) => Elements.line(line, parent, opts, queryOrExisting),\n    circle: (circle:CirclePositioned, opts?:CircleDrawingOpts, queryOrExisting?:string | SVGCircleElement) => Elements.circle(circle, parent, opts, queryOrExisting),\n    path: (svgStr:string | readonly string[], opts?:PathDrawingOpts, queryOrExisting?:string | SVGPathElement) => Elements.path(svgStr, parent, opts, queryOrExisting),\n    grid: (center:Points.Point, spacing:number, width:number, height:number, opts?:LineDrawingOpts) => Elements.grid(parent, center, spacing, width, height, opts),\n    query: <V extends SVGElement>(selectors:string):V | null => parent.querySelector(selectors),\n    get width():number {\n      const w = parent.getAttributeNS(null, `width`);\n      if (w === null) return 0;\n      return parseFloat(w);\n    },\n    set width(width:number) {\n      parent.setAttributeNS(null, `width`, width.toString());\n    },\n    get parent():SVGElement {\n      return parent;\n    },\n    get height():number {\n      const w = parent.getAttributeNS(null, `height`);\n      if (w === null) return 0;\n      return parseFloat(w);\n    },\n    set height(height:number) {\n      parent.setAttributeNS(null, `height`, height.toString());\n    },\n    clear: () => {\n      while (parent.firstChild) {\n        parent.removeChild(parent.lastChild as HTMLElement);\n      }\n    }\n  };\n  return o;\n};\n\n","\r\nimport {createOrResolve, MarkerOpts, createEl, DrawingOpts, applyOpts} from './Svg.js';\r\n\r\nexport const createMarker = (id:string, opts:MarkerOpts, childCreator?:()=>SVGElement):SVGMarkerElement => {\r\n  const m = createEl<SVGMarkerElement>(`marker`, id);\r\n  \r\n  if (opts.markerWidth) m.setAttribute(`markerWidth`, opts.markerWidth?.toString());\r\n  if (opts.markerHeight) m.setAttribute(`markerHeight`, opts.markerHeight?.toString());\r\n  if (opts.orient) m.setAttribute(`orient`, opts.orient.toString());\r\n  else m.setAttribute(`orient`, `auto-start-reverse`);\r\n\r\n  if (opts.viewBox) m.setAttribute(`viewBox`, opts.viewBox.toString());\r\n  if (opts.refX) m.setAttribute(`refX`, opts.refX.toString());\r\n  if (opts.refY) m.setAttribute(`refY`, opts.refY.toString());\r\n\r\n  if (childCreator) {\r\n    const c = childCreator();\r\n    m.appendChild(c);\r\n  }\r\n  return m;\r\n};\r\n\r\nexport const markerPrebuilt = (elem: SVGElement | null, opts: MarkerOpts, _context: DrawingOpts): string => {\r\n  if (elem === null) return `(elem null)`;\r\n\r\n  const parent = elem.ownerSVGElement;\r\n  if (parent === null) throw new Error(`parent for elem is null`);\r\n  const defsEl = createOrResolve<SVGDefsElement>(parent, `defs`, `defs`);\r\n\r\n  //eslint-disable-next-line functional/no-let\r\n  let defEl = defsEl.querySelector(`#${opts.id}`) as SVGElement | null;\r\n\r\n  if (defEl !== null) {\r\n    return `url(#${opts.id})`;\r\n  }\r\n\r\n  if (opts.id === `triangle`) {\r\n    opts = {...opts, strokeStyle: `transparent`};\r\n    if (!opts.markerHeight) opts = {...opts, markerHeight: 6};\r\n    if (!opts.markerWidth) opts = {...opts, markerWidth: 6};\r\n    if (!opts.refX) opts = {...opts, refX: opts.markerWidth};\r\n    if (!opts.refY) opts = {...opts, refY: opts.markerHeight};\r\n    if (!opts.fillStyle || opts.fillStyle === `none`) opts = {...opts, fillStyle: `black`};\r\n    if (!opts.viewBox) opts = {...opts, viewBox: `0 0 10 10`};\r\n\r\n    defEl = createMarker(opts.id, opts, () => {\r\n      const tri = createEl<SVGPathElement>(`path`);\r\n      tri.setAttribute(`d`, `M 0 0 L 10 5 L 0 10 z`);\r\n      if (opts) applyOpts(tri, opts);\r\n      return tri;\r\n    });\r\n  } else throw new Error(`Do not know how to make ${opts.id}`);\r\n\r\n  //eslint-disable-next-line functional/immutable-data\r\n  defEl.id = opts.id;\r\n  defsEl.appendChild(defEl);\r\n\r\n  return `url(#${opts.id})`;\r\n};\r\n","\nimport { CirclePositioned } from \"../geometry/Circle.js\";\nimport * as Lines from \"../geometry/Line.js\";\nimport * as Points from \"../geometry/Point.js\";\nimport * as Svg from \"./Svg.js\";\nimport { getCssVariable } from \"./Colour.js\";\n//import {Palette} from \".\";\n\n\nconst numOrPercentage = (v:number):string => {\n  if (v >= 0 && v <= 1) return (v * 100) + `%`;\n  return v.toString();\n};\n\n/**\n * Creates and adds an SVG path element\n * @example\n * ```js\n * const paths = [\n *  `M300,200`,\n *  `a25,25 -30 0,1 50, -25 l 50,-25`\n * ]\n * const pathEl = path(paths, parentEl);\n * ```\n * @param svgOrArray Path syntax, or array of paths. Can be empty if path data will be added later\n * @param parent SVG parent element\n * @param opts Options Drawing options\n * @returns \n */\nexport const path = (svgOrArray:string | readonly string[], parent:SVGElement, opts?:Svg.PathDrawingOpts, queryOrExisting?:string | SVGPathElement):SVGPathElement => {\n  const elem = Svg.createOrResolve<SVGPathElement>(parent, `path`, queryOrExisting);\n  const svg = typeof svgOrArray === `string` ? svgOrArray : svgOrArray.join(`\\n`);\n\n  elem.setAttributeNS(null, `d`, svg);\n  parent.appendChild(elem);\n  return pathUpdate(elem, opts);\n};\n\nexport const pathUpdate = (elem:SVGPathElement, opts?:Svg.PathDrawingOpts) => {\n  if (opts) Svg.applyOpts(elem, opts);\n  if (opts) Svg.applyStrokeOpts(elem, opts);\n  return elem;\n};\n\n/**\n * Updates an existing `SVGCircleElement` with potentially updated circle data and drawing options\n * @param elem Element\n * @param circle Circle\n * @param opts Drawing options\n * @returns SVGCircleElement\n */\nexport const circleUpdate = (elem:SVGCircleElement, circle:CirclePositioned, opts?:Svg.CircleDrawingOpts) => {\n  elem.setAttributeNS(null, `cx`, circle.x.toString());\n  elem.setAttributeNS(null, `cy`, circle.y.toString());\n  elem.setAttributeNS(null, `r`, circle.radius.toString());\n  if (opts) Svg.applyOpts(elem, opts);\n  if (opts) Svg.applyStrokeOpts(elem, opts);\n\n  return elem;\n};\n\n/**\n * Creates or reuses a `SVGCircleElement`.\n * \n * To update an existing element, use `circleUpdate`\n * @param circle \n * @param parent \n * @param opts \n * @param queryOrExisting \n * @returns \n */\nexport const circle = (circle:CirclePositioned, parent:SVGElement, opts?:Svg.CircleDrawingOpts, queryOrExisting?:string | SVGCircleElement):SVGCircleElement => {\n  const p = Svg.createOrResolve<SVGCircleElement>(parent, `circle`, queryOrExisting);\n  return circleUpdate(p, circle, opts);\n};\n\n/**\n * Creates or resuses a `SVGGElement` (group)\n * \n * To update an existing elemnet, use `groupUpdate`\n * @param children \n * @param parent \n * @param queryOrExisting \n * @returns \n */\nexport const group = (children:readonly SVGElement[], parent:SVGElement, queryOrExisting?:string | SVGGElement):SVGGElement => {\n  const p = Svg.createOrResolve<SVGGElement>(parent, `g`, queryOrExisting);\n  return groupUpdate(p, children);\n};\n\nexport const groupUpdate = (elem:SVGGElement, children:readonly SVGElement[]) => {\n  for (const c of children) {\n    if (c.parentNode !== elem) {\n      elem.appendChild(c);\n    }\n  }\n\n  return elem;\n};\n\n/**\n * Creates or reuses a SVGLineElement.\n * \n * @param line \n * @param parent \n * @param opts \n * @param queryOrExisting \n * @returns \n */\nexport const line = (line:Lines.Line, parent:SVGElement, opts?:Svg.LineDrawingOpts, queryOrExisting?:string | SVGLineElement):SVGLineElement => {\n  const lineEl = Svg.createOrResolve<SVGLineElement>(parent, `line`, queryOrExisting);\n  return lineUpdate(lineEl, line, opts);\n};\n\n/**\n * Updates a SVGLineElement instance with potentially changed line and drawing data\n * @param lineEl\n * @param line \n * @param opts \n * @returns \n */\nexport const lineUpdate = (lineEl:SVGLineElement, line:Lines.Line, opts?:Svg.LineDrawingOpts) => {\n  lineEl.setAttributeNS(null, `x1`, line.a.x.toString());\n  lineEl.setAttributeNS(null, `y1`, line.a.y.toString());\n  lineEl.setAttributeNS(null, `x2`, line.b.x.toString());\n  lineEl.setAttributeNS(null, `y2`, line.b.y.toString());\n  if (opts) Svg.applyOpts(lineEl, opts);\n  if (opts) Svg.applyPathOpts(lineEl, opts);\n  if (opts) Svg.applyStrokeOpts(lineEl, opts);\n  return lineEl;\n};\n\n/**\n * Updates an existing SVGTextPathElement instance with text and drawing options\n * @param el \n * @param text \n * @param opts \n * @returns \n */\nexport const textPathUpdate = (el:SVGTextPathElement, text?:string, opts?:Svg.TextPathDrawingOpts) => {\n  if (opts?.method) el.setAttributeNS(null, `method`, opts.method);\n  if (opts?.side) el.setAttributeNS(null, `side`, opts.side);\n  if (opts?.spacing) el.setAttributeNS(null, `spacing`, opts.spacing);\n  if (opts?.startOffset) {\n    el.setAttributeNS(null, `startOffset`, numOrPercentage(opts.startOffset));\n  }\n  if (opts?.textLength) el.setAttributeNS(null, `textLength`, numOrPercentage(opts.textLength));\n\n  if (text) {\n    //eslint-disable-next-line functional/immutable-data\n    el.textContent = text;\n  }\n  if (opts) Svg.applyOpts(el, opts);\n  if (opts) Svg.applyStrokeOpts(el, opts);\n  return el;\n};\n\n/**\n * Creates or reuses a SVGTextPathElement.\n * @param pathRef \n * @param text \n * @param parent \n * @param opts \n * @param queryOrExisting \n * @returns \n */\nexport const textPath = (pathRef:string, text:string, parent:SVGElement, opts?:Svg.TextPathDrawingOpts, queryOrExisting?:string | SVGTextPathElement):SVGTextPathElement => {\n  const textEl = Svg.createOrResolve<SVGTextElement>(parent, `text`, queryOrExisting + `-text`);\n  // Update text properties, but don't pass in position or text\n  textUpdate(textEl, undefined, undefined, opts);\n\n  const p = Svg.createOrResolve<SVGTextPathElement>(textEl, `textPath`, queryOrExisting);\n  p.setAttributeNS(null, `href`, pathRef);\n  return textPathUpdate(p, text, opts);\n};\n\n/**\n * Updates an existing SVGTextElement instance with position, text and drawing options\n * @param el \n * @param pos \n * @param text \n * @param opts \n * @returns \n */\nexport const textUpdate = (el:SVGTextElement, pos?:Points.Point, text?:string, opts?:Svg.TextDrawingOpts) => {\n  if (pos) {\n    el.setAttributeNS(null, `x`, pos.x.toString());\n    el.setAttributeNS(null, `y`, pos.y.toString());\n  }\n  if (text) {\n    //eslint-disable-next-line functional/immutable-data\n    el.textContent = text;\n  }\n\n  if (opts) {\n    Svg.applyOpts(el, opts);\n    if (opts) Svg.applyStrokeOpts(el, opts);\n\n    if (opts.anchor) el.setAttributeNS(null, `text-anchor`, opts.anchor);\n    if (opts.align) el.setAttributeNS(null, `alignment-baseline`, opts.align);\n\n    const userSelect = opts.userSelect ?? true;\n\n    if (!userSelect) {\n      //eslint-disable-next-line functional/immutable-data\n      el.style.userSelect = `none`;\n      //eslint-disable-next-line functional/immutable-data\n      el.style.webkitUserSelect = `none`;\n    }\n  }\n  return el;\n};\n\n/**\n * Creates or reuses a SVGTextElement\n * @param pos Position of text\n * @param text Text\n * @param parent \n * @param opts \n * @param queryOrExisting \n * @returns \n */\nexport const text = (text:string, parent:SVGElement, pos?:Points.Point, opts?:Svg.TextDrawingOpts, queryOrExisting?:string | SVGTextElement):SVGTextElement => {\n  const p = Svg.createOrResolve<SVGTextElement>(parent, `text`, queryOrExisting);\n  return textUpdate(p, pos, text, opts);\n};\n\n/**\n * Creates a square grid based at a center point, with cells having `spacing` height and width.\n * \n * It fits in as many cells as it can within `width` and `height`.\n * \n * Returns a SVG group, consisting of horizontal and vertical lines\n * @param parent Parent element\n * @param center Center point of grid\n * @param spacing Width/height of cells\n * @param width How wide grid should be\n * @param height How high grid should be\n * @param opts \n */\nexport const grid = (parent:SVGElement, center:Points.Point, spacing:number, width:number, height:number, opts:Svg.LineDrawingOpts = {}) => {\n  if (!opts.strokeStyle) opts = { ...opts, strokeStyle: getCssVariable(`bg-dim`, `silver`) };\n  if (!opts.strokeWidth) opts = { ...opts, strokeWidth: 1 };\n\n  const g = Svg.createEl<SVGGElement>(`g`);\n  Svg.applyOpts(g, opts);\n  Svg.applyPathOpts(g, opts);\n  Svg.applyStrokeOpts(g, opts);\n\n  // Horizontals\n  //eslint-disable-next-line functional/no-let\n  let y = 0;\n  while (y < height) {\n    const horiz = Lines.fromNumbers(0, y, width, y);\n    line(horiz, g);\n    y += spacing;\n  }\n\n  // Verticals\n  //eslint-disable-next-line functional/no-let\n  let x = 0;\n  while (x < width) {\n    const vert = Lines.fromNumbers(x, 0, x, height);\n    line(vert, g);\n    x += spacing;\n  }\n  parent.appendChild(g);\n  return g;\n};\n","/* eslint-disable */\r\nimport { minMaxAvg } from '../collections/NumericArrays.js';\r\nimport { CircularArray, MapOfMutable } from '../collections/Interfaces.js';\r\nimport { mapCircularMutable, mapArray} from \"../collections/MapMultiMutable.js\"\r\n\r\nimport { Point, subtract as pointSubtract} from \"../geometry/Point.js\";\r\nimport { resolveEl, parentSizeCanvas } from \"../dom/Util.js\";\r\nimport {Rect} from '../geometry/Rect.js';\r\nimport {Colour, Drawing} from './index.js';\r\n\r\nexport type Plotter = {\r\n  add(value:number, series?:string, skipDrawing?:boolean):void\r\n  drawValue(index:number):void\r\n  /**\r\n   * Draws current data. Useful if skipDrawing was true for earlier add() calls.\r\n   */\r\n  draw():void\r\n  clear():void\r\n  dispose():void\r\n}\r\n\r\n/**\r\n * Series\r\n */\r\nexport type Series = {\r\n  min:number,\r\n  max:number,\r\n  range:number,\r\n  name:string,\r\n  colour:string,\r\n  lastValue?:number,\r\n  hoverValue?:number\r\n};\r\n\r\n/**\r\n * Drawing options\r\n */\r\nexport type DrawingOpts = PlotOpts & {\r\n  x:Axis\r\n  y:Axis\r\n  ctx: CanvasRenderingContext2D\r\n  textHeight: number\r\n  capacity:number\r\n  coalesce:boolean\r\n  margin:number\r\n  canvasSize:Rect\r\n  clearCanvas:boolean\r\n  translucentPlot?:boolean\r\n  highlightIndex?:number\r\n  leadingEdgeDot:boolean\r\n  debug:boolean\r\n  digitsPrecision:number\r\n  lineWidth:number\r\n  defaultSeriesColour: string\r\n  defaultSeriesVariable?: string\r\n  showLegend:boolean,\r\n  pointer: {x:number, y:number}\r\n}\r\n\r\n/**\r\n * Properties for an axis\r\n */\r\nexport type Axis = {\r\n  allowedSeries?:string[]\r\n  /**\r\n   * Name of axis, eg `x`\r\n   */\r\n  name:string,\r\n  /**\r\n   * Colour to use for axis labels\r\n   */\r\n  colour?:string,\r\n  /**\r\n   * Forced scale for values\r\n   */\r\n  scaleRange?:[number,number],\r\n  /**\r\n   * Forced range for labelling, by default\r\n   * uses scaleRange\r\n   */\r\n  labelRange?:[number,number],\r\n  /**\r\n   * Width of axis line\r\n   */\r\n  lineWidth:number,\r\n  /**\r\n   * How line ends\r\n   */\r\n  endWith: `none` | `arrow`,\r\n  /**\r\n   * Where to place the name of the axis\r\n   */\r\n  namePosition: `none` | `end` | `side`,\r\n  /**\r\n   * Width for y axis, height for x axis\r\n   */\r\n  textSize: number,\r\n  /**\r\n   * If true, axis labels (ie numeric scale) are shown. Default: true\r\n   */\r\n  showLabels:boolean,\r\n  /**\r\n   * If true, a line is drawn to represent axis. Default: true\r\n   */\r\n  showLine:boolean\r\n}\r\n\r\nexport type SeriesColours = {\r\n  [id:string]: string|undefined\r\n};\r\n\r\n/**\r\n * Plotter options\r\n */\r\nexport type PlotOpts = {\r\n  debug?:boolean,\r\n  seriesColours?:SeriesColours,\r\n  /**\r\n   * Default: 2\r\n   */\r\n  digitsPrecision?:number,\r\n  x?:Axis,\r\n  y?:Axis,\r\n  plotSize?:Rect\r\n  autoSizeCanvas?:boolean\r\n  style?:`connected` | `dots` | `none`\r\n  //palette?: Palette.Palette\r\n  /**\r\n   * Number of items to keep in the circular array\r\n   * Default: 10\r\n   */\r\n  capacity?:number\r\n  //showYAxis?:boolean\r\n  //showXAxis?:boolean\r\n  //yAxes?: string[]|string\r\n  textHeight?: number\r\n  /**\r\n   * Width of plotted line\r\n   */\r\n  lineWidth?:number\r\n  /**\r\n   * If true, sub-pixel data points are ignored\r\n   */\r\n  coalesce?:boolean\r\n  /**\r\n   * Fixed range to scale Y values. By default normalises values\r\n   * as they come in. This will also determine the y-axis labels and drawing\r\n   */\r\n  //fixedRange?:[number,number]\r\n  /**\r\n   * How many horizontal pixels per data point. If unspecified,\r\n   * it will scale based on width of canvas and capacity.\r\n   */\r\n  //dataXScale?:number\r\n  defaultSeriesColour?:string\r\n  defaultSeriesVariable?:string\r\n  showLegend?:boolean\r\n}\r\n\r\nconst piPi = Math.PI *2;\r\n\r\nexport const defaultAxis = (name:string):Axis => ({\r\n  endWith: `none`,\r\n  lineWidth: 1,\r\n  namePosition: 'none',\r\n  name: name,\r\n  showLabels: name === `y`,\r\n  showLine: true,\r\n  // For y axis, it's the width, for x axis it's the text height\r\n  textSize: name === `y` ? 20 : 10\r\n });\r\n\r\nexport const calcScale = (buffer:BufferType, drawingOpts:DrawingOpts, seriesColours?:SeriesColours) => {\r\n  const seriesNames = buffer.keys();\r\n  const scales:Series[] = [];\r\n  seriesNames.forEach(s => {\r\n    const series = buffer.get(s);\r\n    if (series === undefined) return;\r\n\r\n    let {min,max} = minMaxAvg(series);\r\n    let range = max - min;\r\n    \r\n    let colour;\r\n    if (seriesColours !== undefined) {\r\n      colour = seriesColours[s];\r\n    }\r\n    if (colour == undefined) {\r\n      if (drawingOpts.defaultSeriesVariable) colour = Colour.getCssVariable(`accent`, drawingOpts.defaultSeriesColour);\r\n      else colour = drawingOpts.defaultSeriesColour;\r\n    }\r\n\r\n    if (range === 0) {\r\n      range = min;\r\n      min = min - range/2;\r\n      max = max + range/2;\r\n    }\r\n    scales.push({\r\n      min, max, range,\r\n      name: s,\r\n      colour: colour\r\n    })\r\n  });\r\n  return scales;\r\n}\r\n\r\nexport const add = (buffer:BufferType, value:number, series:string = \"\") => {\r\n  buffer.addKeyedValues(series, value);\r\n}\r\n\r\nexport type BufferType = MapOfMutable<number, CircularArray<number>> | MapOfMutable<number, ReadonlyArray<number>>;\r\n\r\nexport const drawValue = (index:number, buffer:BufferType, drawing:DrawingOpts) => {\r\n  const c = {\r\n    ...drawing,\r\n    translucentPlot: true,\r\n    leadingEdgeDot: false\r\n  };\r\n  draw(buffer, c);\r\n  \r\n  drawing =  {\r\n    ...drawing,\r\n    highlightIndex: index,\r\n    leadingEdgeDot: true,\r\n    translucentPlot: false,\r\n    style: `none`,\r\n    clearCanvas: false\r\n  };\r\n  draw(buffer, drawing);\r\n};\r\n\r\nconst scaleWithFixedRange = (buffer:BufferType, range:[number,number], drawing:DrawingOpts) => calcScale(buffer, drawing, drawing.seriesColours).map((s) => ({...s, range: range[1] - range[0], min: range[0], max: range[1]}));\r\n\r\n/**\r\n * Draws a `buffer` of data with `drawing` options.\r\n * \r\n * @param buffer \r\n * @param drawing \r\n */\r\nexport const draw = (buffer:BufferType, drawing:DrawingOpts) => {\r\n  const {x:xAxis, y:yAxis, ctx, canvasSize} = drawing;\r\n  const margin = drawing.margin;\r\n // const cap = drawing.capacity === 0 ? buffer.lengthMax : drawing.capacity;\r\n  const series = drawing.y.scaleRange ? scaleWithFixedRange(buffer, drawing.y.scaleRange, drawing) : calcScale(buffer, drawing, drawing.seriesColours);\r\n\r\n  if (drawing.clearCanvas) ctx.clearRect(0,0,canvasSize.width,canvasSize.height);\r\n  \r\n  if (drawing.debug) {\r\n    ctx.strokeStyle = `orange`;\r\n    ctx.strokeRect(0,0,canvasSize.width, canvasSize.height); \r\n  }\r\n  \r\n  // Move in for margin\r\n  ctx.translate(margin, margin);\r\n  \r\n\r\n  // Calculate/use plot area\r\n  const plotSize = drawing.plotSize ?? plotSizeFromBounds(canvasSize, drawing);\r\n\r\n  // Draw vertical axes\r\n  const axisSize = {height: plotSize.height + margin + margin, width:plotSize.width};\r\n\r\n  if (yAxis.showLabels || yAxis.showLine) {\r\n    // Draw the labels for each series\r\n    series.forEach(s => {\r\n      if (yAxis.allowedSeries !== undefined) {\r\n        if (!yAxis.allowedSeries.includes(s.name)) return;\r\n      }\r\n      drawYSeriesScale(s, axisSize, drawing);\r\n    });\r\n\r\n    // Draw vertical line\r\n    if (series.length > 0 && yAxis.showLine)  drawYLine(axisSize, series[0], drawing);\r\n  }\r\n\r\n  // Draw x/horizontal axis if needed\r\n  if ((xAxis.showLabels || xAxis.showLine) && series.length > 0) {\r\n    const yPos = yAxis.labelRange ? yAxis.labelRange[0] : series[0].min;\r\n    drawXAxis( plotSize.width, calcYForValue(yPos, series[0], plotSize.height)+margin + xAxis.lineWidth, drawing);\r\n  }\r\n\r\n  const plotDrawing = {\r\n    ...drawing,\r\n    plotSize\r\n  };\r\n  \r\n  const ptr = Drawing.translatePoint(ctx, drawing.pointer);\r\n  //console.log(ptr);\r\n\r\n  // Draw data for each series\r\n  series.forEach(s => {\r\n    const data = buffer.getSource(s.name);\r\n    if (data === undefined) return;\r\n    \r\n    let leadingEdgeIndex = (buffer.typeName === `circular`)  ? (data as CircularArray<number>).pointer - 1: data.length -1;\r\n    if (drawing.highlightIndex !== undefined) leadingEdgeIndex = drawing.highlightIndex; \r\n    ctx.save();\r\n    ctx.translate(0, margin + margin);\r\n\r\n    drawSeriesData(s, data, plotSize, plotDrawing, leadingEdgeIndex);\r\n    ctx.restore();\r\n  });\r\n\r\n  if (drawing.showLegend) {\r\n    ctx.save();\r\n    ctx.translate(0, plotSize.height + margin + margin + margin);\r\n    const legendSize = {width: plotSize.width, height: drawing.x.textSize + margin + margin} \r\n    drawLegend(series, drawing, legendSize);\r\n    ctx.restore();\r\n  }\r\n  ctx.resetTransform();\r\n}\r\n\r\n/**\r\n * Draw vertical axis\r\n * @param series \r\n * @param height \r\n * @param drawing \r\n */\r\nconst drawYSeriesScale = (series:Series, plotSize:Rect, drawing:DrawingOpts) => {\r\n  const {ctx, y, digitsPrecision, margin} = drawing;\r\n  const { height} = plotSize;\r\n\r\n  if (drawing.debug) {\r\n    ctx.strokeStyle = `purple`;\r\n    ctx.strokeRect(0,0, y.textSize, height + margin);  \r\n  }\r\n  \r\n  ctx.fillStyle = series.colour.length > 0 ? series.colour : `white`;\r\n\r\n  // Override colour with axis-defined colour\r\n  if (y.colour) ctx.fillStyle = y.colour;\r\n\r\n  // Draw labels\r\n  const min = y.labelRange ? y.labelRange[0] : series.min;\r\n  const max = y.labelRange ? y.labelRange[1] : series.max;\r\n  const range = y.labelRange ? max - min : series.range;\r\n  const mid = min + (range / 2)\r\n  const halfHeight = drawing.textHeight / 2;\r\n\r\n  ctx.textBaseline = `top`;\r\n  ctx.fillText(min.toFixed(digitsPrecision), 0, calcYForValue(min, series, height)-halfHeight);\r\n  ctx.fillText(mid.toFixed(digitsPrecision), 0, calcYForValue(mid, series, height)-halfHeight);\r\n  ctx.fillText(max.toFixed(digitsPrecision), 0, calcYForValue(max, series, height) - margin);\r\n\r\n  ctx.translate(y.textSize + margin, 0);\r\n}\r\n\r\nconst drawYLine = (plotSize:Rect, series:Series, drawing:DrawingOpts) => {\r\n  if (series === undefined) throw new Error(`series undefined`);\r\n  const {ctx, y} = drawing;\r\n  const { height} = plotSize;\r\n  \r\n  const min = y.labelRange ? y.labelRange[0] : series.min;\r\n  const max = y.labelRange ? y.labelRange[1] : series.max;\r\n\r\n  const minPos = calcYForValue(min, series, height);\r\n  const maxPos = calcYForValue(max, series, height);\r\n\r\n  // Draw line\r\n  ctx.translate(y.lineWidth, 0);\r\n  ctx.lineWidth = y.lineWidth;\r\n  ctx.beginPath();\r\n  ctx.moveTo(0, minPos);\r\n  ctx.lineTo(0, maxPos);\r\n  ctx.strokeStyle = series.colour;\r\n  if (y.colour) ctx.strokeStyle = y.colour;\r\n  ctx.stroke();\r\n  ctx.translate(y.lineWidth, 0);\r\n};\r\n\r\nconst drawLegend = (series:Series[], drawing:DrawingOpts, size:{width:number, height:number}) => {\r\n  const {ctx} = drawing;\r\n  const lineSampleWidth = 10;\r\n\r\n  let x = 0;\r\n  const lineY = drawing.margin*3;\r\n  const textY = drawing.margin;\r\n\r\n  ctx.lineWidth = drawing.lineWidth;\r\n\r\n  series.forEach(s=> {\r\n    ctx.moveTo(x, lineY);\r\n    ctx.strokeStyle = s.colour;\r\n    ctx.lineTo(x+lineSampleWidth, lineY);\r\n    ctx.stroke();\r\n    x += lineSampleWidth + drawing.margin;\r\n    \r\n    let label = s.name;\r\n    if (s.lastValue) label += ' ' + s.lastValue.toFixed(drawing.digitsPrecision);\r\n    const labelSize = ctx.measureText(label);\r\n\r\n    ctx.fillStyle = s.colour;\r\n    ctx.fillText(label, x, textY);\r\n    x += labelSize.width;\r\n  });\r\n\r\n  \r\n}\r\n\r\nconst drawXAxis = ( width:number, yPos:number, drawing:DrawingOpts) => {\r\n  const {ctx, x, y} = drawing;\r\n\r\n  if (!x.showLine) return;\r\n\r\n  if (x.colour) ctx.strokeStyle = x.colour;\r\n  ctx.lineWidth = x.lineWidth;\r\n  ctx.beginPath();\r\n\r\n  // Assumes ctx is translated after drawing Y axis\r\n  ctx.moveTo(0, yPos);\r\n  ctx.lineTo(width, yPos);\r\n  ctx.stroke();\r\n\r\n}\r\n\r\n/**\r\n * Draw series data\r\n * @param series \r\n * @param values \r\n * @param plotSize \r\n * @param drawing \r\n */\r\nconst drawSeriesData = (series:Series, values:ArrayLike<number>, plotSize:Rect, drawing:DrawingOpts, leadingEdgeIndex:number) => {\r\n  const {ctx, lineWidth, translucentPlot = false, margin, x:xAxis} = drawing;\r\n  const style = drawing.style ?? `connected`;\r\n  const height = plotSize.height - margin;\r\n\r\n  let dataXScale = 1;\r\n  if (xAxis.scaleRange) {\r\n    const xAxisRange = xAxis.scaleRange[1] - xAxis.scaleRange[0];\r\n    dataXScale = plotSize.width / xAxisRange;\r\n  } else {\r\n    if (drawing.capacity === 0) dataXScale = plotSize.width / values.length;\r\n    else dataXScale = plotSize.width / drawing.capacity;\r\n  }\r\n\r\n  // Step through data faster if per-pixel density is above one\r\n  const incrementBy = drawing.coalesce ? \r\n    dataXScale! < 0 ? Math.floor((1/dataXScale!)) : 1\r\n    : 1;\r\n\r\n  let x = 0;\r\n  let leadingEdge:Point|undefined;\r\n  \r\n  if (drawing.debug) {\r\n    ctx.strokeStyle = `green`;\r\n    ctx.strokeRect(0,0, plotSize.width, plotSize.height);\r\n  }\r\n\r\n  const colourTransform = (c:string) => {\r\n    if (translucentPlot) return Colour.opacity(c, 0.2);\r\n    return c;\r\n  }\r\n\r\n  if (style === `dots`) { \r\n    ctx.fillStyle = colourTransform(series.colour);\r\n  } else if (style === `none`) {\r\n  } else {\r\n    ctx.beginPath();\r\n    ctx.lineWidth = lineWidth;\r\n    ctx.strokeStyle = colourTransform(series.colour);\r\n  } \r\n\r\n  for (let i=0; i<values.length; i += incrementBy) {\r\n    let y = calcYForValue(values[i], series, height) -1;\r\n    \r\n    if (style === `dots`) {\r\n      ctx.beginPath();\r\n      ctx.arc(x, y, lineWidth, 0, piPi);\r\n      ctx.fill();\r\n    } else if (style === `none`) {\r\n    } else  {\r\n      if (i == 0) ctx.moveTo(x, y);\r\n      ctx.lineTo(x, y);\r\n    }\r\n    \r\n    if (i === leadingEdgeIndex) {\r\n      leadingEdge = {x, y};\r\n      series.lastValue = values[i];\r\n    }\r\n    x += dataXScale;\r\n  }\r\n\r\n  if (style === `connected`) {\r\n    ctx.stroke();\r\n  }\r\n\r\n  // Draw a circle at latest data point\r\n  if (leadingEdge !== undefined && drawing.leadingEdgeDot) {\r\n    ctx.beginPath();\r\n    ctx.fillStyle = colourTransform(series.colour);// drawing.palette.getOrAdd(`series${series.name}`));\r\n    ctx.arc(leadingEdge.x, leadingEdge.y, 3, 0, 2 * Math.PI);\r\n    ctx.fill();\r\n  }\r\n}\r\n\r\nconst calcYForValue = (v:number, series:Series, height:number) => (1 - (v - series.min) / series.range) * height ;\r\n\r\n/**\r\n * Calculates lost area, given a margin value, axis settings.\r\n * @param margin \r\n * @param x \r\n * @param y \r\n * @param showLegend \r\n * @returns \r\n */\r\nconst calcSizing = (margin:number, x:Axis, y:Axis, showLegend:boolean) => {\r\n  let fromLeft = margin;\r\n  if (y.showLabels) fromLeft += y.textSize;\r\n  if (y.showLine) fromLeft += y.lineWidth;\r\n  if (y.showLabels || y.showLine) fromLeft += margin + margin;\r\n  let fromRight = margin;\r\n\r\n  let fromTop = margin + margin;\r\n  let fromBottom = margin + margin;\r\n  if (x.showLabels) fromBottom += x.textSize;\r\n  else fromBottom += margin;\r\n  if (x.showLine) fromBottom += x.lineWidth;\r\n  if (x.showLabels || x.showLine) fromBottom += margin;\r\n\r\n  if (showLegend) fromBottom += x.textSize;\r\n\r\n  return {\r\n    left: fromLeft,\r\n    right: fromRight,\r\n    top: fromTop,\r\n    bottom: fromBottom\r\n  };\r\n}\r\n\r\nconst plotSizeFromBounds = (bounds:Rect, opts:{margin:number, y:Axis, x:Axis, showLegend:boolean}):Rect => {\r\n  const { width, height } = bounds;\r\n  const sizing = calcSizing(opts.margin, opts.x, opts.y, opts.showLegend);\r\n  return {\r\n    width: width - sizing.left - sizing.right, \r\n    height: height - sizing.top - sizing.bottom\r\n  }\r\n};\r\n\r\nconst canvasSizeFromPlot = (plot:Rect, opts:{margin:number, y:Axis, x:Axis, showLegend:boolean}):Rect => {\r\n  const { width, height } = plot;\r\n  const sizing = calcSizing(opts.margin, opts.x, opts.y, opts.showLegend);\r\n  return {\r\n    width: width + sizing.left + sizing.right,\r\n    height: height + sizing.top + sizing.bottom\r\n  };\r\n};\r\n\r\n/**\r\n * Creates a simple horizontal data plot within a DIV.\r\n * \r\n * ```\r\n * const p = plot(`#parentDiv`);\r\n * p.add(10);\r\n * p.clear();\r\n * \r\n * // Plot data using series\r\n * p.add(-1, `temp`);\r\n * p.add(0.4, `humidty`);\r\n * ```\r\n * \r\n * Options can be specified to customise plot\r\n * ```\r\n * const p = plot(`#parentDiv`, {\r\n *  capacity: 100,     // How many data points to store (default: 10)\r\n *  showYAxis: false,  // Toggle whether y axis is shown (default: true)\r\n *  lineWidth: 2,      // Width of plot line (default: 2)\r\n *  yAxes:  [`temp`],  // Only show these y axes (by default all are shown)\r\n *  coalesce: true,    // If true, sub-pixel data points are skipped, improving performance for dense plots at the expense of plot precision\r\n * });\r\n * ```\r\n * \r\n * For all `capacity` values other than `0`, a circular array is used to track data. Otherwise an array is used that will\r\n * grow infinitely.\r\n * \r\n * By default, will attempt to use CSS variable `--series[seriesName]` for axis colours.\r\n *  `--series[name]-axis` for titles. Eg `--seriesX`. For data added without a named series,\r\n * it will use `--series` and `--series-axis`.\r\n * @param parentElOrQuery\r\n * @param opts\r\n * @return Plotter instance\r\n */\r\nexport const plot = (parentElOrQuery:string|HTMLElement, opts:PlotOpts):Plotter => {\r\n  if (parentElOrQuery === null) throw new Error(`parentElOrQuery is null. Expected string or element`);\r\n\r\n  const parentEl = resolveEl(parentElOrQuery);\r\n  let canvasEl:HTMLCanvasElement;\r\n  let destroyCanvasEl = true;\r\n  let plotSize:Rect|undefined = opts.plotSize;\r\n  let canvasSize:Rect\r\n  if (parentEl.nodeName === `CANVAS`)  {\r\n    // Use provided canvas\r\n    canvasEl = parentEl as HTMLCanvasElement;  \r\n    destroyCanvasEl = false;\r\n    canvasSize = {width: canvasEl.width, height: canvasEl.height};\r\n  } else {\r\n    // Create a CANVAS that fills parent\r\n    canvasEl = document.createElement(`CANVAS`) as HTMLCanvasElement;\r\n    parentEl.append(canvasEl);\r\n    plotSize = opts.plotSize;\r\n    canvasSize = {width: canvasEl.width, height: canvasEl.height};\r\n  }\r\n  \r\n  const pointer = {x:0, y:0};\r\n\r\n  const onPointerMove = (evt:PointerEvent) => {\r\n    pointer.x = evt.offsetX;\r\n    pointer.y = evt.offsetY;\r\n  };\r\n\r\n  canvasEl.addEventListener(`pointermove`, onPointerMove);\r\n\r\n  const ctx = canvasEl.getContext(`2d`)!;\r\n\r\n  const capacity = opts.capacity ?? 10;\r\n  const buffer = capacity > 0 ? mapCircularMutable<number>({ capacity }) : mapArray<number>();\r\n  const metrics = ctx.measureText('Xy');\r\n  const coalesce = opts.coalesce ?? true;\r\n\r\n  // Sanity-check\r\n  if (ctx === null) throw new Error(`Drawing context not available`);\r\n\r\n  let xAxis = defaultAxis(`x`);\r\n  if (opts.x) xAxis = {...xAxis, ...opts.x};\r\n  let yAxis = defaultAxis(`y`);\r\n  if (opts.y) yAxis = {...yAxis, ...opts.y};\r\n\r\n  let drawingOpts:DrawingOpts = {\r\n    ...opts,\r\n    y: yAxis,\r\n    x: xAxis,\r\n    pointer: pointer,\r\n    capacity, coalesce, plotSize, canvasSize, ctx,\r\n    textHeight: opts.textHeight ?? metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent,\r\n    style: opts.style ?? `connected`,\r\n    defaultSeriesColour: opts.defaultSeriesColour ?? `yellow`,\r\n    margin: 3,\r\n    clearCanvas:true,\r\n    leadingEdgeDot:true,\r\n    debug: opts.debug ?? false,\r\n    digitsPrecision: opts.digitsPrecision ?? 2,\r\n    lineWidth: opts.lineWidth ?? 2,\r\n    showLegend: opts.showLegend ?? false\r\n  };\r\n\r\n  if (plotSize) {\r\n    // Size canvas based on given plot size\r\n    const canvasSize = canvasSizeFromPlot(plotSize, drawingOpts);\r\n    canvasEl.width = canvasSize.width;\r\n    canvasEl.height = canvasSize.height;\r\n\r\n    drawingOpts.canvasSize = canvasSize;\r\n  }\r\n\r\n  if (opts.autoSizeCanvas) {\r\n    parentSizeCanvas(canvasEl, (args) => {\r\n      const bounds = args.bounds;\r\n      drawingOpts = {\r\n        ...drawingOpts, \r\n        plotSize: plotSizeFromBounds(bounds, drawingOpts),\r\n        canvasSize: bounds\r\n      };\r\n      draw(buffer, drawingOpts);\r\n\r\n    });\r\n  }\r\n\r\n  return {\r\n    drawValue: (index:number) => {\r\n      drawValue(index, buffer, drawingOpts);\r\n    },\r\n    dispose: () => {\r\n      canvasEl.removeEventListener(`pointermove`, onPointerMove);\r\n      if (destroyCanvasEl) canvasEl.remove();    \r\n    },\r\n    add: (value:number, series = \"\", skipDrawing = false) => {\r\n      add(buffer, value, series);\r\n      if (skipDrawing) return;\r\n      draw(buffer, drawingOpts)\r\n    },\r\n    draw: () => {\r\n      draw(buffer, drawingOpts)\r\n    },\r\n    clear:() => {\r\n      buffer.clear();\r\n    }\r\n  }\r\n}\r\n\r\n","/* eslint-disable */\nimport {minIndex} from '../collections/NumericArrays.js';\nimport {PointCalculableShape} from '../geometry/Point.js';\nimport {Arrays} from '../collections/index.js';\nimport { Points, Rects} from '../geometry/index.js';\nimport {clamp, flip,  scale} from '../data/index.js';\nimport { parentSizeCanvas } from \"../dom/Util.js\";\nimport * as Sg from './SceneGraph.js';\n\nimport {textWidth} from './Drawing.js';\nimport {getFieldPaths, getFieldByPath, ifNaN} from '../Util.js';\nimport {number as guardNumber} from '../Guards.js';\n\n/**\n * A data source\n */\nexport interface DataSource {\n  dirty:boolean\n  type: string\n  get range():DataRange\n  add(value:number):void\n  clear():void\n}\n\n/**\n * Plot options\n */\nexport type Opts = {\n  /**\n   * If true, Canvas will be resized to fit parent\n   */\n  autoSize?:boolean\n  /**\n   * Colour for axis lines & labels\n   */\n  axisColour?:string\n  /**\n   * Width for axis lines\n   */\n  axisWidth?:number\n}\n\n/**\n * Series options\n */\nexport type SeriesOpts = {\n  /**\n   * Colour for series\n   */\n  colour:string\n  /**\n   * Visual width/height (depends on drawingStyle)\n   */\n  width?:number\n  /**\n   * How series should be rendered\n   */\n  drawingStyle?: `line`|`dotted`|`bar`\n  /**\n   * Preferred data range\n   */\n  axisRange?:DataRange\n  /**\n   * If true, range will stay at min/max, rather than continuously adapting\n   * to the current data range.\n   */\n  visualRangeStretch?:boolean\n};\n\nexport type DataPoint = {\n  value:number\n  index:number\n  title?:string\n};\n\n\nexport type DataHitPoint = (pt:Points.Point) => [point: DataPoint|undefined, distance: number];\n\nclass ArrayDataSource implements DataSource {\n  data:number[];\n  series:Series;\n  dirty = false;\n  type = `array`;\n\n  _range:Arrays.MinMaxAvgTotal|undefined;\n  \n  constructor(series:Series) {\n    this.series = series;\n    this.data = [];\n    this.dirty = true;\n  }\n\n  clear() {\n    this.set([]);\n    this._range = undefined;\n  }\n\n  set(data:number[]) {\n    this.data = data;\n    this.dirty = true;\n  }\n\n  get length():number {\n    return this.data.length;\n  }\n\n  get range():DataRange {\n    if (!this.dirty && this._range !== undefined) return this._range;\n    this.dirty = false;\n    this._range = Arrays.minMaxAvg(this.data);\n    return {...this._range, changed: true};\n  }\n\n  add(value:number) {\n    this.data = [...this.data, value];\n    this.dirty = true;\n  }\n}\n\nclass StreamingDataSource extends ArrayDataSource {\n  desiredDataPointMinWidth = 5;\n  \n  constructor(series:Series) {\n    super(series);\n  }\n\n  add(value:number) {\n    const lastWidth = this.series.lastPxPerPt;\n    if (lastWidth > -1 && lastWidth < this.desiredDataPointMinWidth) { \n      // Remove older data\n      const pts = Math.floor(this.desiredDataPointMinWidth / lastWidth);\n      const d = [...this.data.slice(pts), value];\n      super.set(d);\n    } else super.add(value);\n  }\n}\n\nexport type DataRange = {\n  min:number,\n  max:number,\n  changed?:boolean\n}\n\nexport class Series {\n  name:string;\n  colour:string;\n  source: DataSource\n  drawingStyle:`line`|`dotted`|`bar`;\n  width = 3;\n  dataHitPoint: DataHitPoint|undefined;\n  tooltip?:string;\n  precision = 2;\n  \n  readonly axisRange:DataRange\n\n  // How many pixels wide per data point on last draw\n  lastPxPerPt = -1;\n\n  protected _visualRange:DataRange;\n  protected _visualRangeStretch:boolean;\n\n  constructor(name:string, sourceType:`array`|`stream`, private plot:Plot, opts:SeriesOpts) {\n    this.name = name;\n\n    this.drawingStyle = opts.drawingStyle ?? `line`;\n    this.colour = opts.colour;\n    this.width = opts.width ?? 3;\n    this.axisRange = opts.axisRange ?? {min:Number.NaN,max:Number.NaN};\n    this._visualRange = {...this.axisRange};\n    this._visualRangeStretch = opts.visualRangeStretch ?? true;\n\n    if (sourceType === `array`) {\n      this.source = new ArrayDataSource(this);\n    } else if (sourceType === `stream`) {\n      this.source = new StreamingDataSource(this);\n    } else throw new Error(`Unknown sourceType. Expected array|stream`);\n  }\n\n  formatValue(v:number) {\n    return v.toFixed(this.precision);\n  }\n\n  get visualRange():DataRange {\n    let vr = this._visualRange;\n    const sourceRange = this.source.range;\n    let changed = false;\n    \n    if (sourceRange.changed) { \n      if (this._visualRangeStretch) {\n        // Stretch range to lowest/highest-seen min/max\n        const rmin = Math.min(ifNaN(vr.min, sourceRange.min), sourceRange.min);\n        const rmax = Math.max(ifNaN(vr.max, sourceRange.max), sourceRange.max);\n        if (rmin !== vr.min || rmax !== vr.max) {\n          // Changed\n          vr = {min:rmin, max:rmax};\n          changed = true;\n        }\n      } else {\n        // Use actual range of data\n        if (!isRangeEqual(sourceRange, vr)) {\n          vr = sourceRange;\n          changed = true;\n        }\n      }\n    }\n    this._visualRange = vr;\n    return {...vr, changed};\n  }\n\n  scaleValue(value:number): number {\n    if (this.source === undefined) return value;\n    const r = this.visualRange;\n    if (r.min == r.max) {\n      // No real scale - only received the same value for this series\n      return 0.5;\n    }\n    return scale(value, r.min, r.max);\n  }\n\n  add(value:number) {\n    guardNumber(value, ``, `value`);\n    this.source.add(value);\n    this.plot.plotArea.needsDrawing = true;\n  }\n\n  /**\n   * Clears the underlying source\n   * and sets a flag that the plot area needs redrawing\n   */\n  clear() {\n    this.source.clear();\n    this._visualRange = {...this.axisRange};\n    this.plot.plotArea.needsDrawing = true;\n  }\n}\n\nexport class PlotArea extends Sg.CanvasBox {\n  paddingPx = 3;\n  piPi = Math.PI*2;\n  // If pointer is more than this distance away from a data point, it's ignored\n  pointerDistanceThreshold = 20;\n  lastRangeChange = 0;\n  pointer:Points.Point|undefined;\n\n  constructor(private plot:Plot) {\n    super(plot, plot.canvasEl, `PlotArea`);\n  }\n  \n  clear() {\n    this.lastRangeChange = 0;\n    this.pointer = undefined;\n  }\n\n  protected measureSelf(opts: Sg.MeasureState, parent?: Sg.Measurement): Rects.Rect | Rects.RectPositioned | undefined {\n    const axisY = opts.getSize(`AxisY`);\n    if (axisY === undefined) return;\n    \n    const legend = opts.getSize(`Legend`);\n    if (legend === undefined) return;\n\n    const axisX = opts.getSize(`AxisX`);\n    if (axisX === undefined) return;\n\n    return {\n      x: axisY.width,\n      y: 0,\n      width: opts.bounds.width - axisY.width,\n      height: opts.bounds.height - legend.height - axisX.height,\n    };\n  }\n\n  protected onNotify(msg: string, source: Sg.Box): void {\n    if (msg === `measureApplied` && source === this.plot.axisY) this._needsLayout = true;  \n    if (msg === `measureApplied` && source === this.plot.legend) this._needsLayout = true;  \n\n  }\n\n  // protected onClick(p: Points.Point): void {\n  //   this.plot.frozen = !this.plot.frozen;    \n  // }\n\n  protected onPointerLeave(): void {\n    const series = [...this.plot.series.values()];\n    series.forEach(series => {\n      series.tooltip = undefined;\n    });\n    this.pointer = undefined;\n    this.plot.legend.onLayoutNeeded();\n\n  }\n\n  protected onPointerMove(p: Points.Point): void {\n    this.pointer = p;\n    this.plot.legend.onLayoutNeeded();\n  }\n\n  protected measurePreflight(): void {\n    this.updateTooltip();\n      \n  }\n\n  updateTooltip() {\n    const p = this.pointer;\n    if (p === undefined) return;\n    const series = [...this.plot.series.values()];\n    series.forEach(series => {\n      if (p === undefined) { \n        series.tooltip = undefined;\n        return;\n      }\n      if (series.dataHitPoint === undefined) return;\n      const v = series.dataHitPoint(p);\n      if (v[0] === undefined) return;\n      if (v[1] > this.pointerDistanceThreshold) return; // too far away\n      series.tooltip = series.formatValue(v[0].value);\n      //this.plot.legend.onLayoutNeeded();\n    });\n    this.plot.legend.needsDrawing = true;\n  }\n\n  protected drawSelf(ctx: CanvasRenderingContext2D): void {\n    if (this.plot.frozen) return;\n    const series = this.plot.seriesArray();// [...this.plot.series.values()];\n    ctx.clearRect(0, 0, this.visual.width, this.visual.height);\n\n    series.forEach(series => {      \n      if (series.source.type === `array` || series.source.type === `stream`) {\n        const arraySeries = series.source as ArrayDataSource;\n        if (arraySeries.data === undefined) return;\n        const d = [...arraySeries.data];\n        this.drawDataSet(series, d, ctx);\n      }\n      else console.warn(`Unknown data source type ${series.source.type}`);\n    });\n  }\n\n  computeY(series:Series, rawValue:number) {\n    const s = series.scaleValue(rawValue);\n    return (flip(s)*this.visual.height) + this.paddingPx;\n  }\n\n  drawDataSet(series:Series, d:number[], ctx:CanvasRenderingContext2D): void {\n    const padding = this.paddingPx + series.width;\n    const v = Rects.subtract(this.visual, padding*2, padding*3.5);\n    const pxPerPt = v.width/ d.length;\n    \n    series.lastPxPerPt = pxPerPt;\n    let x = padding;\n    \n    ctx.strokeStyle = series.colour;\n    ctx.lineWidth = series.width;\n    const shapes:(DataPoint & PointCalculableShape)[] = [];\n  \n    series.dataHitPoint = (pt:Points.Point):[DataPoint,number] => {\n      const distances = shapes.map(v => Points.distanceToExterior(pt, v));\n      const i = minIndex(...distances);\n      const closest = shapes[i];\n      if (closest === undefined) [undefined,0];\n      return [closest, distances[i]];\n    };\n\n    if (series.drawingStyle === `line`) {\n      let y = 0;\n      ctx.beginPath();\n\n      for (let i=0;i<d.length;i++) {\n        const scaled = clamp(series.scaleValue(d[i]));\n        y = padding + this.paddingPx + (v.height * flip(scaled));\n        shapes.push({x, y, index:i, value:d[i]});\n\n        if (i == 0) ctx.moveTo(x+pxPerPt/2, y);\n        else ctx.lineTo(x+pxPerPt/2,y);\n       \n        if (y>this.visual.height) console.warn(y + ' h: ' + this.visual.height);\n        x += pxPerPt;\n      }\n      ctx.strokeStyle = series.colour;\n      ctx.stroke();\n    } else if (series.drawingStyle === `dotted`) {\n      let y = 0;\n      ctx.fillStyle = series.colour;\n      for (let i=0;i<d.length;i++) {\n        const scaled = series.scaleValue(d[i]);\n        y = padding + (v.height * flip(scaled));\n        ctx.beginPath();\n        ctx.arc(x + pxPerPt/2, y, series.width, 0, this.piPi);\n        ctx.fill();\n        shapes.push({radius: series.width, x, y, index:i, value: d[i]});\n        x += pxPerPt;\n      }\n    } else if (series.drawingStyle === `bar`) {\n      ctx.fillStyle = series.colour;\n      const interBarPadding = Math.ceil(pxPerPt*0.1);\n      for (let i=0;i<d.length;i++) {\n        const scaled = series.scaleValue(d[i]);\n        const h = (v.height) * scaled;\n        const r = {\n          x: x + interBarPadding,\n          y: v.height - h + padding,\n          width: pxPerPt-interBarPadding,\n          height: h,\n          index: i,\n          value: d[i]\n        };\n        ctx.fillRect(r.x, r.y, r.width, r.height);\n        shapes.push(r);\n        x += pxPerPt;\n      }\n    }\n  }\n}\n\nexport class Legend extends Sg.CanvasBox {\n  sampleSize = {width:10, height: 10};\n  padding = 3;\n  widthSnapping = 20;\n\n  constructor(private plot:Plot) {\n    super(plot, plot.canvasEl, `Legend`);\n  }\n\n  clear() {\n  }\n\n  protected measureSelf(opts: Sg.MeasureState, parent?: Sg.Measurement): Rects.Rect | Rects.RectPositioned | undefined {\n    const yAxis = opts.measurements.get(`AxisY`);\n    const sample = this.sampleSize;\n    const widthSnapping= this.widthSnapping;\n    const padding = this.padding;\n    const ctx = (opts as Sg.CanvasMeasureState).ctx;\n    if (yAxis === undefined) return;\n\n    const usableWidth = opts.bounds.width - yAxis.size.width;\n\n    const series = this.plot.seriesArray();\n    let width = padding;\n    for (let i=0;i<series.length;i++) {\n      width += sample.width + padding;\n      width += textWidth(ctx, series[i].name, padding, widthSnapping);\n      width += textWidth(ctx, series[i].tooltip, padding, widthSnapping);\n     }\n\n    const rows = Math.max(1, Math.ceil(width / usableWidth));\n    const h = rows * (this.sampleSize.height + this.padding + this.padding);\n    return {\n      x: yAxis.size.width,\n      y: opts.bounds.height - h,\n      width: usableWidth,\n      height: h\n    };\n  }\n    \n  protected drawSelf(ctx: CanvasRenderingContext2D): void {\n    const series = this.plot.seriesArray();\n    const sample = this.sampleSize;\n    const padding = this.padding;\n    const widthSnapping= this.widthSnapping;\n\n    let x = padding;\n    let y = padding;\n    \n    ctx.clearRect(0, 0, this.visual.width, this.visual.height);\n\n    for (let i=0;i<series.length;i++) {\n      const s = series[i];\n      ctx.fillStyle = s.colour;\n      ctx.fillRect(x, y, sample.width, sample.height);\n      x += sample.width + padding;\n      ctx.textBaseline = `middle`;\n      \n      ctx.fillText(s.name, x, y + (sample.height/2));\n      x += textWidth(ctx, s.name, padding, widthSnapping);\n      \n      if (s.tooltip) {\n        ctx.fillStyle = this.plot.axisColour;\n        ctx.fillText(s.tooltip, x, y+ (sample.height/2));\n        x += textWidth(ctx, s.tooltip, padding, widthSnapping);\n      }\n      x += padding;\n      if (x > this.visual.width - 100) {\n        x = padding;\n        y += sample.height + padding + padding;\n      }\n    }\n  }\n\n  protected onNotify(msg: string, source: Sg.Box): void {\n    if (msg === `measureApplied` && source === (this._parent as Plot).axisY) this._needsLayout = true;  \n  }\n}\n\nexport class AxisX extends Sg.CanvasBox {\n  paddingPx = 2;\n  colour?:string;\n\n  constructor(private plot:Plot) {\n    super(plot, plot.canvasEl,`AxisX`);\n  }\n\n  clear() {\n  }\n\n  protected onNotify(msg: string, source: Sg.Box): void {\n    if (msg === `measureApplied` && source === this.plot.axisY) this._needsLayout = true;  \n    if (msg === `measureApplied` && source === this.plot.legend) {\n      this.onLayoutNeeded();\n    }  \n  }\n\n  protected drawSelf(ctx: CanvasRenderingContext2D): void {\n    const plot = this.plot;\n    const v = this.visual;\n    const width = plot.axisWidth;\n\n    const colour = this.colour ?? plot.axisColour;\n    ctx.strokeStyle = colour;\n\n    ctx.clearRect(0,0,v.width, v.height);\n    ctx.beginPath();\n    ctx.lineWidth = width;    \n    ctx.moveTo(0, width/2);\n    ctx.lineTo(v.width, width/2);\n    ctx.stroke();\n  }\n\n  protected measureSelf(opts: Sg.MeasureState, parent?: Sg.Measurement): Rects.Rect | Rects.RectPositioned | undefined {\n    const plot = this.plot;\n    \n    const yAxis = opts.measurements.get(`AxisY`);\n    if (yAxis === undefined) return;\n    \n    const legend = opts.measurements.get(`Legend`);\n    if (legend === undefined) return;\n\n    const h = plot.axisWidth + this.paddingPx;\n    return {\n      x: yAxis.size.width,\n      y: opts.bounds.height - h - legend.size.height,\n      width: opts.bounds.width - yAxis.size.width,\n      height: h\n    }\n  }\n}\n\nconst isRangeEqual = (a:DataRange, b:DataRange) =>  a.max === b.max && a.min === b.min;\nconst isRangeSinglePoint = (a:DataRange) => a.max === a.min;\n\nexport class AxisY extends Sg.CanvasBox {\n  // Number of digits axis will be expected to show as a data legend\n  private _maxDigits = 1;\n\n  seriesToShow:string|undefined;\n  paddingPx = 2;\n  colour?:string;\n  \n  lastRange:DataRange;\n  lastPlotAreaHeight = 0;\n\n  constructor(private plot:Plot) {\n    super(plot, plot.canvasEl, `AxisY`);\n    this.lastRange = {min:0,max:0};\n  }\n\n  clear() {\n    this.lastRange = {min:0,max:0};\n    this.lastPlotAreaHeight = 0;\n  }\n\n  protected measurePreflight(): void {\n    const series = this.getSeries();\n    if (series !== undefined && !isRangeEqual(series.visualRange, this.lastRange)) {\n      this._needsLayout = true;\n      this.needsDrawing = true;\n    }\n  }\n\n  protected onNotify(msg: string, source: Sg.Box): void {\n    const pa = this.plot.plotArea;\n    if (msg === `measureApplied` && source === pa) {\n      if (pa.visual.height !== this.lastPlotAreaHeight) {\n        this.lastPlotAreaHeight = pa.visual.height;\n        this.needsDrawing = true;  \n      }\n    }  \n  }\n\n  protected measureSelf(opts: Sg.MeasureState): Rects.RectPositioned {\n    //this.debugLog(`measureSelf. needsLayout: ${this._needsLayout} needsDrawing: ${this.needsDrawing}`);\n    \n    const copts = opts as Sg.CanvasMeasureState;\n    const paddingPx = this.paddingPx;\n    let width = this.plot.axisWidth + paddingPx;\n\n    const series = this.getSeries();\n    if (series !== undefined) {\n      const r = series.visualRange;\n      this._maxDigits = Math.ceil(r.max).toString().length + series.precision + 1;\n\n      const textToMeasure = `9`.repeat(this._maxDigits);\n      width += textWidth(copts.ctx, textToMeasure, paddingPx*2);\n    }\n    const w = opts.resolveToPx(this.desiredSize?.width, width);\n    return {\n      x:0,\n      y:0,\n      width: w,\n      height: opts.bounds.height\n    }\n  }\n\n  protected drawSelf(ctx: CanvasRenderingContext2D): void {\n    const s = this.getSeries();\n    if (s !== undefined) this.seriesAxis(s, ctx);\n    else {\n      if (this.seriesToShow === undefined) return;\n      console.warn(`Plot AxisY series '${this.seriesToShow}' is missing.`);\n    }  \n  }\n\n  getSeries():Series|undefined {\n    if (this.seriesToShow === undefined) {\n      // Pick first series\n      return this.plot.seriesArray()[0];\n    } else {\n      // Try designated series name\n      return this.plot.series.get(this.seriesToShow);\n    }\n  }\n\n  seriesAxis(series:Series, ctx:CanvasRenderingContext2D) {\n    const plot = this.plot;\n    const plotArea = plot.plotArea;\n    const v = this.visual;\n    const paddingPx = this.paddingPx;\n    const r = series.visualRange;\n    const width = plot.axisWidth;\n\n    const colour = this.colour ?? plot.axisColour;\n    ctx.strokeStyle = colour;\n    ctx.fillStyle = colour;\n\n    if (Number.isNaN(r.min)  && Number.isNaN(r.max)) return; // Empty\n    this.lastRange = r;\n    ctx.clearRect(0,0,v.width, v.height);\n \n    ctx.beginPath();\n    ctx.lineWidth = width;    \n    const lineX = v.width - width/2;\n    ctx.moveTo(lineX, plotArea.paddingPx + (width));\n    ctx.lineTo(lineX, plotArea.visual.height + width);\n    ctx.stroke();\n\n    ctx.textBaseline = `top`;\n    const fromRight = v.width - (paddingPx *4);\n\n    if (isRangeSinglePoint(r)) {\n      drawText(ctx, series.formatValue(r.max), size => [\n        fromRight-size.width, \n        plotArea.computeY(series, r.max) - (paddingPx*4)\n      ]);\n    } else {\n      // Draw min/max data labels\n      drawText(ctx, series.formatValue(r.max), size => [\n        fromRight-size.width, \n        plotArea.computeY(series, r.max) + (width/2)\n      ]);\n      drawText(ctx, series.formatValue(r.min), size => [\n        fromRight-size.width,\n        plotArea.computeY(series, r.min) - 5\n      ]);\n    }\n  }\n}\n\nconst drawText = (ctx:CanvasRenderingContext2D, text:string, position:(size:TextMetrics) => [x:number,y:number]) => {\n  const size = ctx.measureText(text);\n  const xy = position(size);\n  ctx.fillText(text, xy[0], xy[1]);\n}\n\n/**\n * Canvas-based data plotter.\n * \n * ```\n * const p = new Plot(document.getElementById(`myCanvas`), opts);\n * \n * // Plot 1-5 as series  test'\n * p.createSeries(`test`, `array`, [1,2,3,4,5]);\n * \n * // Create a streaming series, add a random number\n * const s = p.createSeries(`test2`, `stream`);\n * s.add(Math.random());\n * ```\n * `createSeries` returns the {@link Series} instance with properties for fine-tuning\n * \n * For simple usage, use `plot(someData)` which automatically creates\n * series for the properties of an object.\n */\nexport class Plot extends Sg.CanvasBox {\n  plotArea:PlotArea;\n  legend:Legend;\n  axisX:AxisX;\n  axisY:AxisY;\n  axisColour:string;\n  axisWidth:number;\n  series:Map<string,Series>;\n  private _frozen = false;\n\n  defaultSeriesOpts?:SeriesOpts;\n  constructor(canvasEl:HTMLCanvasElement, opts:Opts = {}) {\n    if (canvasEl === undefined) throw new Error(`canvasEl undefined`);\n    super(undefined, canvasEl, `Plot`);\n  \n    if (opts.autoSize) {\n      parentSizeCanvas(canvasEl, evt => {\n        this.update(true);\n      });\n    }\n\n    this.axisColour = opts.axisColour ?? `black`;\n    this.axisWidth = opts.axisWidth ?? 3;\n    this.series = new Map();\n    this.plotArea = new PlotArea(this);\n    this.legend = new Legend(this);\n    this.axisX = new AxisX(this);\n    this.axisY = new AxisY(this);\n  }\n\n  /**\n   * Calls 'clear()' on each of the series\n   */\n  clearSeries() {\n    for (const series of this.series.values()) {\n      series.clear();\n    }\n  }\n\n  /**\n   * Removes all series, plot, legend\n   * and axis data.\n   */\n  clear() {\n    this.series = new Map();\n    this.plotArea.clear();\n    this.legend.clear();\n    this.axisX.clear();\n    this.axisY.clear();\n    this.update(true);\n  }\n\n  get frozen():boolean {\n    return this._frozen;\n  }\n\n  set frozen(v:boolean) {\n    this._frozen = v;\n    if (v) {\n      this.canvasEl.classList.add(`frozen`);\n      this.canvasEl.title = `Plot frozen. Tap to unfreeze`;\n    } else {\n      this.canvasEl.title = ``;\n      this.canvasEl.classList.remove(`frozen`);\n    } \n  }\n\n  seriesArray():Series[] {\n    return [...this.series.values()];\n  }\n\n  get seriesLength():number {\n    return this.series.size;\n  }\n\n  /**\n   * Plots a simple object, eg `{ x: 10, y: 20, z: 300 }`\n   * Series are automatically created for each property of `o`\n   * \n   * Be sure to call `update()` to visually refresh.\n   * @param o \n   */\n  plot(o:any) {\n    const paths = getFieldPaths(o);\n    paths.forEach(p => {\n      let s = this.series.get(p);\n      if (s === undefined) {\n        s = this.createSeries(p, `stream`);\n        s.drawingStyle = `line`;\n      }\n      s.add(getFieldByPath(o, p));\n    })\n  }\n\n  createSeriesFromObject(o:any, prefix:string = ``):Series[] {\n    const keys = Object.keys(o);\n    const create = (key:string):Series[] => {\n      const v = o[key];\n      if (typeof v === `object`) {\n        return this.createSeriesFromObject(v, prefix + key +'.');\n      } else if (typeof v === `number`) {\n        return [this.createSeries(key, `stream`)];\n      } else {\n        return [];\n      }\n    }\n    return keys.flatMap(create);\n  }\n\n  createSeries(name?:string, type:`stream`|`array` = `array`, seriesOpts?:SeriesOpts):Series {\n    const len = this.seriesLength;\n\n    if (name === undefined) name = `series-${len}`;\n    if (this.series.has(name)) throw new Error(`Series name '${name}' already in use`);\n \n    let opts:SeriesOpts = {\n      colour: `hsl(${len*25 % 360}, 70%,50%)`,\n      ...seriesOpts\n    };\n    if (this.defaultSeriesOpts) opts = {...this.defaultSeriesOpts, ...opts};\n    \n    const s = new Series(name, type, this, opts);\n    // if (type === `array` && initialData !== undefined) {\n    //   (s.source as ArrayDataSource).set(initialData);\n    // }\n    \n    this.series.set(name, s);\n    this.setReady(true, true);\n    this.plotArea.needsDrawing = true;\n    return s;\n  }\n}","/* eslint-disable */\r\nimport {Arrays} from '../collections/index.js';\r\nimport {Points} from '../geometry/index.js';\r\nimport * as Rects from '../geometry/Rect.js';\r\nimport {hue as randomHue} from  '../Random.js';\r\n\r\nexport type Measurement = {\r\n  size: Rects.Rect|Rects.RectPositioned\r\n  ref: Box\r\n  children: Array<Measurement|undefined>\r\n}\r\n\r\nexport type PxUnit = {\r\n  value: number;\r\n  type: `px`;\r\n}\r\n\r\nexport type BoxUnit = PxUnit;\r\n\r\nexport type BoxRect = {\r\n  x?: BoxUnit\r\n  y?: BoxUnit\r\n  width?: BoxUnit\r\n  height?: BoxUnit \r\n}\r\n\r\nconst unitIsEqual = (a:BoxUnit, b:BoxUnit):boolean => {\r\n  if (a.type ===`px` && b.type === `px`) {\r\n    return (a.value === b.value)\r\n  }\r\n  return false;\r\n}\r\n\r\nconst boxRectIsEqual = (a:BoxRect|undefined, b:BoxRect|undefined):boolean => {\r\n  if (a === undefined && b === undefined) return true;\r\n  if (a === undefined) return false;\r\n  if (b === undefined) return false;\r\n  if (a.x && b.x) {\r\n    if (!unitIsEqual(a.x, b.x)) return false;\r\n  }\r\n  if (a.y && b.y) {\r\n    if (!unitIsEqual(a.y, b.y)) return false;\r\n  }\r\n  if (a.width && b.width) {\r\n    if (!unitIsEqual(a.width, b.width)) return false;\r\n  }\r\n  if (a.height && b.height) {\r\n    if (!unitIsEqual(a.height, b.height)) return false;\r\n  }\r\n  return true;\r\n}\r\n\r\nexport class MeasureState {\r\n  bounds: Rects.Rect;\r\n  pass: number;\r\n  measurements: Map<string, Measurement>;\r\n  \r\n  constructor(bounds:Rects.Rect) {\r\n    this.bounds = bounds;\r\n    this.pass = 0;\r\n    this.measurements = new Map<string, Measurement>();\r\n  }\r\n\r\n  getSize(id:string):Rects.Rect|undefined {\r\n    const s = this.measurements.get(id);\r\n    if (s === undefined) return;\r\n    if (Rects.isPlaceholder(s.size)) return;\r\n    return s.size;\r\n  }\r\n  \r\n  resolveToPx(u:BoxUnit|undefined, defaultValue:number):number {\r\n    if (u === undefined) return defaultValue; //throw new Error(`unit undefined`);\r\n    if (u.type === `px`) return u.value;\r\n    throw new Error(`Unknown unit type ${u.type}`);\r\n  }\r\n}\r\n\r\nexport abstract class Box {\r\n  visual:Rects.RectPositioned = Rects.placeholderPositioned;\r\n  private _desiredSize:BoxRect|undefined;\r\n  private _lastMeasure:Rects.RectPositioned | Rects.Rect|undefined\r\n\r\n  protected children: Box[] = [];\r\n  protected readonly _parent:Box|undefined;\r\n  private _idMap: Map<string,Box> = new Map();\r\n\r\n  debugLayout = false;\r\n  \r\n  private _visible = true;\r\n  protected _ready = true;\r\n\r\n  takesSpaceWhenInvisible = false;\r\n  needsDrawing = true;\r\n  protected _needsLayout = true;\r\n\r\n  debugHue = randomHue();\r\n  readonly id: string;\r\n  \r\n  constructor(parent:Box|undefined, id:string) {\r\n    this.id = id;\r\n    this._parent = parent;\r\n\r\n    parent?.onChildAdded(this);\r\n  }\r\n\r\n  hasChild(box:Box):boolean {\r\n    const byRef = this.children.find(c=>c === box);\r\n    const byId = this.children.find( c => c.id === box.id);\r\n    return byRef !== undefined || byId !== undefined;\r\n  }\r\n\r\n  notify(msg:string, source:Box) {\r\n    this.onNotify(msg, source);\r\n    this.children.forEach(c => c.notify(msg, source));\r\n  }\r\n\r\n  protected onNotify(msg:string, source:Box) {\r\n  \r\n  }\r\n\r\n  protected onChildAdded(child:Box) {\r\n    if (child.hasChild(this)) throw new Error(`Recursive`);\r\n    if (child === this) throw new Error(`Cannot add self as child`);\r\n    if (this.hasChild(child)) throw new Error(`Child already present`);\r\n\r\n    this.children.push(child);\r\n    this._idMap.set(child.id, child)\r\n  }\r\n\r\n  setReady(ready:boolean, includeChildren:boolean = false) {\r\n    this._ready = ready;\r\n    if (includeChildren) {\r\n      this.children.forEach(c => c.setReady(ready, includeChildren));\r\n    }\r\n  }\r\n\r\n\r\n  get visible():boolean {\r\n    return this._visible;\r\n  }\r\n\r\n  set visible(v:boolean) {\r\n    if (this._visible === v) return;\r\n    this._visible = v;\r\n    this.onLayoutNeeded();\r\n  }\r\n\r\n  get desiredSize():BoxRect|undefined {\r\n    return this._desiredSize;\r\n  }\r\n\r\n  set desiredSize(v:BoxRect|undefined) {\r\n    if (boxRectIsEqual(v, this._desiredSize)) return;\r\n    this._desiredSize = v;\r\n    this.onLayoutNeeded();\r\n  }\r\n  \r\n  onLayoutNeeded() {\r\n    this.notifyChildLayoutNeeded();\r\n  }\r\n\r\n  private notifyChildLayoutNeeded() {\r\n    this._needsLayout = true;\r\n    this.needsDrawing = true;\r\n    if (this._parent !== undefined) {\r\n      this._parent.notifyChildLayoutNeeded();\r\n    } else {\r\n      this.update();\r\n    }\r\n  }\r\n\r\n  get root():Box {\r\n    if (this._parent === undefined) return this;\r\n    return this._parent.root;\r\n  }\r\n\r\n  protected measurePreflight() {}\r\n\r\n  /**\r\n   * Applies measurement, returning true if size is different than before\r\n   * @param size \r\n   * @returns \r\n   */\r\n   measureApply(m:Measurement, force:boolean) {\r\n\r\n    let different = true;\r\n    this._needsLayout = false;\r\n    \r\n    if (Rects.isEqual(m.size, this.visual)) different = false;\r\n        \r\n    if (Rects.isPositioned(m.size)) {\r\n      this.visual = m.size;\r\n    } else {\r\n      this.visual = {\r\n        x: 0, y: 0,\r\n        width: m.size.width,\r\n        height: m.size.height\r\n      }\r\n    }\r\n\r\n    m.children.forEach(c => {\r\n      if (c !== undefined) c.ref.measureApply(c, force);\r\n    })\r\n    if (different || force) {\r\n      this.needsDrawing = true;\r\n      this.root.notify(`measureApplied`, this);\r\n    \r\n    }\r\n    return different;\r\n  }\r\n\r\n\r\n  debugLog(m:any) {\r\n    console.log(this.id, m);\r\n  }\r\n\r\n  measureStart(opts:MeasureState, force:boolean, parent?:Measurement):Measurement|undefined {\r\n    this.measurePreflight();\r\n\r\n    let m:Measurement = {\r\n      ref: this,\r\n      size:Rects.placeholder,\r\n      children:[]\r\n    };\r\n    opts.measurements.set(this.id, m);\r\n    \r\n    \r\n    if (!this._visible && !this.takesSpaceWhenInvisible) {\r\n      m.size = Rects.emptyPositioned;\r\n    } else {\r\n      let size = this._lastMeasure;\r\n      if (this._needsLayout || this._lastMeasure === undefined) {\r\n        size = this.measureSelf(opts, parent);\r\n        this.root.notify(`measured`, this);\r\n      }\r\n      if (size === undefined) return;\r\n      m.size = size;\r\n      this._lastMeasure = size;\r\n    }\r\n\r\n    m.children = this.children.map(c => c.measureStart(opts, force, m));\r\n    if (Arrays.without(m.children, undefined).length < this.children.length) {\r\n      return undefined; // One of the children did not resolve\r\n    }\r\n\r\n    return m;\r\n  }\r\n\r\n  protected measureSelf(opts:MeasureState, parent?:Measurement):Rects.RectPositioned | Rects.Rect|undefined {\r\n    let size = Rects.placeholderPositioned;\r\n    if (parent) {\r\n      // Use parent size\r\n      if (parent.size) {\r\n        size = {\r\n          x: 0, y: 0,\r\n          width: parent.size.width,\r\n          height: parent.size.height \r\n        }\r\n      }\r\n    } else {\r\n      // Use canvas size\r\n      size = {\r\n        x:0, y:0,\r\n        width: opts.bounds.width,\r\n        height: opts.bounds.height\r\n      }\r\n    }\r\n    if (Rects.isPlaceholder(size)) return;\r\n    return size;\r\n  }\r\n\r\n  /**\r\n   * Called when update() is called\r\n   * @param force \r\n   */\r\n  protected abstract updateBegin(force:boolean):MeasureState;\r\n  \r\n  protected updateDone(state:MeasureState, force:boolean):void {\r\n    this.onUpdateDone(state, force);\r\n    this.children.forEach(c=>c.updateDone(state, force));\r\n  }\r\n\r\n  abstract onUpdateDone(state:MeasureState, force:boolean):void;\r\n\r\n  update(force = false) {\r\n    const state = this.updateBegin(force);\r\n    let attempts = 5;\r\n    let applied = false;\r\n\r\n    while (attempts--) {\r\n      const m = this.measureStart(state, force);\r\n      if (m !== undefined) {\r\n        // Apply measurements\r\n        this.measureApply(m, force);\r\n        if (!this._ready) return;\r\n        applied = true;\r\n        //this.onMeasurementApplied(sizeChanged, force;\r\n        //return;\r\n      }\r\n    }\r\n\r\n    this.updateDone( state, force);\r\n    if (!applied) console.warn(`Ran out of measurement attempts`);\r\n  }\r\n}\r\n\r\nexport class CanvasMeasureState extends MeasureState {\r\n  readonly ctx:CanvasRenderingContext2D;\r\n  constructor(bounds:Rects.Rect, ctx:CanvasRenderingContext2D) {\r\n    super(bounds);\r\n    this.ctx = ctx;\r\n  }\r\n}\r\n\r\n\r\nexport class CanvasBox extends Box {\r\n  readonly canvasEl:HTMLCanvasElement;\r\n\r\n  constructor(parent:CanvasBox|undefined, canvasEl:HTMLCanvasElement, id:string) {\r\n    super(parent, id);\r\n    if (canvasEl === undefined) throw new Error(`canvasEl undefined`);\r\n    if (canvasEl === null) throw new Error(`canvasEl null`);\r\n    this.canvasEl = canvasEl;\r\n\r\n    if (parent === undefined) this.designateRoot();\r\n  }\r\n\r\n  private designateRoot() {\r\n    this.canvasEl.addEventListener(`pointermove`, evt => {\r\n      const p = {x:evt.offsetX, y:evt.offsetY};\r\n      this.notifyPointerMove(p);\r\n    });\r\n\r\n    this.canvasEl.addEventListener(`pointerleave`, evt => {\r\n      this.notifyPointerLeave();    \r\n    })\r\n\r\n    this.canvasEl.addEventListener(`click`, evt => {\r\n      const p = {x:evt.offsetX, y:evt.offsetY};\r\n      this.notifyClick(p);\r\n    })\r\n  }\r\n\r\n  protected onClick(p:Points.Point) {}\r\n\r\n  private notifyClick(p:Points.Point) {\r\n    if (Rects.isPlaceholder(this.visual)) return;\r\n    if (Rects.intersectsPoint(this.visual, p)) {\r\n      const pp = Points.subtract(p, this.visual.x, this.visual.y);\r\n      this.onClick(pp);\r\n      this.children.forEach(c=> (c as CanvasBox).notifyClick(pp));\r\n    }\r\n  }\r\n\r\n  private notifyPointerLeave() {\r\n    this.onPointerLeave();\r\n    this.children.forEach(c=>(c as CanvasBox).notifyPointerLeave());\r\n  }\r\n\r\n  private notifyPointerMove(p:Points.Point) {\r\n    if (Rects.isPlaceholder(this.visual)) return;\r\n    if (Rects.intersectsPoint(this.visual, p)) {\r\n      const pp = Points.subtract(p, this.visual.x, this.visual.y);\r\n      this.onPointerMove(pp);\r\n      this.children.forEach(c=> (c as CanvasBox).notifyPointerMove(pp));\r\n    }\r\n  };\r\n\r\n  protected onPointerLeave() {\r\n\r\n  }\r\n\r\n  protected onPointerMove(p:Points.Point) {\r\n\r\n  }\r\n\r\n  protected updateBegin():MeasureState {\r\n    const ctx = this.canvasEl.getContext(`2d`);\r\n    if (ctx === null) throw new Error(`Context unavailable`);\r\n\r\n    const s = this.canvasEl.getBoundingClientRect();\r\n\r\n    return new CanvasMeasureState({\r\n      width: s.width,\r\n      height: s.height\r\n    }, ctx);\r\n  }\r\n\r\n  override onUpdateDone(state: MeasureState, force: boolean) {\r\n    if (!this.needsDrawing && !force) return;\r\n    \r\n    const ctx = this.canvasEl.getContext(`2d`);\r\n    if (ctx === null) throw new Error(`Context unavailable`);\r\n\r\n    ctx.save();\r\n    ctx.translate(this.visual.x, this.visual.y);\r\n    \r\n    const v = this.visual;\r\n    \r\n    if (this.debugLayout) {\r\n      \r\n      //ctx.clearRect(0,0,v.width,v.height);\r\n      \r\n      ctx.lineWidth = 1;\r\n      ctx.strokeStyle = `hsl(${this.debugHue}, 100%, 50%)`;\r\n\r\n      //ctx.fillStyle = ctx.strokeStyle;\r\n      //ctx.fillRect(0,0,v.width,v.height);\r\n      \r\n      ctx.strokeRect(0, 0, v.width, v.height);\r\n\r\n      ctx.fillStyle = ctx.strokeStyle;\r\n      ctx.fillText(this.id, 10, 10, v.width);\r\n\r\n      ctx.beginPath();\r\n      ctx.moveTo(0,0);\r\n      ctx.lineTo(v.width, v.height);\r\n      ctx.stroke();\r\n    }\r\n\r\n    this.drawSelf(ctx);\r\n\r\n    this.needsDrawing = false;\r\n    ctx.restore();\r\n  }\r\n\r\n  protected drawSelf(ctx:CanvasRenderingContext2D):void {\r\n\r\n  }\r\n}","/**\r\n * Manage a set of colours. Uses CSS variables as a fallback if colour is not added\r\n *\r\n */\r\nexport type Palette = {\r\n  //eslint-disable-next-line functional/no-method-signature\r\n  setElementBase(el:Element):void\r\n  //eslint-disable-next-line functional/no-method-signature\r\n  has(key:string):boolean\r\n\r\n  /**\r\n   * Returns a colour by name. \r\n   * \r\n   * If the colour is not found:\r\n   *  1. Try to use a CSS variable `--key`, or\r\n   *  2. The next fallback colour is used (array cycles)\r\n   *\r\n   * @param key\r\n   * @returns\r\n   */\r\n  //eslint-disable-next-line functional/no-method-signature\r\n  get(key:string, fallback?:string):string\r\n\r\n  /**\r\n   * Gets a colour by key, adding and returning fallback if not present\r\n   * @param key Key of colour\r\n   * @param fallback Fallback colour if key is not found\r\n   */\r\n  //eslint-disable-next-line functional/no-method-signature\r\n  getOrAdd(key: string, fallback?:string):string\r\n\r\n  /**\r\n   * Adds a colour with a given key\r\n   *\r\n   * @param key\r\n   * @param colour\r\n   */\r\n  //eslint-disable-next-line functional/no-method-signature\r\n  add(key:string, value:string):void\r\n\r\n  alias(from:string, to:string):void\r\n};\r\n\r\nexport const create = (fallbacks?:readonly string[]):Palette => new PaletteImpl(fallbacks);\r\n\r\nclass PaletteImpl {\r\n  /* eslint-disable-next-line functional/prefer-readonly-type */\r\n  readonly #store:Map<string, string> = new Map();\r\n  /* eslint-disable-next-line functional/prefer-readonly-type */\r\n  readonly #aliases:Map<string, string> = new Map();\r\n\r\n  readonly fallbacks:readonly string[];\r\n  #lastFallback = 0;\r\n\r\n  #elementBase:Element;\r\n\r\n  constructor(fallbacks?:readonly string[]) {\r\n    if (fallbacks !== undefined) this.fallbacks = fallbacks;\r\n    else this.fallbacks = [`red`, `blue`, `green`, `orange`];\r\n    this.#elementBase = document.body;\r\n  }\r\n\r\n  setElementBase(el:Element) {\r\n    this.#elementBase = el;\r\n  }\r\n\r\n  add(key:string, colour:string) {\r\n    this.#store.set(key, colour);\r\n  }\r\n\r\n  alias(from:string, to:string) {\r\n    this.#aliases.set(from, to);\r\n  }\r\n\r\n  get(key:string, fallback?:string):string {\r\n    const alias =  this.#aliases.get(key);\r\n    if (alias !== undefined) key = alias;\r\n  \r\n    const c = this.#store.get(key);\r\n    if (c !== undefined) return c;\r\n\r\n    const varName = `--` + key;\r\n    // eslint-disable-next-line functional/no-let\r\n    let fromCss = getComputedStyle(this.#elementBase).getPropertyValue(varName).trim();\r\n\r\n    // Not found\r\n    if (fromCss === undefined || fromCss.length === 0) {\r\n      if (fallback !== undefined) return fallback;\r\n      fromCss = this.fallbacks[this.#lastFallback];\r\n      this.#lastFallback++;\r\n      if (this.#lastFallback === this.fallbacks.length) this.#lastFallback = 0;\r\n    }\r\n    return fromCss;\r\n  }\r\n\r\n  getOrAdd(key:string, fallback?:string):string {\r\n    if (this.has(key)) return this.get(key);\r\n    const c = this.get(key, fallback);\r\n    this.add(key, c);\r\n    return c;\r\n  }\r\n\r\n  has(key:string):boolean {\r\n    return this.#store.has(key);\r\n  }\r\n}\r\n\r\n","export * from './Log.js';\n\nexport * from './DomRx.js';\nexport * from './Util.js';\n\n/**\n * Functions for working with DOM elements\n */\nexport * as Forms from './Forms.js';\n\nexport * from './PointerVisualise.js';\n\nexport * from './ErrorHandler.js';\n\nexport * as DragDrop from './DragDrop.js';","export const addShadowCss = (parentEl:HTMLElement, styles:string):ShadowRoot => {\r\n  const styleEl = document.createElement(`style`);\r\n  styleEl.textContent = styles;\r\n\r\n  let shadowRoot;\r\n  if (parentEl.shadowRoot) {\r\n    shadowRoot = parentEl.shadowRoot;\r\n    shadowRoot.innerHTML = ``;\r\n  } else {\r\n    shadowRoot = parentEl.attachShadow({ mode: `open` });\r\n  }\r\n  shadowRoot.appendChild(styleEl);\r\n  return shadowRoot;\r\n};\r\n","import {resolveEl} from \"./Util.js\";\nimport {addShadowCss} from \"./ShadowDom.js\";\n\nexport type LogOpts = {\n  readonly reverse?:boolean\n  readonly capacity?: number\n  readonly timestamp?: boolean\n  readonly collapseDuplicates?:boolean\n  readonly monospaced?:boolean\n  readonly minIntervalMs?:number\n  readonly css?:string\n}\n\nexport type Log = Readonly<{\n  clear():void\n  error(msgOrError:string|Error|unknown):void\n  log(msg?:string|object|number):HTMLElement|undefined\n  append(el:HTMLElement):void\n  dispose():void\n  readonly isEmpty:boolean\n}>\n\n/**\n * Allows writing to a DOM element in console.log style. Element grows in size, so use\n * something like `overflow-y: scroll` on its parent\n * \n * ```\n * const l = log(`#dataStream`); // Assumes HTML element with id `dataStream` exists \n * l.log(`Hi`);\n * l.log(); // Displays a horizontal rule\n * \n * const l = log(document.getElementById(`dataStream`), {\n *  timestamp: true,\n *  truncateEntries: 20\n * });\n * l.log(`Hi`);\n * l.error(`Some error`); // Adds class `error` to line\n * ```\n * \n * For logging high-throughput streams:\n * ```\n * // Silently drop log if it was less than 5ms since the last\n * const l = log(`#dataStream`, { minIntervalMs: 5 });\n * \n * // Only the last 100 entries are kept\n * const l = log(`#dataStream`, { capacity: 100 });\n * ```\n *\n * @param {(HTMLElement | string | undefined)} elOrId Element or id of element\n * @param {LogOpts} opts\n * @returns {Log}\n */\nexport const log = (domQueryOrEl: HTMLElement | string, opts: LogOpts = {}):Log => {\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  const {capacity = 0, monospaced = true, timestamp = false, collapseDuplicates = true, css =  `` } = opts;\n\n  // eslint-disable-next-line functional/no-let\n  let added = 0;\n  // eslint-disable-next-line functional/no-let\n  let lastLog:string|undefined;\n  // eslint-disable-next-line functional/no-let\n  let lastLogRepeats = 0;\n\n  const parentEl = resolveEl<HTMLElement>(domQueryOrEl);\n  const fontFamily = monospaced ? `Consolas, \"Andale Mono WT\", \"Andale Mono\", \"Lucida Console\", \"Lucida Sans Typewriter\", \"DejaVu Sans Mono\", \"Bitstream Vera Sans Mono\", \"Liberation Mono\", Monaco, \"Courier New\", Courier, monospace` : `normal`;\n  const shadowRoot = addShadowCss(parentEl, `\n  .log {\n    font-family: ${fontFamily};\n    background-color: var(--code-background-color);\n    padding: var(--padding1, 0.2em);\n    overflow-y: auto;\n    height:100%;\n  }\n  .timestamp {\n    margin-right: 0.5em;\n    opacity: 0.5;\n    font-size: 70%;\n    align-self: center;\n  }\n  .line {\n    display: flex;\n    padding-bottom: 0.1em;\n    padding-top: 0.1em;\n  }\n  .line:hover {\n  \n  }\n  .error {\n    color: red;\n  }\n  .badge {\n    border: 1px solid currentColor;\n    align-self: center;\n    font-size: 70%;\n    padding-left: 0.2em;\n    padding-right: 0.2em;\n    border-radius: 1em;\n    margin-left: 0.5em;\n    margin-right: 0.5em;\n  }\n  .msg {\n    flex: 1;\n    word-break: break-word;\n  }\n  ${css}\n  `);\n  \n  const el = document.createElement(`div`);\n  // eslint-disable-next-line functional/immutable-data\n  el.className = `log`;\n  shadowRoot.append(el);\n\n  const error = (msgOrError: string | Error | unknown) => {\n    const line = document.createElement(`div`);\n    \n    if (typeof msgOrError === `string`) {\n      // eslint-disable-next-line functional/immutable-data\n      line.innerHTML = msgOrError;\n    } else if (msgOrError instanceof Error) {\n      const stack = msgOrError.stack;\n      if (stack === undefined) {\n        // eslint-disable-next-line functional/immutable-data\n        line.innerHTML = msgOrError.toString();\n      } else {\n        // eslint-disable-next-line functional/immutable-data\n        line.innerHTML = stack.toString();\n      }\n    } else {\n      // eslint-disable-next-line functional/immutable-data\n      line.innerHTML = msgOrError as string;\n    }\n    line.classList.add(`error`);\n    append(line);\n    lastLog = undefined;\n    lastLogRepeats = 0;\n  };\n\n  //eslint-disable-next-line functional/no-let\n  let lastLogTime = 0;\n\n  const log = (whatToLog: unknown = ``):HTMLElement|undefined => {\n    // eslint-disable-next-line functional/no-let\n    let msg:string|undefined;\n    const interval = window.performance.now() - lastLogTime;\n    if (opts.minIntervalMs && interval < opts.minIntervalMs) return;\n    lastLogTime = window.performance.now();\n\n    if (typeof whatToLog === `object`) {\n      msg = JSON.stringify(whatToLog);\n    } else if (whatToLog === undefined) {\n      msg = `(undefined)`;\n    } else if (whatToLog === null) {\n      msg = `(null)`;\n    } else if (typeof whatToLog === `number`) {\n      if (Number.isNaN(msg)) msg = `(NaN)`;\n      msg = whatToLog.toString();\n    } else {\n      msg = whatToLog as string;\n    }\n   \n    if (msg.length === 0) {\n      const rule = document.createElement(`hr`);\n      lastLog = undefined;\n      append(rule);\n    } else if (msg === lastLog && collapseDuplicates) {\n      const lastEl = el.firstElementChild as HTMLElement;\n      // eslint-disable-next-line functional/no-let\n      let lastBadge = lastEl.querySelector(`.badge`);\n      if (lastBadge === null) {\n        lastBadge = document.createElement(`div`);\n        // eslint-disable-next-line functional/immutable-data\n        lastBadge.className = `badge`;\n        lastEl.insertAdjacentElement(`beforeend`, lastBadge);\n      }\n      if (lastEl !== null) {\n        // eslint-disable-next-line functional/immutable-data\n        lastBadge.textContent = (++lastLogRepeats).toString();\n      }\n      return lastEl;\n    } else {\n      const line = document.createElement(`div`);\n      // eslint-disable-next-line functional/immutable-data\n      line.innerText = msg;\n      append(line);\n      lastLog = msg;\n      return line;\n    }\n  };\n\n  const append = (line: HTMLElement) => {\n    if (timestamp) {\n      const wrapper = document.createElement(`div`);\n      const timestamp = document.createElement(`div`);\n      // eslint-disable-next-line functional/immutable-data\n      timestamp.className = `timestamp`;\n      // eslint-disable-next-line functional/immutable-data\n      timestamp.innerText = new Date().toLocaleTimeString();\n      wrapper.append(timestamp, line);\n      line.classList.add(`msg`);\n      wrapper.classList.add(`line`);\n      line = wrapper;\n    } else {\n      line.classList.add(`line`, `msg`);\n    }\n\n    if (opts.reverse) {\n      el.appendChild(line);\n    } else {\n      el.insertBefore(line, el.firstChild);\n    }\n\n    if (capacity > 0 && (++added > capacity * 2)) {\n      while (added > capacity) {\n        el.lastChild?.remove();\n        added--;\n      }\n    }\n\n    if (opts.reverse) {\n      // Scroll to bottom\n      //eslint-disable-next-line functional/immutable-data\n      el.scrollTop = el.scrollHeight;\n    }\n    lastLogRepeats = 0;\n  };\n\n  const clear = () => {\n    // eslint-disable-next-line functional/immutable-data\n    el.innerHTML = ``;\n    lastLog = undefined;\n    lastLogRepeats = 0;\n    added = 0;\n  };\n\n  const dispose = () => {\n    el.remove();\n  };\n\n  return {\n    error, log, append, clear, dispose,\n    get isEmpty() {\n      return added === 0;\n    }\n  };\n};","import { fromEvent, Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { resolveEl } from './Util.js';\n\nexport type PluckOpts =  {\n  readonly pluck:string\n}\n\nexport type TransformOpts = {\n  //eslint-disable-next-line @typescript-eslint/no-explicit-any\n  transform(ev:Event):any\n}\n\n/**\n * Responsive value\n */\n// eslint-disable-next-line functional/no-mixed-type\nexport type Rx<V> = {\n  /**\n   * Last value\n   */\n  readonly value:V,\n  /**\n   * Clears last value\n   */\n  readonly clear:()=>void\n}\n\nexport type DomRxOpts = PluckOpts | TransformOpts;\n\n/**\n * Keeps track of last event data\n * \n * ```js\n * const pointer = rx(`#myDiv`, `pointermove`).value;\n * \n * if (pointer.clientX > ...)\n * ``` \n * \n * Pluck a field:\n * ```js\n * const pointerX = rx(`#myDiv`, `pointermove`, { pluck: `clientX` }).value;\n * \n * if (pointerX > ...)\n * ```\n * @template V Event type\n * @param opts\n * @return\n */\nexport const rx = <V extends object>(elOrQuery:HTMLElement|string, event:string, opts?:DomRxOpts):Rx<V> => {\n  const el = resolveEl<HTMLElement>(elOrQuery);\n  const ev = fromEvent(el, event);\n  // @ts-ignore\n  const value:V = {};\n\n  const clear = () => {\n    const keys = Object.keys(value);\n    keys.forEach(key => {\n      // eslint-disable-next-line functional/immutable-data, @typescript-eslint/no-explicit-any\n      delete (value as any)[key];\n    });\n  };\n\n  const setup = (sub:Observable<Event>):Rx<V> => {\n    sub.subscribe({\n      next: (newValue) => {\n        // eslint-disable-next-line functional/immutable-data, @typescript-eslint/no-explicit-any\n        Object.assign(value, newValue);\n      }\n    });\n    return {\n      value, clear\n    };\n  };\n\n  if (opts === undefined) return setup(ev);\n  \n  if ((opts as PluckOpts).pluck) {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return setup(ev.pipe(map(x => (x as any)[(opts as PluckOpts).pluck])));\n  } else if ((opts as TransformOpts).transform) {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return setup(ev.pipe(map(x => (opts as TransformOpts).transform(x))));\n  }\n\n  return setup(ev);\n};","import {resolveEl} from \"./Util.js\";\r\n\r\n/**\r\n * Adds tab and shift+tab to TEXTAREA\r\n * @param el \r\n */\r\nexport const textAreaKeyboard = (el:HTMLTextAreaElement) => {\r\n\r\n  el.addEventListener(`keydown`, evt => {\r\n    const val = el.value;\r\n    const start = el.selectionStart;\r\n    const end = el.selectionEnd;\r\n\r\n    if (evt.key === `Tab` && evt.shiftKey) {\r\n      if (el.value.substring(start - 2, start) === `  `) {\r\n        //eslint-disable-next-line functional/immutable-data\r\n        el.value = val.substring(0, start - 2) + val.substring(end);\r\n      }\r\n      //eslint-disable-next-line functional/immutable-data\r\n      el.selectionStart = el.selectionEnd = start - 2;\r\n      evt.preventDefault();\r\n      return false;\r\n    } else if (evt.key === `Tab`) {\r\n      //eslint-disable-next-line functional/immutable-data\r\n      el.value = val.substring(0, start) + `  ` + val.substring(end);\r\n      //eslint-disable-next-line functional/immutable-data\r\n      el.selectionStart = el.selectionEnd = start + 2;\r\n      evt.preventDefault();\r\n      return false;\r\n    }\r\n  \r\n  });\r\n};\r\n\r\n/**\r\n * Quick access to <input type=\"checkbox\"> value.\r\n * Provide a checkbox by string id or object reference. If a callback is\r\n * supplied, it will be called when the checkbox changes value.\r\n * \r\n * ```\r\n * const opt = checkbox(`#chkMate`);\r\n * opt.checked; // Gets/sets\r\n * \r\n * const opt = checkbox(document.getElementById(`#chkMate`), newVal => {\r\n *  if (newVal) ...\r\n * });\r\n * ```\r\n * @param {(string | HTMLInputElement)} domIdOrEl\r\n * @param {(currentVal:boolean) => void} [onChanged]\r\n * @returns\r\n */\r\nexport const checkbox = (domIdOrEl: string | HTMLInputElement, onChanged?:(currentVal:boolean) => void) => {\r\n  const el = resolveEl<HTMLInputElement>(domIdOrEl);\r\n\r\n  if (onChanged) {\r\n    el.addEventListener(`change`, () => {\r\n      onChanged(el.checked);\r\n    });\r\n  }\r\n  return {\r\n    get checked():boolean  {\r\n      return el.checked;\r\n    },\r\n    set checked(val:boolean) {\r\n      // eslint-disable-next-line functional/immutable-data\r\n      el.checked = val;\r\n    }\r\n  };\r\n};\r\n\r\n/**\r\n * Numeric INPUT\r\n * \r\n * ```\r\n * const el = numeric(`#num`, (currentValue) => {\r\n *  // Called when input changes\r\n * })\r\n * ```\r\n * \r\n * Get/set value\r\n * ```\r\n * el.value = 10;\r\n * ```\r\n * @param domIdOrEl \r\n * @param onChanged \r\n * @param live If true, event handler fires based on `input` event, rather than `change`\r\n * @returns \r\n */\r\nexport const numeric = (domIdOrEl: string | HTMLInputElement, onChanged?:(currentVal:number) => void, live?:boolean) => {\r\n  const el = resolveEl<HTMLInputElement>(domIdOrEl) as HTMLInputElement;\r\n  const evt = live ? `change` : `input`;\r\n  if (onChanged) {\r\n    el.addEventListener(evt, () => {\r\n      onChanged(parseInt(el.value));\r\n    });\r\n  }\r\n  return {\r\n    get value():number  {\r\n      return parseInt(el.value);\r\n    },\r\n    set value(val:number) {\r\n      // eslint-disable-next-line functional/immutable-data\r\n      el.value = val.toString();\r\n    }\r\n  };\r\n};\r\n\r\n/**\r\n * SELECT options\r\n */\r\nexport type SelectOpts = {\r\n  /**\r\n   * Placeholder item\r\n   */\r\n  readonly placeholderOpt?:string\r\n  /**\r\n   * If true, a placeholder option 'Choose' is added to the list\r\n   */\r\n  readonly shouldAddChoosePlaceholder?:boolean\r\n  /**\r\n   * Item to choose after a selection is made\r\n   */\r\n  readonly autoSelectAfterChoice?:number\r\n}\r\n\r\n/**\r\n * Button\r\n * \r\n * ```\r\n * const b = button(`#myButton`, () => {\r\n *  console.log(`Button clicked`);\r\n * });\r\n * ```\r\n * \r\n * ```\r\n * b.click(); // Call the click handler\r\n * b.disabled = true / false;\r\n * ```\r\n * @param domQueryOrEl Query string or element instance\r\n * @param onClick Callback when button is clicked \r\n * @returns \r\n */\r\nexport const button = (domQueryOrEl:string|HTMLButtonElement, onClick?:() => void) => {\r\n  const el = resolveEl(domQueryOrEl) as HTMLButtonElement;\r\n\r\n  if (onClick) {\r\n    el.addEventListener(`click`, (_ev) => {\r\n      onClick();\r\n    });\r\n  }\r\n  return {\r\n    click() {\r\n      if (onClick) onClick();\r\n    },\r\n    set disabled(val:boolean) {\r\n      // eslint-disable-next-line functional/immutable-data\r\n      el.disabled = val;\r\n    },\r\n  };\r\n};\r\n\r\n/**\r\n * SELECT handler\r\n */\r\nexport interface SelectHandler {\r\n  /** \r\n   * Gets/Sets disabled\r\n   */\r\n  set disabled(value:boolean);\r\n\r\n  get disabled():boolean;\r\n/**\r\n * Gets value\r\n */\r\n  get value():string;\r\n/**\r\n * Sets selected index\r\n */\r\n  get index():number;\r\n/**\r\n * _True_ if currently selected item is the placeholder\r\n */\r\n  get isSelectedPlaceholder():boolean;\r\n/**\r\n * Set options\r\n * @param opts Options\r\n * @param preSelect Item to preselect\r\n */\r\n  setOpts(opts:readonly string[], preSelect?:string):void;\r\n/**\r\n * Select item by index \r\n * @param index Index\r\n * @param trigger If true, triggers change event\r\n */\r\n  select(index?:number, trigger?:boolean):void\r\n}\r\n\r\n/**\r\n * SELECT element.\r\n * \r\n * Handle changes in value:\r\n * ```\r\n * const mySelect = select(`#mySelect`, (newValue) => {\r\n *  console.log(`Value is now ${newValue}`);\r\n * });\r\n * ```\r\n *\r\n * Enable/disable:\r\n * ```\r\n * mySelect.disabled = true / false;\r\n * ```\r\n * \r\n * Get currently selected index or value:\r\n * ```\r\n * mySelect.value / mySelect.index\r\n * ```\r\n * \r\n * Is the currently selected value a placeholder?\r\n * ```\r\n * mySelect.isSelectedPlaceholder\r\n * ```\r\n * \r\n * Set list of options\r\n * ```\r\n * // Adds options, preselecting `opt2`.\r\n * mySelect.setOpts([`opt1`, `opt2 ...], `opt2`);\r\n * ```\r\n * \r\n * Select an element\r\n * ```\r\n * mySelect.select(1); // Select second item\r\n * mySelect.select(1, true); // If true is added, change handler fires as well\r\n * ```\r\n * @param domQueryOrEl Query (eg `#id`) or element\r\n * @param onChanged Callback when a selection is made\r\n * @param opts Options\r\n * @return  \r\n */\r\nexport const select = (domQueryOrEl:string|HTMLSelectElement, onChanged?:(currentVal:string) => void, opts:SelectOpts = {}):SelectHandler => {\r\n  const el = resolveEl(domQueryOrEl) as HTMLSelectElement;\r\n  const {placeholderOpt, shouldAddChoosePlaceholder = false, autoSelectAfterChoice = -1} = opts;\r\n\r\n  const change = () => {\r\n    if (onChanged !== undefined) onChanged(el.value);\r\n    // eslint-disable-next-line functional/immutable-data\r\n    if (autoSelectAfterChoice >= 0) el.selectedIndex = autoSelectAfterChoice;\r\n  };\r\n\r\n  if (onChanged) {\r\n    el.addEventListener(`change`, (_ev) => {\r\n      change();\r\n    });\r\n  }\r\n  return {\r\n    set disabled(val:boolean) {\r\n      // eslint-disable-next-line functional/immutable-data\r\n      el.disabled = val;\r\n    },\r\n    get value():string {\r\n      return el.value;\r\n    },\r\n    get index():number {\r\n      return el.selectedIndex;\r\n    },\r\n    get isSelectedPlaceholder():boolean {\r\n      return ((shouldAddChoosePlaceholder || opts.placeholderOpt !== undefined) && el.selectedIndex === 0);\r\n    },\r\n    setOpts(opts:string[], preSelect?:string):void {\r\n      // eslint-disable-next-line functional/immutable-data\r\n      el.options.length = 0;\r\n      \r\n      if (shouldAddChoosePlaceholder) opts = [`-- Choose --`, ...opts];\r\n      else if (placeholderOpt !== undefined) opts = [placeholderOpt, ...opts];\r\n      // eslint-disable-next-line functional/no-let\r\n      let toSelect = 0;\r\n      \r\n      opts.forEach((o, index) => {\r\n        const optEl = document.createElement(`option`);\r\n        // eslint-disable-next-line functional/immutable-data\r\n        optEl.value = o;\r\n        // eslint-disable-next-line functional/immutable-data\r\n        optEl.innerHTML = o;\r\n        if (preSelect !== undefined && o === preSelect) toSelect = index;\r\n        el.options.add(optEl);\r\n      });\r\n      // eslint-disable-next-line functional/immutable-data\r\n      el.selectedIndex = toSelect;\r\n    },\r\n    select(index:number = 0, trigger:boolean = false):void {\r\n      // eslint-disable-next-line functional/immutable-data\r\n      el.selectedIndex = index;\r\n      if (trigger && onChanged) {\r\n        change();\r\n      } \r\n    }\r\n  };\r\n};","import { GetOrGenerate, getOrGenerate } from \"../collections/Map.js\";\nimport { TrackerBase } from \"./TrackerBase.js\";\n\nexport type Timestamped<V> = V & {\n  readonly at:number\n};\n\n/**\n * Options\n */\nexport type TrackedValueOpts = {\n  readonly id?:string\n  \n  /**\n   * If true, intermediate points are stored. False by default\n   */\n  readonly storeIntermediate?:boolean\n  /**\n   * If above zero, tracker will reset after this many samples\n   */\n  readonly resetAfterSamples?:number\n  \n  /**\n   * If above zero, there will be a limit to intermediate values kept.\n   * \n   * When the seen values is twice `sampleLimit`, the stored values will be trimmed down\n   * to `sampleLimit`. We only do this when the values are double the size so that\n   * the collections do not need to be trimmed repeatedly whilst we are at the limit.\n   * \n   * Automatically implies storeIntermediate\n   */\n  readonly sampleLimit?:number\n}\n\n/**\n * Keeps track of keyed values of type `V` (eg Point) It stores occurences in type `T`, which\n * must extend from `TrackerBase<V>`, eg `PointTracker`.\n * \n * The `creator` function passed in to the constructor is responsible for instantiating\n * the appropriate `TrackerBase` sub-class.\n * \n * @example Sub-class\n * ```js\n * export class TrackedPointMap extends TrackedValueMap<Points.Point> {\n *  constructor(opts:TrackOpts = {}) {\n *   super((key, start) => {\n *    if (start === undefined) throw new Error(`Requires start point`);\n *    const p = new PointTracker(key, opts);\n *    p.seen(start);\n *    return p;\n *   });\n *  }\n * }\n * ```\n * \n */\nexport class TrackedValueMap<V, T extends TrackerBase<V>>  {\n  store:Map<string, T>;\n  gog:GetOrGenerate<string, T, V>;\n\n  constructor(creator:(key:string, start:V|undefined)=>T) {\n    this.store = new Map();\n    this.gog = getOrGenerate<string, T, V>(this.store, creator);\n  }\n\n  /**\n   * Number of named values being tracked\n   */\n  get size() {\n    return this.store.size;\n  }\n\n  /**\n   * Returns _true_ if `id` is stored\n   * @param id \n   * @returns \n   */\n  has(id:string) {\n    return this.store.has(id);\n  }\n\n  /**\n   * For a given id, note that we have seen one or more values.\n   * @param id Id\n   * @param values Values(s)\n   * @returns Information about start to last value\n   */\n  //eslint-disable-next-line @typescript-eslint/no-explicit-any\n  public async seen(id:string, ...values:V[]):Promise<any> {\n    const trackedValue = await this.getTrackedValue(id, ...values);\n    \n    // Pass it over to the TrackedValue\n    return trackedValue.seen(...values);\n  }\n\n  /**\n   * Creates or returns a TrackedValue instance for `id`.\n   * @param id \n   * @param values \n   * @returns \n   */\n  protected async getTrackedValue(id:string, ...values:V[]) {\n    if (id === null) throw new Error(`id parameter cannot be null`);\n    if (id === undefined) throw new Error(`id parameter cannot be undefined`);\n\n    // Create or recall TrackedValue by id\n    const trackedValue = await this.gog(id, values[0]);\n    return trackedValue;\n  }\n\n  /**\n   * Remove a tracked value by id.\n   * Use {@link reset} to clear them all.\n   * @param id\n   */\n  delete(id:string) {\n    this.store.delete(id);\n  }\n\n  /**\n   * Remove all tracked values.\n   * Use {@link delete} to remove a single value by id.\n   */\n  reset() {\n    this.store = new Map();\n  }\n\n  /**\n   * Enumerate ids\n   */\n  *ids() {\n    yield* this.store.keys();\n  }\n\n  /**\n   * Enumerate tracked values\n   */\n  *tracked() {\n    yield* this.store.values();\n  }\n\n  /**\n   * Iterates TrackedValues ordered with oldest first\n   * @returns \n   */\n  *trackedByAge() {\n    const tp = Array.from(this.store.values());\n    tp.sort((a, b) => {\n      const aa = a.elapsed;\n      const bb = b.elapsed;\n      if (aa === bb) return 0;\n      if (aa > bb) return -1;\n      return 1;\n    });\n\n    for (const t of tp) {\n      yield t;\n    }\n  }\n\n  /**\n   * Iterates underlying values, ordered by age (oldest first)\n   * First the named values are sorted by their `elapsed` value, and then\n   * we return the last value for that group.\n   */\n  *valuesByAge() {\n    for (const tb of this.trackedByAge()) {\n      yield tb.last;\n    }\n  }\n\n  /**\n   * Enumerate last received values\n   * \n   * @example Calculate centroid of latest-received values\n   * ```js\n   * const pointers = pointTracker();\n   * const c = Points.centroid(...Array.from(pointers.lastPoints()));\n   * ```\n   */\n  *last() {\n    for (const p of this.store.values()) {\n      yield p.last;\n    }\n  }\n\n  /**\n   * Enumerate starting values\n   */\n  *initialValues() {\n    for (const p of this.store.values()) {\n      yield p.initial;\n    }\n  }\n\n  /**\n   * Returns a tracked value by id, or undefined if not found\n   * @param id \n   * @returns \n   */\n  get(id:string):TrackerBase<V>|undefined {\n    return this.store.get(id);\n  }\n}\n\n\n","import { Timestamped, TrackedValueOpts } from \"./TrackedValue.js\";\nimport { TrackerBase } from \"./TrackerBase.js\";\n\n/**\n * A tracked value of type `V`.\n */\nexport class ObjectTracker<V> extends TrackerBase<V> {\n  values:Timestamped<V>[];\n\n  constructor(opts:TrackedValueOpts = {}) {\n    super(opts);\n    this.values = [];\n  }\n\n\n  onTrimmed() {\n    // no-op\n  }\n\n  /**\n   * Reduces size of value store to `limit`. Returns\n   * number of remaining items\n   * @param limit \n   */\n  trimStore(limit:number):number {\n    if (limit >= this.values.length) return this.values.length;\n    this.values = this.values.slice(-limit);\n    return this.values.length;\n  }\n\n  /**\n   * Allows sub-classes to be notified when a reset happens\n   * @ignore\n   */\n  onReset() {\n    this.values = [];\n  }\n\n  /**\n   * Tracks a value\n   * @ignore\n   */\n  //eslint-disable-next-line @typescript-eslint/no-explicit-any\n  seenImpl(p:V[]|Timestamped<V>[]):Timestamped<V>[] {\n    // Make sure values have a timestamp\n    const ts = p.map(v => ((`at` in v) ? v : {\n      ...v,\n      at: Date.now()\n    }));\n\n    const last = ts.at(-1) as Timestamped<V>;\n  \n    if (this.storeIntermediate) this.values.push(...ts);\n    else if (this.values.length === 0) {\n      // Add as initial value\n      this.values.push(last);\n    }\n    else if (this.values.length === 2) {\n      // Replace last value\n      this.values[1] = last;\n    } else if (this.values.length === 1) {\n      // Add last value\n      this.values.push(last);\n    }\n\n    return ts;\n  }\n\n  /**\n   * Last seen value. If no values have been added, it will return the initial value\n   */\n  get last() {\n    if (this.values.length === 1) return this.values[0];\n    //eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    return this.values.at(-1)!;\n  }\n\n  /**\n   * Returns the initial value\n   */\n  get initial() {\n    return this.values.at(0);\n  }\n  \n  /**\n   * Returns number of recorded values (includes the initial value in the count)\n   */\n  get size() {\n    return this.values.length;\n  }\n\n  /**\n   * Returns the elapsed time, in milliseconds since the initial value\n   */\n  get elapsed():number {\n    return Date.now() - this.values[0].at;\n  }\n}\n","import * as Points from \"../geometry/Point.js\";\nimport { Timestamped,  TrackedValueMap, TrackedValueOpts as TrackOpts } from \"./TrackedValue.js\";\nimport { ObjectTracker } from \"./ObjectTracker.js\";\nimport { Lines, Polar, Vectors } from \"../geometry/index.js\";\n\n/**\n * Information about seen points\n */\nexport type PointTrack = Points.PointRelationResult & {\n  // readonly speedFromInitial:number\n};\n\nexport type PointTrackerResults = {\n  readonly fromLast:PointTrack\n  readonly fromInitial:PointTrack\n  readonly values:readonly Points.Point[]\n}\n\n/**\n * Point tracker. Create via `pointTracker()`.\n * \n */\nexport class PointTracker extends ObjectTracker<Points.Point> {\n  /**\n   * Function that yields the relation from initial point\n   */\n  initialRelation:Points.PointRelation|undefined;\n  \n  /**\n   * Last result\n   */\n  lastResult:PointTrackerResults|undefined;\n\n  constructor(opts:TrackOpts = {}) {\n    super(opts);\n  }\n\n  onTrimmed():void {\n    // Force new relation calculations\n    this.initialRelation = undefined;\n  }\n\n  /**\n   * Returns the last x coord\n   */\n  get x() {\n    return this.last.x;\n  }\n\n  /**\n   * Returns the last y coord\n   */\n  get y() {\n    return this.last.y;\n  }\n\n  /**\n   * @ignore\n   */\n  onReset():void {\n    super.onReset();\n    this.lastResult = undefined;\n    this.initialRelation = undefined;\n  }\n\n\n  /**\n   * Tracks a point, returning data on its relation to the\n   * initial point and the last received point.\n   * @param p Point\n   */\n  seen(...p:Points.Point[]|Timestamped<Points.Point>[]):PointTrackerResults {\n    const currentLast = this.last;\n    super.seen(...p);\n    const newLast = this.last;\n  \n    // Don't yet have an initial relation function\n    if (this.initialRelation === undefined && this.initial) {\n      this.initialRelation = Points.relation(this.initial);\n    } else if (this.initialRelation === undefined) {\n      throw new Error(`Bug: No initialRelation, and this.inital is undefined?`);\n    }\n\n    const lastRelation = Points.relation(currentLast);\n\n    // Get basic geometric relation from start to the last provided point\n    const initialRel:PointTrack = {\n      ...this.initialRelation(newLast),\n    };\n    const lastRel:PointTrack = {\n      ...lastRelation(newLast),\n      speed: this.values.length < 2 ? 0 : Lines.length(currentLast, newLast) / (newLast.at - currentLast.at),\n    };\n    \n    const r:PointTrackerResults = {\n      fromInitial: initialRel,\n      fromLast: lastRel,\n      values: [...this.values]\n    };\n    this.lastResult = r;\n    return r;\n  }\n\n  /**\n   * Returns a polyline representation of stored points.\n   * Returns an empty array if points were not saved, or there's only one.\n   */\n  get line():Lines.PolyLine {\n    if (this.values.length === 1) return [];\n    return Lines.joinPointsToLines(...this.values);\n  }\n\n  /**\n   * Returns a vector of the initial/last points of the tracker.\n   * Returns as a polar coordinate\n   */\n  get vectorPolar():Polar.Coord {\n    return Vectors.fromLinePolar(this.lineStartEnd);\n  }\n\n  /**\n   * Returns a vector of the initial/last points of the tracker.\n   * Returns as a Cartesian coordinate\n   */\n  get vectorCartesian():Points.Point {\n    return Vectors.fromLineCartesian(this.lineStartEnd);\n  }\n\n  /**\n   * Returns a line from initial point to last point.\n   * \n   * If there are less than two points, Lines.Empty is returned\n   */\n  get lineStartEnd():Lines.Line {\n    const initial = this.initial;\n    if (this.values.length < 2 || !initial) return Lines.Empty;\n    return {\n      a: initial,\n      b: this.last\n    };\n  }\n\n  /**\n   * Returns distance from latest point to initial point.\n   * If there are less than two points, zero is returned.\n   * \n   * This is the direct distance, not the accumulated length.\n   * @returns Distance\n   */\n  distanceFromStart():number {\n    const initial = this.initial;\n    if (this.values.length >= 2 && initial !== undefined) {\n      return Points.distance(initial, this.last);\n    } else {\n      return 0;\n    }\n  }\n\n  /**\n   * Difference between last point and the initial point, calculated\n   * as a simple subtraction of x & y.\n   * \n   * `Points.Placeholder` is returned if there's only one point so far.\n   */\n  difference():Points.Point {\n    const initial = this.initial;\n    if (this.values.length >= 2 && initial !== undefined) {\n      return Points.subtract(this.last, initial);\n    } else {\n      return Points.Placeholder;\n    }\n  }\n\n  /**\n   * Returns angle (in radians) from latest point to the initial point\n   * If there are less than two points, undefined is return.\n   * @returns Angle in radians\n   */\n  angleFromStart():number|undefined {\n    const initial = this.initial;\n    if (initial !== undefined && this.values.length > 2) {\n      return Points.angle(initial, this.last);\n    }\n  }\n\n  /**\n   * Returns the total length of accumulated points.\n   * Returns 0 if points were not saved, or there's only one\n   */\n  get length():number {\n    if (this.values.length === 1) return 0;\n    const l = this.line;\n    return Lines.length(l);\n  }\n}\n\n\n/**\n * A {@link TrackedValueMap} for points. Uses {@link PointTracker} to\n * track added values.\n */\nexport class TrackedPointMap extends TrackedValueMap<Points.Point, PointTracker> {\n  constructor(opts:TrackOpts = {}) {\n    super((key, start) => {\n      if (start === undefined) throw new Error(`Requires start point`);\n      const p = new PointTracker({\n        ...opts,\n        id: key\n      });\n      p.seen(start);\n      return p;\n    });\n  }\n}\n\n/**\n * Track several named points over time, eg a TensorFlow body pose point.\n * Call `seen()` to track a point. Mutable. If you want to compare\n * a single coordinate with a reference coordinate, [Geometry.Points.relation](Geometry.Points.relation.html) may be a better choice.\n * \n * Basic usage\n * ```js\n * import { pointsTracker } from 'https://unpkg.com/ixfx/dist/data.js';\n * \n * const pt = pointsTracker();\n * \n * // Track a point under a given id\n * document.addEventListener(`pointermove`, e => {\n *  const info = await pt.seen(e.pointerId, { x: e.x, y: e.y });\n *  // Yields some info on relation of the point to initial value\n * });\n * ```\n * \n * Do something with last values for all points\n * ```js\n * const c = Points.centroid(...Array.from(pt.last()));\n * ```\n * \n * More functions...\n * ```js\n * pt.size;         // How many named points are being tracked\n * pt.delete(id);  // Delete named point\n * pt.reset();     // Clear data\n * ```\n * \n * Accessing by id:\n * \n * ```js\n * pt.get(id);  // Get named point (or _undefined_)\n * pt.has(id);  // Returns true if id exists\n * ```\n *\n * Iterating over data\n * \n * ```js\n * pt.trackedByAge();   // Iterates over tracked points, sorted by age (oldest first) \n * pt.tracked();  // Tracked values\n * pt.ids();      // Iterator over ids\n * \n * // Last received value for each named point\n * pt.last(); \n * \n * pt.initialValues(); // Iterator over initial values for each point\n * ```\n * \n * You can work with 'most recently updated' points:\n * \n * ```js\n * // Iterates over points, sorted by age (oldest first)\n * pt.valuesByAge(); \n * ```\n * \n * Options:\n * * `storeIntermediate`: if true, all points are stored internally\n * * `resetAfterSamples`: If set above 0, it will automatically reset after the given number of samples have been seen\n * @param opts \n * @returns \n */\nexport const pointsTracker = (opts:TrackOpts = {}) => new TrackedPointMap(opts);\n\n/**\n * A tracked point. Create via {@link pointTracker}. Mutable. Useful for monitoring how\n * it changes over time. Eg. when a pointerdown event happens, to record the start position and then\n * track the pointer as it moves until pointerup.\n * \n * [See the point tracker playground](https://clinth.github.io/ixfx-demos/playgrounds/data/point-tracker/)\n * \n * ```js\n* import { pointTracker } from 'https://unpkg.com/ixfx/dist/data.js';\n * \n * // Create a tracker\n * const t = pointTracker();\n * \n * // ...and later, tell it when a point is seen\n * const nfo = t.seen({x: evt.x, y:evt.y});\n * // nfo gives us some details on the relation between the seen point, the start, and points in-between\n * // nfo.angle, nfo.centroid, nfo.speed etc.\n * ```\n * \n * Compute based on last seen point\n * ```js\n * t.angleFromStart();\n * t.distanceFromStart();\n * t.x / t.y\n * t.length; // Total length of accumulated points\n * t.elapsed; // Total duration since start\n * t.lastResult; // The PointSeenInfo for last seen point\n * ```\n * \n * Housekeeping\n * ```js\n * t.reset(); // Reset tracker\n * ```\n * \n * By default, the tracker only keeps track of the initial point and\n * does not store intermediate 'seen' points. To use the tracker as a buffer.\n * \n * ```js\n * // Keep only the last 10 points\n * const t = pointTracker({\n *  sampleLimit: 10\n * });\n * \n * // Store all 'seen' points\n * const t = pointTracker({\n *  storeIntermediate: true\n * });\n * \n * // In this case, the whole tracker is automatically\n * // reset after 10 samples\n * const t = pointTracker({\n *  resetAfterSamples: 10\n * })\n * ```\n * \n * When using a limited buffer, the 'initial' point will be the oldest in the\n * buffer, not actually the very first point seen.\n */\nexport const pointTracker = (opts:TrackOpts = {}) => new PointTracker(opts);","/* eslint-disable functional/immutable-data */\nimport { PointTrackerResults, pointsTracker} from \"../data/PointTracker.js\";\nimport {fullSizeElement, resolveEl} from \"./Util.js\";\nimport * as Svg from \"../visual/Svg.js\";\n\nexport type Opts = {\n  readonly touchRadius?:number\n  readonly mouseRadius?:number\n  readonly trace?:boolean\n  readonly hue?:number\n}\n\n/**\n * Visualises pointer events within a given element.\n * \n * ```js\n * // Show pointer events for whole document\n * pointerVis(document);\n * ```\n * \n * Note you may need to set the following CSS properties on the target element:\n * \n * ```css\n * touch-action: none;\n * user-select: none;\n * overscroll-behavior: none;\n * ```\n * \n * Options\n * * touchRadius/mouseRadius: size of circle for these kinds of pointer events\n * * trace: if true, intermediate events are captured and displayed\n * @param elOrQuery \n * @param opts \n */\nexport const pointerVisualise = (elOrQuery: HTMLElement | string, opts:Opts = {}) => {\n  const touchRadius = opts.touchRadius ?? 45;\n  const mouseRadius = opts.touchRadius ?? 20;\n  const trace = opts.trace ?? false;\n  const hue = opts.hue ?? 100;\n\n  const startFillStyle =`hsla(${hue}, 100%, 10%, 10%)`;\n\n  //eslint-disable-next-line functional/no-let\n  let currentHue = hue;\n\n  const el = resolveEl(elOrQuery);\n  const tracker = pointsTracker({\n    storeIntermediate:trace\n  });  \n\n  //eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const svg = (document.createElementNS(`http://www.w3.org/2000/svg`, `svg`) as any) as SVGElement & HTMLElement;\n  svg.id = `pointerVis`;\n  svg.style.zIndex = `-1000`;\n  svg.style.position = `fixed`;\n  svg.style.top = `0`;\n  svg.style.left = `0`;\n  svg.style.width = `100%`;\n  svg.style.height = `100%`;\n  svg.style.boxSizing = `border-box`;\n  svg.style.border = `3px solid red`;\n  svg.style.pointerEvents = `none`;\n  svg.style.touchAction = `none`;\n\n  fullSizeElement(svg);\n  //eslint-disable-next-line functional/no-let\n  let pointerCount = 0;\n\n  const lostPointer = async (ev:PointerEvent) => {\n    const id = ev.pointerId.toString();\n    tracker.delete(id);\n    currentHue = hue;\n    svg.querySelector(`#pv-start-${id}`)?.remove();\n\n    //eslint-disable-next-line functional/no-let\n    for (let i=0;i<pointerCount+10;i++) {\n      svg.querySelector(`#pv-progress-${id}-${i}`)?.remove();\n    }\n    pointerCount = 0;\n\n  };\n\n  const trackPointer = async (ev:PointerEvent) => {\n    const id = ev.pointerId.toString();\n    const pt = {x: ev.x, y: ev.y};\n    const type = ev.pointerType;\n    if (ev.type ===`pointermove` && !tracker.has(id)) {\n      return;\n    }\n    const info = await tracker.seen(id, pt) as PointTrackerResults;\n\n    if (info.values.length === 1) {\n      const el = Svg.Elements.circle({...info.values[0], radius: (type === `touch` ? touchRadius : mouseRadius)}, svg, {\n        fillStyle: startFillStyle,\n      }, `#pv-start-${id}`);\n      el.style.pointerEvents = `none`;\n      el.style.touchAction = `none`;\n\n    }\n\n    const progressFillStyle = `hsla(${currentHue}, 100%, 50%, 50%)`;\n    \n    const el2 = Svg.Elements.circle({...pt, radius: (type === `touch` ? touchRadius : mouseRadius)}, svg, {\n      fillStyle: progressFillStyle\n    }, `#pv-progress-${id}-${info.values.length}`);\n    el2.style.pointerEvents = `none`;\n    el2.style.touchAction =`none`;\n    currentHue +=1;\n    pointerCount = info.values.length;\n    return true;\n  };\n\n  document.body.appendChild(svg);\n\n  el.addEventListener(`pointerdown`, trackPointer);\n  el.addEventListener(`pointermove`, trackPointer);\n  el.addEventListener(`pointerup`, lostPointer);\n  el.addEventListener(`pointerleave`, lostPointer);\n  el.addEventListener(`contextmenu`, ev => {\n    ev.preventDefault();\n  });\n};","/* eslint-disable */\r\n\r\n/**\r\n * Creates an error handler to show errors on-screen.\r\n * This is useful when testing on mobile devices that lack access to the console.\r\n * \r\n * ```js\r\n * const e = defaultErrorHandler();\r\n * ```\r\n * \r\n * Manual control:\r\n * ```js\r\n * const e = defaultErrorHandler();\r\n * e.show(someError);\r\n * e.hide();\r\n * ```\r\n * @returns \r\n */\r\nexport const defaultErrorHandler = () => {\r\n  //eslint-disable-next-line functional/no-let\r\n  let enabled = true;\r\n  const container = document.createElement(`div`);\r\n  container.style.color = `black`;\r\n  container.style.border = `2px solid red`;\r\n  container.style.backgroundColor = `hsl(0, 80%, 90%)`;\r\n  container.style.padding = `1em`;\r\n  container.style.display = `none`;\r\n  container.style.top = `1em`;\r\n  container.style.left = `1em`;\r\n  container.style.position =`absolute`;\r\n\r\n  container.style.fontFamily =`monospace`;\r\n\r\n  const msgEl = document.createElement(`div`);\r\n  msgEl.style.maxWidth = `50vw`;\r\n  msgEl.style.maxHeight = `50vh`;\r\n  msgEl.style.overflowY = `scroll`;\r\n\r\n  container.innerHTML = `<h1>Error</h1>`;\r\n  container.append(msgEl);\r\n\r\n  const styleButton = (b:HTMLButtonElement) => {\r\n    b.style.padding = `0.3em`;\r\n    b.style.marginTop = `1em`;\r\n  }\r\n\r\n  const btnClose = document.createElement(`button`);\r\n  btnClose.innerText = `Close`;\r\n  btnClose.onclick = () => {\r\n    hide();\r\n  };\r\n\r\n  const btnStop = document.createElement(`button`);\r\n  btnStop.innerText = `Stop displaying errors`;\r\n  btnStop.onclick = () => {\r\n    enabled = false;\r\n    hide();\r\n  };\r\n\r\n  styleButton(btnClose);\r\n  styleButton(btnStop);\r\n\r\n  container.append(btnClose);\r\n  container.append(btnStop);\r\n  document.body.append(container);\r\n\r\n  const show = (ex:Error|string|Event) => {\r\n    container.style.display = `inline`;\r\n    if ((ex as any).stack) {\r\n      msgEl.innerHTML += `<pre>${(ex as any).stack}</pre>`;\r\n    } else {\r\n      msgEl.innerHTML += `<p>${ex}</p>`;\r\n    }\r\n  };\r\n\r\n  const hide = () => {\r\n    container.style.display =`none`;\r\n  };\r\n\r\n  window.onerror = (msg, url, lineNo, colNo, error) => {\r\n    if (enabled) {\r\n      if (error) {\r\n        console.log(error);\r\n        show(error);\r\n      } else {\r\n        console.log(msg);\r\n        show(msg);\r\n      }\r\n    }\r\n    \r\n  };\r\n\r\n  window.addEventListener(`unhandledrejection`, e => {\r\n    console.log(e.reason);\r\n    if (enabled)  {\r\n      show(e.reason);\r\n    }\r\n  })\r\n  return { show, hide};\r\n};","import { Points } from \"../geometry/index.js\";\n\nexport type DragState = {\n  readonly token?:object\n  readonly initial:Points.Point\n  readonly delta:Points.Point\n}\n\nexport type DragStart = {\n  readonly allow:boolean\n  readonly token:object\n}\nexport type DragListener = {\n  readonly start?:()=>DragStart\n  readonly progress?:(state:DragState)=>boolean\n  readonly abort?:(reason:string, state:DragState)=>void\n  readonly success?:(state:DragState)=>void\n}\n\nexport const draggable = (elem:SVGElement, listener:DragListener) => {\n  //eslint-disable-next-line functional/no-let\n  let initial = Points.Placeholder;\n  //eslint-disable-next-line functional/no-let\n  let token:object;\n\n  // De-select if there's a click elsewhere\n  const onParentClick = () => {\n    const selected = elem.classList.contains(`drag-sel`);\n    if (selected) {\n      elem.classList.remove(`drag-sel`);\n    }\n  };\n\n  // Click to select\n  const onElementClick = (evt:MouseEvent) => {\n    const selected = elem.classList.contains(`drag-sel`);\n    if (selected) {\n      elem.classList.remove(`drag-sel`);\n    } else {\n      elem.classList.add(`drag-sel`);\n    }\n    evt.stopPropagation();\n  };\n\n  elem.ownerDocument.addEventListener(`click`, onParentClick);\n  elem.addEventListener(`click`, onElementClick);\n\n  // Remove event handlers\n  const dragCleanup = () => {\n    elem.classList.remove(`drag-progress`);\n\n    elem.ownerDocument.removeEventListener(`pointermove`, onPointerMove);\n    elem.ownerDocument.removeEventListener(`pointerup`, onPointerUp);\n    elem.ownerDocument.removeEventListener(`pointercancel`, onDragCancel);\n  };\n\n  const dispose = () => {\n    console.log(`drag dispose`);\n    if (elem.classList.contains(`drag-progress`)) {\n      onDragCancel(null, `dispose`);\n    } else {\n      dragCleanup();\n    }\n    elem.ownerDocument.removeEventListener(`click`, onParentClick);\n    elem.removeEventListener(`click`, onElementClick);\n  };\n\n  // Dragging\n  const onPointerMove = (e:PointerEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    const offset = Points.isPlaceholder(initial) ? { x: e.offsetX, y: e.offsetY } : {\n      x: e.x - initial.x,\n      y: e.y - initial.y\n    };\n    const state:DragState = {\n      delta: offset,\n      initial: initial,\n      token\n    };\n    if (typeof listener.progress !== `undefined` && !listener.progress(state)) {\n      onDragCancel(null, `discontinued`);\n    }\n  };\n\n  // Done dragging\n  const onPointerUp = (e:PointerEvent) => {\n    dragCleanup();\n    const offset = {\n      x: e.x - initial.x,\n      y: e.y - initial.y\n    };\n    const state:DragState = {\n      initial: initial,\n      token,\n      delta: offset\n    };\n    if (typeof listener.success !== `undefined`) {\n      listener.success(state);\n    }\n  };\n\n  // Drag is cancelled\n  const onDragCancel = (evt:PointerEvent | MouseEvent | null, reason:string = `pointercancel`) => {\n    dragCleanup();\n    const state:DragState = {\n      token,\n      initial: initial,\n      delta: { x: -1, y: -1 }\n    };\n    if (typeof listener.abort !== `undefined`) {\n      listener.abort(reason, state);\n    }\n  };\n\n  elem.addEventListener(`pointerdown`, evt => {\n    const selected = elem.classList.contains(`drag-sel`);\n    if (!selected) return;\n\n    initial = { x: evt.x, y: evt.y };\n    const s = typeof listener.start !== `undefined` ? listener.start() : { allow: true, token };\n    if (!s.allow) return;\n\n    token = s.token;\n\n    elem.classList.add(`drag-progress`);\n    elem.ownerDocument.addEventListener(`pointermove`, onPointerMove);\n    elem.ownerDocument.addEventListener(`pointerup`, onPointerUp);\n    elem.ownerDocument.addEventListener(`pointercancel`, onDragCancel);\n  });\n\n  return dispose;\n};\n","import {RandomSource, defaultRandom} from '../Random.js';\nimport {clamp} from '../data/Clamp.js';\nimport {number as guardNumber} from '../Guards.js';\nimport * as Easings from './Easing.js';\nimport * as Envelopes from './Envelope.js';\nimport * as Forces from './Forces.js';\nimport * as Oscillators from './Oscillator.js';\n\nexport * from './PingPong.js';\n/**\n * Easings module\n * \n * [See the guide](https://clinth.github.io/ixfx-docs/modulation/easing/)\n * \n * Overview:\n * * {@link Easings.time}: Ease by time\n * * {@link Easings.tick}: Ease by tick\n * * {@link Easings.get}: Get an easing function by name\n * * {@link Easings.crossfade}: Mix two synchronised easing functions (a slight shortcut over `mix`)\n * * {@link Easings.mix}: Mix two easing functions\n * * {@link Easings.gaussian}: Gaussian distribution (rough bell curve)\n * \n * @example Importing\n * ```js\n * // If library is stored two directories up under `ixfx/`\n * import { Easings } from '../../ixfx/dist/modulation.js';\n * Easings.time(...);\n * \n * // Import from web\n * import { Easings } from 'https://unpkg.com/ixfx/dist/modulation.js'\n * Easings.time(...);\n * ```\n */\nexport {Easings};\n\n/**\n * Envelope\n */\nexport * from './Envelope.js';\n\n/**\n * Forces module can help to compute basic physical forces like gravity, friction, springs etc.\n * \n * @example Importing\n * ```js\n * // If library is stored two directories up under `ixfx/`\n * import { Forces } from '../../ixfx/dist/modulation.js';\n * Forces.attractionForce(...);\n * \n * // Import from web\n * import { Forces } from 'https://unpkg.com/ixfx/dist/modulation.js'\n * Forces.attractionForce(...);\n * ```\n * \n */\nexport {Forces};\n\n/**\n * Oscillators module has waveshapes for producing values with a specified frequency.\n * \n * Overview\n * * {@link Oscillators.saw}: 'Sawtooth' wave\n * * {@link Oscillators.sine}: Sine wave\n * * {@link Oscillators.sineBipolar}: Sine wave with range of -1 to 1\n * * {@link Oscillators.square}: Square wave\n * * {@link Oscillators.triangle}: Triangle wave\n * * {@link Oscillators.spring}: Spring oscillator\n * \n * @example On-demand sampling\n * ```js\n * // Saw wave with frequency of 0.10hZ\n * const osc = Oscillators.saw(0.1);\n * \n * // Whever we need to sample from the oscillator...\n * const v = osc.next().value;\n * ```\n * \n * @example Importing\n * ```js\n * // If library is stored two directories up under `ixfx/`\n * import { Oscillators } from '../../ixfx/dist/modulation.js';\n * Oscillators.saw(...);\n * \n * // Import from web\n * import { Oscillators } from 'https://unpkg.com/ixfx/dist/modulation.js'\n * Oscillators.saw(...);\n * ```\n * \n */\nexport {Oscillators};\n\nexport type JitterOpts = {\n  readonly type?: `rel`|`abs`,\n  readonly clamped?: boolean,\n  readonly random?: RandomSource\n}\n\n/**\n * Jitters `value` by the absolute `jitter` amount.\n * All values should be on a 0..1 scale, and the return value is by default clamped to 0..1. \n * Pass `clamped:false` as an option\n * to allow for arbitary ranges.\n * \n * ```js\n * import { jitter } from 'https://unpkg.com/ixfx/dist/modulation.js';\n * \n * // Jitter 0.5 by 10% (absolute)\n * // yields range of 0.4-0.6\n * jitter(0.5, 0.1);\n * \n * // Jitter 0.5 by 10% (relative, 10% of 0.5)\n * // yields range of 0.45-0.55\n * jitter(0.5, 0.1, { type:`rel` });\n * ```\n * \n * You can also opt not to clamp values:\n * ```js\n * // Yields range of -1.5 - 1.5\n * jitter(0.5, 1, { clamped:false });\n * ```\n * \n * A custom source for random numbers can be provided. Eg, use a weighted\n * random number generator:\n * \n * ```js\n * import { weighted } from 'https://unpkg.com/ixfx/dist/random.js';\n * jitter(0.5, 0.1, { random: weighted };\n * ```\n * \n * Options\n * * clamped: If false, `value`s out of percentage range can be used and return value may\n *    beyond percentage range. True by default\n * * type: if `rel`, `jitter` is considered to be a percentage relative to `value`\n *         if `abs`, `jitter` is considered to be an absolute value (default)\n * @param value Value to jitter\n * @param jitter Absolute amount to jitter by\n * @param opts Jitter options\n * @returns Jittered value\n */\nexport const jitter = (value:number, jitter:number, opts:JitterOpts = {}) => {\n \n  const type = opts.type ?? `abs`;\n  const clamped = opts.clamped ?? true;\n  const rand = opts.random ?? defaultRandom;\n\n  guardNumber(value, clamped ? `percentage` : `bipolar`, `value`);\n  guardNumber(jitter, clamped ? `percentage` :`bipolar`, `jitter`);\n\n  //eslint-disable-next-line functional/no-let\n  let v:number;\n  if (type === `rel`) {\n    jitter = value * jitter;\n    const j = jitter * 2 * rand();\n    v = value - jitter + j;\n  } else if (type === `abs`) {\n    const j = jitter * 2 * rand();\n    v = value - jitter + j;\n  } else {\n    throw new Error(`Unknown jitter type: ${type}.`);\n  }\n  if (clamped) return clamp(v);\n  return v;\n};\n\ntry {\n  if (typeof window !== `undefined`) {\n    //eslint-disable-next-line functional/immutable-data,@typescript-eslint/no-explicit-any\n    (window as any).ixfx = {...(window as any).ixfx, Modulation: {Forces, jitter, Envelopes, Oscillators, Easings}};\n  }\n} catch { /* no-op */ }","import {SimpleEventEmitter} from \"../Events.js\";\nimport {  msElapsedTimer, sleep, TimerSource} from \"../flow/index.js\";\nimport { Timer } from \"../flow/Timer.js\";\nimport { StateMachine } from \"../flow/StateMachine.js\";\nimport {Path} from \"../geometry/Path.js\";\nimport * as Bezier from '../geometry/Bezier.js';\nimport {scale} from \"../data/Scale.js\";\n\n/**\n * @returns Returns a full set of default ADSR options\n */\nexport const defaultAdsrOpts = ():EnvelopeOpts => ({\n  attackBend: -1,\n  decayBend: -.3,\n  releaseBend: -.3,\n  peakLevel: 1,\n  initialLevel: 0,\n  sustainLevel: 0.6,\n  releaseLevel: 0,\n  attackDuration: 600,\n  decayDuration: 200,\n  releaseDuration: 800,\n  shouldLoop: false\n});\n\nexport type EnvelopeOpts = AdsrOpts & AdsrTimingOpts;\n/**\n * Options for the ADSR envelope. \n * \n * Use {@link defaultAdsrOpts} to get an initial default:\n * @example\n * ```js\n * let env = adsr({\n *  ...defaultAdsrOpts(),\n *  attackDuration: 2000,\n *  releaseDuration: 5000,\n *  sustainLevel: 1,\n *  retrigger: false\n * });\n * ```\n */\nexport type AdsrOpts = {\n  /**\n   * Attack bezier 'bend'. Bend from -1 to 1. 0 for a straight line\n   */\n   readonly attackBend: number\n  /**\n   * Decay bezier 'bend'. Bend from -1 to 1. 0 for a straight line\n   */\n   readonly decayBend: number\n  /**\n   * Release bezier 'bend'. Bend from -1 to 1. 0 for a straight line\n   */\n   readonly releaseBend: number\n\n   /**\n    * Peak level (maximum of attack stage)\n    */\n   readonly peakLevel:number\n\n  /**\n   * Starting level (usually 0)\n   */\n   readonly initialLevel?:number\n/**\n * Sustain level. Only valid if trigger and hold happens\n */ \n   readonly sustainLevel:number\n/**\n * Release level, when envelope is done (usually 0)\n */\n   readonly releaseLevel?:number\n\n  /**\n   * When _false_, envelope starts from it's current level when being triggered.\n   * _True_ by default.\n   */\n  readonly retrigger?: boolean\n}\n\nexport type AdsrTimingOpts = {\n  /**\n   * If true, envelope indefinately returns to attack stage after release\n   *\n   * @type {boolean}\n   */\n  readonly shouldLoop: boolean\n\n  /**\n   * Duration for attack stage\n   * Unit depends on timer source\n   * @type {number}\n   */\n  readonly attackDuration: number\n  /**\n   * Duration for decay stage\n   * Unit depends on timer source\n   * @type {number}\n   */\n  readonly decayDuration: number\n  /**\n   * Duration for release stage\n   * Unit depends on timer source\n   * @type {number}\n   */\n  readonly releaseDuration: number\n}\n\n/**\n * State change event\n */\nexport interface StateChangeEvent {\n  readonly newState: string,\n  readonly priorState: string\n}\n\n// eslint-disable-next-line @typescript-eslint/no-empty-interface\nexport interface CompleteEvent { /* no-op */}\n\nexport type Events = {\n  readonly change: StateChangeEvent\n  readonly complete: CompleteEvent\n};\n\nclass AdsrBase extends SimpleEventEmitter<Events> {\n  readonly #sm:StateMachine;\n  readonly #timeSource:TimerSource;\n  #timer:Timer|undefined;\n\n  #holding:boolean;\n  #holdingInitial:boolean;\n\n  attackDuration:number;\n  decayDuration:number;\n  releaseDuration:number;\n  decayDurationTotal:number;\n  shouldLoop:boolean;\n\n  constructor(opts:AdsrTimingOpts) {\n    super();\n    \n    this.attackDuration = opts.attackDuration ?? 300;\n    this.decayDuration = opts.decayDuration ?? 500;\n    this.releaseDuration = opts.releaseDuration ?? 1000;\n    this.shouldLoop = opts.shouldLoop ?? false;\n\n    const descr ={\n      attack: [`decay`, `release`],\n      decay: [`sustain`, `release`],\n      sustain: [`release`],\n      release: [`complete`],\n      complete: null\n    };\n    \n    this.#sm = new StateMachine(`attack`, descr);\n    this.#sm.addEventListener(`change`, (ev => {\n      // Reset timer on release\n      if (ev.newState === `release` && this.#holdingInitial) {\n        this.#timer?.reset();\n      }\n      super.fireEvent(`change`, ev);\n    }));\n    this.#sm.addEventListener(`stop`, (ev => {\n      super.fireEvent(`complete`, ev);\n    }));\n    \n    this.#timeSource = msElapsedTimer;\n    this.#holding = this.#holdingInitial = false;\n\n    this.decayDurationTotal = this.attackDuration + this.decayDuration;\n  }\n\n  protected switchState():boolean {\n    if (this.#timer === undefined) return false;\n    // eslint-disable-next-line functional/no-let\n    let elapsed = this.#timer.elapsed;\n    const wasHeld = this.#holdingInitial && !this.#holding;\n   \n    // Change through states for as long as needed\n    // eslint-disable-next-line functional/no-let\n    let hasChanged = false;\n    do {\n      hasChanged = false;\n      switch (this.#sm.state) {\n      case `attack`:\n        if (elapsed > this.attackDuration || wasHeld) {\n          this.#sm.next();\n          hasChanged = true;\n        }\n        break;\n      case `decay`:\n        if (elapsed > this.decayDurationTotal || wasHeld) {\n          this.#sm.next();\n          hasChanged = true;\n        }\n        break;\n      case `sustain`:\n        if (!this.#holding || wasHeld) {\n          elapsed = 0;\n          this.#sm.next();\n          this.#timer?.reset();\n          hasChanged = true;\n        }\n        break;\n      case `release`:\n        if (elapsed > this.releaseDuration) {\n          this.#sm.next();\n          hasChanged = true;\n        }\n        break;\n      case `complete`:\n        if (this.shouldLoop) {\n          this.trigger(this.#holdingInitial);\n        }\n      }\n    } while (hasChanged);\n    return hasChanged;\n  }\n\n  /**\n   * Computes a stage progress from 0-1\n   * @param allowStateChange \n   * @returns \n   */\n  protected computeRaw(allowStateChange = true):[stage:string|undefined, amount:number, prevStage:string] {\n    if (this.#timer === undefined) return [undefined, 0, this.#sm.state];\n  \n    // Change state if necessary based on elapsed time\n    if (allowStateChange) this.switchState();\n    \n    const prevStage = this.#sm.state;\n\n    const elapsed = this.#timer.elapsed;\n    // eslint-disable-next-line functional/no-let\n    let relative = 0;\n    const state = this.#sm.state;\n    switch (state) {\n    case `attack`:\n      relative = elapsed / this.attackDuration;\n      break;\n    case `decay`:\n      relative = (elapsed - this.attackDuration) / this.decayDuration;\n      break;\n    case `sustain`:\n      relative = 1;\n      break;\n    case `release`:\n      relative = Math.min(elapsed / this.releaseDuration, 1);\n      break;\n    case `complete`:\n      return [undefined, 1, prevStage];\n    default:\n      throw new Error(`State machine in unknown state: ${state}`);\n    }\n    return [state, relative, prevStage];\n  }\n\n  get isDone():boolean {\n    return this.#sm.isDone;\n  }\n\n  onTrigger():void {\n    /* no op */\n  }\n\n  trigger(hold:boolean = false) {\n    this.onTrigger();\n\n    this.#sm.reset();\n    this.#timer = this.#timeSource();\n    this.#holding = hold;\n    this.#holdingInitial = hold;\n  }\n\n  compute(): void {\n    /* no-op */\n  }\n\n  release() {\n    if (this.isDone || !this.#holdingInitial) return; // Was never holding or done\n  \n    // Setting holding flag to false, computeRaw will change state\n    this.#holding = false;\n    this.compute();\n  }\n}\n\n/**\n * ADSR (Attack Decay Sustain Release) envelope. An envelope is a value that changes over time,\n * usually in response to an intial trigger. \n * \n * Created with the {@link adsr} function. [See the ixfx Guide on Envelopes](https://clinth.github.io/ixfx-docs/modulation/envelope/).\n * \n * @example Setup\n * ```js\n * import {adsr, defaultAdsrOpts} from 'https://unpkg.com/ixfx/dist/modulation.js'\n * const opts = {\n *  ...defaultAdsrOpts(),\n *  attackDuration: 1000,\n *  decayDuration: 200,\n *  sustainDuration: 100\n * }\n * const env = adsr(opts);\n * ```\n * \n * [Options for envelope](https://clinth.github.io/ixfx/types/Modulation.EnvelopeOpts.html) are as follows:\n * \n * ```js\n * initialLevel?: number\n * attackBend: number\n * attackDuration: number\n * decayBend: number\n * decayDuration:number\n * sustainLevel: number\n * releaseBend: number\n * releaseDuration: number\n * releaseLevel?: number\n * peakLevel: number\n * retrigger?: boolean\n * shouldLoop: boolean\n * ```\n * \n * If `retrigger` is false, re-triggers will continue at current level\n * rather than resetting to `initialLevel`.\n * \n * If `shouldLoop` is true, envelope loops until `release()` is called.\n * \n * @example Using\n * ```js\n * env.trigger(); // Start envelope\n * ...\n * // Get current value of envelope\n * const [state, scaled, raw] = env.compute();\n * ```\n * \n * * `state` is a string, one of the following: 'attack', 'decay', 'sustain', 'release', 'complete' \n * * `scaled` is a value scaled according to the stage's _levels_\n * * `raw` is the progress from 0 to 1 within a stage. ie. 0.5 means we're halfway through a stage.\n * \n * Instead of `compute()`, most usage of the envelope is just fetching the `value` property, which returns the same scaled value of `compute()`:\n * \n * ```js\n * const value = env.value; // Get scaled number\n * ```\n * \n * @example Hold & release\n * ```js\n * env.trigger(true);   // Pass in true to hold\n * ...envelope will stop at sustain stage...\n * env.release();      // Release into decay\n * ```\n * \n * Check if it's done:\n * \n * ```js\n * env.isDone; // True if envelope is completed\n * ```\n * \n * Envelope has events to track activity: 'change' and 'complete':\n * \n * ```\n * env.addEventListener(`change`, ev => {\n *  console.log(`Old: ${evt.oldState} new: ${ev.newState}`);\n * })\n * ```\n */\nexport interface Adsr extends SimpleEventEmitter<Events> {\n  /**\n   * Compute value of envelope at this point in time.\n   * \n   * Returns an array of [stage, scaled, raw]. Most likely you want to use {@link value} to just get the scaled value.\n   * @param allowStateChange If true (default) envelope will be allowed to change state if necessary before returning value\n   */\n  //eslint-disable-next-line functional/no-method-signature\n  compute(allowStateChange?:boolean):readonly [stage:string|undefined, scaled:number, raw:number]\n\n  /**\n   * Returns the scaled value\n   * Same as .compute()[1]\n   */\n  get value():number;\n /**\n  * Releases a held envelope. Has no effect if envelope was not held or is complete.\n  */\n  //eslint-disable-next-line functional/no-method-signature\n  release():void\n  /**\n   * Triggers envelope.\n   * \n   * If event is already trigged,\n   * it will be _retriggered_. If`opts.retriggered` is false (default)\n   * envelope starts again at `opts.initialValue`. Otherwise it starts at\n   * the current value.\n   * \n   * @param hold If _true_ envelope will hold at sustain stage\n   */\n  //eslint-disable-next-line functional/no-method-signature\n  trigger(hold?:boolean):void\n  /** \n   * _True_ if envelope is completed\n   */\n  //eslint-disable-next-line functional/no-method-signature\n  get isDone():boolean;\n}\n\nclass AdsrImpl extends AdsrBase implements Adsr {\n  readonly attackPath:Path;\n  readonly decayPath:Path;\n  readonly releasePath:Path;\n\n  readonly initialLevel;\n  readonly peakLevel;\n  readonly releaseLevel;\n  readonly sustainLevel;\n\n  readonly attackBend;\n  readonly decayBend;\n  readonly releaseBend;\n\n  protected initialLevelOverride:number|undefined;\n  readonly retrigger:boolean;\n  private releasedAt:number|undefined;\n\n  constructor(opts:EnvelopeOpts) {\n    super(opts);\n    this.initialLevel = opts.initialLevel ?? 0;\n    this.peakLevel = opts.peakLevel ?? 1;\n    this.releaseLevel = opts.releaseLevel ?? 0;\n    this.sustainLevel = opts.sustainLevel ?? 0.75;\n    this.retrigger = opts.retrigger ?? true;\n    \n    this.attackBend = opts.attackBend ?? 0;\n    this.releaseBend = opts.releaseBend ?? 0;\n    this.decayBend = opts.decayBend ?? 0;\n    \n    const max = 1;\n    this.attackPath = Bezier.toPath(Bezier.quadraticSimple(\n      {x: 0, y: this.initialLevel}, \n      {x: max, y: this.peakLevel}, \n      -this.attackBend\n    ));\n    this.decayPath = Bezier.toPath(Bezier.quadraticSimple(\n      {x: 0, y: this.peakLevel}, \n      {x: max, y: this.sustainLevel}, \n      -this.decayBend\n    ));\n    this.releasePath = Bezier.toPath(Bezier.quadraticSimple(\n      {x: 0, y: this.sustainLevel},\n      {x: max, y: this.releaseLevel}, \n      -this.releaseBend\n    ));\n  }\n\n  onTrigger() {\n    this.initialLevelOverride = undefined;\n    if (!this.retrigger) {      \n      const [_stage, scaled, _raw] = this.compute();\n      if (!Number.isNaN(scaled) && scaled > 0) {\n        this.initialLevelOverride = scaled;\n      }\n    }\n  }\n\n  get value():number {\n    return this.compute(true)[1];\n  }\n\n  compute(allowStateChange = true):[stage:string|undefined, scaled:number, raw:number] {\n    const [stage, amt] = super.computeRaw(allowStateChange);\n    if (stage === undefined) return [undefined, NaN, NaN];\n    // eslint-disable-next-line functional/no-let\n    let v;\n    switch (stage) {\n    case `attack`:\n      v = this.attackPath.interpolate(amt).y;\n      if (this.initialLevelOverride !== undefined) {\n        v = scale(v, 0, 1, this.initialLevelOverride, 1);\n      }\n      this.releasedAt = v;\n      break;\n    case `decay`:\n      v = this.decayPath.interpolate(amt).y;\n      this.releasedAt = v;\n      break;\n    case `sustain`:\n      v = this.sustainLevel;\n      this.releasedAt = v;\n      break;\n    case `release`:\n      v = this.releasePath.interpolate(amt).y;\n      // Bound release level to the amp level that we released at.\n      // ie. when release happens before a stage completes\n      if (this.releasedAt !== undefined) v = scale(v, 0, this.sustainLevel, 0, this.releasedAt);\n      break;\n    case `complete`:\n      v = this.releaseLevel;\n      this.releasedAt = undefined;\n      break;\n    default:\n      throw new Error(`Unknown state: ${stage}`);\n    }\n    return [stage, v, amt];\n  }\n}\n\n/**\n * Creates an {@link Adsr} envelope.\n * @param opts \n * @returns New {@link Adsr} Envelope\n */\nexport const adsr = (opts:EnvelopeOpts):Adsr => new AdsrImpl(opts);\n\n/**\n * Creates and runs an envelope, sampling its values at `sampleRateMs`.\n * \n * @example Init\n * ```js\n * import {adsrSample, defaultAdsrOpts} from 'https://unpkg.com/ixfx/dist/modulation.js';\n * import {IterableAsync} from  'https://unpkg.com/ixfx/dist/util.js';\n * \n * const opts = {\n *  ...defaultAdsrOpts(),\n *  attackDuration: 1000,\n *  releaseDuration: 1000,\n *  sustainLevel: 1,\n *  attackBend: 1,\n *  decayBend: -1\n * };\n * ```\n * \n * @example Add data to array\n * ```js\n * // Sample an envelope every 5ms into an array\n * const data = await IterableAsync.toArray(adsrSample(opts, 20));\n * ```\n * \n * @example Looping\n * ```js\n * // Work with values as sampled\n * for await (const v of adsrSample(opts, 5)) {\n *  // Work with envelope value `v`...\n * }\n * ```\n * @param opts Envelope options\n * @param sampleRateMs Sample rate\n * @returns \n */\n//eslint-disable-next-line func-style\nexport async function* adsrSample(opts:EnvelopeOpts, sampleRateMs:number) {\n  if (opts.shouldLoop) throw new Error(`Cannot sample a looping envelope`);\n  \n  const env = adsr(opts);\n\n  env.trigger();\n\n  while (true) {\n    await sleep(sampleRateMs);\n    const v = env.value;\n    if (env.isDone) return;\n    yield v;\n  }\n}\n// export function* adsrSample (opts:EnvelopeOpts, sampleRateMs:number) {\n//   if (opts.shouldLoop) throw new Error(`Cannot sample a looping envelope`);\n  \n//   const env = adsr(opts);\n//   //const data:number[] = [];\n\n//   //eslint-disable-next-line functional/no-let\n//   let started = false;\n\n//   return new Promise<number[]>((resolve, _reject) => {\n//     continuously(() => {\n//       if (!started) {\n//         started = true;\n//         env.trigger();\n//       }\n\n//       const v = env.value;\n//       //eslint-disable-next-line functional/immutable-data\n//       if (!Number.isNaN(v)) yield env.value;// data.push(env.value);\n//       if (env.isDone) {\n//         resolve(data);\n//         return false;\n//       }\n//     }, sampleRateMs).start();\n//   });\n// };","/**\n * Acknowledgements: much of the work here is an adapation from Daniel Shiffman's excellent _The Nature of Code_ website.\n */\nimport {Points, Polar} from '../geometry/index.js';\nimport { Point} from '../geometry/Point.js';\nimport {clamp} from '../data/Clamp.js';\nimport {interpolateAngle} from '../data/Interpolate.js';\nimport {Rect, getEdgeX, getEdgeY} from '../geometry/Rect.js';\n\n/**\n * Logic for applying mass\n */\nexport type MassApplication = `dampen`|`multiply`|`ignored`;\n\n\n/**\n * Basic properties of a thing that can be\n * affected by forces\n */\nexport type ForceAffected = {\n  /**\n   * Position. Probably best to use relative coordinates\n   */\n  readonly position?:Point\n  /**\n   * Velocity vector. \n   * Probably don't want to assign this yourself, but rather have it computed based on acceleration and applied forces\n   */\n  readonly velocity?:Point\n  /**\n   * Acceleration vector. Most applied forces will alter the acceleration, culminating in a new velocity being set and the\n   * acceleraton value zeroed\n   */\n  readonly acceleration?:Point\n  /**\n   * Mass. The unit is undefined, again best to think of this being on a 0..1 scale. Mass is particularly important\n   * for the attraction/repulsion force, but other forces can incorporate mass too.\n   */\n  readonly mass?:number\n\n  readonly angularAcceleration?:number;\n\n  readonly angularVelocity?:number;\n\n  readonly angle?:number;\n};\n\n/**\n * A function that updates values of a thing.\n * \n * These can be created using the xxxForce functions, eg {@link attractionForce}, {@link accelerationForce}, {@link magnitudeForce}, {@link velocityForce}\n */\nexport type ForceFn = (t:ForceAffected) => ForceAffected;\n\n/**\n * A vector to apply to acceleration or a force function\n */\nexport type ForceKind = Points.Point|ForceFn|null;\n\n/**\n * Throws an error if `t` is not of the `ForceAffected` shape.\n * @param t\n * @param name \n */\nexport const guard = (t:ForceAffected, name:string= `t`) => {\n  if (t === undefined) throw new Error(`Parameter ${name} is undefined. Expected ForceAffected`);\n  if (t === null) throw new Error(`Parameter ${name} is null. Expected ForceAffected`);\n  if (typeof t !== `object`) throw new Error(`Parameter ${name} is type ${typeof t}. Expected object of shape ForceAffected`);\n};\n\n\n/**\n * `constrainBounce` yields a function that affects `t`'s position and velocity such that it\n * bounces within bounds.\n * \n * ```js\n * // Setup bounce with area constraints\n * // Reduce velocity by 10% with each impact\n * const b = constrainBounce({ width:200, height:500 }, 0.9);\n * \n * // Thing\n * const t = {\n *  position: { x: 50,  y: 50 },\n *  velocity: { x: 0.3, y: 0.01 }\n * };\n * \n * // `b` returns an altereted version of `t`, with the\n * // bounce logic applied.\n * const bounced = b(t);\n * ```\n * \n * `dampen` parameter allows velocity to be dampened with each bounce. A value\n * of 0.9 for example reduces velocity by 10%. A value of 1.1 will increase velocity by\n * 10% with each bounce.\n * @param bounds Constraints of area\n * @params dampen How much to dampen velocity by. Defaults to 1 meaning there is no damping. \n * @returns A function that can perform bounce logic\n */\nexport const constrainBounce = (bounds:Rect = {width:1, height:1}, dampen=1) => {\n  const minX = getEdgeX(bounds, `left`);\n  const maxX = getEdgeX(bounds, `right`);\n  const minY = getEdgeY(bounds, `top`);\n  const maxY = getEdgeY(bounds, `bottom`);\n\n  return (t:ForceAffected):ForceAffected => {\n    const position = computePositionFromVelocity(t.position ?? Points.Empty, t.velocity ?? Points.Empty);\n    //eslint-disable-next-line functional/no-let\n    let velocity = t.velocity ?? Points.Empty;\n    //eslint-disable-next-line functional/no-let\n    let {x, y} = position;\n  \n    if (x > maxX) {\n      x = maxX;\n      velocity = Points.invert(Points.multiply(velocity, dampen), `x`);\n    } else if (x < minX) {\n      x = minX;\n      velocity = Points.invert(Points.multiply(velocity, dampen), `x`);\n    }\n\n    if (y > maxY) {\n      y = maxY;\n      velocity = Points.multiply(Points.invert(velocity, `y`), dampen);\n    } else if (position.y < minY) {\n      y = minY;\n      velocity = Points.invert(Points.multiply(velocity, dampen), `y`);\n    }\n    \n    return Object.freeze({\n      ...t,\n      position: {x, y},\n      velocity\n    });\n  };\n};\n\n\n/**\n * For a given set of attractors, returns a function that a sets acceleration of attractee.\n * Keep note though that this bakes-in the values of the attractor, it won't reflect changes to their state. For dynamic\n * attractors, it might be easier to use `computeAttractionForce`.\n * \n * @example Force\n * ```js\n * const f = Forces.attractionForce(sun, gravity);\n * earth = Forces.apply(earth, f);\n * ```\n * \n * @example Everything mutually attracted\n * ```js\n * // Create a force with all things as attractors.\n * const f = Forces.attractionForce(things, gravity);\n * // Apply force to all things.\n * // The function returned by attractionForce will automatically ignore self-attraction\n * things = things.map(a => Forces.apply(a, f));\n * ```\n * @param attractors \n * @param gravity \n * @param distanceRange \n * @returns \n */\nexport const attractionForce = (attractors:readonly ForceAffected[], gravity:number,  distanceRange:{readonly min?:number, readonly max?:number} = {}) => (attractee:ForceAffected):ForceAffected => {\n  //eslint-disable-next-line functional/no-let\n  let accel = attractee.acceleration ?? Points.Empty;\n  attractors.forEach(a => {\n    if (a === attractee) return;\n\n    const f = computeAttractionForce(a, attractee, gravity, distanceRange);\n    accel = Points.sum(accel, f);\n  });\n  return {\n    ...attractee,\n    acceleration: accel\n  };\n};\n\n\n/**\n * Computes the attraction force between two things.\n * Value for `gravity` will depend on what range is used for `mass`. It's probably a good idea\n * to keep mass to mean something relative - ie 1 is 'full' mass, and adjust the `gravity`\n * value until it behaves as you like. Keeping mass in 0..1 range makes it easier to apply to\n * visual properties later.\n * \n * @example Attractee and attractor, gravity 0.005\n * ```js\n * const attractor = { position: { x:0.5, y:0.5 }, mass: 1 };\n * const attractee = { position: Points.random(), mass: 0.01 };\n * attractee = Forces.apply(attractee, Forces.computeAttractionForce(attractor, attractee, 0.005));\n * ```\n * \n * @example Many attractees for one attractor, gravity 0.005\n * ```js\n * attractor =  { position: { x:0.5, y:0.5 }, mass: 1 };\n * attractees = attractees.map(a => Forces.apply(a, Forces.computeAttractionForce(attractor, a, 0.005)));\n * ```\n * \n * @example Everything mutually attracted\n * ```js\n * // Create a force with all things as attractors.\n * const f = Forces.attractionForce(things, gravity);\n * // Apply force to all things.\n * // The function returned by attractionForce will automatically ignore self-attraction\n * things = things.map(a => Forces.apply(a, f));\n * ```\n * \n * `attractor` thing attracting (eg, earth)\n * `attractee` thing being attracted (eg. satellite)\n * \n * \n * `gravity` will have to be tweaked to taste. \n * `distanceRange` clamps the computed distance. This affects how tightly the particles will orbit and can also determine speed. By default it is 0.001-0.7\n * @param attractor Attractor (eg earth)\n * @param attractee Attractee (eg satellite)\n * @param gravity Gravity constant\n * @param distanceRange Min/max that distance is clamped to.\n * @returns \n */\nexport const computeAttractionForce = (attractor:ForceAffected, attractee:ForceAffected, gravity:number, distanceRange:{readonly min?:number, readonly max?:number} = {}):Points.Point => {\n  if (attractor.position === undefined) throw new Error(`attractor.position not set`);\n  if (attractee.position === undefined) throw new Error(`attractee.position not set`);\n  \n  const distRangeMin = distanceRange.min ??  0.01;\n  const distRangeMax = distanceRange.max ?? 0.7;\n\n  // Vector between objects\n  const f = Points.normalise(Points.subtract(attractor.position, attractee.position));\n  \n  // Distance\n  const d = clamp(Points.distance(f), distRangeMin, distRangeMax);\n  \n  // Multiply vector by gravity, scaled by mass of things and distance\n  return Points.multiply(f, (gravity * (attractor.mass ?? 1) * (attractee.mass ?? 1)) / (d * d));\n};\n\nexport type TargetOpts = {\n  /**\n   * Acceleration scaling. Defaults to 0.001\n   */\n  readonly diminishBy?: number,\n  /**\n   * If distance is less than this range, don't move.\n   * If undefined (default), will try to get an exact position\n   */\n  readonly range?: Points.Point\n}\n/**\n * A force that moves a thing toward `targetPos`.\n * \n * ```js\n * const t = Forces.apply(t, Forces.targetForce(targetPos));\n * ```\n * @param targetPos \n * @param diminishBy Scales acceleration. Defaults to 0.001.\n * @returns \n */\nexport const targetForce = (targetPos:Points.Point, opts:TargetOpts = {}) => {\n  const fn = (t:ForceAffected):ForceAffected =>  {\n    const accel = computeAccelerationToTarget(targetPos, t.position ?? { x: 0.5, y: 0.5}, opts);\n    return {\n      ...t,\n      acceleration: Points.sum(t.acceleration ?? Points.Empty, accel)\n    };\n  };\n  return fn;\n};\n\n/**\n * Returns `pt` with x and y set to `setpoint` if either's absolute value is below `v`\n * @param pt \n * @param v \n * @returns \n */\nconst roundTo = (pt:Point, v:number, setpoint:number):Point => {\n  const x = Math.abs(pt.x);\n  const y = Math.abs(pt.y);\n\n  if (x < v && y < v) return {x:setpoint, y:setpoint};\n  if (x < v) return {x:setpoint, y:pt.y};\n  if (y < v) return {x:pt.x, y:setpoint};\n  return pt;\n};\n\n/**\n * Apply a series of force functions or forces to `t`. Null/undefined entries are skipped silently.\n * It also updates the velocity and position of the returned version of `t`.\n * \n * ```js\n * // Wind adds acceleration. Force is dampened by mass\n * const wind = Forces.accelerationForce({ x: 0.00001, y: 0 }, `dampen`);\n * \n * // Gravity adds acceleration. Force is magnified by mass\n * const gravity = Forces.accelerationForce({ x: 0, y: 0.0001 }, `multiply`);\n * \n * // Friction is calculated based on velocity. Force is magnified by mass\n * const friction = Forces.velocityForce(0.00001, `multiply`);\n * \n *  // Flip movement velocity if we hit a wall. And dampen it by 10%\n * const bouncer = Forces.constrainBounce({ width: 1, height: 1 }, 0.9);\n * \n * let t = {\n *  position: Points.random(),\n *  mass: 0.1\n * };\n * \n * // Apply list of forces, returning a new version of the thing\n * t = Forces.apply(t,\n *   gravity,\n *   wind,\n *   friction,\n *   bouncer\n * );\n * ```\n */\nexport const apply = (t:ForceAffected, ...accelForces:readonly ForceKind[]):ForceAffected => {\n  if (t === undefined) throw new Error(`t parameter is undefined`);\n\n  accelForces.forEach(f => {\n    if (f === null || f=== undefined) return;\n    if (typeof f === `function`) {\n      t = f(t);\n    } else {\n      t = {\n        ...t,\n        acceleration: Points.sum(t.acceleration ?? Points.Empty, f)\n      };\n    }\n  });\n\n  // Integate velocity from acceleration\n  const velo = computeVelocity(t.acceleration ?? Points.Empty, t.velocity ?? Points.Empty);\n  \n  // Compute position\n  const pos = computePositionFromVelocity(t.position ?? Points.Empty, velo);\n\n  const ff:ForceAffected = {\n    ...t,\n    position: pos,\n    velocity: velo,\n    // Clear accel, because it has been integrated into velocity\n    acceleration: Points.Empty\n  };\n  return ff;\n};\n\n\n/**\n * Apples `vector` to acceleration, scaling according to mass, based on the `mass` option.\n * It returns a function which can later be applied to a thing.\n * \n * ```js\n * import { Forces } from \"https://unpkg.com/ixfx/dist/modulation.js\"\n * // Acceleration vector of (0.1, 0), ie moving straight on horizontal axis\n * const f = Forces.accelerationForce({ x:0.1, y:0 }, `dampen`);\n * \n * // Thing to move\n * let t = { position: ..., acceleration: ... }\n * \n * // Apply force\n * t = f(t);  \n * ```\n * @param vector \n * @returns Force function\n */\nexport const accelerationForce = (vector:Points.Point, mass:MassApplication = `ignored`):ForceFn => (t:ForceAffected) => Object.freeze({\n  ...t,\n  acceleration: massApplyAccel(vector, t, mass) //Points.sum(t.acceleration ?? Points.Empty, op(t.mass ?? 1))\n});\n\n\n/**\n * Returns an acceleration vector with mass either dampening or multiplying it.\n * The passed-in `thing` is not modified.\n * \n * ```js\n * // Initial acceleration vector\n * const accel = { x: 0.1, y: 0};\n * \n * // Thing being moved\n * const thing = { mass: 0.5, position: ..., acceleration: ... }\n * \n * // New acceleration vector, affected by mass of `thing`\n * const accelWithMass = massApplyAccel(accel, thing, `dampen`);\n * ``` \n * Mass of thing can be factored in, according to `mass` setting. Use `dampen`\n * to reduce acceleration with greater mass of thing. Use `multiply` to increase\n * the effect of acceleration with a greater mass of thing. `ignored` means\n * mass is not taken into account. \n * \n * If `t` has no mass, the `mass` setting is ignored.\n * \n * This function is used internally by the predefined forces.\n *  \n * @param vector Vector force\n * @param thing Thing being affected\n * @param mass How to factor in mass of thing (default ignored)\n * @returns Acceleration vector\n */\nconst massApplyAccel = (vector:Points.Point, thing:ForceAffected, mass: MassApplication = `ignored`) => {\n  //eslint-disable-next-line functional/no-let\n  let op;\n  if (mass === `dampen`) op =  (mass:number) => Points.divide(vector, mass, mass);\n  else if (mass === `multiply`) op = (mass:number) => Points.multiply(vector, mass, mass);\n  else if (mass === `ignored`) {\n    op =  (_mass:number) => vector;\n  } else {\n    throw new Error(`Unknown 'mass' parameter '${mass}. Expected 'dampen', 'multiply' or 'ignored'`);\n  }\n  return Points.sum(thing.acceleration ?? Points.Empty, op(thing.mass ?? 1));\n  // if (t.mass) {\n  //   if (dampen) return Points.sum(t.acceleration ?? Points.Empty, Points.divide(v, t.mass ?? 1));\n  //   else return Points.sum(t.acceleration ?? Points.Empty, Points.multiply(v, t.mass ?? 1));\n  // }\n  // return v;\n};\n\n/**\n * A force based on the square of the thing's velocity.\n * It's like {@link velocityForce}, but here the velocity has a bigger impact.\n * \n * ```js\n * const thing = {\n *  position: { x: 0.5, y:0.5 },\n *  velocity: { x: 0.001, y:0 }\n * };\n * const drag = magnitudeForce(0.1);\n * \n * // Apply drag force to thing, returning result\n * const t = Forces.apply(thing, drag);\n * ```\n * @param force Force value\n * @param mass How to factor in mass \n * @returns Function that computes force\n */\nexport const magnitudeForce = (force:number, mass:MassApplication = `ignored`):ForceFn =>  (t:ForceAffected):ForceAffected => {\n  if (t.velocity === undefined) return t;\n\n  const mag = Points.distance(Points.normalise(t.velocity));\n  const magSq = force* mag * mag;\n  const vv = Points.multiply(Points.invert(t.velocity), magSq);\n  return Object.freeze({\n    ...t,\n    acceleration: massApplyAccel(vv, t, mass)\n  });\n};\n\n\n/**\n * Null force does nothing\n * @returns A force that does nothing\n */\nexport const nullForce = (t:ForceAffected):ForceAffected => t;\n\n/**\n * Force calculated from velocity of object. Reads velocity and influences acceleration.\n * \n * ```js\n * let t = { position: Points.random(), mass: 0.1 };\n * const friction = velocityForce(0.1, `dampen`);\n * \n * // Apply force, updating position and velocity\n * t = Forces.apply(t, friction);\n * ```\n * @param force Force\n * @param mass How to factor in mass\n * @returns Function that computes force\n */\nexport const velocityForce = (force:number, mass: MassApplication):ForceFn => {\n  // Invert velocity and then multiply by force\n  const pipeline = Points.pipeline(\n    // Points.normalise, \n    Points.invert, \n    (v:Point) => Points.multiply(v, force),\n  );\n\n  return (t:ForceAffected):ForceAffected => {\n    if (t.velocity === undefined) return t;\n\n    // Apply pipeline\n    const v = pipeline(t.velocity);    \n    return Object.freeze({\n      ...t,\n      acceleration: massApplyAccel(v, t, mass)\n    });\n  };\n};\n\n/**\n * Sets angle, angularVelocity and angularAcceleration based on\n *  angularAcceleration, angularVelocity, angle\n * @returns \n */\nexport const angularForce = () => (t:ForceAffected) => {\n  const acc = t.angularAcceleration ?? 0;\n  const vel = t.angularVelocity ?? 0;\n  const angle = t.angle ?? 0;\n\n  const v = vel + acc;\n  const a = angle + v;\n\n  return Object.freeze({\n    ...t,\n    angle: a,\n    angularVelocity: v,\n    angularAcceleration: 0 \n  });\n};\n\n// export const positionFromAngleForce = () => (t:ForceAffected) => {\n//   return Object.freeze({\n//     ...t,\n//     position: computePositionFromAngle()\n//   });\n// };\n\n/**\n * Yields a force function that applies the thing's acceleration.x to its angular acceleration.\n * @param scaling Use this to scale the accel.x value. Defaults to 20 (ie accel.x*20). Adjust if rotation is too much or too little\n * @returns \n */\nexport const angleFromAccelerationForce = (scaling:number = 20) => (t:ForceAffected) => {\n  const accel = t.acceleration ?? Points.Empty;\n  return Object.freeze({\n    ...t,\n    angularAcceleration: accel.x*scaling\n  });\n};\n\n/**\n * Yields a force function that applies the thing's velocity to its angular acceleration.\n * This will mean it points in the direction of travel.\n * @param interpolateAmt If provided, the angle will be interpolated toward by this amount. Defaults to 1, no interpolation\n * @returns \n */\nexport const angleFromVelocityForce = (interpolateAmt:number = 1) => (t:ForceAffected) => {\n  const a = Points.angle(t.velocity ?? Points.Empty);\n  return Object.freeze({\n    ...t,\n    angle: interpolateAmt < 1 ? interpolateAngle(interpolateAmt, t.angle ?? 0, a) : a\n  });\n};\n\n/**\n * Spring force\n * \n *  * ```js\n * // End of spring that moves\n * let thing = {\n *   position: { x: 1, y: 0.5 },\n *   mass: 0.1\n * };\n * \n * // Anchored other end of spring\n * const pinnedAt = {x: 0.5, y: 0.5};\n *\n * // Create force: length of 0.4\n * const springForce = Forces.springForce(pinnedAt, 0.4);\n * \n * continuously(() => {\n *  // Apply force\n *  thing = Forces.apply(thing, springForce);\n * }).start();\n * ```\n * [Read more](https://www.joshwcomeau.com/animation/a-friendly-introduction-to-spring-physics/)\n * \n * @param pinnedAt Anchored end of the spring\n * @param restingLength Length of spring-at-rest (default: 0.5)\n * @param k Spring stiffness (default: 0.0002)\n * @param damping Damping factor to apply, so spring slows over time. (default: 0.995)\n * @returns \n */\nexport const springForce = (pinnedAt:Points.Point, restingLength:number = 0.5, k = 0.0002, damping = 0.999) => (t:ForceAffected):ForceAffected => {\n  const dir = Points.subtract(t.position ?? Points.Empty, pinnedAt);\n  const mag = Points.distance(dir);\n  const stretch = Math.abs(restingLength - mag);\n\n  //console.log(`mag: ${mag.toPrecision(3)} stretch: ${stretch.toPrecision(3)} resting: ${restingLength} dir: ${dir.x.toPrecision(3)}, ${dir.y.toPrecision(3)}`);\n  //console.log(`pinnedAt: ${pinnedAt.x}, ${pinnedAt.y} pos: ${t.position?.x}, ${t.position?.y}`);\n  //console.log(t.velocity);\n  const f = Points.pipelineApply(\n    dir,\n    Points.normalise,\n    p => Points.multiply(p,  -k * stretch)\n  );\n\n  const accel = massApplyAccel(f, t, `dampen`);\n  const velo = computeVelocity(accel ?? Points.Empty, t.velocity ?? Points.Empty);\n  const veloDamped = Points.multiply(velo, damping, damping);\n  return {\n    ...t,\n    velocity: veloDamped,\n    acceleration: Points.Empty \n  };\n};\n\n/**\n * Pendulum force options\n */\nexport type PendulumOpts = {\n  /**\n   * Length of 'string' thing is hanging from. If\n   * undefined, the current length between thing and\n   * pinnedAt is used.\n   */\n  readonly length?: number,\n  /**\n   * Max speed of swing. Slower speed can reach equilibrium faster, since it\n   * might not swing past resting point.\n   * Default 0.001.\n   */\n  readonly speed?: number,\n  /**\n   * Damping, how much to reduce velocity. Default 0.995 (ie 0.5% loss)\n   */\n  readonly damping?:number\n}\n/**\n * The pendulum force swings something back and forth.\n * \n * ```js\n * // Swinger\n * let thing = {\n *   position: { x: 1, y: 0.5 },\n *   mass: 0.1\n * };\n * \n * // Position thing swings from (middle of screen)\n * const pinnedAt = {x: 0.5, y: 0.5};\n *\n * // Create force: length of 0.4\n * const pendulumForce = Forces.pendulumForce(pinnedAt, { length: 0.4 });\n * \n * continuously(() => {\n *  // Apply force\n *  // Returns a new thing with recalculated angularVelocity, angle and position.\n *  thing = Forces.apply(thing, pendulumForce);\n * }).start();\n * ```\n * \n * [Read more](https://natureofcode.com/book/chapter-3-oscillation/)\n * \n * @param pinnedAt Location to swing from (x:0.5, y:0.5 default)\n * @param opts Options\n * @returns \n */\nexport const pendulumForce = (pinnedAt:Points.Point = {x:0.5, y:0}, opts:PendulumOpts = {})  => (t:ForceAffected):ForceAffected => {\n  const length = opts.length ?? Points.distance(pinnedAt, t.position ?? Points.Empty);\n  const speed = opts.speed ?? 0.001;\n  const damping = opts.damping ?? 0.995;\n\n  //eslint-disable-next-line functional/no-let\n  let angle = t.angle;\n  if (angle === undefined) {\n    if (t.position) {\n      angle = Points.angle(pinnedAt, t.position) - Math.PI/2;\n    } else {\n      angle = 0; // Position wherever\n    }\n  }\n  const accel = (-1 * speed / length) * Math.sin(angle);\n  const v = (t.angularVelocity ?? 0) + accel;\n  angle += v;\n    \n  return Object.freeze({\n    angularVelocity: v * damping,\n    angle,\n    position: computePositionFromAngle(length, angle+Math.PI/2, pinnedAt)\n  });\n};\n\n/**\n * Compute velocity based on acceleration and current velocity\n * @param acceleration Acceleration\n * @param velocity Velocity\n * @param velocityMax If specified, velocity will be capped at this value\n * @returns \n */\nexport const computeVelocity = (acceleration:Points.Point, velocity:Points.Point, velocityMax?:number):Points.Point => {\n  const p = Points.sum(velocity, acceleration);\n  if (velocityMax !== undefined) return Points.clampMagnitude(p, velocityMax);\n  else return p;\n};\n\n/**\n * Returns the acceleration to get from `currentPos` to `targetPos`.\n * \n * @example Barebones usage:\n * ```js\n * const accel = Forces.computeAccelerationToTarget(targetPos, currentPos);\n * const vel = Forces.computeVelocity(accel, currentVelocity);\n * \n * // New position:\n * const pos = Points.sum(currentPos, vel);\n * ```\n * \n * @example Implementation:\n * ```js\n * const direction = Points.subtract(targetPos, currentPos);\n * const accel = Points.multiply(direction, diminishBy);\n * ```\n * @param currentPos Current position\n * @param targetPos Target position\n * @param opts Options\n * @returns \n */\nexport const computeAccelerationToTarget = (targetPos:Points.Point, currentPos:Points.Point, opts:TargetOpts = {}) => {\n\n  const diminishBy = opts.diminishBy ?? 0.001;\n\n  // Compare to current position of thing to get vector direction\n  const direction = Points.subtract(targetPos, currentPos);\n\n  if (opts.range) {\n    // If direction is less than range, return { x: 0, y: 0}\n    if (Points.compare(Points.abs(direction), opts.range) === -2) return Points.Empty;\n  }\n\n  // Diminish vector to make a meaningful acceleration\n  return Points.multiply(direction, diminishBy); \n};\n\n/**\n * Compute a new position based on existing position and velocity vector\n * @param position Position Current position\n * @param velocity Velocity vector\n * @returns Point\n */\nexport const computePositionFromVelocity = (position:Points.Point, velocity:Points.Point):Points.Point => Points.sum(position, velocity);\n\n/**\n * Compute a position based on distance and angle from origin\n * @param distance Distance from origin\n * @param angleRadians Angle, in radians from origin\n * @param origin Origin point\n * @returns Point\n */\nexport const computePositionFromAngle = (distance:number, angleRadians:number, origin:Points.Point) => Polar.toCartesian(distance, angleRadians, origin);\n\nconst _angularForce = angularForce();\nconst _angleFromAccelerationForce = angleFromAccelerationForce();\n\n/**\n * A force that orients things according to direction of travel.\n * \n * Under the hood, it applies:\n * * angularForce,\n * * angleFromAccelerationForce, and\n * * angleFromVelocityForce\n * @param interpolationAmt \n * @returns \n */\nexport const orientationForce = (interpolationAmt = 0.5):ForceFn => {\n  const angleFromVel = angleFromVelocityForce(interpolationAmt);\n\n  return (t:ForceAffected) => {\n    t = _angularForce(t);\n    t = _angleFromAccelerationForce(t);\n    t = angleFromVel(t);\n    return t;\n  };\n};","import * as Timers from '../flow/Timer.js';\n\nconst piPi = Math.PI*2;\n\nexport type SpringOpts = {\n  /**\n   * Default: 1\n   */\n\treadonly mass?: number; // = 1.0\n  /**\n   * Default: 10\n   */\n\treadonly damping?: number; // = 10.0\n  /**\n   * Default: 100\n   */\n\treadonly stiffness?: number; // = 100.0\n  /**\n   * Default: false\n   */\n\treadonly soft?: boolean; // = false\n\n  /**\n   * Default: 0.1\n   */\n  readonly velocity?:number\n\n  /**\n   * How many iterations to wait for spring settling (default: 10)\n   */\n  readonly countdown?:number\n}\n\nconst springRaw = (opts: SpringOpts = {}, from: number = 0, to: number = 1) => {\n  /** MIT License github.com/pushkine/ */\n  const mass = opts.mass ?? 1;\n  const stiffness = opts.stiffness ?? 100;\n  const soft = opts.soft ?? false;\n  const damping = opts.damping ?? 10;\n  const velocity = opts.velocity ?? 0.1;\n  const delta = to - from;\n  if (true === soft || 1.0 <= damping / (2.0 * Math.sqrt(stiffness * mass))) {\n    const angularFrequency = -Math.sqrt(stiffness / mass);\n    const leftover = -angularFrequency * delta - velocity;\n    return (t: number) => to - (delta + t * leftover) * Math.E ** (t * angularFrequency);\n  } else {\n    const dampingFrequency = Math.sqrt(4.0 * mass * stiffness - damping ** 2.0);\n    const leftover = (damping * delta - 2.0 * mass * velocity) / dampingFrequency;\n    const dfm = (0.5 * dampingFrequency) / mass;\n    const dm = -(0.5 * damping) / mass;\n    return (t: number) => to - (Math.cos(t * dfm) * delta + Math.sin(t * dfm) * leftover) * Math.E ** (t * dm);\n  }\n};\n\n/**\n * Spring-style oscillation\n * \n * ```js\n * import { Oscillators } from \"https://unpkg.com/ixfx/dist/modulation.js\"\n * const spring = Oscillators.spring();\n * \n * continuously(() => {\n *  const v = spring.next().value;\n *  // Yields values 0...1\n *  //  undefined is yielded when spring is estimated to have stopped\n * });\n * ``` \n * \n * Parameters to the spring can be provided.\n * ```js\n * const spring = Oscillators.spring({\n *  mass: 5,\n *  damping: 10\n *  stiffness: 100\n * });\n * ```\n * @param opts Options for spring\n * @param timerOrFreq Timer to use, or frequency\n */\n//eslint-disable-next-line func-style\nexport function* spring(opts:SpringOpts = {}, timerOrFreq:Timers.Timer|number|undefined) {\n  if (timerOrFreq === undefined) timerOrFreq = Timers.msElapsedTimer();\n  else if (typeof timerOrFreq === `number`) timerOrFreq = Timers.frequencyTimer(timerOrFreq);\n\n  const fn = springRaw(opts, 0, 1);\n\n  // Give it some iterations to settle\n  //eslint-disable-next-line functional/no-let\n  let doneCountdown = opts.countdown ?? 10;\n\n  while (doneCountdown > 0) {\n    const s = fn(timerOrFreq.elapsed/1000);\n    yield s;\n    if (s === 1) {\n      doneCountdown--;\n    } else {\n      doneCountdown = 100;\n    }\n  }\n}\n\n/**\n * Sine oscillator.\n * \n * ```js\n * import { Oscillators } from \"https://unpkg.com/ixfx/dist/modulation.js\"\n * \n * // Setup\n * const osc = Oscillators.sine(Timers.frequencyTimer(10));\n * const osc = Oscillators.sine(0.1);\n * \n * // Call whenever a value is needed\n * const v = osc.next().value;\n * ```\n * \n * @example Saw/tri pinch\n * ```js\n * const v = Math.pow(osc.value, 2);\n * ```\n * \n * @example Saw/tri bulge\n * ```js\n * const v = Math.pow(osc.value, 0.5);\n * ```\n * \n */\n//eslint-disable-next-line func-style\nexport function* sine(timerOrFreq:Timers.Timer|number) {\n  if (typeof timerOrFreq === `number`) timerOrFreq = Timers.frequencyTimer(timerOrFreq);\n  \n  while (true) {\n    // Rather than -1 to 1, we want 0 to 1\n    yield (Math.sin(timerOrFreq.elapsed*piPi) + 1) / 2;\n  }\n}\n\n/**\n * Bipolar sine (-1 to 1)\n * @param timerOrFreq \n */\n//eslint-disable-next-line func-style\nexport function* sineBipolar(timerOrFreq:Timers.Timer|number) {\n  if (typeof timerOrFreq === `number`) timerOrFreq = Timers.frequencyTimer(timerOrFreq);\n  while (true) {\n    yield Math.sin(timerOrFreq.elapsed*piPi);\n  }\n}\n\n/**\n * Triangle oscillator\n * \n * ```js\n * // Setup\n * const osc = triangle(Timers.frequencyTimer(0.1));\n * const osc = triangle(0.1);\n * \n * // Call whenver a value is needed\n * const v = osc.next().value;\n * ```\n */\n//eslint-disable-next-line func-style\nexport function* triangle(timerOrFreq:Timers.Timer|number) {\n  if (typeof timerOrFreq === `number`) timerOrFreq = Timers.frequencyTimer(timerOrFreq);\n  while (true) {\n    // elapsed is repeatedly 0->1\n    //eslint-disable-next-line functional/no-let\n    let v = timerOrFreq.elapsed; \n    // /2 = 0->0.5\n    if (v < 0.5) {\n      // Upward\n      v *= 2;        \n    } else {\n      // Downward\n      v = 2 - v*2;\n    }\n    yield v;\n  }\n}\n\n/**\n * Saw oscillator\n * \n * ```js\n * import { Oscillators } from \"https://unpkg.com/ixfx/dist/modulation.js\"\n * \n * // Setup\n * const osc = Oscillators.saw(Timers.frequencyTimer(0.1));\n * \n * // Or\n * const osc = Oscillators.saw(0.1);\n * \n * // Call whenever a value is needed\n * const v = osc.next().value;\n * ```\n */\n//eslint-disable-next-line func-style\nexport function* saw(timerOrFreq:Timers.Timer|number) {\n  if (typeof timerOrFreq === `number`) timerOrFreq = Timers.frequencyTimer(timerOrFreq);\n  while (true) {\n    yield timerOrFreq.elapsed;\n  }\n}\n\n/**\n * Square oscillator\n * \n * ```js\n * import { Oscillators } from \"https://unpkg.com/ixfx/dist/modulation.js\"\n * \n * // Setup\n * const osc = Oscillators.square(Timers.frequencyTimer(0.1));\n * const osc = Oscillators.square(0.1);\n * \n * // Call whenever a value is needed\n * osc.next().value;\n * ```\n */\n//eslint-disable-next-line func-style\nexport function* square(timerOrFreq:Timers.Timer|number) {\n  if (typeof timerOrFreq === `number`) timerOrFreq = Timers.frequencyTimer(timerOrFreq);\n  while (true) {   \n    yield (timerOrFreq.elapsed < 0.5) ? 0 : 1;\n  }\n}","///  Unit tested!\n\nimport { ToString } from \"../Util.js\";\nimport {SimpleEventEmitter} from \"../Events.js\";\nimport * as KeyValueUtil from '../KeyValue.js';\nimport {KeyValues} from \"../index.js\";\n\nexport type FrequencyEventMap = {\n  readonly change:void;\n}\n\nexport class FrequencyMutable<V> extends SimpleEventEmitter<FrequencyEventMap> {\n  readonly #store:Map<string, number>;\n  readonly #keyString: ToString<V>;\n\n  /**\n   * Constructor\n   * @param keyString Function to key items. Uses JSON.stringify by default\n   */\n  constructor(keyString: ToString<V> | undefined = undefined) {\n    super();\n    this.#store = new Map();\n\n    if (keyString === undefined) {\n      keyString = (a) => {\n        if (a === undefined) throw new Error(`Cannot create key for undefined`);\n        if (typeof a === `string`) { \n          return a;\n        } else { \n          return JSON.stringify(a);\n        }\n      };\n    }\n    this.#keyString = keyString;\n  }\n\n  /**\n   * Clear data. Fires `change` event\n   */\n  clear() {\n    this.#store.clear();\n    this.fireEvent(`change`, undefined);\n  }\n  \n  /**\n   * @returns Iterator over keys (ie. groups)\n   */\n  keys():IterableIterator<string> {\n    return this.#store.keys();\n  }\n\n  /**\n   * @returns Iterator over frequency counts\n   */\n  values():IterableIterator<number> {\n    return this.#store.values();\n  }\n\n  /**\n   * @returns Copy of entries as an array of `[key, count]`\n   */\n  toArray():[key:string, count:number][] {\n    return Array.from(this.#store.entries());\n  }\n  \n  /**\n   * Returns a string with keys and counts, useful for debugging.\n   * @returns \n   */\n  debugString():string {\n    //eslint-disable-next-line functional/no-let\n    let t = ``;\n    for (const [key, count] of this.#store.entries()) {\n      t += `${key}: ${count}, `;\n    }\n    if (t.endsWith(`, `)) return t.substring(0, t.length-2);\n    return t;\n  }\n\n  /**\n   * \n   * @param value Value to count\n   * @returns Frequency of value, or _undefined_ if it does not exist\n   */\n  frequencyOf(value:V|string):number|undefined {\n    if (typeof value === `string`) return this.#store.get(value);\n\n    const key = this.#keyString(value);\n    return this.#store.get(key);\n  }\n\n  /**\n   * \n   * @param value Value to count\n   * @returns Relative frequency of `value`, or _undefined_ if it does not exist\n   */\n  relativeFrequencyOf(value:V|string):number|undefined {\n    //eslint-disable-next-line functional/no-let\n    let freq:number|undefined;\n    if (typeof value === `string`) freq = this.#store.get(value);\n    else {\n      const key = this.#keyString(value);\n      freq = this.#store.get(key);\n    }\n    if (freq === undefined) return;\n\n    const mma = this.minMaxAvg();\n    return freq / mma.total;\n  }\n\n  /**\n   * @returns Copy of entries as an array \n   */\n  entries():Array<KeyValueUtil.KeyValue> {\n    return Array.from(this.#store.entries());\n  }\n  \n  /**\n   * \n   * @returns Returns `{min,max,avg,total}`\n   */\n  minMaxAvg() {\n    return KeyValues.minMaxAvg(this.entries());\n  }\n\n  /**\n   * \n   * @param sortStyle Sorting style (default: _value_, ie. count)\n   * @returns Sorted array of [key,frequency]\n   */\n  entriesSorted(sortStyle:`value` | `valueReverse` | `key` | `keyReverse` = `value`):ReadonlyArray<KeyValues.KeyValue> {\n    const s = KeyValueUtil.getSorter(sortStyle);\n    return s(this.entries());\n  }\n\n  /**\n   * \n   * @param values Values to add. Fires _change_ event after adding item(s)\n   */\n  add(...values:V[]) {\n    if (values === undefined) throw new Error(`value parameter is undefined`);\n    \n    const keys = values.map(this.#keyString);\n    \n    //const key = this.#keyString(value);\n    keys.forEach(key => {\n      const score = this.#store.get(key) ?? 0;\n      this.#store.set(key, score+1);  \n    });\n    this.fireEvent(`change`, undefined);\n  }\n}\n\n/**\n * Frequency keeps track of how many times a particular value is seen, but\n * unlike a Map it does not store the data. By default compares\n * items by value (via JSON.stringify).\n * \n * Create with {@link frequencyMutable}.\n * \n * Fires `change` event when items are added or it is cleared.\n *\n * Overview\n * ```\n * const fh = frequencyMutable();\n * fh.add(value); // adds a value\n * fh.clear();    // clears all data\n * fh.keys() / .values() // returns an iterator for keys and values\n * fh.toArray();  //  returns an array of data in the shape [[key,freq],[key,freq]...]\n * ```\n * \n * Usage\n * ```\n * const fh = frequencyMutable();\n * fh.add(`apples`); // Count an occurence of `apples`\n * fh.add(`oranges)`;\n * fh.add(`apples`);\n * \n * const fhData = fh.toArray(); // Expect result [[`apples`, 2], [`oranges`, 1]]\n * fhData.forEach((d) => {\n *  const [key,freq] = d;\n *  console.log(`Key '${key}' occurred ${freq} time(s).`);\n * })\n * ```\n * \n * Custom key string\n * ```\n * const fh = frequencyMutable( person => person.name);\n * // All people with name `Samantha` will be counted in same group\n * fh.add({name:`Samantha`, city:`Brisbane`});\n * ```\n * @template V Type of items\n */\nexport const frequencyMutable = <V>(keyString?:ToString<V>|undefined) => new FrequencyMutable<V>(keyString);\n","import { Arrays, queueMutable } from '../collections/index.js';\nimport { integer as guardInteger } from '../Guards.js';\n\n/**\n * A moving average calculator (exponential weighted moving average) which does not keep track of\n * previous samples. Less accurate, but uses less system resources.\n * \n * The `scaling` parameter determines smoothing. A value of `1` means that\n * the latest value is used as the average - that is, no smoothing. Higher numbers\n * introduce progressively more smoothing by weighting the accumulated prior average more heavily.\n * \n * `add()` adds a new value and returns the calculated average.\n * \n * ```\n * const ma = movingAverageLight(); // default scaling of 3\n * ma.add(50);  // 50\n * ma.add(100); // 75\n * ma.add(75);  // 75\n * ma.add(0);   // 50\n * ```\n * \n * Note that the final average of 50 is pretty far from the last value of 0. To make it more responsive,\n * we could use a lower scaling factor: `movingAverageLight(2)`. This yields a final average of `37.5` instead.\n * \n * Use `clear()` to reset the moving average, or `compute()` to get the current value without adding.\n * @param scaling Scaling factor. 1 is no smoothing. Default: 3\n * @returns {@link MovingAverage} \n */\nexport const movingAverageLight = (scaling:number = 3):MovingAverage => {\n  guardInteger(scaling, `aboveZero`, `scaling`);\n  //eslint-disable-next-line functional/no-let\n  let average = 0;\n  //eslint-disable-next-line functional/no-let\n  let count = 0;\n\n  //eslint-disable-next-line functional/no-let\n  let disposed = false;\n  const ma:MovingAverage = {\n    dispose() {\n      disposed = true;\n    },\n    get isDisposed() {\n      return disposed;\n    },\n    add(v:number) {\n      if (disposed) throw new Error(`MovingAverage disposed, cannot add`);\n      count++;\n      average = average + (v - average) / Math.min(count, scaling);\n      return average;\n    },\n    clear() {\n      if (disposed) throw new Error(`MovingAverage disposed, cannot clear`);\n      average = 0;\n      count = 0;\n    },\n    compute() {\n      return average;\n    }\n  };\n  return ma;\n};\n\n/**\n * Uses the same algorithm as {@link movingAverageLight}, but adds values automatically if\n * nothing has been manually added.\n * \n * This is useful if you are averaging something based on events. For example calculating the\n * average speed of the pointer. If there is no speed, there is no pointer move event. Using\n * this function, `value` is added at a rate of `updateRateMs`. This timer is reset\n * every time a value is added, a bit like the `debounce` function.\n * @param updateRateMs \n * @param value \n * @param scaling \n * @returns \n */\nexport const movingAverageTimed = (updateRateMs:number = 200, value:number = 0, scaling:number = 3):MovingAverage => {\n  guardInteger(scaling, `aboveZero`, `scaling`);\n  guardInteger(updateRateMs, `aboveZero`, `decayRateMs`);\n  \n  const mal = movingAverageLight(scaling);\n\n  //eslint-disable-next-line functional/no-let\n  let timer = 0;\n\n  const reschedule = () => {\n    if (timer !== 0) clearTimeout(timer);\n    // @ts-ignore\n    timer = setTimeout(decay, updateRateMs) as number;\n  };\n  \n  const decay = () => {\n    mal.add(value);\n    if (!mal.isDisposed) setTimeout(decay, updateRateMs);\n  };\n\n  const ma:MovingAverage = {\n    add(v:number) {\n      reschedule();\n      return mal.add(v);\n    },\n\n    dispose() {\n      mal.dispose();\n    },\n    clear: function ():void {\n      mal.clear();\n    },\n    compute: function ():number {\n      return mal.compute();\n    },\n    isDisposed: false\n  };\n\n  return ma;\n};\n\n/**\n * Creates a moving average for a set number of `samples`.\n * \n * Moving average are useful for computing the average over a recent set of numbers.\n * A lower number of samples produces a computed value that is lower-latency yet more jittery.\n * A higher number of samples produces a smoother computed value which takes longer to respond to\n * changes in data.\n * \n * Sample size is considered with respect to the level of latency/smoothness trade-off, and also\n * the rate at which new data is added to the moving average.\n * \n* `add` adds a number and returns the computed average. Call `compute` to \n * get the average without adding a new value.\n * \n * ```js\n * import { movingAverage } from 'https://unpkg.com/ixfx/dist/data.js';\n * \n * const ma = movingAverage(10);\n * ma.add(10); // 10\n * ma.add(5);  // 7.5\n * ```\n * \n * `clear` clears the average.\n * \n * A weighting function can be provided to shape how the average is\n * calculated - eg privileging the most recent data over older data.\n * It uses `Arrays.averageWeighted` under the hood.\n * \n * ```js\n * import { movingAverage } from 'https://unpkg.com/ixfx/dist/data.js';\n * \n * // Give more weight to data in middle of sampling window\n * const ma = movingAverage(100, Easings.gaussian());\n * ```\n * \n * Because it keeps track of `samples` previous data, there is a memory impact. A lighter version is {@link movingAverageLight} which does not keep a buffer of prior data, but can't be as easily fine-tuned.\n * @param samples Number of samples to compute average from\n * @param weightingFn Optional weighting function\n * @returns \n */\nexport const movingAverage = (samples = 100, weightingFn?:(v:number)=>number):MovingAverage => {\n  \n  //eslint-disable-next-line functional/no-let\n  let disposed = false;\n\n  //eslint-disable-next-line functional/no-let\n  let q = queueMutable<number>({\n    capacity: samples,\n    discardPolicy: `older`\n  });\n  \n  const clear = () => {\n    q = queueMutable<number>({\n      capacity: samples,\n      discardPolicy: `older`\n    });\n  };\n\n  const compute = () => {\n    if (weightingFn === undefined) {\n      return Arrays.average(q.data);\n    } else {\n      return Arrays.averageWeighted(q.data, weightingFn);\n    }\n  };\n\n  const add = (v:number) => {\n    q.enqueue(v);\n    return compute();\n  };\n\n  const dispose = () => {\n    disposed = true;\n  };\n\n  return { add, compute, clear, dispose, isDisposed:disposed };\n};\n\n/**\n * Moving average.\n * Create via {@link movingAverage} or {@link movingAverageLight}.\n */\nexport type MovingAverage = {\n  /**\n   * Clear data\n   */\n  clear():void\n  /**\n   * Returns current average\n   */\n  compute():number\n  /**\n   * Adds a value, returning new average\n   * @param v Value to add\n   */\n  add(v:number):number\n\n  dispose():void;\n  get isDisposed():boolean;\n}\n","import { NumberTracker } from \"./NumberTracker.js\";\nimport { TrackedValueOpts as TrackOpts } from \"./TrackedValue.js\";\n\n/**\n * A `Tracker` that tracks interval between calls to `mark()`\n *\n * @export\n * @class IntervalTracker\n * @extends {ValueTracker}\n */\nexport class IntervalTracker extends NumberTracker {\n  lastMark = 0;\n\n  mark() {\n    if (this.lastMark > 0) {\n      this.seen(window.performance.now() - this.lastMark);\n    }\n    this.lastMark = window.performance.now();\n  }\n}\n\n/**\n * Returns a new {@link IntervalTracker} instance. IntervalTracker\n * records the interval between each call to `mark`.\n * \n * ```js\n * import { intervalTracker } from 'https://unpkg.com/ixfx/dist/data.js';\n * \n * const t = intervalTracker();\n * \n * // Call `mark` to record an interval\n * t.mark();\n * ...\n * t.mark();\n * \n * // Get average time in milliseconds between calls to `mark`\n * t.avg;\n * \n * // Longest and shortest times are available too...\n * t.min / t.max\n * ```\n * \n * Interval tracker can automatically reset after a given number of samples:\n * \n * ```\n * // Reset after 100 samples\n * const t = intervalTracker({ resetAfterSamples: 100} );\n * ```\n * @param opts Options for tracker\n * @returns New interval tracker\n */\nexport const intervalTracker = (opts?:TrackOpts) => new IntervalTracker(opts);","import { NumberFunction } from \".\";\nimport { number as guardNumber } from \"../Guards.js\";\n\n/**\n * Flips a percentage-scale number: `1 - v`.\n * \n * The utility of this function is that it sanity-checks\n * that `v` is in 0..1 scale.\n * \n * ```js\n * flip(1);   // 0\n * flip(0.5); // 0.5\n * flip(0);   // 1\n * ```\n * @param v \n * @returns \n */\nexport const flip = (v:number|NumberFunction) => {\n  if (typeof v === `function`) v = v();\n  guardNumber(v, `percentage`, `v`);\n  return 1 - v;\n};","import { number as guardNumber, integer as guardInteger} from \"../Guards.js\";\n\n/**\n * Wraps an integer number within a specified range, defaulting to degrees (0-360). Use {@link wrap} for floating-point wrapping.\n * \n * This is useful for calculations involving degree angles and hue, which wrap from 0-360.\n * Eg: to add 200 to 200, we don't want 400, but 40.\n * \n * ```js\n * const v = wrapInteger(200+200, 0, 360); // 40\n * ```\n * \n * Or if we minus 100 from 10, we don't want -90 but 270\n * ```js\n * const v = wrapInteger(10-100, 0, 360); // 270\n * ```\n * \n * `wrapInteger` uses 0-360 as a default range, so both of these\n * examples could just as well be:\n * \n * ```js\n * wrapInteger(200+200);  // 40\n * wrapInteger(10-100);  // 270\n * ```\n * \n * Non-zero starting points can be used. A range of 20-70: \n * ```js\n * const v = wrapInteger(-20, 20, 70); // 50 \n * ```\n * \n * Note that the minimum value is inclusive, while the maximum is _exclusive_.\n * So with the default range of 0-360, 360 is never reached:\n * \n * ```js\n * wrapInteger(360); // 0\n * wrapInteger(361); // 1\n * ```\n * \n * If you just want to lock values to a range without wrapping, consider {@link clamp}.\n * \n * @param v Value to wrap\n * @param min Integer minimum of range (default: 0). Inclusive\n * @param max Integer maximum of range (default: 360). Exlusive\n * @returns \n */\nexport const wrapInteger = (v:number, min:number = 0, max:number = 360) => {\n  guardInteger(v, undefined, `v`);\n  guardInteger(min, undefined, `min`);\n  guardInteger(max, undefined, `max`);\n\n  if (v === min) return min;\n  if (v === max) return min; // Wraps\n  if (v > 0 && v < min) v += min;\n  \n  v -= min;\n  max -= min;\n  v = v%max;\n  \n  if (v < 0) v = max - Math.abs(v) + min;\n  return v + min;\n};\n\n/**\n * Wraps floating point numbers to be within a range (default: 0..1). Use {@link wrapInteger} if you want to wrap integer values.\n * \n * This logic makes sense for some things like rotation angle.\n * \n * If you just want to lock values to a range without wrapping, consider {@link clamp}.\n * \n * ```js\n * wrap(1.2);   // 0.2\n * wrap(2);     // 1.0\n * wrap(-0.2); // 0.8\n * ```\n * \n * A range can be provided too:\n * ```js\n * wrap(30, 20, 50);  \t // 30\n * wrap(60, 20, 50);    //  30 \n * ```\n * @param v \n * @param min \n * @param max \n * @returns \n */\nexport const wrap = (v:number, min: number = 0, max:number = 1) => {\n  guardNumber(v, ``, `min`);\n  guardNumber(min, ``, `min`);\n  guardNumber(max, ``, `max`);\n\n  if (v === min) return min;\n  if (v === max) return min; // Wraps\n\n  while (v <= min || v >= max) {\n    if (v === max) break;\n    if (v === min) break;\n    if (v > max) {\n      v = min + (v-max);\n    } else if (v < min) {\n      v = max - (min-v);\n    }\n  }\n  return v;\n};\n\n/**\n * Performs a calculation within a wrapping number range. This is a lower-level function.\n * See also: {@link wrapInteger} for simple wrapping within a range.\n * \n * `min` and `max` define the start and end of the valid range, inclusive. Eg for hue degrees it'd be 0, 360.\n * `a` and `b` is the range you want to work in. \n * \n * For example, let's say you want to get the middle point between a hue of 30 and a hue of 330 (ie warmer colours):\n * ```js\n * wrapRange(0,360, (distance) => {\n *  // for a:0 and b:330, distance would be 90 from 30 degrees to 330 (via zero)\n *  return distance * 0.5; // eg return middle point \n * }, 30, 330);\n * ```\n * \n * The return value of the callback should be in the range of 0-distance. `wrapRange` will subsequently\n * conform it to the `min` and `max` range before it's returned to the caller.\n * \n * @param a Output start (eg. 60)\n * @param b Output end (eg 300)\n * @param min Range start (eg 0)\n * @param max Range end (eg 360)\n * @param fn Returns a computed value from 0 to `distance`.\n * @returns \n */\nexport const wrapRange = (min:number, max:number, fn:(distance:number)=>number, a:number, b:number) => {\n  //eslint-disable-next-line functional/no-let\n  let r = 0;\n  // No wrapping\n  const distF = Math.abs(b - a);\n  // When b is wrapped forwards\n  const distFwrap = Math.abs(max-a + b);\n  // When b is wrapped backwards (10, 300)\n  const distBWrap = Math.abs(a + (360-b));\n  \n  const distMin = Math.min(distF, distFwrap, distBWrap);\n  if (distMin === distBWrap) {\n    // (10, 300) = 70\n    r = a - fn(distMin);\n  } else if (distMin === distFwrap) {\n    // (300, 60) = 120\n    r = a + fn(distMin);\n  } else {\n    // Forwards or backwards without wrapping\n    if (a > b) {\n      // (240,120) -- backwards\n      r = a - fn(distMin);\n    } else {\n      // (120,240) -- forwards\n      r = a + fn(distMin);\n    }\n  }\n  return wrapInteger(r, min, max); \n};\n","/**\n * Returns the similarity of `a` and `b` to each other,\n * where higher similarity should be a higher number.\n * @param a \n * @param b \n */\nexport type Similarity<V> =(a:V, b:V)=>number;\n\ntype Scored = {\n  readonly score:number\n}\n\nconst orderScore = (a:Scored, b:Scored) => {\n  if (a.score > b.score) return -1;\n  else if (a.score < b.score) return 1;\n  return 0;\n};\n\n/**\n * Options for alignmnent\n */\nexport type AlignOpts = {\n  /**\n   * If the similarity score is above this threshold,\n   * consider them the same\n   */\n  readonly matchThreshold?:number\n  /**\n   * If true, additional console messages are printed during\n   * execution.\n   */\n  readonly debug?:boolean\n};\n\n/**\n * Some data with an id property.\n */\nexport type DataWithId<V> = V & {\n  readonly id:string\n}\n\n/**\n * Attempts to align prior data with new data, based on a provided similarity function.\n * \n * See also `alignById` for a version which encloses parameters.\n * \n * ```js\n * // Compare data based on x,y distance\n * const fn = (a, b) => {\n *  return 1-Points.distance(a, b);\n * }\n * const lastData = [\n *  { id:`1`, x:100, y:200 }\n *  ...\n * ]\n * const newData = [\n *  { id:`2`, x:101, y:200 }\n * ]\n * const aligned = Correlate.align(fn, lastdata, newData, opts);\n * \n * // Result:\n * [\n *  { id:`1`, x:101, y:200 }\n * ]\n * ```\n * @param similarityFn \n * @param lastData \n * @param newData \n * @param opts \n * @returns \n */\n//eslint-disable-next-line functional/immutable-data\nexport const align = <V>(similarityFn:Similarity<V>, lastData:readonly DataWithId<V>[]|undefined, newData:readonly DataWithId<V>[], opts:AlignOpts = {}):readonly DataWithId<V>[] => {\n  const matchThreshold = opts.matchThreshold ?? 0;\n  const debug = opts.debug ?? false;\n  const results = new Map();\n  const newThings:DataWithId<V>[] = [];\n  \n  const lastMap = new Map();\n  lastData?.forEach((d, index) => {\n    if (d === undefined) throw new Error(`'lastData' contains undefined (index: ${index})`);\n    lastMap.set(d.id, d);\n  });\n\n  //eslint-disable-next-line functional/no-let\n  for (let i=0;i<newData.length;i++) {\n    const newD = newData[i];\n\n    if (!lastData || lastData.length === 0) {\n      // No last data to compare to\n      if (debug) console.debug(`Correlate.align() new id: ${newD.id}`);\n\n      //eslint-disable-next-line functional/immutable-data\n      newThings.push(newD);\n      continue;\n    }\n\n    // Which of the old data does the new data match up to best?\n    const scoredLastValues = Array.from(lastMap.values()).map(last => ({ id: last.id, score: last === null ? -1 : similarityFn(last, newD), last }\n    ));\n\n    if (scoredLastValues.length === 0) {\n      if (debug) console.debug(`Correlate.align() no valid last values id: ${newD.id}`);\n      //eslint-disable-next-line functional/immutable-data\n      newThings.push(newD);\n      continue;\n    }\n    //eslint-disable-next-line functional/immutable-data\n    scoredLastValues.sort(orderScore);\n\n    // Top-ranked match is pretty low, must be something new\n    const top = scoredLastValues[0];\n    if (top.score < matchThreshold) {\n      if (debug) console.debug(`Correlate.align() new item does not reach threshold. Top score: ${top.score} id: ${newD.id}`);\n      //eslint-disable-next-line functional/immutable-data\n      newThings.push(newD);\n      continue;\n    }\n\n    // TODO: If there are close options to pick, need a pluggable\n    // function to determine which is the winner.\n\n    //    console.log(`updating prior ${top.score}. top: ${top.id} newD: ${newD.id}`);\n\n    // The new item is considered the same as top ranked\n    if (debug && top.id !== newD.id) console.log(`Correlate.align() Remapped ${newD.id} -> ${top.id} (score: ${top.score})`);\n\n    //eslint-disable-next-line functional/immutable-data\n    results.set(top.id, { ...newD, id: top.id });\n\n    // Remove that old one from the list\n    //eslint-disable-next-line functional/immutable-data\n    lastMap.delete(top.id);\n  }\n\n  //eslint-disable-next-line functional/immutable-data\n  newThings.forEach(t => results.set(t.id, t));\n  return Array.from(results.values());\n};\n\n/**\n * Returns a function that attempts to align a series of data by its id.\n * See also {@link align} for a version with no internal storage.\n * \n * ```js\n * // Compare data based on x,y distance\n * const fn = (a, b) => {\n *  return 1-Points.distance(a, b);\n * }\n * const aligner = Correlate.alignById(fn, opts);\n *\n * const lastData = [\n *  { id:`1`, x:100, y:200 }\n *  ...\n * ]\n * const aligned = aligner(lastData);\n * \n * ```\n * @param fn \n * @param opts \n * @returns \n */\nexport const alignById = <V>(fn:Similarity<V>, opts:AlignOpts = {}) => {\n  //eslint-disable-next-line functional/no-let\n  let lastData:readonly DataWithId<V>[] = [];\n\n  const compute = (newData:DataWithId<V>[]) => {\n    lastData = align(fn, lastData, newData, opts);\n    return [...lastData];\n  };\n  return compute;\n};","import { SimpleEventEmitter } from \"../Events.js\";\nimport * as Debug from \"../Debug.js\";\n/**\n * Policy for when the pool is fully used\n */\nexport type FullPolicy = `error`|`evictOldestUser`\n\n/**\n * Pool options\n */\n//eslint-disable-next-line functional/no-mixed-type\nexport type Opts<V> = {\n  /**\n   * Maximum number of resources for this pool\n   */\n  readonly capacity?:number\n  /**\n   * If above 0, users will be removed if there is no activity after this interval.\n   * Activity is marked whenever `use` us called with that user key\n   */\n  readonly userExpireAfterMs?:number\n  /**\n   * If above 0, resources with no users will be automatically removed after this interval\n   */\n  readonly resourcesWithoutUserExpireAfterMs?:number\n  /**\n   * Maximum number of users per resource. Defaults to 1\n   */\n  readonly capacityPerResource?:number\n  /**\n   * What to do if pool is full and a new resource allocation is requested\n   */\n  readonly fullPolicy?:FullPolicy\n  /**\n   * If true, additional logging will trace activity of pool\n   */\n  readonly debug?:boolean\n  /**\n   * If specified, this function will generate new resources as needed.\n   */\n  readonly generate?:()=>V\n  /**\n   * If specified, this function will be called when a resource is disposed\n   */\n  readonly free?:(v:V)=>void\n}\n\n/**\n * Function that initialises a pool item\n */\n//export type InitPoolItem_ = <V>(id:string)=>V;\n\n/**\n * State of pool\n */\nexport type PoolState = `idle`|`active`|`disposed`;\n\nexport type PoolUserEventMap<V> = {\n  readonly disposed:{ readonly data:V, readonly reason:string }\n  readonly released:{ readonly data:V, readonly reason:string }\n};\n\n/**\n * A use of a pool resource\n * \n * Has two events, _disposed_ and _released_.\n */\nexport class PoolUser<V> extends SimpleEventEmitter<PoolUserEventMap<V>> {\n  private _lastUpdate:number;\n  private _pool:Pool<V>;\n  private _state:PoolState;\n  private _userExpireAfterMs:number;\n\n  /**\n   * Constructor\n   * @param key User key\n   * @param resource Resource being used\n   */\n  constructor(readonly key:string, readonly resource:Resource<V>) {\n    super();\n    this._lastUpdate = performance.now();\n    this._pool = resource.pool;\n    this._userExpireAfterMs = this._pool.userExpireAfterMs;\n    this._state = `idle`;\n    this._pool.log.log(`PoolUser ctor key: ${this.key}`);\n  }\n\n  /**\n   * Returns a human readable debug string\n   * @returns \n   */\n  toString() {\n    if (this.isDisposed) return `PoolUser. State: disposed`;\n\n    return `PoolUser. State: ${this._state} Elapsed: ${performance.now()-this._lastUpdate} Data: ${JSON.stringify(this.resource.data)}`;\n  }\n\n  /**\n   * Resets countdown for instance expiry.\n   * Throws an error if instance is disposed.\n   */\n  keepAlive() {\n    if (this._state === `disposed`) throw new Error(`PoolItem disposed`);\n    this._lastUpdate = performance.now();\n  }\n\n  /**\n   * @internal\n   * @param reason \n   * @returns \n   */\n  _dispose(reason:string) {\n    if (this._state ===`disposed`) return;\n    const resource = this.resource;\n    const data = resource.data;\n    this._state = `disposed`;\n    resource._release(this);\n    this._pool.log.log(`PoolUser dispose key: ${this.key} reason: ${reason}`);\n    this.fireEvent(`disposed`, { data, reason });\n    super.clearEventListeners();\n  }\n\n  /**\n   * Release this instance\n   * @param reason \n   */\n  release(reason:string) {\n    if (this.isDisposed) throw new Error(`User disposed`);\n    const resource = this.resource;\n    const data = resource.data;\n    this._pool.log.log(`PoolUser release key: ${this.key} reason: ${reason}`);\n    this.fireEvent(`released`, { data, reason });\n    this._dispose(`release-${reason}`);\n  }\n\n  // #region Properties\n  get data():V {\n    if (this.isDisposed) throw new Error(`User disposed`);\n    return this.resource.data;\n  }\n\n  /**\n   * Returns true if this instance has expired.\n   * Expiry counts if elapsed time is greater than `userExpireAfterMs` \n   */\n  get isExpired() {\n    if (this._userExpireAfterMs > 0) {\n      return performance.now() > (this._lastUpdate + this._userExpireAfterMs);\n    }\n    return false;\n  }\n\n  /**\n   * Returns elapsed time since last 'update'\n   */\n  get elapsed() {\n    return performance.now() - this._lastUpdate;\n  }\n\n  /**\n   * Returns true if instance is disposed\n   */\n  get isDisposed() {\n    return this._state === `disposed`;\n  }\n\n  /**\n   * Returns true if instance is neither disposed nor expired\n   */\n  get isValid() {\n    if (this.isDisposed || this.isExpired) return false;\n    if (this.resource.isDisposed) return false;\n    return true;\n  }\n  // #endregion\n\n}\n\n/**\n * A resource allocated in the Pool\n */\nexport class Resource<V> {\n  private state:PoolState;\n  private readonly _data:V;\n  private users:PoolUser<V>[];\n  private readonly capacityPerResource;\n  private readonly resourcesWithoutUserExpireAfterMs;\n  private lastUsersChange:number;\n\n  /**\n   * Constructor.\n   * @param pool Pool\n   * @param data Data\n   */\n  constructor(readonly pool:Pool<V>, data:V) {\n    this._data = data;\n    this.lastUsersChange = 0;\n    this.resourcesWithoutUserExpireAfterMs = pool.resourcesWithoutUserExpireAfterMs;\n    this.capacityPerResource = pool.capacityPerResource;\n    this.users = [];\n    this.state = `idle`;\n  }\n\n  /**\n   * Gets data associated with resource.\n   * Throws an error if disposed\n   */\n  get data() {\n    if (this.state === `disposed`) throw new Error(`Resource disposed`);\n    return this._data;\n  }\n\n  /**\n   * Returns a human-readable debug string for resource\n   * @returns\n   */\n  toString() {\n    return `Resource (expired: ${this.isExpiredFromUsers} users: ${this.users.length}, state: ${this.state}) data: ${JSON.stringify(this.data)}`;\n  }\n\n  /**\n   * Assigns a user to this resource.\n   * @internal\n   * @param user \n   */\n  _assign(user:PoolUser<V>) {\n    const existing = this.users.find(u => u === user || u.key === user.key);\n    if (existing) throw new Error(`User instance already assigned to resource`);\n    this.users.push(user);\n    this.lastUsersChange = performance.now();\n  }\n\n  /**\n   * Releases a user from this resource\n   * @internal\n   * @param user \n   */\n  _release(user:PoolUser<V>) {\n    this.users = this.users.filter(u => u !== user);\n    this.pool._release(user);\n    this.lastUsersChange = performance.now();\n  }\n\n  /**\n   * Returns true if resource can have additional users allocated\n   */\n  get hasUserCapacity() {\n    return this.usersCount < this.capacityPerResource;\n  }\n\n  /**\n   * Returns number of uses of the resource\n   */\n  get usersCount() {\n    return this.users.length;\n  }\n\n  /**\n   * Returns true if automatic expiry is enabled, and that interval\n   * has elapsed since the users list has changed for this resource\n   */\n  get isExpiredFromUsers() {\n    if (this.resourcesWithoutUserExpireAfterMs <= 0) return false;\n    if (this.users.length > 0) return false;\n    return performance.now() > this.resourcesWithoutUserExpireAfterMs + this.lastUsersChange;\n  }\n\n  /**\n   * Returns true if instance is disposed\n   */\n  get isDisposed() {\n    return (this.state ===`disposed`);\n  }\n\n  /**\n   * Disposes the resource.\n   * If it is already disposed, it does nothing.\n   * @param reason\n   * @returns \n   */\n  dispose(reason:string) {\n    if (this.state ===`disposed`) return;\n    const data = this._data;\n    this.state = `disposed`;\n    this.pool.log.log(`Resource disposed (${reason})`);\n    for (const u of this.users) {\n      u._dispose(`resource-${reason}`);\n    }\n    this.users = [];\n    this.lastUsersChange = performance.now();\n    this.pool._releaseResource(this, reason); \n\n    if (this.pool.freeResource) this.pool.freeResource(data);\n    \n  }\n}\n\n/**\n * Resource pool\n */\nexport class Pool<V> {\n  private _resources:Resource<V>[];\n  private _users:Map<string, PoolUser<V>>;\n  \n  readonly capacity:number;\n  readonly userExpireAfterMs:number;\n  readonly resourcesWithoutUserExpireAfterMs:number;\n\n  readonly capacityPerResource:number;\n  readonly fullPolicy:FullPolicy;\n  private generateResource?:()=>V;\n  readonly freeResource?:(v:V)=>void;\n\n  readonly log:Debug.LogSet;\n\n  /**\n   * Constructor.\n   * \n   * By default, no capacity limit, one user per resource\n   * @param opts Pool options\n   */\n  constructor(opts:Opts<V> = {}) {\n    this.capacity = opts.capacity ??  -1;\n    this.fullPolicy = opts.fullPolicy ?? `error`;\n    this.capacityPerResource = opts.capacityPerResource ?? 1;\n    this.userExpireAfterMs = opts.userExpireAfterMs ?? -1;\n    this.resourcesWithoutUserExpireAfterMs = opts.resourcesWithoutUserExpireAfterMs ?? -1;\n    \n    this.generateResource = opts.generate;\n    this.freeResource = opts.free;\n\n    this._users = new Map();\n    this._resources = [];\n\n    this.log = Debug.logSet(`Pool`, opts.debug ?? false);\n\n    // If we have a time-based expiry, set an interval to\n    // automatically do the housekeeping\n    const timer = Math.max(this.userExpireAfterMs, this.resourcesWithoutUserExpireAfterMs);\n    if (timer > 0) {\n      setInterval(() => {\n        this.maintain();\n      }, timer*1.1);\n    }\n  }\n\n  /**\n   * Returns a debug string of Pool state\n   * @returns \n   */\n  dumpToString() {\n    //eslint-disable-next-line functional/no-let\n    let r = \n    `Pool\n    capacity: ${this.capacity} userExpireAfterMs: ${this.userExpireAfterMs} capacityPerResource: ${this.capacityPerResource}\n    resources count: ${this._resources.length}`;\n\n    const res = this._resources.map(r => r.toString()).join(`\\r\\n\\t`);\n    r +=`\\r\\nResources:\\r\\n\\t` + res;\n\n    r += `\\r\\nUsers: \\r\\n`;\n    for (const [k, v] of this._users.entries()) {\n      r += `\\tk: ${k} v: ${v.toString()}\\r\\n`;\n    }\n    return r;\n  }\n\n  /**\n   * Sorts users by longest elapsed time since update\n   * @returns \n   */\n  getUsersByLongestElapsed() {\n    return [...this._users.values()].sort((a, b) => {\n      const aa = a.elapsed;\n      const bb = b.elapsed;\n      if (aa === bb) return 0;\n      if (aa < bb) return 1;\n      return -1;\n    });\n  }\n\n  /**\n   * Returns resources sorted with least used first\n   * @returns \n   */\n  getResourcesSortedByUse() {\n    return [...this._resources].sort((a, b) => {\n      if (a.usersCount === b.usersCount) return 0;\n      if (a.usersCount < b.usersCount) return -1;\n      return 1;\n    });\n  }\n\n  /**\n   * Adds a resource to the pool.\n   * Throws an error if the capacity limit is reached.\n   * @param resource\n   * @returns \n   */\n  addResource(resource:V) {\n    if (resource === undefined) throw new Error(`Cannot add undefined resource`);\n    if (resource === null) throw new Error(`Cannot add null resource`);\n\n    if (this.capacity > 0 && this._resources.length === this.capacity) throw new Error(`Capacity limit (${this.capacity}) reached. Cannot add more.`);\n\n    this.log.log(`Adding resource: ${JSON.stringify(resource)}`);\n    const pi = new Resource<V>(this, resource);\n    this._resources.push(pi);\n    return pi;\n  }\n\n  /**\n * Performs maintenance, removing disposed/expired resources & users.\n * This is called automatically when using a resource.\n */\n  maintain() {\n    //eslint-disable-next-line functional/no-let\n    let changed = false;\n\n\n    // Find all disposed resources\n    const nuke:Resource<V>[] = [];\n    for (const p of this._resources) {\n      if (p.isDisposed) {\n        this.log.log(`Maintain, disposed resource: ${JSON.stringify(p.data)}`);\n        nuke.push(p);\n      } else if (p.isExpiredFromUsers) {\n        this.log.log(`Maintain, expired resource: ${JSON.stringify(p.data)}`);\n        nuke.push(p);\n      }\n    }\n\n    // Remove them\n    if (nuke.length > 0) {\n      for (const res of nuke) {\n        res.dispose(`diposed/expired`);\n      }\n      changed = true;\n    }\n\n    // Find 'users' to clean up\n    const userKeysToRemove:string[] = [];\n    for (const [key, user] of this._users.entries()) {\n      if (!user.isValid) {\n        this.log.log(`Maintain. Invalid user: ${user.key} (Disposed: ${user.isDisposed} Expired: ${user.isExpired} Resource disposed: ${user.resource.isDisposed})`);\n\n        userKeysToRemove.push(key);\n        user._dispose(`invalid`);\n      }\n    }\n\n    for (const userKey of userKeysToRemove) {\n      this._users.delete(userKey);\n      changed = true;\n    }\n\n    if (changed) {\n      this.log.log(`End: resource len: ${this._resources.length} users: ${this.usersLength}`);\n    }\n  }\n\n  /**\n   * Iterate over resources in the pool.\n   * To iterate over the data associated with each resource, use\n   * `values`.\n   */\n  *resources() {\n    const res = [...this._resources];\n    for (const r of res) {\n      yield r;\n    }\n  }\n\n  /**\n   * Iterate over resource values in the pool.\n   * to iterate over the resources, use `resources`.\n   * \n   * Note that values may be returned even though there is no\n   * active user.\n   */\n  *values() {\n    const res = [...this._resources];\n    for (const r of res) {\n      yield r.data;\n    }\n  }\n  \n  /**\n   * Unassociate a key with a pool item\n   * @param userKey \n   */\n  release(userKey:string, reason?:string):void {\n    const pi = this._users.get(userKey);\n    if (!pi) return;\n    pi.release(reason ?? `Pool.release`);\n  }\n\n  /**\n  * @internal\n  * @param user \n  */\n  _release(user:PoolUser<V>) {\n    this._users.delete(user.key);\n  }\n\n  /**\n   * @internal\n   * @param resource\n   * @param _ \n   */\n  _releaseResource(resource:Resource<V>, _:string) {\n    this._resources = this._resources.filter(v => v !== resource);\n  }\n\n  /**\n   * Returns true if `v` has an associted resource in the pool\n   * @param res \n   * @returns \n   */\n  hasResource(res:V):boolean {\n    const found =  this._resources.find(v => v.data === res);\n    return found !== undefined;\n  }\n\n  /**\n   * Returns true if a given `userKey` is in use.\n   * @param userKey \n   * @returns \n   */\n  hasUser(userKey:string):boolean {\n    return this._users.has(userKey);\n  }\n\n  /**\n   * @internal\n   * @param key \n   * @param resource \n   * @returns \n   */\n  private _assign(key:string, resource:Resource<V>) {\n    const u = new PoolUser<V>(key, resource);\n    this._users.set(key, u);\n    resource._assign(u);\n    return u;\n  }\n\n  /**\n   * @internal\n   * @param userKey \n   * @returns \n   */\n  private _findUser(userKey:string):PoolUser<V>|undefined {\n    // Sort items by number of users per pool item\n    const sorted = this.getResourcesSortedByUse();\n    //eslint-disable-next-line functional/no-let\n    // for (let i=0;i<sorted.length;i++) {\n    //   console.log(i +`. users: ` + sorted[i].usersCount);\n    // }\n    if (sorted.length > 0 && sorted[0].hasUserCapacity) {\n      // No problem, resource has capacity\n      this.log.log(`resource has capacity: ${sorted[0].data}`);\n      const u = this._assign(userKey, sorted[0]);\n      return u;\n    }\n  \n    // If resource count is below capacity, can we generate more?\n    if (this.generateResource && (this.capacity < 0  || this._resources.length < this.capacity)) {\n      this.log.log(`capacity: ${this.capacity} resources: ${this._resources.length}`);\n      const newResource = this.addResource(this.generateResource());\n      const u = this._assign(userKey, newResource);\n      return u;\n    }\n  }\n\n  /**\n   * Return the number of users\n   */\n  get usersLength() {\n    return [...this._users.values()].length;\n  }\n\n  /**\n   * 'Uses' a resource, returning the value\n   * @param userKey \n   * @returns \n   */\n  useValue(userKey:string):V {\n    const res = this.use(userKey);\n    return res.resource.data;\n  }\n\n  /**\n   * Gets a pool item based on a user key.\n   * The same key should return the same pool item,\n   * for as long as it still exists.\n   * @param userKey \n   * @returns \n   */\n  use(userKey:string):PoolUser<V> {\n    const pi = this._users.get(userKey);\n    if (pi) {\n      pi.keepAlive();\n      return pi;\n    }\n    \n    this.maintain();\n\n    const match = this._findUser(userKey);\n    if (match) return match;\n\n    // Throw an error if all items are being used\n    if (this.fullPolicy === `error`) {\n      console.log(this.dumpToString());\n      throw new Error(`Pool is fully used (fullPolicy: ${this.fullPolicy}, capacity: ${this.capacity})`);\n    }\n    // Evict oldest user\n    if (this.fullPolicy === `evictOldestUser`) {\n      const users = this.getUsersByLongestElapsed();\n      if (users.length > 0) {\n        this.release(users[0].key, `evictedOldestUser`);\n\n        const match2 = this._findUser(userKey);\n        if (match2) return match2;\n      }\n    }\n\n    // Evict newest user\n\n    // Evict from random pool item\n    throw new Error(`Pool is fully used (${this.fullPolicy})`);\n  }\n}\n\n/**\n * Creates an instance of a Pool\n * @param opts \n * @returns \n */\nexport const create = <V>(opts:Opts<V> = {}):Pool<V> => new Pool<V>(opts);","import {piPi} from \"./index.js\";\nimport {wrap} from \"./Wrap.js\";\n\n/**\n * Interpolates between `a` and `b` by `amount`. Aka `lerp`.\n * \n * [ixfx Guide](https://clinth.github.io/ixfx-docs/modulation/interpolate/)\n * \n * @example Get the halfway point between 30 and 60\n * ```js\n * import {interpolate} from 'https://unpkg.com/ixfx/dist/data.js';\n * interpolate(0.5, 30, 60);\n * ```\n * \n * Interpolation is often used for animation. In that case, `amount`\n * would start at 0 and you would keep interpolating up to `1`\n * @example\n * ```js\n * import { interpolate } from 'https://unpkg.com/ixfx/dist/data.js';\n * import { percentPingPong } from 'https://unpkg.com/ixfx/dist/modulation.js'\n * \n * // Go back and forth between 0 and 1 by 0.1\n * let pp = percentPingPong(0.1);\n * continuously(() => {\n *  // Get position in ping-pong\n *  const amt = pp.next().value;\n *  // interpolate between Math.PI and Math.PI*2\n *  const v = interpolate(amt, Math.PI, Math.PI*2); \n *  // do something with v...\n * }).start();\n * ```\n * \n * See also {@link Visual.Colour.interpolate | Visual.Colour.interpolate }, {@link Geometry.Points.interpolate | Geometry.Points.interpolate}.\n * @param amount Interpolation amount, between 0 and 1 inclusive\n * @param a Start (ie when `amt` is 0)\n * @param b End (ie. when `amt` is 1)\n * @returns Interpolated value which will be between `a` and `b`.\n */\nexport const interpolate =(amount:number, a:number, b:number):number => {\n  const v = (1-amount) * a + amount * b;\n  return v;\n};\n\n/**\n * Interpolate between angles `a` and `b` by `amount`. Angles are in radians.\n * \n * ```js\n * import { interpolateAngle } from 'https://unpkg.com/ixfx/dist/data.js';\n * interpolateAngle(0.5, Math.PI, Math.PI/2);\n * ```\n * @param amount \n * @param aRadians \n * @param bRadians \n * @returns \n */\nexport const interpolateAngle = (amount:number, aRadians:number, bRadians:number):number => {\n  const t = wrap(bRadians-aRadians, 0, piPi);\n  return interpolate(amount, aRadians, aRadians + (t > Math.PI ? t - piPi : t));\n};"],"mappings":"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","names":["B","S","apply","identity","flip","t","pipe","__spreadArray","from","__createBinding","__importStar","A","S","bind","__createBinding","__importStar","from","map","_map","E","contramap","empty","compare","contramap","min","max","clamp","between","__createBinding","__importStar","min","max","first","S","_","__createBinding","__importStar","__spreadArray","from","init","E","a","rotate","start","y","group","groupBy","sort","zip","bs","abs","_map","_","extend","map","reduce","b","S","min","max","filter","__createBinding","__importStar","__spreadArray","from","tail","init","E","a","rotate","start","y","group","groupBy","sort","zip","bs","abs","_map","_","extend","map","S","filter","left","right","_map","map","__createBinding","__importStar","C","guard","__createBinding","__importStar","__spreadArray","from","N","isEmpty","as","init","sort","zip","bs","rotate","E","input","second","intersection","ys","_map","zero","_","map","filter","extend","reduce","b","S","e","toArray","__createBinding","__importStar","isEmpty","init","sort","zip","bs","rotate","E","input","second","intersection","ys","_map","zero","map","_","filter","extend","start","isEmpty","__extends","__assign","__rest","__decorate","__param","__metadata","__awaiter","__generator","__exportStar","__values","__read","__spread","__spreadArrays","__spreadArray","__await","__asyncGenerator","__asyncDelegator","__asyncValues","__makeTemplateObject","__importStar","__importDefault","__classPrivateFieldGet","__classPrivateFieldSet","__createBinding","exports","t","from","v","global","module","document","S","key","isFunction","toString","length","c","source","exports","pos","codePointAt","max","min","fromCodePoint","stack","line","parse","text","peek","token","zero","string","start","buffer","push","pop","stringify","value","i","list","JSON5","minMaxAvg","mergeByKey","remove","gaussian","integer","interpolate","piPi","array","t","total","validNumbers","min","max","array","bbox","guard","interpolate","isEqual","length","toPath","Empty","Placeholder","apply","bbox","clamp","distance","divide","dotProduct","fromNumbers","interpolate","isEmpty","isEqual","isNaN","isPlaceholder","multiply","normaliseByRect","quantiseEvery","rotate","subtract","sum","toArray","toString","withinRange","wrap","guard","interpolate","isEmpty","start","length","chunks","text","time","key","existing","map","set","t","scale","opacity","min","max","opacity","t","opacity","opacity","t1","t2","t3","t","t","t","color","rgb","start","opacity","t","t","t","t","t","t","t","i","t","hsl","hue","start","opacity","t","lab","start","opacity","t","hcl","hue","start","opacity","t","cubehelix","hue","start","opacity","t","interpolate","t","i","rgb","hsl","hue","from","lab","scale","min","max","path","start","paths","o","set","t","stack","queue","t","peek","isEmpty","isFull","map","data","isEmpty","line","guard","point","height","sum","interpolate","dot","t","distance","start","average","averageWeighted","filter","max","min","total","t","average","averageWeighted","min","max","total","filter","start","dotProduct","Empty","Placeholder","isEmpty","isPlaceholder","isNaN","min","distance","sum","bbox","toArray","toString","isEqual","withinRange","interpolate","fromNumbers","subtract","apply","pipeline","multiply","divide","quantiseEvery","angle","rotate","length","normaliseByRect","wrap","rounder","max","clamp","start","from","arc","angleRadian","guard","interpolate","toPath","point","bbox","length","start","isEqual","toPath","abs","t","t2","sum","dot","point","bbox","bbox2","intersections","start","min","max","line","reduce","a","b","c","d","v1","q","t1","arc","bbox","offset","abs","min","max","cos","sin","acos","sqrt","pi","point","t","abs","S","B","E","A","angle","C","t1","t2","pi","sqrt","acos","d","start","ls","le","segments","tlen","alen","line","min","max","intersections","arc","cos","sin","path","start","toPath","cubic","cubic2","t","quadraticBezier","quadratic","bbox","distanceCenter","interpolate","isEqual","isNaN","isPositioned","length","multiplyScalar","nearest","point","toPath","toSvg","piPi","isPositioned","point","circle","angleRadian","guard","interpolate","t","length","bbox","distanceCenter","isNaN","isEqual","centroid","intersection","multiplyScalar","toSvg","toSvgFull","nearest","toPath","line","bbox","interpolate","toString","toSvgString","path","interpolate","paths","t","lengths","bbox","corners","toString","start","toSvgString","isEqual","isEqual","grid","start","cells","t","visitor","path","area","center","distanceFromExterior","fromNumbers","guard","isEmpty","isEqual","isPlaceholder","isPositioned","multiply","multiplyScalar","normaliseByRect","random","subtract","sum","toArray","isEmpty","rect","isPlaceholder","isPositioned","fromNumbers","height","toArray","isEqual","subtract","sum","guard","distanceFromExterior","guardPositioned","center","normaliseByRect","multiply","multiplyScalar","area","random","fromDegrees","fromDegrees","center","clampMagnitude","divide","dotProduct","guard","invert","multiply","normalise","rotate","toString","piPi","point","subtract","angle","Empty","rotate","normalise","guard","dotProduct","invert","multiply","divide","clampMagnitude","max","min","distance","toString","center","angle","from","angleRadian","arrow","clampMagnitude","divide","dotProduct","multiply","normalise","subtract","sum","toCartesian","toString","EmptyCartesian","piPi","pi","subtract","distance","line","guard","normalise","Empty","toCartesian","toString","dotProduct","clampMagnitude","max","min","sum","multiply","divide","fromPoints","fromPoints","paths","nearest","distance","normalise","abs","cos","sin","sqrt","pow","pi","piPi","circle","max","angle","offset","Empty","Placeholder","apply","area","bbox","centroid","corners","edges","fromFlatArray","fromPoints","guard","intersectsPoint","isEmpty","isEqual","isPlaceholder","lengths","perimeter","rotate","toFlatArray","area","fromCenter","perimeter","t","area","circumcircle","height","incircle","perimeter","t","area","circumcircle","fromA","fromB","fromC","fromCenter","height","incircle","medians","perimeter","t","piPi","Empty","Placeholder","isEmpty","t","isPlaceholder","apply","guard","isEqual","corners","edges","lengths","distance","centroid","total","perimeter","area","angles","fromPoints","triangle","rotate","length","angleRadian","toFlatArray","fromFlatArray","fromNumbers","bbox","gamma","intersectsPoint","point","config","line","rx","freq","height","offset","hue","button","rect","freq","stream","debug","config","line","config","debug","debug","stream","t","start","startWithVideoEl","capture","c","start","tslib","Subscription","empty","Subscriber","ConsumerObserver","SafeSubscriber","Observable","observable","init","OperatorSubscriber","err","Action","AsyncAction","Scheduler","AsyncScheduler","fromIterable","array","repeat","map","project","map","project","project","map","add","remove","height","scaler","rect","data","t","JSON5","rows","stack","draw","arc","apply","push","pop","path","point","quadratic","t","corners","text","line","applyOpts","clear","makeHelper","applyOpts","circle","line","applyOpts","circle","line","text","center","height","clear","applyOpts","height","makeHelper","text","line","circle","center","add","piPi","min","max","add","height","plot","canvasSize","isPlaceholder","isEqual","isPositioned","plot","series","v","sample","rows","text","paths","create","create","create","from","defaultErrorHandler","line","stack","log","timestamp","clear","clear","map","start","opts","t","distance","subtract","Placeholder","start","hue","tracker","el","defaultErrorHandler","offset","max","toPath","apply","guard","guard","t","apply","t","mass","pipeline","angle","length","distance","triangle","piPi","from","t","triangle","jitter","_store","t","freq","average","clear","add","min","max","debug","t","create","r","pi","create","piPi","interpolate","t","piPi","sqrt","pow","cos","pi","sin","create","t","t2","t3","interpolate","min","max","gaussian","integer","length","array","lengths","length","add","t","total","remove","mergeByKey","reverseOrd","minMaxAvg"]}